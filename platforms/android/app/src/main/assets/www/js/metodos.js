    var IdUsuario = localStorage.getItem("IdUsuario");
    $("#IdUsuario").val(IdUsuario);
    //Borrar variables de sesion y regresar a el Log-in
    function logaout(){
        window.localStorage.clear();
        window.location.href = "index.html";
    }
    //Bennetts Inicio
    function buscarClienteBennetts() {
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var horario_programado = fecha_llegada;
        var estatus = 0;
        productHandler.addBennetts(id_usuario, nombre_usuario, fecha_llegada, geolocation, horario_programado, estatus);
        databaseHandler.db.transaction(
          function (tx) {
            tx.executeSql(
              "Select MAX(id_cedula) as Id from cedulas_general",
              [],
              function (tx, results) {
                var item = results.rows.item(0);
                localStorage.setItem("IdCedula", item.Id);
                app.views.main.router.navigate({ name: "menuBennetts" });
                app.preloader.hide();
              },
              function (tx, error) {
                console.log("Error al guardar cedula: " + error.message);
                app.preloader.hide();
              }
            );
          },
          function (error) {},
          function () {}
        );
      }
      function continuarCedBennetts(id_cedula,tipo){
        localStorage.setItem("IdCedula",id_cedula);
        localStorage.setItem("Opcion", '1');
        if(tipo == 1){
            app.views.main.router.navigate({ name: 'menuBennetts'});
        } else if(tipo == 2){
            app.views.main.router.back('/recorridoBennetts2/', {force: true, ignoreCache: true, reload: true});
        }
      }
      function guardarDatosBennetts(){
        app.preloader.show('blue');
        if($("#division").val() == "0"){
          swal("", "Debes de llenar todos los campos" , "warning");
          app.preloader.hide();
          return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var division = $("#division").val();
        databaseHandler.db.transaction(
          function(tx){
            tx.executeSql("UPDATE cedulas_general SET nombre_cliente = ? WHERE id_cedula = ?",
            [division,id_cedula],
            function(tx, results){
              $("#division").css("background-color", "#FFFFFF");
              swal("","Se guardaron los datos correctamente", "success");
              app.preloader.hide();
            },
            function(tx, error){
              swal("Error al guardar", error.message, "error");
              app.preloader.hide();
            }
            );
          },
          function(error){},
          function(){}
        );
      
      }
      function guardarDatosBennetts2(){
        app.preloader.show('blue');
        if($("#nombre_comp").val() == "" || $("#almacen").val() == "0" || $("#empresa").val() == "0"){
          swal("", "Debes de llenar todos los campos" , "warning");
          app.preloader.hide();
          return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombre_comp = $("#nombre_comp").val();
        var almacen = $("#almacen").val();
        var empresa = $("#empresa").val();
        databaseHandler.db.transaction(
          function(tx){
            tx.executeSql("UPDATE inventario SET pareja_almacen = ?, almacen = ?, empresa = ? WHERE id_cedula = ?",
            [nombre_comp,almacen,empresa,id_cedula],
            function(tx, results){
                if(empresa == 1 && almacen == 1){
                    var inventario = "codigos_bennetts"
                } else if(empresa == 1 && almacen == 2){
                    var inventario = "codigos_bennetts2"
                } else if(empresa == 2 && almacen == 1){
                    var inventario = "codigos_bennetts3"
                } else {
                    var inventario = "codigos_bennetts4"
                }
                localStorage.setItem("almacen", inventario);
              $("#nombre_comp").css("background-color", "#FFFFFF");
              swal("","Se guardaron los datos correctamente", "success");
              app.preloader.hide();

            },
            function(tx, error){
              swal("Error al guardar", error.message, "error");
              app.preloader.hide();
            }
            );
          },
          function(error){},
          function(){}
        );
      
      }
      function datosCheckB(){
        var checkbox1 = document.getElementById("destruccion");
        var checkbox2 = document.getElementById("baja"); 
       checkbox1.onclick = function(){ 
       if(checkbox1.checked != false){ 
       checkbox2.checked =null; }
        } 
       checkbox2.onclick = function(){ 
       if(checkbox2.checked != false){ 
       checkbox1.checked=null;
        }
       
        } 
       }
       
    function actaBajaProducto(){
        app.preloader.show('blue');
        if($("#codigo").val() == "" || $("#descripcion").val() == "" || $("#cantidad").val() == "" || ($("#destruccion").prop("checked") == false && $("#baja").prop("checked") == false) || $("#motivo").val() == "" || $("#imagenC1").val() == "" || $("#imagenC2").val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var codigo_producto = $("#codigo").val();
        var descripcion_producto = $("#descripcion").val();
        var cantidad_producto = $("#cantidad").val();
        var motivo = $("#motivo").val();
        if ($("#destruccion").prop("checked") == true){
        var aplica = 1; 
        } else {
        var aplica = 0;
        }
        var evidencia_foto_antes = $('#imagenC1').val();
        var evidencia_foto_despues = $('#imagenC2').val();
        var fechaR = new Date();
        var fecha = fechaR.getFullYear()+"-"+(fechaR.getMonth()+1)+"-"+fechaR.getDate()+" "+fechaR.getHours()+":"+fechaR.getMinutes()+":"+fechaR.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
            
                tx.executeSql("INSERT INTO productos(id_cedula,codigo_producto,descripcion_producto,cantidad_producto,motivo, aplica, evidencia_foto_antes,evidencia_foto_despues,fecha) VALUES (?,?,?,?,?,?,?,?,?)",
                    [id_cedula,codigo_producto,descripcion_producto,cantidad_producto,motivo, aplica, evidencia_foto_antes,evidencia_foto_despues,fecha],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_producto) as Id from productos",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from productos where id_producto = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        if(item.aplica ==1){
                                                        var valoraplica = "Destrucci√≥n";
                                                        } else{
                                                        var valoraplica = "Baja";
                                                        }
                                                        $("#smallImage1").attr("src","img/blank.png");
                                                        $("#smallImage2").attr("src","img/blank.png");
                                                        $('#imagenC1').val("");
                                                        $('#imagenC2').val("");
                                                        $("#photoIcon1").attr("src","img/camera.svg");
                                                        $("#photoIcon2").attr("src","img/camera.svg");
                                                        $("#tabla_productos tbody").append("<tr id='fila"+ item.id_producto +"'><td><a href='#' onclick='eliminarFilaBennetts("+ item.id_producto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td style='text-align: center;'>" + unescape(item.codigo_producto) + "</td><td style='text-align: center;'>" + unescape(item.descripcion_producto) + "</td><td style='text-align: center;'>" + unescape(item.cantidad_producto) + "</td><td style='text-align: center;'>" + unescape(item.motivo) + "</td><td style='text-align: center;'>" + valoraplica + "</td><td><img src='"+item.evidencia_foto_antes+"' width='60px' style='margin-top: 4px;'/></td><td><img src='"+item.evidencia_foto_despues+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.fecha + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $("#codigo").css("background-color","#ffffff");
                                                        $("#descripcion").css("background-color","#ffffff");
                                                        $("#cantidad").css("background-color","#ffffff");
                                                        $("#motivo").css("background-color","#ffffff");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Acuerdo guardado","success");
                        app.preloader.hide();
                        
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function deleteForm() {
        document.getElementById("demo-form").reset();
    }
    function eliminarFilaBennetts(index, opc, contexto){
        if(opc == 1) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM productos WHERE id_producto = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else if(opc == 2) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM conteo WHERE id_conteo = ?",
                        [index],
                        function(tx, results){
                            var table = $("#inventario").DataTable();
                            table.row($(contexto).parents('tr')).remove().draw();
                            swal("","El registro se elimito satisfactoriamente","success");
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function guardarCierreBennetts() {
        if ($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#puesto").val() == "" || $("#correo").val() == ""){
          swal("", "Todos los campos son obligatorios", "warning");
          return false;
        }
        
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var correo = $("#correo").val();
        var puesto = $("#puesto").val();
        var correo = $("#correo").val()
        var fecha = new Date();
        var fecha_firma =
          fecha.getFullYear() +
          "-" +
          (fecha.getMonth() + 1) +
          "-" +
          fecha.getDate() +
          " " +
          fecha.getHours() +
          ":" +
          fecha.getMinutes() +
          ":" +
          fecha.getSeconds();
        databaseHandler.db.transaction(
          function (tx) {
            tx.executeSql(
              "UPDATE datos_productos SET firma_cliente = ?, puesto = ?,correo = ? WHERE id_cedula = ?",
              [firmaCliente, puesto,correo, id_cedula],
              function (tx, results) {
                databaseHandler.db.transaction(
                  function (tx) {
                    tx.executeSql(
                      "UPDATE cedulas_general SET nombre_evalua = ?, horario_programado = ? WHERE id_cedula = ?",
                      [nombrefirma,puesto,id_cedula],
                      function (tx, results) {
                        swal("", "Guardado correctamente", "success");
                        app.views.main.router.back("/yamevoyBennetts/", {
                          force: true,
                          ignoreCache: true,
                          reload: true,
                        });
                      },
                      function (tx, error) {
                        console.error("Error al guardar cierre: " + error.message);
                      }
                    );
                  },
                  function (error) {},
                  function () {}
                );
              },
              function (tx, error) {
                console.error("Error al guardar cierre: " + error.message);
              }
            );
          },
          function (error) {},
          function () {}
        );
      }
      function terminarBajaBennetts() {
        var id_cedula = localStorage.getItem("IdCedula");
        var fecha = new Date();
        var fecha_salida =
          fecha.getFullYear() +
          "-" +
          (fecha.getMonth() + 1) +
          "-" +
          fecha.getDate() +
          " " +
          fecha.getHours() +
          ":" +
          fecha.getMinutes() +
          ":" +
          fecha.getSeconds();
        var ubicacion_salida = $("#geolocation").val();
        var estatus = 1;
        databaseHandler.db.transaction(
          function (tx) {
            tx.executeSql(
              "UPDATE cedulas_general SET fecha_salida = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
              [fecha_salida, ubicacion_salida, estatus, id_cedula],
              function (tx, results) {
                window.location.href = "./menu.html";
              },
              function (tx, error) {
                swal("Error al guardar", error.message, "error");
              }
            );
          },
          function (error) {},
          function () {}
        )
      }
      function terminarConteoBennetts() {
        var id_cedula = localStorage.getItem("IdCedula");
        var fecha = new Date();
        var fecha_salida =
          fecha.getFullYear() +
          "-" +
          (fecha.getMonth() + 1) +
          "-" +
          fecha.getDate() +
          " " +
          fecha.getHours() +
          ":" +
          fecha.getMinutes() +
          ":" +
          fecha.getSeconds();
        var ubicacion_salida = $("#geolocation").val();
        var estatus = 1;
        databaseHandler.db.transaction(
          function (tx) {
            tx.executeSql(
              "UPDATE cedulas_general SET fecha_salida = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
              [fecha_salida, ubicacion_salida, estatus, id_cedula],
              function (tx, results) {
                window.location.href = "./menu.html";
              },
              function (tx, error) {
                swal("Error al guardar", error.message, "error");
              }
            );
          },
          function (error) {},
          function () {}
        )
      }
      function generarBajaBennetts(){
        // let id_cedula = localStorage.getItem("IdCedula");
        // let foto_llegada = localStorage.getItem("foto_llegada");
        // let tipoCedula = "minutaCoordinador";
        // databaseHandler.db.transaction(
        //     function(tx){
        //         tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
        //             [tipoCedula,id_cedula],
        //             function(tx, results){
        //                 productHandler.addMinutaCoordinador(id_cedula,foto_llegada);
                        app.views.main.router.navigate({name: 'recorridoBennetts1'});
        //             },
        //             function(tx, error){
        //                 console.error("Error al actualizar el tipo de cedula: " + error.message);
        //             }
        //         );
        //     },
        //     function(error){},
        //     function(){}
        // );
    }
    function generarInventarioBennetts(){
      let id_cedula = localStorage.getItem("IdCedula");
      let tipoCedula = "conteo";
      databaseHandler.db.transaction(
          function(tx){
              tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                  [tipoCedula,id_cedula],
                  function(tx, results){
                      productHandler.addConteo(id_cedula);
                      app.views.main.router.navigate({name: 'recorridoBennetts2'});
                  },
                  function(tx, error){
                      console.error("Error al actualizar el tipo de cedula: " + error.message);
                  }
              );
          },
          function(error){},
          function(){}
      );
    }
    function buscarCodigoBennetts(table,codigo){
        var NomJson = localStorage.getItem("almacen");;
        app.request({
            url: cordova.file.dataDirectory + "jsons/"+NomJson+".json", // y por cual era? XD perate culo dale shift+f6 si le distre? xd
            method: 'GET',
            dataType: 'json',
            //send "query" to server. Useful in case you generate response dynamically, deja inento en el mio para acordarme xd
            success: function (data) {
                var aux = 0;
                for (var i = 0; i < data.length; i++) {
                    if(data[i].CodigoSIAN == codigo || data[i].CodigoSAP == codigo){
                        aux =  aux + 1;
                        $("#inventario tbody").append("<tr id='fila" + i + "'><td style='text-align: center;'>" + unescape(data[i].CodigoSIAN) + "</td><td style='text-align: center;'>" + unescape(data[i].CodigoSAP) + "</td><td style='text-align: center;'>" + unescape(data[i].Descripcion) + "</td><td style='text-align: center;'>" + unescape(data[i].Existencia) + "</td><td><a href='#' onclick='eliminarFilaBennetts(" + i + ",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td></tr>");
                    }
                    table.row.add([
                        data[i].CodigoSIAN, '1', '1','1', '1', '1'
                      ]).draw();
                }
                if(aux == 0){
                    console.log("No lo encontre")
                }
            }
        }); 
    }
    function cantidadIngresada(inventario,id,id_conteo){
        $('input').blur();
        inventario = parseFloat(inventario);
        var valor = $("#"+id).val();
        var adicional = inventario / 2;
        var max = inventario + adicional;
        var min = inventario - adicional;
        if(valor == 0 && max == 0 && min ==0){

        } else {
            if(valor <= min || valor >= max){
                swal("Alerta!", "La cantidad de producto ingresada esta excediendo el rango del 50% de existencia." ,"warning");
            }
        }
        if(valor == parseInt(inventario)){
            var estatus = 1;
        } else {
            var estatus = 0;
        }
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE conteo SET fisico = ?,estatus_diferencia = ? WHERE id_conteo = ?",
                    [valor,estatus,id_conteo],
                    function(tx, results){
                    },
                    function(tx, error){
                        console.log("Error al guardar cedula: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function rotate(){
        if(localStorage.getItem("currentOrientation") == "portrait"){
            screen.orientation.lock('landscape');
            localStorage.setItem("currentOrientation", "landscape");
        } else {
            screen.orientation.lock('portrait');
            localStorage.setItem("currentOrientation", "portrait");
        }
    }
    function validateScan(){
        cordova.plugins.barcodeScanner.scan(
            function (result) {
                var texto =  result.text;
                var camera = app.popup.create({
                    content: `
                    <div class="popup" id="camera">
                        <div class="headerPopupPhoto" style="width: 90%;display: flex;justify-content: end;padding-left: 20px;margin-top:20px">
                            <a class="link popup-close">Cerrar</a>
                        </div>
                        <div id="log"></div>
                        <div class="app">
                            <div id="deviceready">
                                <pre style="display: inline-block;white-space: break-spaces;">${result.text}</pre>
                                <p>Formato: ${result.format}</p>
                            </div>
                        </div>
                    </div>
                    `,
                    on: {
                        open: function (popup) {},
                    }
                });
                camera.open();
            },
            function (error) {
                alert("Scanning failed: " + error);
            },
            {
                preferFrontCamera : false,
                showFlipCameraButton : true,
                showTorchButton : true,
                torchOn: false,
                saveHistory: false,
                prompt : "Coloca el codigo de barras en la zona marcada",
                resultDisplayDuration: 500,
                orientation : "portrait",
                disableAnimations : true,
                disableSuccessBeep: false
            }
          );
    }
    function insertConteo(id_cedula,id_conteo_general,numero_conteo,Codigo,SAP,ubicacion,Descripcion,Inventario,Familia,Costo_unitario,id_usuario){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("SELECT id_cedula FROM conteo WHERE id_cedula = ? AND (codigo_sap = ? OR codigo_proveedor = ?) AND ubicacion = ?",
                    [id_cedula,SAP,Codigo,ubicacion],
                    function(tx, results){
                        if(results.rows.length == 0){
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("INSERT INTO conteo(id_cedula,id_conteo_general,numero_conteo,codigo_proveedor,codigo_sap,ubicacion,descripcion,inventario,familia,costo_unitario,usuario,estatus_diferencia,enviado) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,'0')",
                                        [id_cedula,id_conteo_general,numero_conteo,Codigo,SAP,ubicacion,Descripcion,Inventario,Familia,Costo_unitario,id_usuario],
                                        function(tx, results){
                                            var id = results.insertId;
                                            var table = $('#inventario').DataTable();
                                            table.row.add([id,SAP,"<input type='number' id='item"+id+"' onchange='cantidadIngresada(\"" + Inventario + "\",this.id,"+id+")' placeholder='#' style='width:60px'>",Descripcion,Inventario,ubicacion,"<a href='#' class='remove' onclick='eliminarFilaBennetts(" + id + ",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a>"]).draw();
                                            $("#codigo").val("");
                                            app.preloader.hide();
                                        },
                                        function(tx, error){
                                            swal("Error al guardar el registro",error.message,"error");
                                            app.preloader.hide();
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        } else {
                            swal(`El codigo ${SAP} ya fue escaneado`, `Ese producto ya fue escaneado en la ubicaci√≥n ${ubicacion}, por favor actualiza la cantidad en el registro existente!` ,"warning");
                            $("#codigo").val("");
                        }
                    },
                    function(tx, error){
                        swal("Error al guardar el registro",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function searchAsin(codigo){
        var id_cedula = localStorage.getItem("IdCedula");
        var NomJson = localStorage.getItem("almacen");;
        app.request({
            url: cordova.file.dataDirectory + "jsons/"+NomJson+".json",
            method: 'GET',
            dataType: 'json',
            success: function (data) {
                var aux = 0;
                var samecode = 0;
                let noencontrados;
                for (var j = 0; j < data.length; j++) {
                    if(data[j].CodigoSIAN == codigo || data[j].CodigoSAP == codigo){
                        aux =  aux + 1;
                        samecode ++;
                        var id_conteo_general = "1";
                        var numero_conteo = "1";
                        var id_usuario = localStorage.getItem("id_usuario");
                        if(codigo == ""){
                            return;
                        } else {
                            insertConteo(id_cedula,id_conteo_general,numero_conteo,data[j].CodigoSIAN,data[j].CodigoSAP,$('#ubicacion').val(),data[j].Descripcion,data[j].Existencia,data[j].Familia,data[j].Precio,id_usuario);
                        }
                        if(samecode == 2){
                            swal("Codigo duplicado","El codigo ingresado tiene 2 coincidencias en el catalogo de productos, por favor revisalo!.","warning");      
                        }
                    }
                }
                if(aux == 0){
                  swal("Codigo No encontrado",`El codigo ${codigo} no esta en el catalogo de productos.`,"warning");
                  $("#codigo").val("");
                }
            }
        });
    }
    function searchSingle(codigo){
        var id_cedula = localStorage.getItem("IdCedula");
        var NomJson = localStorage.getItem("almacen");;
        app.request({
            url: cordova.file.dataDirectory + "jsons/"+NomJson+".json",
            method: 'GET',
            dataType: 'json',
            success: function (data) {
                var aux = 0;
                var samecode = 0;
                for (var i = 0; i < data.length; i++) {
                    if(data[i].CodigoSIAN == codigo || data[i].CodigoSAP == codigo){
                        aux =  aux + 1;
                        samecode++;
                        var id_conteo_general = "1";
                        var numero_conteo = "1";
                        var id_usuario = localStorage.getItem("id_usuario");
                        insertConteo(id_cedula,id_conteo_general,numero_conteo,data[i].CodigoSIAN,data[i].CodigoSAP,$('#ubicacion').val(),data[i].Descripcion,data[i].Existencia,data[i].Familia,data[i].Precio,id_usuario);
                        if(samecode == 2){
                            swal("Codigo duplicado","El codigo ingresado tiene 2 coincidencias en el catalogo de productos, por favor revisalo!.","warning");
                            $("#codigo").val("");
                        }
                    }
                }
                if(aux == 0){
                  swal("Codigo No encontrado","El codigo escaneado no esta en el catalogo de productos.","warning");
                  $("#codigo").val("");
                }
            }
        });
    }
    function llevarUbicacion(){
        var ubicacion = $("#ubicacion").val();
        var id_cedula = localStorage.getItem("IdCedula");
        var almacen;
        var empresa;
        databaseHandler.db.transaction(
            function(tx){
              tx.executeSql(
                "Select * from inventario WHERE id_cedula = ?",
                [id_cedula],
                function(tx, results){
                  let length = results.rows.length;
                  for (var i = 0; i< length; i++){
                    var item = results.rows.item(i);
                    almacen = item.almacen;
                    empresa = item.empresa;
                  }
                },
                function(tx, error){
                  console.log("Error al guardar registro: " + error.message);
                  app.preloader.hide();
                }
              );
            },
            function(error){},
            function(){}
          );
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("SELECT ubicacion FROM conteo WHERE ubicacion = ? AND (fisico IS NULL OR fisico = '') AND id_cedula = ?",
                    [ubicacion,id_cedula],
                    function(tx, results){
                        if(results.rows.length == 0){
                            var conteo = new Array();
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("SELECT * from conteo WHERE id_cedula = ? AND ubicacion = ?",
                                        [id_cedula,ubicacion],
                                        function(tx, results){
                                            var length = results.rows.length;
                                            for(var i = 0; i< length; i++){
                                                var item3 = results.rows.item(i);
                                                conteo[i] = {'id_cedula': item3.id_cedula,'id_conteo_general': item3.id_conteo_general,'numero_conteo': item3.numero_conteo,'codigo_proveedor': item3.codigo_proveedor,'codigo_sap': item3.codigo_sap,'ubicacion': item3.ubicacion,'descripcion': item3.descripcion,'inventario': item3.inventario,'familia': item3.familia,'costo_unitario': item3.costo_unitario,'usuario': item3.usuario,'estatus_diferencia': item3.estatus_diferencia,'fisico': item3.fisico};
                                            }
                                            $("#ubicacion").val("");
                                            var table = $('#inventario').DataTable();
                                            table.search("").draw();
                                            $.ajax({
                                                type: "POST",
                                                async : true,
                                                url: "http://www.appbennetts.com/FWM2/app/guardarConteoInTime.php",
                                                dataType: 'html',
                                                data: {'conteo': JSON.stringify(conteo),'almacen':almacen,'empresa':empresa},
                                                success: function(respuesta){
                                                    if(respuesta == "CEDULA._.1"){
                                                        databaseHandler.db.transaction(
                                                            function(tx7){
                                                                tx7.executeSql(
                                                                    "UPDATE conteo SET enviado = 1 WHERE id_cedula = ? AND ubicacion = ?",
                                                                    [id_cedula,ubicacion],
                                                                    function(tx7, results){
                                                                        $("#filtrosUbicacion").css("display","none");
                                                                        swal("Ubicacion guardada", "Se acaba de enviar la Ubicacion!" ,"success");
                                                                    }
                                                                );
                                                            }
                                                        );
                                                        
                                                    }
                                                },
                                                error: function(){
                                                    console.log("Error en la comunicacion con el servidor");
                                                }
                                            });
                                        },
                                        function(tx, error){
                                            console.log("Error al consultar evidencia_levantamiento_smc: " +error.message);
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        } else {
                            swal("Llena las cantidades", "No puedes finalizar la ubicacion actual y no tienes llenas todas las cantidades!" ,"warning");
                        }
                    },
                    function(tx, error){
                        swal("Error al guardar el registro",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function restorientation(){
        screen.orientation.lock('portrait');
        localStorage.setItem("currentOrientation", "portrait");
    }
    function validarInventario(){
        if(localStorage.getItem("almacen") == "no"){
          swal("Faltan datos","Para poder iniciar el conteo necesitas llenar datos generales.","warning");
        } else {
            app.views.main.router.back('/template2/', {force: true, ignoreCache: true, reload: true});
        }
    }
    function eliminarubicacion(){
        var id_cedula = localStorage.getItem("IdCedula");
        var ubicacion = $("#ubicacion").val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("SELECT ubicacion FROM conteo WHERE ubicacion = ? AND id_cedula = ?",
                    [ubicacion,id_cedula],
                    function(tx, results){
                        if(results.rows.length == 0){
                            swal("No existen registros", "La ubicacion no tiene registros en la base de datos!" ,"warning");
                        } else {
                            databaseHandler.db.transaction(
                                function(tx4){
                                    tx4.executeSql("DELETE FROM conteo WHERE id_cedula = ? AND ubicacion = ?",
                                        [id_cedula,ubicacion],
                                        function(tx4, results){
                                            swal("Ubicacion eliminada", "Se eliminaron todos los registros de la ubicacion exitosamente!" ,"success");
                                            var table = $('#inventario').DataTable();
                                            var texto = '';
                                            var indexes = table
                                            .rows()
                                            .indexes()
                                            .filter( function ( value, index ) {
                                                return ubicacion === table.row(value).data()[5];
                                            });
                                            table.rows(indexes).remove().draw();
                                            table.search(texto).draw();
                                            $("#ubicacion").val('');
                                        },
                                        function(tx4, error){
                                            console.error("Error al eliminar cedula_general: " + error.message);
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        }
                    },
                    function(tx, error){
                        swal("Error al guardar el registro",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    //Bennetts Fin
    //DIPREC Inicio
    function buscarClienteDIPREC(){
        app.preloader.show('blue');
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_cliente = $('#id_cliente').val();
        var nombre_cliente = $("#nombre_cliente").val();
        var hora_programada = $("#horario_programado").val();
        var atencion = $("#persona_recibe").val();
        var direccion = $("#direccion").val();
        var telefono = $("#telefono").val();
        var correo = $("#correo").val();
        var foto_llegada = $("#imagenC").val();
        var documentoIngresar = $("#documento_ingresar").val();
        var telefono = $("#telefono").val();
        var correo = $("#correo").val();
        var estatus = 0;
        if(localStorage.getItem("IdCedula"))
        {
            app.preloader.hide();
            var cedula = localStorage.getItem("IdCedula");
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [cedula],
                        function(tx5, results){
                            var item = results.rows.item(0);
                            if(nombre_cliente != item.nombre_cliente || foto_llegada != localStorage.getItem("foto_llegada")){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("UPDATE cedulas_general SET id_usuario = ?,nombre_usuario = ?,fecha_entrada = ?,geolocalizacion_entrada = ?,id_cliente = ?,nombre_cliente = ?,horario_programado = ? WHERE id_cedula = ?",
                                            [id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,hora_programada,cedula],
                                            function(tx, results){
                                                app.views.main.router.navigate({name: 'recorrido1'});
                                            },
                                            function(tx, error){
                                                console.log("Error al guardar cedula: " + error.message);
                                                app.preloader.hide();
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            } else {
                                app.views.main.router.navigate({name: 'recorrido1'});
                            }
                        },
                        function(tx5, error){
                            console.error("Error al consultar bandeja de salida: " + error.message);
                        }
                    );
                },
            function(error){},
            function(){}
            );
        } else {
            var NomDescCli = "Clientes_DIPREC";
            if(foto_llegada != ''){
                app.request.get(cordova.file.dataDirectory + "jsons/"+NomDescCli+".json", { IdCed: id_usuario}, function (data) {
                    var content = JSON.parse(data);
                    var aux = 0;
                    for(var i=0; i < content.length; i++){
                        for (var i = 0; i < content.length; i++) {
                            if(content[i].IdCte == id_cliente){
                                aux = 1;
                                productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,hora_programada,estatus);
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                                            [],
                                            function(tx, results){
                                                var item = results.rows.item(0);
                                                localStorage.setItem("IdCedula", item.Id);
                                                localStorage.setItem("nombreCliente", nombre_cliente);
                                                localStorage.setItem("IdCte", id_cliente);
                                                localStorage.setItem("foto_llegada", foto_llegada);
                                                localStorage.setItem("atencion", atencion);
                                                localStorage.setItem("direccion", direccion);
                                                localStorage.setItem("documentoIngresar", documentoIngresar);
                                                localStorage.setItem("telefono", telefono);
                                                localStorage.setItem("correo", correo);
                                                app.views.main.router.navigate({name: 'menuDIPREC'});
                                                app.preloader.hide();
                                            },
                                            function(tx, error){
                                                console.log("Error al guardar cedula: " + error.message);
                                                app.preloader.hide();
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                        }
                    }
                    if(aux == 0){
                        app.preloader.hide();
                        swal("Cliente no encontrado", "No se tiene registro de ese cliente, Por favor sincroniza tus datos!" ,"error");
                    }
                });
            } else {
                swal("Falta un campo", "La fotograf√≠a es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        }
    }
    function generarReporteTecnico(){
        let id_cedula = localStorage.getItem("IdCedula");
        let nombre_cliente = localStorage.getItem("nombreCliente");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let atencion = localStorage.getItem("atencion");
        let direccion = localStorage.getItem("direccion");
        let telefono = localStorage.getItem("telefono");
        let correo = localStorage.getItem("correo");
        let tipoCedula = "reporteTecnico";
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addReporteTecnico(id_cedula,foto_llegada,nombre_cliente,direccion,telefono,atencion,correo);
                        app.views.main.router.navigate({name: 'recorridoDIPREC1'});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function continuarCedDIPREC(id_cedula,tipo){
        localStorage.setItem("IdCedula",id_cedula);
        localStorage.setItem("Opcion", '1');
        if(tipo == 1){
            app.views.main.router.navigate({ name: 'recorridoDIPREC1'});
        } else if(tipo == 2){
            app.views.main.router.navigate({ name: 'recorridoDIPREC3'});
        }
    }
    
    function guardarDatosReporteTecnicoDIPREC(){
        app.preloader.show('blue');
        if($("#nombreCliente").val() =="" || $("#atencion").val() == "" || $("#direccion").val() == "" || $("#telefono").val() == "" || $("#correo").val() == "" || $("#tipoServicio").val() == 0){
            swal("", "Debes llenar todos los campos" ,"warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var cliente = $("#nombreCliente").val();
        var atencion = $("#atencion").val();
        var direccion = $("#direccion").val();
        var telefono = $("#telefono").val();
        var correo = $("#correo").val();
        var tipoServicio = $("#tipoServicio").val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE servicio_tecnico SET nombre_cliente = ?,atencion = ?,direccion = ?,telefono = ?,email = ?,tipo_servicio = ? WHERE id_cedula = ?",
                    [cliente,atencion,direccion,telefono,correo,tipoServicio,id_cedula],
                    function(tx, results){
                        $("#nombreCliente").css("background-color", "#FFFFFF");
                        $("#atencion").css("background-color", "#FFFFFF");
                        $("#direccion").css("background-color", "#FFFFFF");
                        $("#telefono").css("background-color", "#FFFFFF");
                        $("#correo").css("background-color", "#FFFFFF");
                        $("#tipoServicio").css("background-color", "#FFFFFF");
                        swal("", "Se guardaron los datos correctamente" ,"success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    
    function guardarEquipoDIPREC(){
        app.preloader.show('blue');
        if($("#nombreEquipo").val() == "" || $('#marca').val() == "0" || $('#modelo').val() == ""  || $('#noSerie').val() == "" || $('#imagenC').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var equipo = $("#nombreEquipo").val();
        var marca = $('#marca').val();
        var modelo = $('#modelo').val();
        var noSerie = $('#noSerie').val();
        var foto = $('#imagenC').val();
        var fecha = new Date();
        var fase = 'antes';
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        //-------------
        databaseHandler.db.transaction(
            function(tx1){
                tx1.executeSql(
                    "Select * from datos_equipo where equipo = ? AND marca = ? AND modelo = ? AND no_serie = ? AND id_cedula = ?",
                    [equipo,marca,modelo,noSerie,id_cedula],
                    function(tx, results){
                        var length = results.rows.length;
                        if(length == 0){
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("INSERT INTO datos_equipo(id_cedula,equipo,marca,modelo,no_serie,fecha_registro) VALUES (?,?,?,?,?,?)",
                                        [id_cedula,equipo,marca,modelo,noSerie,fecha_registro],
                                        function(tx, results){
                                            databaseHandler.db.transaction(
                                                function(tx){
                                                    tx.executeSql("INSERT INTO evidencia_equipo(id_cedula,fase,foto,equipo,fecha_regristro) VALUES (?,?,?,?,?)",
                                                        [id_cedula,fase,foto,equipo,fecha_registro],
                                                        function(tx, results){
                                                            app.preloader.hide();
                                                            databaseHandler.db.transaction(
                                                                function(tx){
                                                                    tx.executeSql("Select MAX(id_foto) as Id from evidencia_equipo",
                                                                        [],
                                                                        function(tx, results){
                                                                            var item = results.rows.item(0);
                                                                            var id_evidencia = item.Id;
                                                                            app.preloader.hide();
                                                                            //Consultar el producto
                                                                            databaseHandler.db.transaction(
                                                                                function(tx){
                                                                                    tx.executeSql("Select * from evidencia_equipo where id_foto = ?",
                                                                                    [id_evidencia],
                                                                                        function(tx, results){
                                                                                            var item = results.rows.item(0);
                                                                                            $("#smallImage").attr("src","img/blank.png");
                                                                                            $('#imagenC').val("");
                                                                                            $("#photoIcon").attr("src","img/camera.svg");
                    
                                                                                            $("#nombreEquipo").css("background-color", "#FFFFFF");
                                                                                            $("#marca").css("background-color", "#FFFFFF");
                                                                                            $("#modelo").css("background-color", "#FFFFFF");
                                                                                            $("#noSerie").css("background-color", "#FFFFFF");
                    
                                                                                            $("#tabla_reporteTecnico tbody").append("<tr id='fila"+ item.id_foto +"'><td><a href='#' onclick='eliminarFilaDIPREC("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.equipo) + "</td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                                                            $("#message-nr").css("display", "none");
                                                                                            $('.preloader').remove();
                                                                                            $('.infinite-scroll-preloader').remove();
                                                                                            app.preloader.hide();
                                                                                        },
                                                                                        function(tx, error){
                                                                                            console.log("Error al guardar cedula: " + error.message);
                                                                                            app.preloader.hide();
                                                                                        }
                                                                                    );
                                                                                },
                                                                                function(error){},
                                                                                function(){}
                                                                            );
                                                                        },
                                                                        function(tx, error){
                                                                            swal("Error al mostrar el registro guardada",error.message,"error");
                                                                            app.preloader.hide();
                                                                        }
                                                                    );
                                                                },
                                                                function(error){},
                                                                function(){}
                                                            );
                                                            swal("","Registro guardado","success");
                                                            app.preloader.hide();
                                                        },
                                                        function(tx, error){
                                                            swal("Error al guardar plaga",error.message,"error");
                                                            app.preloader.hide();
                                                        }
                                                    );
                                                },
                                                function(error){},
                                                function(){}
                                            );
                                        },
                                        function(tx, error){
                                            swal("Error al guardar",error.message,"error");
                                            app.preloader.hide();
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        } else {
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("INSERT INTO evidencia_equipo(id_cedula,fase,foto,equipo,fecha_regristro) VALUES (?,?,?,?,?)",
                                        [id_cedula,fase,foto,equipo,fecha_registro],
                                        function(tx, results){
                                            app.preloader.hide();
                                            databaseHandler.db.transaction(
                                                function(tx){
                                                    tx.executeSql("Select MAX(id_foto) as Id from evidencia_equipo",
                                                        [],
                                                        function(tx, results){
                                                            var item = results.rows.item(0);
                                                            var id_evidencia = item.Id;
                                                            app.preloader.hide();
                                                            //Consultar el producto
                                                            databaseHandler.db.transaction(
                                                                function(tx){
                                                                    tx.executeSql("Select * from evidencia_equipo where id_foto = ?",
                                                                    [id_evidencia],
                                                                        function(tx, results){
                                                                            var item = results.rows.item(0);
                                                                            $("#smallImage").attr("src","img/blank.png");
                                                                            $('#imagenC').val("");
                                                                            $("#photoIcon").attr("src","img/camera.svg");
    
                                                                            $("#nombreEquipo").css("background-color", "#FFFFFF");
                                                                            $("#marca").css("background-color", "#FFFFFF");
                                                                            $("#modelo").css("background-color", "#FFFFFF");
                                                                            $("#noSerie").css("background-color", "#FFFFFF");
    
                                                                            $("#tabla_reporteTecnico tbody").append("<tr id='fila"+ item.id_foto +"'><td><a href='#' onclick='eliminarFilaDIPREC("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.equipo) + "</td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                                            $("#message-nr").css("display", "none");
                                                                            $('.preloader').remove();
                                                                            $('.infinite-scroll-preloader').remove();
                                                                            app.preloader.hide();
                                                                        },
                                                                        function(tx, error){
                                                                            console.log("Error al guardar cedula: " + error.message);
                                                                            app.preloader.hide();
                                                                        }
                                                                    );
                                                                },
                                                                function(error){},
                                                                function(){}
                                                            );
                                                        },
                                                        function(tx, error){
                                                            swal("Error al mostrar el registro guardada",error.message,"error");
                                                            app.preloader.hide();
                                                        }
                                                    );
                                                },
                                                function(error){},
                                                function(){}
                                            );
                                            swal("","Registro guardado","success");
                                            app.preloader.hide();
                                        },
                                        function(tx, error){
                                            swal("Error al guardar plaga",error.message,"error");
                                            app.preloader.hide();
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        }
                    },
                    function(tx, error){
                        console.log("Error al consultar: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    
    function eliminarFilaDIPREC(index, opc){
        if(opc == 1) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM evidencia_equipo WHERE id_foto = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else if(opc == 2) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM evidencia_refacciones WHERE id_foto = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else if(opc == 3) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM zonas_coordinador WHERE id_zona = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else if(opc == 4) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM equipos_coordinador WHERE id_equipo = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else if(opc == 5) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM observaciones WHERE id_acuerdo = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else if(opc == 6) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM notas WHERE id_nota = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function guardarRevisionDiprec(){
        app.preloader.show('blue');
        // if($("#equipo").val() == "0" || $('#voltaje').val() == "" || ($("#voltaje1").prop("checked") == false && $("#voltaje2").prop("checked") == false) || $('#imagenC1').val() == "" || $('#corriente').val() == "" || ($("#corriente1").prop("checked") == false && $("#corriente2").prop("checked") == false) || $('#imagenC2').val() == "" || $('#fase').val() == "" || ($("#fase1").prop("checked") == false && $("#fase2").prop("checked") == false) || $('#imagenC3').val() == "" || $('#tipogas').val() == "" || ($("#tipogas1").prop("checked") == false && $("#tipogas2").prop("checked") == false) || $('#imagenC4').val() == "" || $('#tipogas').val() == "" || ($("#tipogas1").prop("checked") == false && $("#tipogas2").prop("checked") == false) || $('#imagenC4').val() == "" || $('#tipogas').val() == "" || ($("#tipogas1").prop("checked") == false && $("#tipogas2").prop("checked") == false) || $('#imagenC4').val() == "" || $('#presiongas').val() == "" || ($("#presiongas1").prop("checked") == false && $("#presiongas2").prop("checked") == false) || $('#imagenC5').val() == "" || $('#presionvapor').val() == "" || ($("#presionvapor1").prop("checked") == false && $("#presionvapor2").prop("checked") == false) || $('#imagenC6').val() == "" || $('#temperaturaequipo').val() == "" || ($("#temperaturaequipo1").prop("checked") == false && $("#temperaturaequipo2").prop("checked") == false) || $('#imagenC7').val() == "" || $('#fallareportada').val() == ""){
        if($("#equipo").val() == "0"){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var equipo = $("#equipo").val();
        var voltajeT = $("#voltaje").val();
        if($("#voltaje1").prop("checked") == true){
            var voltajeC = "1";
        } else if($("#voltaje0").prop("checked")){
            var voltajeC = "0";
        }
        var voltajeF = $('#imagenC1').val();
        var corrienteT = $("#corriente").val();
        if($("#corriente1").prop("checked") == true){
            var corrienteC = "1";
        } else if($("#corriente0").prop("checked")){
            var corrienteC = "0";
        }
        var corrienteF = $('#imagenC2').val();

        var faseT = $("#fase").val();
        if($("#fase1").prop("checked") == true){
            var faseC = "1";
        } else if($("#fase0").prop("checked")){
            var faseC = "0";
        }
        var faseF = $('#imagenC3').val();
        var tipogasT = $("#tipogas").val();
        if($("#tipogas1").prop("checked") == true){
            var tipogasC = "1";
        } else if($("#tipogas0").prop("checked")){
            var tipogasC = "0";
        }
        var tipogasF = $('#imagenC4').val();
        var presiongasT = $("#presiongas").val();
        if($("#presiongas1").prop("checked") == true){
            var presiongasC = "1";
        } else if($("#presiongas0").prop("checked")){
            var presiongasC = "0";
        }
        var presiongasF = $('#imagenC5').val();
        var presionvaporT = $("#presionvapor").val();
        if($("#presionvapor1").prop("checked") == true){
            var presionvaporC = "1";
        } else if($("#presionvapor0").prop("checked")){
            var presionvaporC = "0";
        }
        var presionvaporF = $('#imagenC6').val();
        var temperaturaequipoT = $("#temperaturaequipo").val();
        if($("#temperaturaequipo1").prop("checked") == true){
            var temperaturaequipoC = "1";
        } else if($("#temperaturaequipo0").prop("checked")){
            var temperaturaequipoC = "0";
        }
        var temperaturaequipoF = $('#imagenC7').val();
        var fallareportada = $('#fallareportada').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO datos_equipo_antes(id_cedula,equipo,voltaje,estado_voltaje,evidencia_voltaje,corriente,estado_corriente,evidencia_corriente,fases,estado_fase,evidencia_fase,tipo_gas,estado_gas,evidencia_gas,presion_gas,estado_presion_gas,evidencia_presion_gas,presion_vapor,estado_presion_vapor,evidencia_presion_vapor,temperatura,estado_temperatura,evidencia_estado_temperatura,falla_reportada) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)",
                    [id_cedula,equipo,voltajeT,voltajeC,voltajeF,corrienteT,corrienteC,corrienteF,faseT,faseC,faseF,tipogasT,tipogasC,tipogasF,presiongasT,presiongasC,presiongasF,presionvaporT,presionvaporC,presionvaporF,temperaturaequipoT,temperaturaequipoC,temperaturaequipoF,fallareportada],
                    function(tx, results){
                        swal("","Evidencia del equipo Guardada","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar el registro",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    
    function guardarRefaccionDIPREC(){
        app.preloader.show('blue');
        if($("#refaccion").val() == "0" || $('#clave').val() == "" || $('#cantidad').val() == "" || $('#descripcion').val() == "" || $('#imagenC').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var refacion= $('#refaccion').val()
        var clave= $('#clave').val()
        var cantidad= $('#cantidad').val()
        var descripcion= $('#descripcion').val()
        var foto = $('#imagenC').val()
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO evidencia_refacciones(id_cedula,fase,clave,cantidad,descripcion,foto,fecha_regristro) VALUES (?,?,?,?,?,?,?)",
                    [id_cedula,refacion,clave,cantidad,descripcion,foto,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_foto) as Id from evidencia_refacciones",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from evidencia_refacciones where id_foto = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $('#imagenC').val("");
                                                        $("#refacion").val("");
                                                        $("#clave").val("");
                                                        $("#cantidad").val("");
                                                        $("#descripcion").val("");
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        $("#tabla_refacciones tbody").append("<tr id='fila"+ item.id_foto +"'><td><a href='#' onclick='eliminarFilaDIPREC("+ item.id_foto +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.clave) + "</td><td style='text-align: center;'>" + unescape(item.cantidad) + "</td><td style='text-align: center;'>" + unescape(item.descripcion) + "</td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar el registro guardada",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Registro guardado exitosamente","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar el registro",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarActividadesDIPREC(){
        var id_cedula = localStorage.getItem("IdCedula");
        app.preloader.show('blue');
        if($("#equipo").val() == "0" || ($('#recorrido1').prop("checked") == false && $('#recorrido2').prop("checked") == false)){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        if($('#recorrido2').prop("checked") == true){
            if(($("#valvulas1").prop("checked") == true || $("#valvulas0").prop("checked") == true) && ($("#termostato1").prop("checked") == true || $("#termostato0").prop("checked") == true) && ($("#controlpresion1").prop("checked") == true || $("#controlpresion0").prop("checked") == true) && ($("#quemador1").prop("checked") == true || $("#quemador0").prop("checked") == true) && ($("#turbinas1").prop("checked") == true || $("#turbinas0").prop("checked") == true) && ($("#resistencias1").prop("checked") == true || $("#resistencias0").prop("checked") == true) && ($("#sondas1").prop("checked") == true || $("#sondas0").prop("checked") == true) && ($("#tarjetaselectronicas1").prop("checked") == true || $("#tarjetaselectronicas0").prop("checked") == true) && ($("#compresor1").prop("checked") == true || $("#compresor0").prop("checked") == true) && ($("#motordifusores1").prop("checked") == true || $("#motordifusores0").prop("checked") == true) && ($("#aspasmotor1").prop("checked") == true || $("#aspasmotor0").prop("checked") == true) && ($("#contactores1").prop("checked") == true || $("#contactores0").prop("checked") == true) && ($("#fugatuberia1").prop("checked") == true || $("#fugatuberia0").prop("checked") == true) && ($("#aislantetuberia1").prop("checked") == true || $("#aislantetuberia0").prop("checked") == true) && ($("#condensador1").prop("checked") == true || $("#condensador0").prop("checked") == true) && ($("#iluminacion1").prop("checked") == true || $("#iluminacion0").prop("checked") == true) && ($("#empaques1").prop("checked") == true || $("#empaques0").prop("checked") == true) && ($("#fugagas1").prop("checked") == true || $("#fugagas0").prop("checked") == true)){
                
            } else {
                swal("","Todos los campos son requeridos","warning");
                app.preloader.hide();
                return false;
            }
        }
        var equipo = $('#equipo').val()
        if($("#gabineteexterior").prop("checked") == true){
            var gabineteexteriorC = "1";
        } else {
            var gabineteexteriorC = "0";
        }
        if($("#gabineteinterior").prop("checked") == true){
            var gabineteinteriorC = "1";
        } else {
            var gabineteinteriorC = "0";
        }
        if($("#paneles").prop("checked") == true){
            var panelesC = "1";
        } else {
            var panelesC = "0";
        }
        if($("#quemadores").prop("checked") == true){
            var quemadoresC = "1";
        } else {
            var quemadoresC = "0";
        }
        if($("#parrillas").prop("checked") == true){
            var parrillasC = "1";
        } else {
            var parrillasC = "0";
        }
        if($("#vulvasespreas").prop("checked") == true){
            var vulvasespreasC = "1";
        } else {
            var vulvasespreasC = "0";
        }
        if($("#panelescontrol").prop("checked") == true){
            var panelescontrolC = "1";
        } else {
            var panelescontrolC = "0";
        }
        if($("#condensador").prop("checked") == true){
            var condensadorC = "1";
        } else {
            var condensadorC = "0";
        }
        if($("#evaporador").prop("checked") == true){
            var evaporadorC = "1";
        } else {
            var evaporadorC = "0";
        }
        if($("#motoresaspas").prop("checked") == true){
            var motoresaspasC = "1";
        } else {
            var motoresaspasC = "0";
        }
        if($("#compresor").prop("checked") == true){
            var compresorC = "1";
        } else {
            var compresorC = "0";
        }
        if($("#flautas").prop("checked") == true){
            var flautasC = "1";
        } else {
            var flautasC = "0";
        }
        if($("#sistemahidraulico").prop("checked") == true){
            var sistemahidraulicoC = "1";
        } else {
            var sistemahidraulicoC = "0";
        }
        if($("#sistemalavado").prop("checked") == true){
            var sistemalavadoC = "1";
        } else {
            var sistemalavadoC = "0";
        }
        if($("#empaques").prop("checked") == true){
            var empaquesC = "1";
        } else {
            var empaquesC = "0";
        }
        if($("#deteccionfugas").prop("checked") == true){
            var deteccionfugasC = "1";
        } else {
            var deteccionfugasC = "0";
        }
        if($("#ajusteelectrico").prop("checked") == true){
            var ajusteelectricoC = "1";
        } else {
            var ajusteelectricoC = "0";
        }
        if($("#lubricacionmovil").prop("checked") == true){
            var lubricacionmovilC = "1";
        } else {
            var lubricacionmovilC = "0";
        }
        if($("#revisionmodos").prop("checked") == true){
            var revisionmodosC = "1";
        } else {
            var revisionmodosC = "0";
        }
        if($("#filtroaire").prop("checked") == true){
            var filtroaireC = "1";
        } else {
            var filtroaireC = "0";
        }
        if($("#valvulas1").prop("checked") == true){
            var valvulasS = "1";
        } else if($("#valvulas0").prop("checked")){
            var valvulasS = "0";
        }
        if($("#termostato1").prop("checked") == true){
            var termostatoS = "1";
        } else if($("#termostato0").prop("checked")){
            var termostatoS = "0";
        }
        if($("#controlpresion1").prop("checked") == true){
            var controlpresionS = "1";
        } else if($("#controlpresion0").prop("checked")){
            var controlpresionS = "0";
        }
        if($("#sensorflama1").prop("checked") == true){
            var sensorflamaS = "1";
        } else if($("#sensorflama0").prop("checked")){
            var sensorflamaS = "0";
        }
        if($("#quemador1").prop("checked") == true){
            var quemadorS = "1";
        } else if($("#quemador0").prop("checked")){
            var quemadorS = "0";
        }
        if($("#turbinas1").prop("checked") == true){
            var turbinasS = "1";
        } else if($("#turbinas0").prop("checked")){
            var turbinasS = "0";
        }
        if($("#resistencias1").prop("checked") == true){
            var resistenciasS = "1";
        } else if($("#resistencias0").prop("checked")){
            var resistenciasS = "0";
        }
        if($("#sondas1").prop("checked") == true){
            var sondasS = "1";
        } else if($("#sondas0").prop("checked")){
            var sondasS = "0";
        }
        if($("#tarjetaselectronicas1").prop("checked") == true){
            var tarjetaselectronicasS = "1";
        } else if($("#tarjetaselectronicas0").prop("checked")){
            var tarjetaselectronicasS = "0";
        }
        if($("#compresor1").prop("checked") == true){
            var compresorS = "1";
        } else if($("#compresor0").prop("checked")){
            var compresorS = "0";
        }
        if($("#motordifusores1").prop("checked") == true){
            var motordifusoresS = "1";
        } else if($("#motordifusores0").prop("checked")){
            var motordifusoresS = "0";
        }
        if($("#aspasmotor1").prop("checked") == true){
            var aspasmotorS = "1";
        } else if($("#aspasmotor0").prop("checked")){
            var aspasmotorS = "0";
        }
        if($("#contactores1").prop("checked") == true){
            var contactoresS = "1";
        } else if($("#contactores0").prop("checked")){
            var contactoresS = "0";
        }
        if($("#fugatuberia1").prop("checked") == true){
            var fugatuberiaS = "1";
        } else if($("#fugatuberia0").prop("checked")){
            var fugatuberiaS= "0";
        }
        if($("#aislantetuberia1").prop("checked") == true){
            var aislantetuberiaS = "1";
        } else if($("#aislantetuberia1").prop("checked")){
            var aislantetuberiaS = "0";
        }
        if($("#condensador1").prop("checked") == true){
            var condensadorS = "1";
        } else if($("#condensador0").prop("checked")){
            var condensadorS = "0";
        }
        if($("#iluminacion1").prop("checked") == true){
            var iluminacionS = "1";
        } else if($("#iluminacion0").prop("checked")){
            var iluminacionS = "0";
        }
        if($("#empaques1").prop("checked") == true){
            var empaquesS = "1";
        } else if($("#empaques0").prop("checked")){
            var empaquesS = "0";
        }
        if($("#fugagas1").prop("checked") == true){
            var fugagaS = "1";
        } else if($("#fugagas0").prop("checked")){
            var fugagaS = "0";
        }
        if($("#fugagas1").prop("checked") == true){
            var valvulasS = "1";
        } else if($("#fugagas0").prop("checked")){
            var valvulasS = "0";
        }
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO check_list(id_cedula,equipo,gabinete_exterior,gabinete_interior,quemadores,paneles,parillas,vulvas_espreas,paneles_control,condensador,evaporador,motores,compresor,flautas,sistema_hidraulico,sistema_lavado,empaques,dereccion_fugas,ajuste_electrico,libricacion,revision_operacion,filtro_aire) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)",
                    [id_cedula,equipo,gabineteexteriorC,gabineteinteriorC,quemadoresC,panelesC,parrillasC,vulvasespreasC,panelescontrolC,condensadorC,evaporadorC,motoresaspasC,compresorC,flautasC,sistemahidraulicoC,sistemalavadoC,empaquesC,deteccionfugasC,ajusteelectricoC,lubricacionmovilC,revisionmodosC,filtroaireC],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("INSERT INTO check_list2(id_cedula,equipo,vulvas,termostato,control_presion,sensor_flama,quemadores,turbinas,resistencias,sondas,tarjeta_electronica,compresor,motor_difusores,aspas,contractores,fuga_tuberia,aislante_tuberia,condfensador,iluminacion,empaques,fuga) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)",
                                    [id_cedula,equipo,valvulasS,termostatoS,controlpresionS,sensorflamaS,quemadorS,turbinasS,resistenciasS,sondasS,tarjetaselectronicasS,compresorS,motordifusoresS,aspasmotorS,contactoresS,fugatuberiaS,aislantetuberiaS,condensadorS,iluminacionS,empaquesS,fugagaS],
                                    function(tx, results){
                                        swal("","Comprobacion Guardada","success");
                                        app.preloader.hide();
                                    },
                                    function(tx, error){
                                        swal("Error al guardar el registro",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar el registro",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarEquipoDespuesDIPREC(){
        app.preloader.show('blue');
        if($("#equipo").val() == "" || $('#imagenC').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var equipo = $("#equipo").val();
        var foto = $('#imagenC').val();
        var fecha = new Date();
        var fase = 'despues';
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();

        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO evidencia_equipo(id_cedula,fase,foto,equipo,fecha_regristro) VALUES (?,?,?,?,?)",
                    [id_cedula,fase,foto,equipo,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_foto) as Id from evidencia_equipo",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from evidencia_equipo where id_foto = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $('#imagenC').val("");
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        $("#tabla_equipo_despues tbody").append("<tr id='fila"+ item.id_foto +"'><td><a href='#' onclick='eliminarFilaDIPREC("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.equipo) + "</td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar el registro guardada",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Registro guardado","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarRevisionDespuesDiprec(){
        app.preloader.show('blue');
        // if($("#equipo").val() == "0" || $('#voltaje').val() == "" || ($("#voltaje1").prop("checked") == false && $("#voltaje2").prop("checked") == false) || $('#imagenC1').val() == "" || $('#corriente').val() == "" || ($("#corriente1").prop("checked") == false && $("#corriente2").prop("checked") == false) || $('#imagenC2').val() == "" || $('#fase').val() == "" || ($("#fase1").prop("checked") == false && $("#fase2").prop("checked") == false) || $('#imagenC3').val() == "" || $('#tipogas').val() == "" || ($("#tipogas1").prop("checked") == false && $("#tipogas2").prop("checked") == false) || $('#imagenC4').val() == "" || $('#tipogas').val() == "" || ($("#tipogas1").prop("checked") == false && $("#tipogas2").prop("checked") == false) || $('#imagenC4').val() == "" || $('#tipogas').val() == "" || ($("#tipogas1").prop("checked") == false && $("#tipogas2").prop("checked") == false) || $('#imagenC4').val() == "" || $('#presiongas').val() == "" || ($("#presiongas1").prop("checked") == false && $("#presiongas2").prop("checked") == false) || $('#imagenC5').val() == "" || $('#presionvapor').val() == "" || ($("#presionvapor1").prop("checked") == false && $("#presionvapor2").prop("checked") == false) || $('#imagenC6').val() == "" || $('#temperaturaequipo').val() == "" || ($("#temperaturaequipo1").prop("checked") == false && $("#temperaturaequipo2").prop("checked") == false) || $('#imagenC7').val() == "" || $('#fallareportada').val() == ""){
        if($("#equipo").val() == "0"){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var equipo = $("#equipo").val();
        var voltajeT = $("#voltaje").val();
        if($("#voltaje1").prop("checked") == true){
            var voltajeC = "1";
        } else if($("#voltaje0").prop("checked")){
            var voltajeC = "0";
        }
        var voltajeF = $('#imagenC1').val();
        var corrienteT = $("#corriente").val();
        if($("#corriente1").prop("checked") == true){
            var corrienteC = "1";
        } else if($("#corriente0").prop("checked")){
            var corrienteC = "0";
        }
        var corrienteF = $('#imagenC2').val();

        var faseT = $("#fase").val();
        if($("#fase1").prop("checked") == true){
            var faseC = "1";
        } else if($("#fase0").prop("checked")){
            var faseC = "0";
        }
        var faseF = $('#imagenC3').val();
        var tipogasT = $("#tipogas").val();
        if($("#tipogas1").prop("checked") == true){
            var tipogasC = "1";
        } else if($("#tipogas0").prop("checked")){
            var tipogasC = "0";
        }
        var tipogasF = $('#imagenC4').val();
        var presiongasT = $("#presiongas").val();
        if($("#presiongas1").prop("checked") == true){
            var presiongasC = "1";
        } else if($("#presiongas0").prop("checked")){
            var presiongasC = "0";
        }
        var presiongasF = $('#imagenC5').val();
        var presionvaporT = $("#presionvapor").val();
        if($("#presionvapor1").prop("checked") == true){
            var presionvaporC = "1";
        } else if($("#presionvapor0").prop("checked")){
            var presionvaporC = "0";
        }
        var presionvaporF = $('#imagenC6').val();
        var temperaturaequipoT = $("#temperaturaequipo").val();
        if($("#temperaturaequipo1").prop("checked") == true){
            var temperaturaequipoC = "1";
        } else if($("#temperaturaequipo0").prop("checked")){
            var temperaturaequipoC = "0";
        }
        var temperaturaequipoF = $('#imagenC7').val();
        var fallareportada = $('#fallareportada').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO datos_equipo_despues(id_cedula,equipo,voltaje,estado_voltaje,evidencia_voltaje,corriente,estado_corriente,evidencia_corriente,fases,estado_fase,evidencia_fase,tipo_gas,estado_gas,evidencia_gas,presion_gas,estado_presion_gas,evidencia_presion_gas,presion_vapor,estado_presion_vapor,evidencia_presion_vapor,temperatura,estado_temperatura,evidencia_estado_temperatura,falla_reportada) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)",
                    [id_cedula,equipo,voltajeT,voltajeC,voltajeF,corrienteT,corrienteC,corrienteF,faseT,faseC,faseF,tipogasT,tipogasC,tipogasF,presiongasT,presiongasC,presiongasF,presionvaporT,presionvaporC,presionvaporF,temperaturaequipoT,temperaturaequipoC,temperaturaequipoF,fallareportada],
                    function(tx, results){
                        app.preloader.hide();
                        swal("","Evidencia del equipo Guardada","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarCierreReporteDIPREC(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#eval").val() == "" || $("#puesto").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        if($("#eval").val() <= '3' && $("#comentario_cliente").val() == ""){
            swal("","Por favor, ingresa el motivo de tu calificacion","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var calificacion = $("#eval").val();
        var puesto = $("#puesto").val();
        var comentarioCliente = $('#comentario_cliente').val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE servicio_tecnico SET firma_cliente = ?,fecha_cliente = ?,puesto = ? WHERE id_cedula = ?",
                    [firmaCliente,fecha_firma,puesto,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                    [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoyTecnicoDIPREC/', {force: true, ignoreCache: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    
    function guardarCierreMinutaDIPREC(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#puesto").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        } else {
            if($("#coordinadorobra").text() == 'Entrega'){
                if($("#eval").val() <= '2' && $("#comentario_cliente").val() == ""){
                    swal("","Por favor, ingresa el motivo de tu calificacion","warning");
                    return false;
                }
            } else {
                
            }
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        if($("#coordinadorobra").text() == 'Entrega'){
            var calificacion = $("#eval").val(); 
            var comentarioCliente = $('#comentario_cliente').val(); 
        } else {
            var calificacion = "";
            var comentarioCliente = "";
        }
        
        var puesto = $("#puesto").val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE minuta_coordinador SET firma_cliente = ?,fecha_cliente = ?,puesto = ? WHERE id_cedula = ?",
                    [firmaCliente,fecha_firma,puesto,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                    [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoyCoordinadorDIPREC/', {force: true, ignoreCache: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarTecnicoDIPREC(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE servicio_tecnico SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function generarMinutaCoordinador(){
        let id_cedula = localStorage.getItem("IdCedula");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let tipoCedula = "minutaCoordinador";
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addMinutaCoordinador(id_cedula,foto_llegada);
                        app.views.main.router.navigate({name: 'recorridoDIPREC3'});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    
    function guardarDatosMinutaCoordinadorDIPREC(){
        app.preloader.show('blue');
        if($("#empresa").val() =="0" || $("#coordinadorObra").val() == "0" || $("#nombreCliente").val() == "" || $("#proyecto").val() == "" || $("#coordinador").val() == "" || $("#direccion").val() == ""){
            swal("", "Debes llenar todos los campos" ,"warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var empresa = $("#empresa").val();
        var coordinadorObra = $("#coordinadorObra").val();
        var nombreCliente = $("#nombreCliente").val();
        var proyecto = $("#proyecto").val();
        var coordinador = $("#coordinador").val();
        var direccion = $("#direccion").val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET nombre_cliente = ?,id_cliente = ? WHERE id_cedula = ?",
                    [nombreCliente,nombreCliente,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE minuta_coordinador SET empresa = ?,coordinador_obra = ?,nombre_cliente = ?,proyecto = ?,coordonador = ?,direccion = ? WHERE id_cedula = ?",
                                    [empresa,coordinadorObra,nombreCliente,proyecto,coordinador,direccion,id_cedula],
                                    function(tx, results){
                                        $("#empresa").css("background-color", "#FFFFFF");
                                        $("#coordinadorObra").css("background-color", "#FFFFFF");
                                        $("#nombreCliente").css("background-color", "#FFFFFF");
                                        $("#proyecto").css("background-color", "#FFFFFF");
                                        $("#coordinador").css("background-color", "#FFFFFF");
                                        $("#direccion").css("background-color", "#FFFFFF");
                                        swal("", "Se guardaron los datos correctamente" ,"success");
                                        app.preloader.hide();
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    
    function guardarZonaDIPREC(){
        app.preloader.show('blue');
        if($("#zona").val() == "" || $('#imagenC').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var zona = $("#zona").val();
        var foto = $('#imagenC').val();
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();

        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO zonas_coordinador(id_cedula,nombre,foto,fecha_registro) VALUES (?,?,?,?)",
                    [id_cedula,zona,foto,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_zona) as Id from zonas_coordinador",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from zonas_coordinador where id_zona = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $('#imagenC').val("");
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        $("#tabla_zona tbody").append("<tr id='fila"+ item.id_zona +"'><td><a href='#' onclick='eliminarFilaDIPREC("+ item.id_zona +",4);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.nombre) + "</td><td style='text-align: center;'>" + item.fecha_registro + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Registro guardado","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }

    function guardarEquipoCoordinadorDIPREC(){
        app.preloader.show('blue');
        if($("#zona").val() == "0" || $('#equipo').val() == "" || $('#imagenC').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var zona = $("#zona").val();
        var equipo = $("#equipo").val();
        var foto = $('#imagenC').val();
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();

        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO equipos_coordinador(id_cedula,zona,equipo,foto,fecha_registro) VALUES (?,?,?,?,?)",
                    [id_cedula,zona,equipo,foto,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_equipo) as Id from equipos_coordinador",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from equipos_coordinador where id_equipo = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $('#imagenC').val("");
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        $("#tabla_equipo tbody").append("<tr id='fila"+ item.id_equipo +"'><td><a href='#' onclick='eliminarFilaDIPREC("+ item.id_equipo +",4);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.zona) + "</td><td style='text-align: center;'>" + unescape(item.equipo) + "</td><td style='text-align: center;'>" + item.fecha_registro + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Registro guardado","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    
    function guardarZonaEquipoDiprec(){
        app.preloader.show('blue');
        // if($("#zona").val() == "0" || $("#equipo").val() == "0" || $('#voltaje').val() == "" || ($("#voltaje1").prop("checked") == false && $("#voltaje2").prop("checked") == false) || $('#imagenC1').val() == "" || $('#corriente').val() == "" || ($("#corriente1").prop("checked") == false && $("#corriente2").prop("checked") == false) || $('#imagenC2').val() == "" || $('#fase').val() == "" || ($("#fase1").prop("checked") == false && $("#fase2").prop("checked") == false) || $('#imagenC3').val() == "" || $('#tipogas').val() == "" || ($("#tipogas1").prop("checked") == false && $("#tipogas2").prop("checked") == false) || $('#imagenC4').val() == "" || $('#tipogas').val() == "" || ($("#tipogas1").prop("checked") == false && $("#tipogas2").prop("checked") == false) || $('#imagenC4').val() == "" || $('#tipogas').val() == "" || ($("#tipogas1").prop("checked") == false && $("#tipogas2").prop("checked") == false) || $('#imagenC4').val() == "" || $('#presiongas').val() == "" || ($("#presiongas1").prop("checked") == false && $("#presiongas2").prop("checked") == false) || $('#imagenC5').val() == "" || $('#presionvapor').val() == "" || ($("#presionvapor1").prop("checked") == false && $("#presionvapor2").prop("checked") == false) || $('#imagenC6').val() == "" || $('#temperaturaequipo').val() == "" || ($("#temperaturaequipo1").prop("checked") == false && $("#temperaturaequipo2").prop("checked") == false) || $('#imagenC7').val() == "" || $('#fallareportada').val() == ""){
        if($("#zona").val() == "0" || $("#equipo").val() == "0"){
            swal("","Los campos de Zona y Equipo son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var zona = $("#zona").val();
        var equipo = $("#equipo").val();

        var voltajeT = $("#voltaje").val();
        if($("#voltaje1").prop("checked") == true){
            var voltajeC = "1";
        } else if($("#voltaje0").prop("checked")){
            var voltajeC = "0";
        }
        var voltajeF = $('#imagenC1').val();
        var corrienteT = $("#corriente").val();
        if($("#corriente1").prop("checked") == true){
            var corrienteC = "1";
        } else if($("#corriente0").prop("checked")){
            var corrienteC = "0";
        }
        var corrienteF = $('#imagenC2').val();

        var faseT = $("#fase").val();
        if($("#fase1").prop("checked") == true){
            var faseC = "1";
        } else if($("#fase0").prop("checked")){
            var faseC = "0";
        }
        var faseF = $('#imagenC3').val();
        var tipogasT = $("#tipogas").val();
        if($("#tipogas1").prop("checked") == true){
            var tipogasC = "1";
        } else if($("#tipogas0").prop("checked")){
            var tipogasC = "0";
        }
        var tipogasF = $('#imagenC4').val();
        var presiongasT = $("#presiongas").val();
        if($("#presiongas1").prop("checked") == true){
            var presiongasC = "1";
        } else if($("#presiongas0").prop("checked")){
            var presiongasC = "0";
        }
        var presiongasF = $('#imagenC5').val();
        var presionvaporT = $("#presionvapor").val();
        if($("#presionvapor1").prop("checked") == true){
            var presionvaporC = "1";
        } else if($("#presionvapor0").prop("checked")){
            var presionvaporC = "0";
        }
        var presionvaporF = $('#imagenC6').val();
        var temperaturaequipoT = $("#temperaturaequipo").val();
        if($("#temperaturaequipo1").prop("checked") == true){
            var temperaturaequipoC = "1";
        } else if($("#temperaturaequipo0").prop("checked")){
            var temperaturaequipoC = "0";
        }
        var temperaturaequipoF = $('#imagenC7').val();
        var fallareportada = $('#fallareportada').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO datos_coordinador(id_cedula,zona,equipo,voltaje,estado_voltaje,evidencia_voltaje,corriente,estado_corriente,evidencia_corriente,fases,estado_fase,evidencia_fase,tipo_gas,estado_gas,evidencia_gas,presion_gas,estado_presion_gas,evidencia_presion_gas,presion_vapor,estado_presion_vapor,evidencia_presion_vapor,temperatura,estado_temperatura,evidencia_estado_temperatura,falla_reportada) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)",
                    [id_cedula,zona,equipo,voltajeT,voltajeC,voltajeF,corrienteT,corrienteC,corrienteF,faseT,faseC,faseF,tipogasT,tipogasC,tipogasF,presiongasT,presiongasC,presiongasF,presionvaporT,presionvaporC,presionvaporF,temperaturaequipoT,temperaturaequipoC,temperaturaequipoF,fallareportada],
                    function(tx, results){
                        app.preloader.hide();
                        swal("","Evidencia del equipo Guardada","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarObservacionesCoordinadorDIPREC(){
        app.preloader.show('blue');
        if($("#acuerdo").val() == "" || $('#imagenC').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        if($("#sourceP").val() == "Subida"){
            var acuerdo = $("#acuerdo").val() + " #$ S";
        } else {
            var acuerdo = $("#acuerdo").val() + " #$ C";
        }
        var foto = $('#imagenC').val();
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();

        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO observaciones(id_cedula,acuerdo,foto,fecha_registro) VALUES (?,?,?,?)",
                    [id_cedula,acuerdo,foto,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_acuerdo) as Id from observaciones",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from observaciones where id_acuerdo = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $('#imagenC').val("");
                                                        $('#acuerdo').val("");
                                                        $("#textInput").text("Seleccione");
                                                        $("#sourceP").text("Camera");
                                                        $("#acuerdo").css("background-color", "white");
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        item.acuerdo = item.acuerdo.split("#$");
                                                        item.acuerdo = item.acuerdo[0];
                                                        $("#tabla_acuerdo tbody").append("<tr id='fila"+ item.id_acuerdo +"'><td class='FWM-table-options'><a href='#' onclick='eliminarFilaDIPREC("+ item.id_acuerdo +",5);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a><a href='#' onclick='editarFilaDiprec("+ item.id_acuerdo +",1);' style='border: none; outline:none;'><img src='img/editar.svg' width='27px' style='margin-top:10%'/></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.acuerdo) + "</td><td style='text-align: center;'>" + item.fecha_registro + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Acuerdo guardado","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarNotasCoordinadorDIPREC(){
        app.preloader.show('blue');
        if($("#nota").val() == "" || $('#imagenC').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        if($("#sourceP").val() == "Subida"){
            var nota = $("#nota").val() + " #$ S";
        } else {
            var nota = $("#nota").val() + " #$ C";
        }
        
        var foto = $('#imagenC').val();
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();

        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO notas(id_cedula,nota,foto,fecha_registro) VALUES (?,?,?,?)",
                    [id_cedula,nota,foto,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_nota) as Id from notas",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from notas where id_nota = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $('#imagenC').val("");
                                                        $("#nota").val("");
                                                        $("#textInput").text("Seleccione");
                                                        $("#sourceP").text("Camera");
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        item.nota = item.nota.split("#$");
                                                        item.nota = item.nota[0];
                                                        $("#tabla_notas tbody").append("<tr id='fila"+ item.id_nota +"'><td class='FWM-table-options'><a href='#' onclick='eliminarFilaDIPREC("+ item.id_nota +",6);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' style='margin-top:10%' /></a><a href='#' onclick='editarFilaDiprec("+ item.id_nota +",2);' style='border: none; outline:none;'><img src='img/editar.svg' width='27px' style='margin-top:10%'/></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.nota) + "</td><td style='text-align: center;'>" + item.fecha_registro + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Acuerdo guardado","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    
    function activarCheck1(valor){
        if($("#recorrido1").prop("checked") === true){
            $("#re1").css("display", "block");
        } else {
            $("#re1").css("display", "none");
        }
    }
    function activarCheck2(valor){
        if($("#recorrido2").prop("checked") === true){
            $("#re2").css("display", "block");
        } else {
            $("#re2").css("display", "none");
        }
    }
    function terminarCoordinadorDIPREC(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE minuta_coordinador SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function editarFilaDiprec(index, opc){
        if(opc == 1){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "SELECT acuerdo FROM observaciones WHERE id_acuerdo = ?",
                        [index],
                        function(tx, results){
                            var item = results.rows.item(0);
                            dynamicPopup.open();
                            item.acuerdo = item.acuerdo.split("#$");
                            var estado = item.acuerdo[1];
                            item.acuerdo = item.acuerdo[0];
                            $("#edit").val(item.acuerdo);
                            $("#option").val(index + "," + opc + "," + estado);
                        },
                        function(tx, error){
                            swal("Error al actualizar el registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 2) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "SELECT nota FROM notas WHERE id_nota = ?",
                        [index],
                        function(tx, results){
                            var item = results.rows.item(0);
                            dynamicPopup.open();
                            item.nota = item.nota.split("#$");
                            var estado = item.nota[1];
                            item.nota = item.nota[0];
                            $("#edit").val(item.nota);
                            $("#option").val(index + "," + opc + "," + estado);
                        },
                        function(tx, error){
                            swal("Error al actualizar el registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } 
    }
    function FilaEditadaDiprec(){
        var options = $("#option").val();
        var opt = options.split(",");
        var text = $("#edit").val() + " #$ " + opt[2];
        if(opt[1] == 1){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE observaciones SET acuerdo = ? WHERE id_acuerdo = ?",
                        [text,opt[0]],
                        function(tx, results){
                            $("#tabla_acuerdo tbody").remove();
                            $("#tabla_acuerdo").append("<tbody></tbody>");
                            var id_cedula = localStorage.getItem("IdCedula");
                            databaseHandler.db.transaction(
                                function(tx1){
                                    tx1.executeSql(
                                        "Select * from observaciones where id_cedula= ?",
                                        [id_cedula],
                                        function(tx, results){
                                            var length = results.rows.length;
                                            if(length == 0){
                                                $("#message-nr").css("display", "block");
                                            } else {
                                                for(var i = 0; i< length; i++){
                                                    var item = results.rows.item(i);
                                                    item.acuerdo = item.acuerdo.split("#$");
                                                    item.acuerdo = item.acuerdo[0];
                                                    $("#tabla_acuerdo tbody").append("<tr id='fila"+ item.id_acuerdo +"'><td class='FWM-table-options'><a href='#' onclick='eliminarFilaDIPREC("+ item.id_acuerdo +",5);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a><a href='#' onclick='editarFilaDiprec("+ item.id_acuerdo +",1);' style='border: none; outline:none;'><img src='img/editar.svg' width='27px' style='margin-top:10%'/></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.acuerdo) + "</td><td style='text-align: center;'>" + item.fecha_registro + "</td></tr>");
                                                    $("#message-nr").css("display", "none");
                                                    swal("", "Registro Actualizado Exitosamente!!" ,"success");
                                                }
                                            }
                                            $('.preloader').remove();
                                            $('.infinite-scroll-preloader').remove();
                                        },
                                        function(tx, error){
                                            console.log("Error al consultar: " + error.message);
                                        }
                                    );
                                    console.log("Consulta correcta");
                                },
                                function(error){},
                                function(){}
                            );
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opt[1] == 2){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE notas SET nota = ? WHERE id_nota = ?",
                        [text,opt[0]],
                        function(tx, results){
                            $("#tabla_notas tbody").remove();
                            $("#tabla_notas").append("<tbody></tbody>");
                            var id_cedula = localStorage.getItem("IdCedula");
                            databaseHandler.db.transaction(
                                function(tx1){
                                    tx1.executeSql(
                                        "Select * from notas where id_cedula= ?",
                                        [id_cedula],
                                        function(tx, results){
                                            var length = results.rows.length;
                                            if(length == 0){
                                                $("#message-nr").css("display", "block");
                                            } else {
                                                for(var i = 0; i< length; i++){
                                                    var item = results.rows.item(i);
                                                    item.nota = item.nota.split("#$");
                                                    item.nota = item.nota[0];
                                                    $("#tabla_notas tbody").append("<tr id='fila"+ item.id_nota +"'><td style='display: flex;flex-direction: row;justify-content: space-around;align-items: flex-end;padding:0;'><a href='#' onclick='eliminarFilaDIPREC("+ item.id_nota +",6);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' style='margin-top:10%' /></a><a href='#' onclick='editarFilaDiprec("+ item.id_nota +",2);' style='border: none; outline:none;'><img src='img/editar.svg' width='27px' style='margin-top:10%'/></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.nota) + "</td><td style='text-align: center;'>" + item.fecha_registro + "</td></tr>");
                                                    $("#message-nr").css("display", "none");
                                                    swal("", "Registro Actualizado Exitosamente!!" ,"success");
                                                }
                                            }
                                            $('.preloader').remove();
                                            $('.infinite-scroll-preloader').remove();
                                        },
                                        function(tx, error){
                                            console.log("Error al consultar: " + error.message);
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function editarFilaSuro(index, opc){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql(
                    "SELECT nombre_grupo FROM grupos WHERE id_grupo = ?",
                    [index],
                    function(tx, results){
                        var item = results.rows.item(0);
                        PopupSuro.open();
                        $("#edit").val(item.nombre_grupo);
                        $("#option").val(index + "," + opc);
                        $("#lastValue").val(item.nombre_grupo);
                    },
                    function(tx, error){
                        swal("Error al actualizar el registro",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function FilaEditadaSuro(){
        var id_cedula = localStorage.getItem("IdCedula");
        var options = $("#option").val();
        var toSearch = $("#lastValue").val();
        var opt = options.split(",");
        var text = $("#edit").val();
        if(opt[1] == 1){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE grupos SET nombre_grupo = ? WHERE id_grupo = ? AND id_cedula = ?",
                        [text,opt[0],id_cedula],
                        function(tx, results){
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("UPDATE evidencia SET nombre_grupo = ? WHERE nombre_grupo = ? AND id_cedula = ? AND fases = 'durante'",
                                        [text,toSearch,id_cedula],
                                        function(tx, results){
                                            $("#tabla_grupos_uno tbody").remove();
                                            $("#tabla_grupos_uno").append("<tbody></tbody>");
                                            var id_cedula = localStorage.getItem("IdCedula");
                                            databaseHandler.db.transaction(
                                                function(tx1){
                                                    tx1.executeSql(
                                                        "Select * from grupos where id_cedula= ? AND fases = 'durante'",
                                                        [id_cedula],
                                                        function(tx, results){
                                                            var length = results.rows.length;
                                                            if(length == 0){
                                                                $("#message-nr").css("display", "block");
                                                            } else {
                                                                for(var i = 0; i< length; i++){
                                                                    var item = results.rows.item(i);
                                                                    $("#tabla_grupos_uno tbody").append("<tr id='fila"+ item.id_grupo +"'><td><a href='#' onclick='editarFilaSuro("+ item.id_grupo +",1);' style='border: none; outline:none;'><img src='img/editar.svg' width='27px' style='margin-top:10%'/></a></td><td> " + item.nombre_grupo + "</td></tr>");
                                                                    $("#message-nr").css("display", "none");
                                                                    swal("", "Registro Actualizado Exitosamente!!" ,"success");
                                                                }
                                                            }
                                                            $('.preloader').remove();
                                                            $('.infinite-scroll-preloader').remove();
                                                        },
                                                        function(tx, error){
                                                            console.log("Error al consultar: " + error.message);
                                                        }
                                                    );
                                                },
                                                function(error){},
                                                function(){}
                                            );
                                        },
                                        function(tx, error){
                                            swal("Error al guardar",error.message,"error");
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opt[1] == 2){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE grupos SET nombre_grupo = ? WHERE id_grupo = ? AND id_cedula = ?",
                        [text,opt[0],id_cedula],
                        function(tx, results){
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("UPDATE evidencia SET nombre_grupo = ? WHERE nombre_grupo = ? AND id_cedula = ? AND fases = 'fomites'",
                                        [text,toSearch,id_cedula],
                                        function(tx, results){
                                            $("#tabla_grupos_dos tbody").remove();
                                            $("#tabla_grupos_dos").append("<tbody></tbody>");
                                            databaseHandler.db.transaction(
                                                function(tx1){
                                                    tx1.executeSql(
                                                        "Select * from grupos where id_cedula= ? AND fases = 'fomites'",
                                                        [id_cedula],
                                                        function(tx, results){
                                                            var length = results.rows.length;
                                                            if(length == 0){
                                                                $("#message-nr2").css("display", "block");
                                                            } else {
                                                                for(var i = 0; i< length; i++){
                                                                    var item = results.rows.item(i);
                                                                    $("#tabla_grupos_dos tbody").append("<tr id='fila"+ item.id_grupo +"'><td><a href='#' onclick='editarFilaSuro("+ item.id_grupo +",2);' style='border: none; outline:none;'><img src='img/editar.svg' width='27px' style='margin-top:10%'/></a></td><td> " + item.nombre_grupo + "</td></tr>");
                                                                    $("#message-nr2").css("display", "none");
                                                                    swal("", "Registro Actualizado Exitosamente!!" ,"success");
                                                                }
                                                            }
                                                            $('.preloader').remove();
                                                            $('.infinite-scroll-preloader').remove();
                                                        },
                                                        function(tx, error){
                                                            console.log("Error al consultar: " + error.message);
                                                        }
                                                    );
                                                },
                                                function(error){},
                                                function(){}
                                            );
                                        },
                                        function(tx, error){
                                            swal("Error al guardar",error.message,"error");
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    var dynamicPopup = app.popup.create({
        content: `
          <div class="popup FWM-half-modal">
            <div class="my-swipe-to-close-handler" style="padding-top:16px">
                <div class="FWM-bubble-close"></div>
            </div>
            <div class="block">
                <p style="margin:0">Edicion de registro:</p>
                <textarea class ="FWM-input-modal" id="edit" name="edit"  cols="30" rows="10"></textarea>
                <input type="hidden" id="option" name="option"/>
                <div class="FWM-button-modal-container">
                    <div class="FWM-button-modal popup-close" onclick="FilaEditadaDiprec()">Actualizar Registro</div>
                </div>
            </div>
          </div>
        `,
        swipeToClose: true,
        swipeHandler: '.my-swipe-to-close-handler',
        // Events
        on: {
          open: function (popup,text) {
            
          },
          opened: function (popup) {
            
          },
        }
    });
    dynamicPopup.on('close', function (popup) {});
    var PopupSuro = app.popup.create({
        content: `
          <div class="popup FWM-half-modal">
            <div class="my-swipe-to-close-handler" style="padding-top:16px">
                <div class="FWM-bubble-close"></div>
            </div>
            <div class="block">
                <p style="margin:0">Edicion de registro:</p>
                <textarea class ="FWM-input-modal" id="edit" name="edit"  cols="30" rows="10"></textarea>
                <input type="hidden" id="option" name="option"/>
                <input type="hidden" id="lastValue" name="lastValue"/>
                <div class="FWM-button-modal-container">
                    <div class="FWM-button-modal popup-close" onclick="FilaEditadaSuro()">Actualizar Registro</div>
                </div>
            </div>
          </div>
        `,
        swipeToClose: true,
        swipeHandler: '.my-swipe-to-close-handler',
        // Events
        on: {
          open: function (popup,text) {
            
          },
          opened: function (popup) {
            
          },
        }
    });
    PopupSuro.on('close', function (popup) {});
    function startFromProgramDIPREC(empresa,category,nombre_comercial,person_receive,direccion){
        localStorage.setItem("empresaD", empresa);
        localStorage.setItem("categoryD", category);
        localStorage.setItem("nombre_comercialD", nombre_comercial);
        localStorage.setItem("person_receiveD", person_receive);
        localStorage.setItem("direccionD", direccion);
        app.views.main.router.navigate({name: 'yallegueDIPREC2'});
    }
    function iniciarClienteDIPREC(){
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_cliente = "N/A";
        var horario_programado = fecha_llegada;
        var foto_llegada = $("#imagenC").val();
        var nombre_cliente = localStorage.getItem("nombre_comercialD");
        var tipoCedula = "minutaCoordinador";
        var estatus = 0;
        if(foto_llegada != ''){
            if(nombre_cliente != ''){
                productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                            [],
                            function(tx, results){
                                var item = results.rows.item(0);
                                var id_cedula = item.Id;
                                localStorage.setItem("IdCedula", item.Id);
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                            [tipoCedula,id_cedula],
                                            function(tx, results){
                                                var empresa = localStorage.getItem("empresaD");
                                                if(empresa == "ZUBRAUN, S.A. DE C.V"){
                                                    empresa = 1;
                                                } else if(empresa == "GASTRO CHEF DE MEXICO S.A. DE C.V"){
                                                    empresa = 2;
                                                } else if(empresa == "DIPREC S.A. DE C.V"){
                                                    empresa = 3;
                                                }
                                                var coordinador_obra = localStorage.getItem("categoryD");
                                                if(coordinador_obra == "Levantamiento"){
                                                    coordinador_obra = 1;
                                                } else if(coordinador_obra == "Instalaci√≥n"){
                                                    coordinador_obra = 2;
                                                } else if(coordinador_obra == "Avance de Obra"){
                                                    coordinador_obra = 3;
                                                } else if(coordinador_obra == "Reuni√≥n"){
                                                    coordinador_obra = 4;
                                                } else if(coordinador_obra == "Capacitaci√≥n"){
                                                    coordinador_obra = 5;
                                                } else if(coordinador_obra =="Entrega"){
                                                    coordinador_obra = 6;
                                                }
                                                var nombre_cliente = localStorage.getItem("nombre_comercialD");
                                                var proyecto = localStorage.getItem("person_receiveD");
                                                var coordonador = nombre_usuario;
                                                var direccion = localStorage.getItem("direccionD");
                                                productHandler.addMinutaCoordinadorr(id_cedula,foto_llegada,empresa,coordinador_obra,nombre_cliente,proyecto,coordonador,direccion);
                                                app.views.main.router.back('/recorridoDIPREC3/', {force: true, ignoreCache: true, reload: true});
                                            },
                                            function(tx, error){
                                                console.error("Error al actualizar el tipo de cedula: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                                // app.views.main.router.navigate({name: 'menuSMC'});
                                app.preloader.hide();
                            },
                            function(tx, error){
                                console.log("Error al guardar cedula: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            } else {
                swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        } else {
            swal("Falta un campo", "La fotograf√≠a es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }
    }
    function uploadPicture(input){
        if (input.files && input.files[0]) {
            var reader = new FileReader();
            reader.onloadend = function (e) {
                $("body").append("<canvas id='tempCanvas' width='800' height='800' style='display:none'></canvas>");
                var canvas = document.getElementById("tempCanvas");
                var ctx = canvas.getContext("2d");
                var maxW = 800;
                var maxH = 800;
                var img = new Image;
                img.src = this.result;
                img.onload = function(){
                    var iw = img.width;
                    var ih = img.height;
                    var scale = Math.min((maxW/iw),(maxH/ih));
                    var iwScaled = iw*scale;
                    var ihScaled = ih*scale;
                    canvas.width = iwScaled;
                    canvas.height = ihScaled;
                    ctx.drawImage(img,0,0,iwScaled,ihScaled);
                    var base64image = canvas.toDataURL("image/jpeg");
                    $("#imagenC").val(base64image);
                    $("#sourceP").val("Subida");
                    $("#textInput").text(input.files[0].name);
                    $("#tempCanvas").remove();
                }
            };
            reader.readAsDataURL(input.files[0]);
        }
    }
    //DIPREC FIN
    //Inicio MerGroup
    function tracking1(){
        app.views.main.router.navigate({
            name: "tracking-1",
        });
    }
    function tracking2(){
        app.views.main.router.navigate({
            name: "tracking-2",
        });
    }
    function tracking3(){
        app.views.main.router.navigate({
            name: "tracking-3",
        });
    }
    function tracking4(){
        app.views.main.router.navigate({
            name: "tracking-4",
        });
    }
    function buscarClienteMerGroup(){
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_cliente = "N/A";
        var horario_programado = fecha_llegada;
        var foto_llegada = $("#imagenC").val();
        var nombre_cliente = $("#autocomplete-dropdown-ajax").val();
        var estatus = 0;
        if(foto_llegada != ''){
            if(nombre_cliente != ''){
                productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                            [],
                            function(tx, results){
                                var item = results.rows.item(0);
                                localStorage.setItem("IdCedula", item.Id);
                                localStorage.setItem("nombreCliente", nombre_cliente);
                                localStorage.setItem("foto_llegada", foto_llegada);
                                app.views.main.router.navigate({name: 'recorridoMerGroup'});
                                app.preloader.hide();
                            },
                            function(tx, error){
                                console.log("Error al guardar cedula: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            } else {
                swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        } else {
            swal("Falta un campo", "La fotograf√≠a es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }
    }
    function guardarObservacionesMer(){
        app.preloader.show('blue');
        if($("#titulo").val() == "" || $('#imagenC').val() == ""){
            swal("","El titulo y la fotografia son obligatorios","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var titulo = $("#titulo").val();
        var observacion = $("#observacion").val();
        var foto = $('#imagenC').val();
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO evidenciaFotografica(id_cedula,titulo,observacion,foto,fecha_registro) VALUES (?,?,?,?,?)",
                    [id_cedula,titulo,observacion,foto,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_evidencia) as Id from evidenciaFotografica",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from evidenciaFotografica where id_evidencia = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        $('#imagenC').val("");
                                                        $("#titulo").val("");
                                                        $("#observacion").val("");
                                                        $("#titulo").css("background-color", "#FFFFFF");
                                                        $("#observacion").css("background-color", "#FFFFFF");
                                                        $("#tabla_evidencias tbody").append("<tr id='fila"+ item.id_evidencia +"'><td class='FWM-table-options'><a href='#' onclick='eliminarFilaDIPREC("+ item.id_evidencia +",6);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' style='margin-top:10%' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.titulo) + "</td><td style='text-align: center;'>" + unescape(item.observacion) + "</td><td style='text-align: center;'>" + item.fecha_registro + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Acuerdo guardado","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarCierreFotografiaMer(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#eval").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        if($("#eval").val() <= '3' && $("#comentario_cliente").val() == ""){
            swal("","Por favor, ingresa el motivo de tu calificacion","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var calificacion = $("#eval").val();
        var comentarioCliente = $('#comentario_cliente').val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE reporteFotografico SET firma_cliente = ?,fecha_cliente = ? WHERE id_cedula = ?",
                    [firmaCliente,fecha_firma,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                    [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoyMerGroup/', {force: true, ignoreCache: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarReporteMer(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE reporteFotografico SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    //Fin MerGroup
    //Inicio PlatoLimpio
    function regeresarPLR1(){
        app.views.main.router.back('/recorridoPL1/', {force: true, ignoreCache: true, reload: true});
    }
    function regeresarPLR2(){
        app.views.main.router.back('/recorridoPL2/', {force: true, ignoreCache: true, reload: true});
    }
    function regeresarPLR3(){
        app.views.main.router.back('/recorridoPL3/', {force: true, ignoreCache: true, reload: true});
    }
    function buscarClientePlatoLimpio(){
            var id_usuario = localStorage.getItem("id_usuario");
            var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
            var fecha = new Date();
            var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            var geolocation = $("#geolocation").val();
            var id_cliente = "N/A";
            var horario_programado = fecha_llegada;
            var foto_llegada = $("#imagenC").val();
            var nombre_cliente = $("#autocomplete-dropdown-ajax").val();
            var estatus = 0;
            if(foto_llegada != ''){
                if(nombre_cliente != ''){
                    productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                                [],
                                function(tx, results){
                                    var item = results.rows.item(0);
                                    localStorage.setItem("IdCedula", item.Id);
                                    localStorage.setItem("nombreCliente", nombre_cliente);
                                    localStorage.setItem("foto_llegada", foto_llegada);
                                    app.views.main.router.navigate({name: 'menuPlatoLimpio'});
                                    app.preloader.hide();
                                },
                                function(tx, error){
                                    console.log("Error al guardar cedula: " + error.message);
                                    app.preloader.hide();
                                }
                            );
                        },
                        function(error){},
                        function(){}
                    );
                } else {
                    swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
                    app.preloader.hide();
                }
            } else {
                swal("Falta un campo", "La fotograf√≠a es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        }
        function generarCicloCharola() {
            let id_cedula = localStorage.getItem("IdCedula");
            let nombre_cliente = localStorage.getItem("nombreCliente");
            let nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
            let foto_llegada = localStorage.getItem("foto_llegada");
            var fecha = new Date();
            var fecha_llegada = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
            let tipoCedula = "Plato Limpio";
            let direccion = localStorage.getItem("direccion");
            let correo = localStorage.getItem("correo");
            let sucursal = localStorage.getItem("sucursal");
            let proceso = 0;
            let recorrido = 0;
            let titulo = "foto_llegada";
            databaseHandler.db.transaction(
                function (tx) {
                    tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                        [tipoCedula, id_cedula],
                        function (tx, results) {
                            databaseHandler.db.transaction(
                                function (tx) {
                                    tx.executeSql("select * from DG_PlatoL WHERE DG_ID_Cedula = ?",
                                        [id_cedula],
                                        function (tx, results) {
                                            let length = results.rows.length;
                                            if (length > 0) {                                           
                                            var item = results.rows.item(i);
                                                app.views.main.router.navigate({ name: 'recorridoPL1' });
                                            }else{
                                                productHandler.addPL(id_cedula, nombre_cliente, correo);
                                                productHandler.PLFotos(id_cedula, recorrido, proceso,titulo, fecha_llegada, foto_llegada);
                                                app.views.main.router.navigate({ name: 'recorridoPL1' });
                                            } 
    
                                        },
                                        function (tx, error) {
                                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                                        }
                                    );
                                },
                                function (error) { },
                                function () { }
                            );                    
        
                        },
                        function (tx, error) {
                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                        }
                    );
                },
                function (error) { },
                function () { }
            );
        
        }
        function FactorHumano(){
            let id_cedula = localStorage.getItem("IdCedula");
            let nombre_cliente = localStorage.getItem("nombreCliente");
            let nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
            let foto_llegada = localStorage.getItem("foto_llegada");
            var fecha = new Date();
            var fecha_llegada = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
            let tipoCedula = "Plato Limpio";
            let direccion = localStorage.getItem("direccion");
            let correo = localStorage.getItem("correo");
            let sucursal = localStorage.getItem("sucursal");
            let proceso = 0;
            let recorrido = 0;
            let titulo = "foto_llegada";
            databaseHandler.db.transaction(
                function (tx) {
                    tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                        [tipoCedula, id_cedula],
                        function (tx, results) {
    
                            databaseHandler.db.transaction(
                                function (tx) {
                                    tx.executeSql("select * from DG_PlatoL WHERE DG_ID_Cedula = ?",
                                        [id_cedula],
                                        function (tx, results) {
                                            let length = results.rows.length;
                                            if (length > 0) {                                           
                                                var item = results.rows.item(i);
                                                app.views.main.router.navigate({name: 'recorridoPL2'});
                                            }else{
                                                productHandler.addPL(id_cedula, nombre_cliente, correo);
                                                productHandler.PLFotos(id_cedula, recorrido, proceso, titulo,fecha_llegada,  foto_llegada);
                                                app.views.main.router.navigate({name: 'recorridoPL2'});
                                            } 
    
                                        },
                                        function (tx, error) {
                                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                                        }
                                    );
                                },
                                function (error) { },
                                function () { }
                            );
    
        
                        },
                        function (tx, error) {
                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                        }
                    );
                },
                function (error) { },
                function () { }
            );
            
        }
        function SanitizacionLava(){
            let id_cedula = localStorage.getItem("IdCedula");
            let nombre_cliente = localStorage.getItem("nombreCliente");
            let nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
            let foto_llegada = localStorage.getItem("foto_llegada");
            var fecha = new Date();
            var fecha_llegada = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
            let tipoCedula = "Plato Limpio";
            let direccion = localStorage.getItem("direccion");
            let correo = localStorage.getItem("correo");
            let sucursal = localStorage.getItem("sucursal");
            let proceso = 0;
            let recorrido = 0;
            let titulo = "foto_llegada";
            databaseHandler.db.transaction(
                function (tx) {
                    tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                        [tipoCedula, id_cedula],
                        function (tx, results) {
    
                            databaseHandler.db.transaction(
                                function (tx) {
                                    tx.executeSql("select * from DG_PlatoL WHERE DG_ID_Cedula = ?",
                                        [id_cedula],
                                        function (tx, results) {
                                            let length = results.rows.length;
                                            if (length > 0) {                                           
                                                var item = results.rows.item(i);                                            
                                                app.views.main.router.navigate({name: 'recorridoPL3'});
                                            }else{
                                                productHandler.addPL(id_cedula, nombre_cliente, correo);
                                                productHandler.PLFotos(id_cedula, recorrido, proceso,  titulo, fecha_llegada, foto_llegada);                                           
                                                app.views.main.router.navigate({name: 'recorridoPL3'});
                                            } 
    
                                        },
                                        function (tx, error) {
                                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                                        }
                                    );
                                },
                                function (error) { },
                                function () { }
                            );
    
        
                        },
                        function (tx, error) {
                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                        }
                    );
                },
                function (error) { },
                function () { }
            );
        }
        function regresarRecorridoPL1(){
            app.views.main.router.back('/recorridoPL1/', {force: true, ignoreCache: true, reload: true});
        }
        function guardarDGPL() {
            app.preloader.show('blue');
            if ($("#empresa").val() == "" || $("#canEmpleados").val() == "" || $("#fecAudi").val() == "" || $("#hora").val() == "") {
                swal("", "Debes llenar todos los campos", "warning");
                app.preloader.hide();
                return false;
            }
            var empresa = $("#empresa").val();
            var canEmpleados = $("#canEmpleados").val();
            var fecAudi = $("#fecAudi").val();
            var hora = $("#hora").val();
            var contacto = $("#contacto").val();
            var puesto = $("#puesto").val();
            var correo = $("#mail").val();
            var movil = $("#movil").val();
            var id_cedula = localStorage.getItem("IdCedula");
            databaseHandler.db.transaction(
                function (tx) {
                    tx.executeSql("UPDATE DG_PlatoL SET  DG_CEmpleados  = ? ,DG_Empresa = ?, DG_FechaA= ?,DG_HoraA = ?, DG_Contacto = ?, DG_Puesto = ?, DG_Correo = ?, DG_Movil = ? WHERE DG_ID_Cedula = ?",
                        [canEmpleados, empresa, fecAudi, hora, contacto, puesto, correo, movil, id_cedula],
                        function (tx, results) {
                            $("#empresa").css("background-color", "#FFFFFF");
                            $("#canEmpleados").css("background-color", "#FFFFFF");
                            $("#fecAudi").css("background-color", "#FFFFFF");
                            $("#puesto").css("background-color", "#FFFFFF");
                            $("#contacto").css("background-color", "#FFFFFF");
                            $("#mail").css("background-color", "#FFFFFF");
                            $("#movil").css("background-color", "#FFFFFF");
    
                            swal("", "Se guardaron los datos correctamente", "success");
                            app.preloader.hide();
                        },
                        function (tx, error) {
                            swal("Error al guardar", error.message, "error");
                            app.preloader.hide();
                        }
                    );
                },
                function (error) { },
                function () { }
            );
        }
        function guardarCCharolaPPL(tipo) {
            app.preloader.show('blue');
            if ($("#RespMD").val() == "" || $("#EscalaR").val() == "" || $("#areaOportunidad").val() == "" || $("#Comentarios").val() == "") {
                swal("", "Debes llenar todos los campos", "warning");
                app.preloader.hide();
                return false;
            }
            var RespMD = $("#RespMD").val();
            var EscalaR = $("#EscalaR").val();
            var areaOportunidad = $("#areaOportunidad").val();
            var Comentarios = $("#Comentarios").val();
            var id_cedula = localStorage.getItem("IdCedula");
            var etapa = $("#Etapa").val();
            $('select[name="Etapa"] option:selected ').html(function (a, cambiar) {
                return cambiar.replace('‚úò', '‚úî');
            });
            var jq = $('select[name="Etapa"] option:selected').text();
            var foto = $("#imagenC").val();
            var recorrido = 1;
            //var proceso= 1;
            var titulo = "" + jq;
            var fecha = new Date();
            var fecha_foto = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
            if (foto) {
                productHandler.PLFotos(id_cedula, recorrido, etapa, titulo, fecha_foto, foto);
            }
            databaseHandler.db.transaction(
                function (tx) {
                    tx.executeSql("select count(*) as Cuenta from Ciclo_Charola WHERE CC_ID_Cedula = ? and CC_Etapa =?",
                        [id_cedula, etapa],
                        function (tx, results) {
                            var item = results.rows.item(0);
                            if (item.Cuenta == 0) {
                                // console.log("Insert")
                                tx.executeSql("insert into Ciclo_Charola(CC_ID_Cedula,CC_tipo,CC_Etapa,CC_Escala,CC_Oportunidad,CC_Comentario,CC_Responsable) values(?,?,?,?,?,?,?)",
                                    [id_cedula, tipo, etapa, EscalaR, areaOportunidad, Comentarios, RespMD],
                                    function (tx, results) {
                                        var item = results.rows.item(0);
                                        //console.log("Registro de Ciclo_Charola exitosamente");
                                        $("#imagenC").val("");
                                        $("#smallImage").attr('src', 'img/blank.png');
                                        $("#photoIcon").attr("src", "img/camera.svg");
                                        swal("", "Se guardaron los datos correctamente", "success");
                                    },
                                    function (tx, error) {
                                        console.error("Error al registrar Ciclo_Charola: " + error.message);
                                    }
                                );
    
                            } else {
                                //console.log("Update")
                                tx.executeSql("UPDATE Ciclo_Charola SET CC_Responsable = ?, CC_Escala = ?, CC_Oportunidad = ? ,CC_Comentario = ? WHERE CC_ID_Cedula = ? and CC_Etapa =?  ",
                                    [RespMD, EscalaR, areaOportunidad, Comentarios, id_cedula, etapa],
                                    function (tx, results) {
                                        var item = results.rows.item(0);
                                        $("#imagenC").val("");
                                        $("#smallImage").attr('src', 'img/blank.png');
                                        $("#photoIcon").attr("src", "img/camera.svg");
                                        // console.log("Registro de Ciclo_Charola exitosamente");
                                        swal("", "Se actualizaron los datos correctamente", "success");
                                    },
                                    function (tx, error) {
                                        console.error("Error al registrar Ciclo_Charola: " + error.message);
                                    }
                                );
                            }
                            $("#RespMD").css("background-color", "#FFFFFF");
                            $("#EscalaR").css("background-color", "#FFFFFF");
                            $("#areaOportunidad").css("background-color", "#FFFFFF");
                            $("#Comentarios").css("background-color", "#FFFFFF");
                            $("#IdCedula").css("background-color", "#FFFFFF");
                            app.preloader.hide();
                        },
                        function (tx, error) {
                            swal("Error al guardar", error.message, "error");
                            app.preloader.hide();
                        }
                    );
                },
                function (error) { },
                function () { }
            );
    
        }
        function EtapasLP(id, value) {
            $("#tabla_ciclo_charola tbody").empty("");
            var id_cedula = localStorage.getItem("IdCedula");
            if (value == 1 || value == 12) {
                $(Protocolo).val("A,C")
            } else if (value == 2 || value == 3) {
                $(Protocolo).val("B,C")
            } else if (value == 4 || value == 9) {
                $(Protocolo).val("B,C,D")
            } else if (value == 5) {
                $(Protocolo).val("A,B,C,E")
            } else if (value == 6 || value == 7) {
                $(Protocolo).val("A,B,D")
            } else if (value == 8) {
                $(Protocolo).val("A,B,C,D")
            } else if (value == 10) {
                $(Protocolo).val("A")
            } else if (value == 11) {
                $(Protocolo).val("A,B,C")
            } else if (value == 13) {
                $(Protocolo).val("A,B")
            } else if (value == 14) {
                $(Protocolo).val("C,D")
            }
            databaseHandler.db.transaction(
                function (tx) {
                    tx.executeSql(
                        "Select * from Ciclo_Charola WHERE CC_ID_Cedula = ? and CC_Etapa = ?",
                        [id_cedula, value],
                        function (tx, results) {
                            let length = results.rows.length;
                            if (length > 0) {
                                for (var i = 0; i < length; i++) {
                                    var item = results.rows.item(i);
                                    $("#RespMD").val(item.CC_Responsable);
                                    $("#areaOportunidad").val(item.CC_Oportunidad)
                                    $("#Comentarios").val(item.CC_Comentario)
                                    $("#EscalaR").val(item.CC_Escala)
                                    $('select[name="Etapa"] option:selected ').html(function (a, cambiar) {
                                        return cambiar.replace('‚úò', '‚úî');
                                    });
                                    // $("#Etapa").css("background-color", "#66D654")
                                    databaseHandler.db.transaction(
                                        function (tx) {
                                            tx.executeSql(
                                                "Select * from PL_Fotos WHERE F_ID_Cedula = ? and F_Recorrido = ? and F_Proceso = ?",
                                                [id_cedula, 1, value],
                                                function (tx, results) {
                                                    let length = results.rows.length;
                                                    if (length > 0) {
                                                        for (var i = 0; i < length; i++) {
                                                            var item = results.rows.item(i);
                                                            $("#tabla_ciclo_charola tbody").append("<tr id='fila" + item.F_ID_Fotos + "'><td><a href='#' onclick='eliminarFila(" + item.F_ID_Fotos + ",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a><td><img src='" + item.F_Foto + "' width='60px'/></td><td style='text-align: center;'>" + item.F_titulo + "</td><td style='text-align: center;'>" + item.F_FechaHora + "</td></tr>");
                                                            $("#message-nr").hide();
                                                        }
                                                    } else {
                                                        $("#message-nr").show();
                                                    }
    
                                                },
                                                function (tx, error) {
                                                    console.log("Error al guardar registroPL: " + error.message);
                                                    app.preloader.hide();
                                                }
                                            );
                                        },
                                        function (error) { },
                                        function () { }
                                    );
                                }
                            } else {
                                $("#RespMD").val("");
                                $("#areaOportunidad").val("")
                                $("#Comentarios").val("")
                                $("#EscalaR").val("")
                                $("#imagenC").val("");
                                $("#smallImage").attr('src', 'img/blank.png');
                                $("#photoIcon").attr("src", "img/camera.svg");
                                $("#message-nr").show();
                                $("#tabla_ciclo_charola tbody").empty("");
                                // $("#Etapa").css("background-color", "red");
                                $('select[name="Etapa"] option:selected ').html(function (a, cambiar) {
                                    return cambiar.replace('‚úî', '‚úò');
                                });
    
                            }
                        },
                        function (tx, error) {
                            console.log("Error al guardar registroPL: " + error.message);
                            app.preloader.hide();
                        }
                    );
                },
                function (error) { },
                function () { }
            );
    
    
    
        }
    function NombrePuesto(id, value) {
        var id_cedula = localStorage.getItem("IdCedula");
        $("#tabla_FH tbody").empty("");
        if (value == 1) {
            $(Actividades).val("Usuario final y principal riesgo a convertirse en v√≠ctima en caso de no cumplirse las  sanitizaci√≥n y posible portador")
            $(Tipo).val("Responsable del cumplimiento de cocina")
        } else if (value == 2) {
            $(Actividades).val("Responsable del cumplimiento a protocolos de sanitizaci√≥n dentro toda la empresa")
            $(Tipo).val("Responsivo")
        } else if (value == 3) {
            $(Actividades).val("Responsable de condiciones de prestaciones a todo colaborador")
            $(Tipo).val("Responsivo")
        } else if (value == 4) {
            $(Actividades).val("Responsable del cumplimiento de cocina")
            $(Tipo).val("Responsivo")
        } else if (value == 5) {
            $(Actividades).val("Responsable del cumplimiento protocolos de sanitizaci√≥n dentro del √°rea de cocina");
            $(Tipo).val("Responsivo");
        } else if (value == 6 || value == 7 || value == 8 || value == 9) {
            $(Actividades).val("Responsable de la Correcta Operaci√≥n/ Manipulaci√≥n o Actividades directas  para el cumplimiento de la sanitizaci√≥n")
            $(Tipo).val(" Manipulaci√≥n Directa Riesgo Cr√≠tico");
        } else if (value == 10) {
            $(Actividades).val("Responsable de la Correcta Operaci√≥n/ Manipulaci√≥n o Actividades directas  para el cumplimiento de la sanitizaci√≥n")
            $(Tipo).val(" Manipulaci√≥n Eventual");
        } else if (value == 11) {
            $(Actividades).val(" ");
            $(Tipo).val(" ");
            $(Actividades).prop("disabled", false);
            $(Tipo).prop("disabled", false);
    
    
        }
    
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql(
                    "Select*from Factor_Humano WHERE FH_ID_Cedula = ? and FH_Puesto = ? ",
                    [id_cedula, value],
                    function (tx, results) {
                        let length = results.rows.length;
                        if (length > 0) {
                            for (var i = 0; i < length; i++) {
                                var item = results.rows.item(i);
                                $("#ObservacionFH").val(item.FH_Observacion);
                                $("input[name=pregunta3][value=" + item.FH_Manuales + "]").prop("checked", true);
                                var cap = item.FH_Capacitacion;
                                var cap2 = cap.slice(0, -1);
                                var arrayCapacitacion = [];
                                arrayCapacitacion = cap2.split(",");
                                for (var j = 0; j < arrayCapacitacion.length; j++) {
                                    $("input[name=pregunta1][value=" + arrayCapacitacion[j] + "]").prop("checked", true);
                                }
                                var cer = item.FH_Certificacion;
                                var cer2 = cer.slice(0, -1);
                                var arrayCertificacion = [];
                                arrayCertificacion = cer2.split(",");
                                for (var k = 0; k < arrayCertificacion; k++) {
                                    $("input[name=pregunta2][value=" + arrayCertificacion[k] + "]").prop("checked", true);
                                }
                                $('select[name="Puesto"] option:selected ').html(function (a, cambiar) {
                                    return cambiar.replace('‚úò', '‚úî');
                                });
                                databaseHandler.db.transaction(
                                    function (tx) {
                                        tx.executeSql(
                                            "Select * from PL_Fotos WHERE F_ID_Cedula = ? and F_Recorrido = ? and F_Proceso = ?",
                                            [id_cedula, 2, value],
                                            function (tx, results) {
                                                let length = results.rows.length;
                                                if (length > 0) {
                                                    for (var i = 0; i < length; i++) {
                                                        var item = results.rows.item(i);
                                                        $("#tabla_FH tbody").append("<tr id='fila" + item.F_ID_Fotos + "'><td><a href='#' onclick='eliminarFila(" + item.F_ID_Fotos + ",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a><td><img src='" + item.F_Foto + "' width='60px'/></td><td style='text-align: center;'>" + item.F_titulo + "</td><td style='text-align: center;'>" + item.F_FechaHora + "</td></tr>");
                                                        $("#message-nr").hide();
                                                    }
                                                } else {
                                                    $("#message-nr").show();
                                                }
                                            }
                                        );
                                    }
                                );
    
                            }
                        } else {
                            $("#ObservacionFH").val("");
                            $("input[name=pregunta1]").prop("checked", false);
                            $("input[name=pregunta2]").prop("checked", false);
                            $("input[name=pregunta3]").prop("checked", false);
                            $("#tabla_FH tbody").empty("");
                            $("#imagenC").val("");
                            $("#smallImage").attr('src', 'img/blank.png');
                            $("#photoIcon").attr("src", "img/camera.svg");
                            $("#message-nr").show();
                            $('select[name="Puesto"] option:selected ').html(function (a, cambiar) {
                                return cambiar.replace('‚úî', '‚úò');
                            });
    
                        }
                    },
                );
            }
        );
    
    
    }
    function EquipoActual(id, value) {
        var id_cedula = localStorage.getItem("IdCedula");
        if (value == 9 || value == 11 || value == 12 || value == 13 || value == 15 || value == 16) {
            $(Boiler).hide();
            $(booster).hide();
            $(Lavaloza).hide();
            $('#SI1').show();
            $('#NO1').show();
            $('#Res1-11').show();
            $('#Res2-11').show();
            $('#SI2').show();
            $('#NO2').show();
            $('#Res1-12').show();
            $('#Res2-12').show();
            $('#SI3').show();
            $('#NO3').show();
            $('#Res1-13').show();
            $('#Res2-13').show();
            // $('pregunta1').css("display", "none");       
    
        } else {
            $(Boiler).show();
            $(booster).show();
            $(Lavaloza).show();
            $('#SI1').hide();
            $('#NO1').hide();
            $('#Res1-11').hide();
            $('#Res2-11').hide();
            $('#SI2').hide();
            $('#NO2').hide();
            $('#Res1-12').hide();
            $('#Res2-12').hide();
            $('#SI3').hide();
            $('#NO3').hide();
            $('#Res1-13').hide();
            $('#Res2-13').hide();
            //$('pregunta1').css("display", "block");
        }
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql(
                    "Select * from Tipo_Sistema WHERE TS_ID_Cedula = ? and TS_Equipo =?",
                    [id_cedula, value],
                    function (tx, results) {
                        let length = results.rows.length;
                        if (length > 0) {
                            for (var i = 0; i < length; i++) {
                                var item = results.rows.item(i);
                                if (item.TS_Boiler == 1 || item.TS_Boiler == 2) {
                                    $("input[name=pregunta1][value=" + item.TS_Boiler + "]").prop("checked", true);
                                } else {
                                    $("#Boiler").val(item.TS_Boiler);
                                }
                                if (item.TS_Booster == 1 || item.TS_Booster == 2) {
                                    $("input[name=pregunta2][value=" + item.TS_Booster + "]").prop("checked", true);
                                } else {
                                    $("#booster").val(item.TS_Booster);
                                }
                                if (item.TS_Maquina === 1 || item.TS_Maquina === 2) {
                                    $("input[name=pregunta3][value=" + item.TS_Maquina + "]").prop("checked", true);
                                } else {
                                    $("#Lavaloza").val(item.TS_Maquina)
                                }
                                $("#Observaciones").val(item.TS_Observacion)
                                $('select[name="Equipo"] option:selected ').html(function (a, cambiar) {
                                    return cambiar.replace('‚úò', '‚úî');
                                });
                                // $("#Etapa").css("background-color", "#66D654")
                                databaseHandler.db.transaction(
                                    function (tx) {
                                        tx.executeSql(
                                            "Select * from PL_Fotos WHERE F_ID_Cedula = ? and F_Recorrido = ? and F_Proceso = ?",
                                            [id_cedula, 3, value],
                                            function (tx, results) {
                                                let length = results.rows.length;
                                                if (length > 0) {
                                                    for (var i = 0; i < length; i++) {
                                                        var item = results.rows.item(i);
                                                        $("#tabla_TSS tbody").append("<tr id='fila" + item.F_ID_Fotos + "'><td><a href='#' onclick='eliminarFila(" + item.F_ID_Fotos + ",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a><td><img src='" + item.F_Foto + "' width='60px'/></td><td style='text-align: center;'>" + item.F_titulo + "</td><td style='text-align: center;'>" + item.F_FechaHora + "</td></tr>");
                                                        $("#message-nr").hide();
                                                    }
                                                } else {
                                                    $("#message-nr").show();
                                                }
    
                                            },
                                            function (tx, error) {
                                                console.log("Error al guardar registroPL: " + error.message);
                                                app.preloader.hide();
                                            }
                                        );
                                    },
                                    function (error) { },
                                    function () { }
                                );
                            }
                        } else {
                            $("input[name=pregunta1][value=1]").prop("checked", false);
                            $("input[name=pregunta1][value=2]").prop("checked", false);
                            $("#Boiler").val("");
                            $("input[name=pregunta2][value=1]").prop("checked", false);
                            $("input[name=pregunta2][value=2]").prop("checked", false);
                            $("#booster").val("");
                            $("input[name=pregunta3][value=1]").prop("checked", false);
                            $("input[name=pregunta3][value=2]").prop("checked", false);
                            $("#Lavaloza").val("");
                            $("#Observaciones").val("")
                            $("#imagenC").val("");
                            $("#smallImage").attr('src', 'img/blank.png');
                            $("#photoIcon").attr("src", "img/camera.svg");
                            $("#message-nr").show();
                            $("#tabla_TSS tbody").empty("");
                            $("#Boiler").css("background-color", "#FFFFFF");
                            $("#Lavaloza").css("background-color", "#FFFFFF");
                            $("#Observaciones").css("background-color", "#FFFFFF");
                            $("#booster").css("background-color", "#FFFFFF");
                            // $("#Etapa").css("background-color", "red");
                            $('select[name="Etapa"] option:selected ').html(function (a, cambiar) {
                                return cambiar.replace('‚úî', '‚úò');
                            });
    
                        }
                    },
                    function (tx, error) {
                        console.log("Error al guardar registroPL: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function (error) { console.log("Error al guardar registroPL: " + error.message); },
            function () { }
        );
    }
    function fromPL10(id, value) {
        if (value == 1 || value == 2) {
            $(suciedad).hide();
            $(detergente).hide();
            $('#SI1').show();
            $('#NO1').show();
            $('#Res1-11').show();
            $('#Res2-11').show();
            $('#SI2').show();
            $('#NO2').show();
            $('#Res1-12').show();
            $('#Res2-12').show();
        } else {
            $(suciedad).show();
            $(detergente).show();
            $('#SI1').hide();
            $('#NO1').hide();
            $('#Res1-11').hide();
            $('#Res2-11').hide();
            $('#SI2').hide();
            $('#NO2').hide();
            $('#Res1-12').hide();
            $('#Res2-12').hide();
            // $(pregunta).css("display", "none");
        }
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql(
                    "select * from Resultado WHERE ID_Cedula = ? and Tipo = ?",
                    [id_cedula, value],
                    function (tx, results) {
                        let length = results.rows.length;
                        if (length > 0) {
                            for (var i = 0; i < length; i++) {
                                var item = results.rows.item(i);
                                if (item.Suciedad == 1 || item.Suciedad == 2) {
                                    $("input[name=pregunta1][value=" + item.Suciedad + "]").prop("checked", true);
                                } else {
                                    $("#suciedad").val(item.Suciedad);
                                }
                                if (item.Detergente == 1 || item.Detergente == 2) {
                                    $("input[name=pregunta2][value=" + item.Detergente + "]").prop("checked", true);
                                } else {
                                    $("#detergente").val(item.Detergente);
                                }
    
                                $('select[name="Tipo"] option:selected ').html(function (a, cambiar) {
                                    return cambiar.replace('‚úò', '‚úî');
                                });
                            }
                        } else {
                            $("#suciedad").val("");
                            $("#detergente").val("");
                            $("#suciedad").css("background-color", "#FFFFFF");
                            $("#detergente").css("background-color", "#FFFFFF");
                            $("input[name=pregunta1][value=1]").prop("checked", false);
                            $("input[name=pregunta1][value=2]").prop("checked", false);
                            $("input[name=pregunta2][value=1]").prop("checked", false);
                            $("input[name=pregunta2][value=2]").prop("checked", false);
                            $('select[name="Tipo"] option:selected ').html(function (a, cambiar) {
                                return cambiar.replace('‚úî', '‚úò');
                            });
                        }
                    },
                    function (tx, error) {
                        console.log("Error al guardar registroPL: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function (error) { },
            function () { }
        );
    
    }
    var i = 0;
    function saveTempFoto(valor) {
        i++;
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
        if($('#imagenC').val()){
        if(valor == 1 || valor == 2){
            if ($('select[name="Etapa"] option:selected ').html().includes("‚úò")) {
                var text = $('select[name="Etapa"] option:selected ').html().split("‚úò")
            } else {
                var text = $('select[name="Etapa"] option:selected ').html().split("‚úî")
            }
            $("#tabla_ciclo_charola tbody").append("<tr id='fila" + i + "'><td><a href='#' onclick='eliminarFila(" + i + ",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></><td><img src='" + $('#imagenC').val() + "' width='60px'/></td><td style='text-align: center;'>" + text[1] + "</td><td style='text-align: center;'>" + fecha_registro + "</td></tr>");
            $("#message-nr").css("display", "none");
        }else if(valor == 3){
            if ($('select[name="Puesto"] option:selected ').html().includes("‚úò")) {
                var text = $('select[name="Puesto"] option:selected ').html().split("‚úò")
            } else {
                var text = $('select[name="Puesto"] option:selected ').html().split("‚úî")
            }
            $("#tabla_FH tbody").append("<tr id='fila" + i + "'><td><a href='#' onclick='eliminarFila(" + i + ",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></><td><img src='" + $('#imagenC').val() + "' width='60px'/></td><td style='text-align: center;'>" + text[1] + "</td><td style='text-align: center;'>" + fecha_registro + "</td></tr>");
            $("#message-nr").css("display", "none");
        }else if(valor == 6){
            if ($('select[name="Equipo"] option:selected ').html().includes("‚úò")) {
                var text = $('select[name="Equipo"] option:selected ').html().split("‚úò")
            } else {
                var text = $('select[name="Equipo"] option:selected ').html().split("‚úî")
            }
            $("#tabla_TSS tbody").append("<tr id='fila" + i + "'><td><a href='#' onclick='eliminarFila(" + i + ",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></><td><img src='" + $('#imagenC').val() + "' width='60px'/></td><td style='text-align: center;'>" + text[1] + "</td><td style='text-align: center;'>" + fecha_registro + "</td></tr>");
            $("#message-nr").css("display", "none");
        }else if(valor == 8){
            if ($('select[name="Tomas"] option:selected ').html().includes("‚úò")) {
                var text = $('select[name="Tomas"] option:selected ').html().split("‚úò")
            } else {
                var text = $('select[name="Tomas"] option:selected ').html().split("‚úî")
            }
            $("#tabla_Rango tbody").append("<tr id='fila" + i + "'><td><a href='#' onclick='eliminarFila(" + i + ",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></><td><img src='" + $('#imagenC').val() + "' width='60px'/></td><td style='text-align: center;'>" + text[1] + "</td><td style='text-align: center;'>" + fecha_registro + "</td></tr>");
            $("#message-nr").css("display", "none");
        }
    }
    }
    function guardarFHPL() {
        app.preloader.show('blue');
        let capacitacion = "";
        $("input:checkbox[name=pregunta1]:checked").each(function () {
            capacitacion += this.value + ',';
        });
        var certificacion = "";
        $("input:checkbox[name=pregunta2]:checked").each(function () {
            certificacion += this.value + ',';
        });
        var manuales = $('input:radio[name=pregunta3]:checked').val();
        var observacion = $("#ObservacionFH").val();
        if (observacion == "" || capacitacion == "" || certificacion == "" || manuales == undefined) {
            swal("", "Debes llenar todos los campos", "warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var puesto = $("#Puesto").val();
        $('select[name="Puesto"] option:selected ').html(function (a, cambiar) {
            return cambiar.replace('‚úò', '‚úî');
        });
        var jq = $('select[name="Puesto"] option:selected').text();
        var foto = $("#imagenC").val();
        var recorrido = 2;
        var titulo = "" + jq;
        var fecha = new Date();
        var fecha_foto = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
        if (foto) {
            productHandler.PLFotos(id_cedula, recorrido, puesto, titulo, fecha_foto, foto);
        }
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql("select count(*) as Cuenta from Factor_Humano WHERE FH_ID_Cedula = ? and FH_Puesto = ? ",
                    [id_cedula, puesto],
                    function (tx, results) {
                        var item = results.rows.item(0);
                        if (item.Cuenta == 0) {
                            tx.executeSql("insert into Factor_Humano(FH_ID_Cedula,FH_Puesto , FH_Capacitacion, FH_Certificacion, FH_Observacion , FH_Manuales) values(?,?,?,?,?,?)",
                                [id_cedula, puesto, capacitacion, certificacion, observacion, manuales],
                                function (tx, results) {
                                    var item = results.rows.item(0);
                                    $("#imagenC").val("");
                                    $("#smallImage").attr('src', 'img/blank.png');
                                    $("#photoIcon").attr("src", "img/camera.svg");
                                    swal("", "Se guardaron los datos correctamente", "success");
                                },
                                function (tx, error) {
                                    console.error("Error al registrar Factor_Humano: " + error.message);
                                }
                            );
    
                        } else {
                            tx.executeSql("UPDATE Factor_Humano SET FH_Capacitacion = ?, FH_Certificacion = ?, FH_Observacion = ? ,FH_Manuales = ? WHERE FH_ID_Cedula = ? and FH_Puesto = ?  ",
                                [capacitacion, certificacion, observacion, manuales, id_cedula, puesto],
                                function (tx, results) {
                                    var item = results.rows.item(0);
                                    $("#imagenC").val("");
                                    $("#smallImage").attr('src', 'img/blank.png');
                                    $("#photoIcon").attr("src", "img/camera.svg");
                                    swal("", "Se actualizaron los datos correctamente", "success");
                                },
                                function (tx, error) {
                                    console.error("Error al registrar Factor_Humano: " + error.message);
                                }
                            );
                        }
                        $("#RespMD").css("background-color", "#FFFFFF");
                        $("#EscalaR").css("background-color", "#FFFFFF");
                        $("#areaOportunidad").css("background-color", "#FFFFFF");
                        $("#Comentarios").css("background-color", "#FFFFFF");
                        $("#IdCedula").css("background-color", "#FFFFFF");
                        app.preloader.hide();
                    },
                    function (tx, error) {
                        swal("Error al guardar", error.message, "error");
                        app.preloader.hide();
                    }
                );
            },
            function (error) { },
            function () { }
        );
    }
    function guardarIEPL() {
        app.preloader.show('blue');
        var id_cedula = localStorage.getItem("IdCedula");
        var modelo = $("#Modelo").val();
        var NS = $("#NS").val();
        var Ubicacion = $("#Ubicacion").val();
        var Fecha = $("#Fecha").val();
        let Uso = "";
        $("input:checkbox[name=pregunta1]:checked").each(function () {
            Uso += this.value + ',';
        });
        var Consumo = $("#Consumo").val();
        var Agua = $("#Agua").val();
        var Suminstro = $("#Suministro").val();
        if (Uso == "" || modelo == "" || NS == "" || Ubicacion == "" || Fecha == "" || Consumo == "" || Agua == "" || Suminstro == "") {
            swal("", "Debes llenar todos los campos", "warning");
            app.preloader.hide();
            return false;
        }
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql("select count(*) as Cuenta from Info_Equipo WHERE IE_ID_Cedula = ?  ",
                    [id_cedula],
                    function (tx, results) {
                        var item = results.rows.item(0);
                        if (item.Cuenta == 0) {
                            tx.executeSql("insert into Info_Equipo(IE_ID_Cedula,IE_Modelo , IE_NS , IE_Ubicacion , IE_Fecha ,IE_Uso,IE_Consumo ,IE_Agua, IE_Suministro) values(?,?,?,?,?,?,?,?,?)",
                                [id_cedula, modelo, NS, Ubicacion, Fecha, Uso, Consumo, Agua, Suminstro],
                                function (tx, results) {
                                    var item = results.rows.item(0);
                                    swal("", "Se guardaron los datos correctamente", "success");
                                },
                                function (tx, error) {
                                    console.error("Error al registrar Info_Equipo: " + error.message);
                                }
                            );
    
                        } else {
                            tx.executeSql("UPDATE Info_Equipo SET IE_Modelo = ?, IE_NS = ?, IE_Ubicacion = ? ,IE_Fecha = ? ,IE_Uso = ? ,IE_Consumo =?, IE_Agua = ? , IE_Suministro = ? WHERE IE_ID_Cedula = ? ",
                                [modelo, NS, Ubicacion, Fecha, Uso, Consumo, Agua, Suminstro, id_cedula],
                                function (tx, results) {
                                    var item = results.rows.item(0);
                                    swal("", "Se actualizaron los datos correctamente", "success");
                                },
                                function (tx, error) {
                                    console.error("Error al registrar Factor_Humano: " + error.message);
                                }
                            );
                        }
                        $("#Modelo").css("background-color", "#FFFFFF");
                        $("#NS").css("background-color", "#FFFFFF");
                        $("#Ubicacion").css("background-color", "#FFFFFF");
                        $("#Fecha").css("background-color", "#FFFFFF");
                        $("#Consumo").css("background-color", "#FFFFFF");
                        $("#Agua").css("background-color", "#FFFFFF");
                        $("#Suministro").css("background-color", "#FFFFFF");
                        app.preloader.hide();
                    },
                    function (tx, error) {
                        swal("Error al guardar", error.message, "error");
                        app.preloader.hide();
                    }
                );
            },
            function (error) { },
            function () { }
        );
    }
    function guardarCEPL(Fase) {
        app.preloader.show('blue');
        var id_cedula = localStorage.getItem("IdCedula");
        if (Fase == 1) {
            var CA = $("#CantidadA").val();
            var Ho = $("#Horario").val();
            if (CA == "" || Ho == "") {
                swal("", "Debes llenar todos los campos", "warning");
                app.preloader.hide();
                return false;
            }
            var Turno = $("#Turno").val();
            $('select[name="Turno"] option:selected ').html(function (a, cambiar) {
                return cambiar.replace('‚úò', '‚úî');
            });
            databaseHandler.db.transaction(
                function (tx) {
                    tx.executeSql("select count(*) as Cuenta from Capa_Equipo_A WHERE CE_ID_Cedula = ? and CE_Turno =?",
                        [id_cedula, Turno],
                        function (tx, results) {
                            var item = results.rows.item(0);
                            if (item.Cuenta == 0) {
                                tx.executeSql("insert into Capa_Equipo_A(CE_ID_Cedula ,CE_Turno , CE_Horario, CE_Cantidad) values(?,?,?,?)",
                                    [id_cedula, Turno, Ho, CA],
                                    function (tx, results) {
                                        var item = results.rows.item(0);
                                        swal("", "Se guardaron los datos correctamente", "success");
                                    },
                                    function (tx, error) {
                                        console.error("Error al registrar Capa_Equipo_A: " + error.message);
                                    }
                                );
    
                            } else {
                                tx.executeSql("UPDATE Capa_Equipo_A SET  CE_Horario = ?, CE_Cantidad = ?  WHERE CE_ID_Cedula = ? and CE_Turno =?",
                                    [Ho, CA, id_cedula, Turno],
                                    function (tx, results) {
                                        var item = results.rows.item(0);
                                        swal("", "Se actualizaron los datos correctamente", "success");
                                    },
                                    function (tx, error) {
                                        console.error("Error al registrar Capa_Equipo_A: " + error.message);
                                    }
                                );
                            }
                            $("#Horario").css("background-color", "#FFFFFF");
                            $("#CantidadA").css("background-color", "#FFFFFF");
                            app.preloader.hide();
                        },
                        function (tx, error) {
                            swal("Error al guardar", error.message, "error");
                            app.preloader.hide();
                        }
                    );
                },
                function (error) { },
                function () { }
            );
    
        } else if (Fase == 2) {
            var CA = $("#CantidadB").val();
            var Tipo = $("#Tipo").val();
            var Material = $("#Material").val();
            var Notas = $("#Notas").val();
            var Loz = $("#Lava").val();
            if (CA == "" || Tipo == "" || Material == "" || Notas == "" || Loz == "") {
                swal("", "Debes llenar todos los campos", "warning");
                app.preloader.hide();
                return false;
            }
            var Utencilio = $("#Utencilio").val();
            $('select[name="Utencilio"] option:selected ').html(function (a, cambiar) {
                return cambiar.replace('‚úò', '‚úî');
            });
            databaseHandler.db.transaction(
                function (tx) {
                    tx.executeSql("select count(*) as Cuenta from Capa_Equipo_B WHERE CE_ID_Cedula = ? and CE_Utencilio =?",
                        [id_cedula, Turno],
                        function (tx, results) {
                            var item = results.rows.item(0);
                            if (item.Cuenta == 0) {
                                tx.executeSql("insert into Capa_Equipo_B(CE_ID_Cedula, CE_Utencilio , CE_Cantidad, CE_Tipo, CE_Material ) values(?,?,?,?,?)",
                                    [id_cedula, Utencilio, CA, Tipo, Material],
                                    function (tx, results) {
                                        var item = results.rows.item(0);
                                        swal("", "Se guardaron los datos correctamente", "success");
                                    },
                                    function (tx, error) {
                                        console.error("Error al registrar Capa_Equipo_B: " + error.message);
                                    }
                                );
    
                            } else {
                                tx.executeSql("UPDATE Capa_Equipo_A SET  CE_Cantidad = ?, CE_Tipo = ? , CE_Material = ? WHERE CE_ID_Cedula = ? and CE_Utencilio =?",
                                    [CA, Tipo, Material, id_cedula, Utencilio],
                                    function (tx, results) {
                                        var item = results.rows.item(0);
                                        swal("", "Se actualizaron los datos correctamente", "success");
                                    },
                                    function (tx, error) {
                                        console.error("Error al registrar Capa_Equipo_A: " + error.message);
                                    }
                                );
                            }
                            tx.executeSql("UPDATE DG_PlatoL SET  DG_CE_Notas = ?, DG_CE_Lavaloza = ? where DG_ID_Cedula = ?",
                                [Notas, Loz, id_cedula],
                                function (tx, results) {
                                    var item = results.rows.item(0);
                                    // swal("", "Se actualizaron los datos correctamente", "success");
                                },
                                function (tx, error) {
                                    console.error("Error al registrar DG_PlatoL: " + error.message);
                                }
                            );
                            $("#CantidadB").css("background-color", "#FFFFFF");
                            $("#Material").css("background-color", "#FFFFFF");
                            $("#Tipo").css("background-color", "#FFFFFF");
                            app.preloader.hide();
                        },
                        function (tx, error) {
                            swal("Error al guardar", error.message, "error");
                            app.preloader.hide();
                        }
                    );
                },
                function (error) { },
                function () { }
            );
    
        }
    }
    function CETurno(id, value) {
        var Turno = value;
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql(
                    "Select * from  Capa_Equipo_A WHERE CE_ID_Cedula = ? and CE_Turno =?",
                    [id_cedula, Turno],
                    function (tx, results) {
                        let length = results.rows.length;
                        if (length > 0) {
                            for (var i = 0; i < length; i++) {
                                var item = results.rows.item(i);
                                $("#CantidadA").val(item.CE_Cantidad);
                                $("#Horario").val(item.CE_Horario);
                                $('select[name="Turno"] option:selected ').html(function (a, cambiar) {
                                    return cambiar.replace('‚úò', '‚úî');
                                });
                            }
                        } else {
                            $("#CantidadA").val("");
                            $("#Horario").val("");
                            $('select[name="Turno"] option:selected ').html(function (a, cambiar) {
                                return cambiar.replace('‚úî', '‚úò');
                            });
                        }
                    },
                    function (tx, error) {
                        console.log("Error al guardar registroPL: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function (error) { },
            function () { }
        );
    
    }
    function CEUtencilio(id, value) {
        var Uten = value;
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql(
                    "Select * from  Capa_Equipo_B WHERE CE_ID_Cedula = ? and CE_Utencilio =?",
                    [id_cedula, Uten],
                    function (tx, results) {
                        let length = results.rows.length;
                        if (length > 0) {
                            for (var i = 0; i < length; i++) {
                                var item = results.rows.item(i);
                                $("#CantidadB").val(item.CE_Cantidad);
                                $("#Tipo").val(item.CE_Tipo);
                                $("#Material").val(item.CE_Material);
                                $('select[name="Utencilio"] option:selected ').html(function (a, cambiar) {
                                    return cambiar.replace('‚úò', '‚úî');
                                });
                            }
                        } else {
                            $("#CantidadB").val("");
                            $("#Tipo").val("");
                            $("#Material").val("");
                            $('select[name="Utencilio"] option:selected ').html(function (a, cambiar) {
                                return cambiar.replace('‚úî', '‚úò');
                            });
                        }
                    },
                    function (tx, error) {
                        console.log("Error al guardar registroPL: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function (error) { },
            function () { }
        );
    }
    function guardarTSSPL() {
        app.preloader.show('blue');
        var Boiler = $("#Boiler").val();
        var Boiler2 = $("input:radio[name=pregunta1]:checked").val();
        var Boiler3;
        if (Boiler) {
            Boiler3 = Boiler;
        } else {
            Boiler3 = Boiler2;
        }
        var booster = $("#booster").val();
        var booster2 = $("input:radio[name=pregunta2]:checked").val();
        var booster3;
        if (booster) {
            booster3 = booster;
        } else {
            booster3 = booster2;
        }
        var Lavaloza = $("#Lavaloza").val();
        var Lavaloza2 = $("input:radio[name=pregunta3]:checked").val();
        var Lavaloza3;
        if (Lavaloza) {
            Lavaloza3 = Lavaloza;
        } else {
            Lavaloza3 = Lavaloza2;
        }
        var observacion = $("#Observaciones").val();
        if (observacion == "" || Lavaloza3 == "" || booster3 == "" || Boiler3 == "") {
            swal("", "Debes llenar todos los campos", "warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var Equipo = $("#Equipo").val();
        $('select[name="Equipo"] option:selected ').html(function (a, cambiar) {
            return cambiar.replace('‚úò', '‚úî');
        });
        var jq = $('select[name="Equipo"] option:selected').text();
        var foto = $("#imagenC").val();
        var recorrido = 3;
        var titulo = "" + jq;
        var fecha = new Date();
        var fecha_foto = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
        if (foto) {
            productHandler.PLFotos(id_cedula, recorrido, Equipo, titulo, fecha_foto, foto);
        }
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql("select count(*) as Cuenta from Tipo_Sistema WHERE TS_ID_Cedula = ? and TS_Equipo =?",
                    [id_cedula, Equipo],
                    function (tx, results) {
                        var item = results.rows.item(0);
                        if (item.Cuenta == 0) {
                            tx.executeSql("insert into Tipo_Sistema(TS_ID_Cedula,TS_Equipo ,TS_Boiler  , TS_Booster , TS_Maquina , TS_Observacion ) values(?,?,?,?,?,?)",
                                [id_cedula, Equipo, Boiler3, booster3, Lavaloza3, observacion],
                                function (tx, results) {
                                    var item = results.rows.item(0);
                                    $("#imagenC").val("");
                                    $("#smallImage").attr('src', 'img/blank.png');
                                    $("#photoIcon").attr("src", "img/camera.svg");
                                    swal("", "Se guardaron los datos correctamente", "success");
                                },
                                function (tx, error) {
                                    console.error("Error al registrar Ciclo_Charola: " + error.message);
                                }
                            );
    
                        } else {
                            tx.executeSql("UPDATE Tipo_Sistema SET TS_Equipo = ?, TS_Boiler = ?, TS_Booster = ? ,TS_Maquina = ? , TS_Observacion = ? WHERE TS_ID_Cedula = ? and TS_Equipo =?  ",
                                [Boiler3, booster3, Lavaloza3, observacion, id_cedula, Equipo],
                                function (tx, results) {
                                    var item = results.rows.item(0);
                                    $("#imagenC").val("");
                                    $("#smallImage").attr('src', 'img/blank.png');
                                    $("#photoIcon").attr("src", "img/camera.svg");
                                    swal("", "Se actualizaron los datos correctamente", "success");
                                },
                                function (tx, error) {
                                    console.error("Error al registrar Ciclo_Charola: " + error.message);
                                }
                            );
                        }
                        $("#RespMD").css("background-color", "#FFFFFF");
                        $("#EscalaR").css("background-color", "#FFFFFF");
                        $("#areaOportunidad").css("background-color", "#FFFFFF");
                        $("#Comentarios").css("background-color", "#FFFFFF");
                        $("#IdCedula").css("background-color", "#FFFFFF");
                        app.preloader.hide();
                    },
                    function (tx, error) {
                        swal("Error al guardar", error.message, "error");
                        app.preloader.hide();
                    }
                );
            },
            function (error) { },
            function () { }
        );
    }
    function guardarPCAPL() {
        var Tipo = $('#Tipo').val();
        var Dureza = $('#Dureza').val();
        var Partes = $('#Partes').val();
        var Pregunta1 = $('input:radio[name=pregunta1]:checked').val();
        var id_cedula = localStorage.getItem("IdCedula");
        app.preloader.show('blue');
        if (Dureza == "" || Tipo == "" || Partes == "" || Pregunta1 == "") {
            swal("", "Debes llenar todos los campos", "warning");
            app.preloader.hide();
            return false;
        }
        $('select[name="Tipo"] option:selected ').html(function (a, cambiar) {
            return cambiar.replace('‚úò', '‚úî');
        });
    
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql("select count(*) as Cuenta from Prueba_Calidad_Agua WHERE PCA_ID_Cedula = ? and  PCA_Tipo =? ",
                    [id_cedula, Tipo],
                    function (tx, results) {
                        var item = results.rows.item(0);
                        if (item.Cuenta == 0) {
                            tx.executeSql("insert into Prueba_Calidad_Agua(PCA_ID_Cedula,PCA_Tipo,PCA_Dureza , PCA_Partes ,PCA_Sitema ) values(?,?,?,?,?)",
                                [id_cedula, Tipo, Dureza, Partes, Pregunta1],
                                function (tx, results) {
                                    var item = results.rows.item(0);
                                    swal("", "Se guardaron los datos correctamente", "success");
                                },
                                function (tx, error) {
                                    console.error("Error al registrar Info_Equipo: " + error.message);
                                }
                            );
    
                        } else {
                            tx.executeSql("UPDATE Prueba_Calidad_Agua  SET  PCA_Dureza = ? ,PCA_Partes = ? ,PCA_Sitema = ? WHERE PCA_ID_Cedula = ? and  PCA_Tipo =?",
                                [Dureza, Partes, Pregunta1, id_cedula, Tipo],
                                function (tx, results) {
                                    var item = results.rows.item(0);
                                    swal("", "Se actualizaron los datos correctamente", "success");
                                },
                                function (tx, error) {
                                    console.error("Error al registrar Prueba_Calidad_Agua: " + error.message);
                                }
                            );
                        }
    
                        $("#Tipo").css("background-color", "#FFFFFF");
                        $("#Dureza").css("background-color", "#FFFFFF");
                        $("#Partes").css("background-color", "#FFFFFF");
                        app.preloader.hide();
                    },
                    function (tx, error) {
                        swal("Error al guardar", error.message, "error");
                        app.preloader.hide();
                    }
                );
            },
            function (error) { },
            function () { }
        );
    
    }
    function checkTipo(val) {
        var id_cedula = localStorage.getItem("IdCedula");
        var tipo = $("#Tipo").val();
        var Dureza = $("#Dureza").val();
        var Partes = $("#Partes").val();
        var Pregunta1 = $("input:radio[name=pregunta1]:checked").val();
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql(
                    "select *from Prueba_Calidad_Agua WHERE PCA_ID_Cedula = ? and  PCA_Tipo =? ",
                    [id_cedula, val],
                    function (tx, results) {
                        let length = results.rows.length;
                        if (length > 0) {
                            for (var i = 0; i < length; i++) {
                                var item = results.rows.item(i);
    
                                $("#Dureza").val(item.PCA_Dureza);
                                $("#Partes").val(item.PCA_Partes);
                                $("input[name=pregunta1][value=" + item.PCA_Sitema + "]").prop("checked", true);
                                $('select[name="T ipo"] option:selected ').html(function (a, cambiar) {
                                    return cambiar.replace('‚úò', '‚úî');
                                });
                            }
                        } else {
                            $("#Dureza").val("");
                            $("#Partes").val("");
                            $("input[name=pregunta1][value=1]").prop("checked", false);
                            $("input[name=pregunta1][value=2]").prop("checked", false);
                            $('select[name="Tipo"] option:selected ').html(function (a, cambiar) {
                                return cambiar.replace('‚úî', '‚úò');
                            });
                        }
                    },
                    function (tx, error) {
                        console.log("Error al guardar registroPL: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function (error) { },
            function () { }
        );
    }
    function guardarInsumo(fase) {
        app.preloader.show('blue');
        var id_cedula = localStorage.getItem("IdCedula");
        if (fase == 1) {
            var Equipo = $("#Equipo").val();
            var Marca = $("#Marca1").val();
            var Modelo = $("#Modelo1").val();
            var Dosificacion = $("#Dosificacion").val();
            if (Equipo == "" || Marca == "" || Modelo == "") {
                swal("", "Debes llenar todos los campos", "warning");
                app.preloader.hide();
                return false;
            }
            $('select[name="Equipo"] option:selected ').html(function (a, cambiar) {
                return cambiar.replace('‚úò', '‚úî');
            });
            databaseHandler.db.transaction(
                function (tx) {
                    tx.executeSql("select count(*) as Cuenta from Insumos_A WHERE ID_Cedula = ? and Equipo = ?  ",
                        [id_cedula, Equipo],
                        function (tx, results) {
                            var item = results.rows.item(0);
                            if (item.Cuenta == 0) {
                                tx.executeSql("insert into Insumos_A(ID_Cedula,Equipo, Marca, Modelo, Dosificador ) values(?,?,?,?,?)",
                                    [id_cedula, Equipo, Marca, Modelo, Dosificacion],
                                    function (tx, results) {
                                        var item = results.rows.item(0);
                                        swal("", "Se guardaron los datos correctamente", "success");
                                    },
                                    function (tx, error) {
                                        console.error("Error al registrar Insumos_A: " + error.message);
                                    }
                                );
                            } else {
                                tx.executeSql("UPDATE Insumos_A  SET Equipo = ?, Marca = ? ,Modelo = ?  Dosificador = ? WHERE ID_Cedula = ? and Equipo = ? ",
                                    [Equipo, Marca, Modelo, Dosificacion, id_cedula, Equipo],
                                    function (tx, results) {
                                        var item = results.rows.item(0);
                                        swal("", "Se actualizaron los datos correctamente", "success");
                                    },
                                    function (tx, error) {
                                        console.error("Error al registrar Insumos_A: " + error.message);
                                    }
                                );
                            }
                            $("#Dosificacion").css("background-color", "#FFFFFF");
                            $("#Modelo1").css("background-color", "#FFFFFF");
                            $("#Marca1").css("background-color", "#FFFFFF");
                            // $('select[name="Equipo"] option:selected ').html(function (a, cambiar) {
                            //     return cambiar.replace('‚úî' , '‚úò');
                            // });
                            app.preloader.hide();
                        },
                        function (tx, error) {
                            swal("Error al guardar", error.message, "error");
                            app.preloader.hide();
                        }
                    );
                },
                function (error) { },
                function () { }
            );
        } else if (fase == 2) {
            var Pregunta1 = $('input:radio[name=pregunta1]:checked').val();
            var Marca = $("#Marca").val();
            var Modelo = $("#Modelo").val();
            if (Pregunta1 == 1) {
                if (Marca == "" || Modelo == "") {
                    swal("", "Debes llenar todos los campos", "warning");
                    app.preloader.hide();
                    return false;
                }
            }
            databaseHandler.db.transaction(
                function (tx) {
                    tx.executeSql("select count(*) as Cuenta from Insumos_B WHERE ID_Cedula = ?  ",
                        [id_cedula],
                        function (tx, results) {
                            var item = results.rows.item(0);
                            if (item.Cuenta == 0) {
                                tx.executeSql("insert into Insumos_B(ID_Cedula, Dosificador, Marca, Modelo ) values(?,?,?,?)",
                                    [id_cedula, Pregunta1, Marca, Modelo],
                                    function (tx, results) {
                                        var item = results.rows.item(0);
                                        swal("", "Se guardaron los datos correctamente", "success");
                                    },
                                    function (tx, error) {
                                        console.error("Error al registrar Insumos_B: " + error.message);
                                    }
                                );
    
                            } else {
                                tx.executeSql("UPDATE Insumos_B  SET Dosificador = ?, Marca = ? ,Modelo = ?  WHERE ID_Cedula = ? ",
                                    [Pregunta1, Marca, Modelo, id_cedula],
                                    function (tx, results) {
                                        var item = results.rows.item(0);
                                        swal("", "Se actualizaron los datos correctamente", "success");
                                    },
                                    function (tx, error) {
                                        console.error("Error al registrar Insumos_A: " + error.message);
                                    }
                                );
                            }
    
                            $("#Modelo").css("background-color", "#FFFFFF");
                            $("#Marca").css("background-color", "#FFFFFF");
    
                            app.preloader.hide();
                        },
                        function (tx, error) {
                            swal("Error al guardar", error.message, "error");
                            app.preloader.hide();
                        }
                    );
                },
                function (error) { },
                function () { }
            );
        } else if (fase == 3) {
            var Horas = $("#Horas").val();
            var Cantidad = $("#Horario").val();                  
            if (Cantidad == "") {
                swal("", "Debes llenar todos los campos", "warning");
                app.preloader.hide();
                return false;
            }
            $('select[name="Horas"] option:selected ').html(function (a, cambiar) {
                return cambiar.replace('‚úò', '‚úî');
            });
            databaseHandler.db.transaction(
                function (tx) {
                    tx.executeSql("select count(*) as Cuenta from Insumos_C WHERE ID_Cedula = ? and Horas = ?",
                        [id_cedula, Horas],
                        function (tx, results) {
                            var item = results.rows.item(0);
                            if (item.Cuenta == 0) {
                                tx.executeSql("insert into Insumos_C(ID_Cedula,Horas, Cantidad ) values(?,?,?)",
                                    [id_cedula, Horas, Cantidad],
                                    function (tx, results) {
                                        var item = results.rows.item(0);
                                        swal("", "Se guardaron los datos correctamente", "success");
                                    },
                                    function (tx, error) {
                                        console.error("Error al registrar Insumos_C: " + error.message);
                                    }
                                );
                            } else {
                                tx.executeSql("UPDATE Insumos_C  SET Horas = ?, Cantidad = ? WHERE ID_Cedula = ? and Horas = ? ",
                                    [Horas, Cantidad, id_cedula, Horas],
                                    function (tx, results) {
                                        var item = results.rows.item(0);
                                        swal("", "Se actualizaron los datos correctamente", "success");
                                    },
                                    function (tx, error) {
                                        console.error("Error al registrar Insumos_C: " + error.message);
                                    }
                                );
                            }
                            $("#Horario").css("background-color", "#FFFFFF");
                            // $('select[name="Horas"] option:selected ').html(function (a, cambiar) {
                            //     return cambiar.replace('‚úî' , '‚úò');
                            // });
                            app.preloader.hide();
                        },
                        function (tx, error) {
                            swal("Error al guardar", error.message, "error");
                            app.preloader.hide();
                        }
                    );
                },
                function (error) { },
                function () { }
            );
        }
    }
    function DosificadorRES(RS) {
        if (RS == 1) {
            $('#Marca').show();
            $('#Modelo').show();
            $('#MarcaL').show();
            $('#ModeloL').show();
            $('#Boton').show();
        } else {
            $('#Boton').show();
            $('#Marca').hide();
            $('#Modelo').hide();
            $('#MarcaL').hide();
            $('#ModeloL').hide();
        }
    }
    function check(fase, value) {
        var id_cedula = localStorage.getItem("IdCedula");
        if (fase == 1) {
            databaseHandler.db.transaction(
                function (tx) {
                    tx.executeSql(
                        "Select * from  Insumos_A WHERE ID_Cedula = ? and  Equipo = ?",
                        [id_cedula, value],
                        function (tx, results) {
                            let length = results.rows.length;
                            if (length > 0) {
                                for (var i = 0; i < length; i++) {
                                    var item = results.rows.item(i);
                                    $("#Marca1").val(item.Marca);
                                    $("#Modelo1").val(item.Modelo);
                                    $("#Dosificacion").val(item.Dosificador);
                                    $('select[name="Equipo"] option:selected ').html(function (a, cambiar) {
                                        return cambiar.replace('‚úò', '‚úî');
                                    });
                                }
                            } else {
                                $("#Marca1").val("");
                                $("#Modelo1").val("");
                                $("#Dosificacion").val("");
                                $('select[name="Equipo"] option:selected ').html(function (a, cambiar) {
                                    return cambiar.replace('‚úî', '‚úò');
                                });
                            }
                        },
                        function (tx, error) {
                            console.log("Error al guardar registroPL: " + error.message);
                            app.preloader.hide();
                        }
                    );
                },
                function (error) { },
                function () { }
            );
        } else if (fase == 2) {
            databaseHandler.db.transaction(
                function (tx) {
                    tx.executeSql(
                        "Select * from  Insumos_C WHERE ID_Cedula = ? and Horas =?",
                        [id_cedula, value],
                        function (tx, results) {
                            let length = results.rows.length;
                            if (length > 0) {
                                for (var i = 0; i < length; i++) {
                                    var item = results.rows.item(i);
                                    $("#Horas").val(item.Horas);
                                    $("#Horario").val(item.Cantidad);
                                    $('select[name="Horas"] option:selected ').html(function (a, cambiar) {
                                        return cambiar.replace('‚úò', '‚úî');
                                    });
                                }
                            } else {
                                $("#Horario").val("");
                                $('select[name="Horas"] option:selected ').html(function (a, cambiar) {
                                    return cambiar.replace('‚úî', '‚úò');
                                });
                            }
                        },
                        function (tx, error) {
                            console.log("Error al guardar registroPL: " + error.message);
                            app.preloader.hide();
                        }
                    );
                },
                function (error) { },
                function () { }
            );
        }
    
    }
    function guardarRangosPL() {
        var id_cedula = localStorage.getItem("IdCedula");
        app.preloader.show('blue');
        var Tomas = $("#Tomas").val();
        var Equipo = $("#Equipo").val();
        var TempE = $("#TemperaturaE").val();
        var PreE = $("#PresionE").val();
        var TempS = $("#TemperaturaS").val();
        var PreS = $("#PresionS").val();;
        var Pregunta3 = $("input:radio[name=pregunta1]:checked").val();
        var Hora = $("#Hora").val();;
        if (TempE == "" || TempS == "" || PreE == "" || PreS == "" || Hora == "" || Pregunta3 == "") {
            swal("", "Debes llenar todos los campos", "warning");
            app.preloader.hide();
            return false;
        }
        $('select[name="Tomas"] option:selected ').html(function (a, cambiar) {
            return cambiar.replace('‚úò', '‚úî');
        });
        $('select[name="Equipo"] option:selected ').html(function (a, cambiar) {
            return cambiar.replace('‚úò', '‚úî');
        });
        var jq = $('select[name="Equipo"] option:selected').text();
        var foto = $("#imagenC").val();
        var recorrido = 3;
        var proceso = "" + Tomas + "" + Equipo;
        var titulo = "" + jq;
        var fecha = new Date();
        var fecha_foto = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
        if (foto) {
            productHandler.PLFotos(id_cedula, recorrido, proceso, titulo, fecha_foto, foto);
        }
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql("select count(*) as Cuenta from Stress WHERE ID_Cedula = ? and Tomas = ? and Equipo = ?",
                    [id_cedula, Tomas, Equipo],
                    function (tx, results) {
                        var item = results.rows.item(0);
                        if (item.Cuenta == 0) {
                            tx.executeSql("insert into Stress(ID_Cedula ,Tomas , Equipo , Hora , TempeE , PreE , TempeS , PreS, Bitacora ) values(?,?,?,?,?,?,?,?,?)",
                                [id_cedula, Tomas, Equipo, Hora, TempE, PreE, TempE, PreS, Pregunta3],
                                function (tx, results) {
                                    var item = results.rows.item(0);
                                    swal("", "Se guardaron los datos correctamente", "success");
                                },
                                function (tx, error) {
                                    console.error("Error al registrar Insumos_C: " + error.message);
                                }
                            );
    
                        } else {
                            tx.executeSql("UPDATE Stress  SET Hora = ?, TempeE = ? , PreE = ?, TempeS = ? , PreS = ?, Bitacora  = ? WHERE ID_Cedula = ? and Tomas = ? and Equipo = ?",
                                [Hora, TempE, PreE, TempE, PreS, Pregunta3, id_cedula, Tomas, Equipo],
                                function (tx, results) {
                                    var item = results.rows.item(0);
                                    swal("", "Se actualizaron los datos correctamente", "success");
                                },
                                function (tx, error) {
                                    console.error("Error al registrar Insumos_C: " + error.message);
                                }
                            );
                        }
    
                        $("#Horario").css("background-color", "#FFFFFF");
                        // $('select[name="Horas"] option:selected ').html(function (a, cambiar) {
                        //     return cambiar.replace('‚úî' , '‚úò');
                        // });
                        app.preloader.hide();
                    },
                    function (tx, error) {
                        swal("Error al guardar", error.message, "error");
                        app.preloader.hide();
                    }
                );
            },
            function (error) { },
            function () { }
        );
    }
    function checkRangos(value) {
        $("#tabla_Rango tbody").empty("");
        var id_cedula = localStorage.getItem("IdCedula");
        var Tomas = $("#Tomas").val();
        var Equipo = $("#Equipo").val();
        var proceso = "" + Tomas + "" + Equipo;
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql(
                    "select * from Stress WHERE ID_Cedula = ? and Tomas = ? and Equipo = ?",
                    [id_cedula, Tomas, Equipo],
                    function (tx, results) {
                        let length = results.rows.length;
                        if (length > 0) {
                            for (var i = 0; i < length; i++) {
                                var item = results.rows.item(i);
                                $("#TemperaturaE").val(item.TempeE);
                                $("#PresionE").val(item.PreE);
                                $("#TemperaturaS").val(item.TempeS);
                                $("#PresionS").val(item.PreS);
                                $("#Hora").val(item.Hora);
                                $('select[name="Equipo"] option:selected ').html(function (a, cambiar) {
                                    return cambiar.replace('‚úò', '‚úî');
                                });
                                $('select[name="Tomas"] option:selected ').html(function (a, cambiar) {
                                    return cambiar.replace('‚úò', '‚úî');
                                });
                                $("input[name=pregunta1][value=" + item.Bitacora + "]").prop("checked", true);
    
                                databaseHandler.db.transaction(
                                    function (tx) {
                                        tx.executeSql(
                                            "Select * from PL_Fotos WHERE F_ID_Cedula = ? and F_Recorrido = ? and F_Proceso = ?",
                                            [id_cedula, 3, proceso],
                                            function (tx, results) {
                                                let length = results.rows.length;
                                                if (length > 0) {
                                                    for (var i = 0; i < length; i++) {
                                                        var item = results.rows.item(i);
                                                        $("#tabla_Rango tbody").append("<tr id='fila" + item.F_ID_Fotos + "'><td><a href='#' onclick='eliminarFila(" + item.F_ID_Fotos + ",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a><td><img src='" + item.F_Foto + "' width='60px'/></td><td style='text-align: center;'>" + item.F_titulo + "</td><td style='text-align: center;'>" + item.F_FechaHora + "</td></tr>");
                                                        $("#message-nr").hide();
                                                    }
                                                } else {
                                                    $("#message-nr").show();
                                                }
    
                                            },
                                            function (tx, error) {
                                                console.log("Error al guardar registroPL: " + error.message);
                                                app.preloader.hide();
                                            }
                                        );
                                    },
                                    function (error) { },
                                    function () { }
                                );
                            }
                        } else {
                            $("#TemperaturaE").val("");
                            $("#PresionE").val("");
                            $("#TemperaturaS").val("");
                            $("#PresionS").val("");
                            $("#Hora").val("");
                            $("#smallImage").attr('src', 'img/blank.png');
                            $("#photoIcon").attr("src", "img/camera.svg");
                            $("#message-nr").show();
                            $("#tabla_Rango tbody").empty("");
                            $("input[name=pregunta1][value=1]").prop("checked", false);
                            $("input[name=pregunta1][value=2]").prop("checked", false);
                            $('select[name="Equipo"] option:selected ').html(function (a, cambiar) {
                                return cambiar.replace('‚úî', '‚úò');
                            });
                            $('select[name="Tomas"] option:selected ').html(function (a, cambiar) {
                                return cambiar.replace('‚úî', '‚úò');
                            });
                        }
                    },
                    function (tx, error) {
                        console.log("Error al guardar registroPL: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function (error) { },
            function () { }
        );
    }
    function guardarResLaPL() {
        var id_cedula = localStorage.getItem("IdCedula");
        app.preloader.show('blue');
        var Tipo = $("#Tipo").val();
        var Pregunta1 = $('input:radio[name=pregunta1]:checked').val();
        var Pregunta2 = $('input:radio[name=pregunta2]:checked').val();
        var Detergente = $("#detergente").val();
        var Suciedad = $("#suciedad").val();
        var DET, SUC;
        if (Pregunta2 == 1 || Pregunta2 == 2) {
            DET = Pregunta2;
        } else {
            DET = Detergente;
        }
        if (Pregunta1 == 1 || Pregunta1 == 2) {
            SUC = Pregunta1;
        } else {
            SUC = Suciedad;
        }
        if (SUC == "" || DET == "") {
            swal("", "Debes llenar todos los campos", "warning");
            app.preloader.hide();
            return false;
        }
        $('select[name="Tipo"] option:selected ').html(function (a, cambiar) {
            return cambiar.replace('‚úò', '‚úî');
        });
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql("select count(*) as Cuenta from Resultado WHERE ID_Cedula = ? and Tipo = ?",
                    [id_cedula, Tipo],
                    function (tx, results) {
                        var item = results.rows.item(0);
                        if (item.Cuenta == 0) {
                            tx.executeSql("insert into Resultado(ID_Cedula ,Tipo,Suciedad , Detergente  ) values(?,?,?,?)",
                                [id_cedula, Tipo, SUC, DET],
                                function (tx, results) {
                                    var item = results.rows.item(0);
                                    swal("", "Se guardaron los datos correctamente", "success");
                                },
                                function (tx, error) {
                                    console.error("Error al registrar Resultado: " + error.message);
                                }
                            );
    
                        } else {
                            tx.executeSql("UPDATE Resultado  SET  Suciedad = ?, Detergente  = ? WHERE ID_Cedula = ? and Tipo = ? ",
                                [Pregunta1, Pregunta2, id_cedula, Tipo],
                                function (tx, results) {
                                    var item = results.rows.item(0);
                                    swal("", "Se actualizaron los datos correctamente", "success");
                                },
                                function (tx, error) {
                                    console.error("Error al registrar Resultado: " + error.message);
                                }
                            );
                        }
    
                        $("#Horario").css("background-color", "#FFFFFF");
                        // $('select[name="Horas"] option:selected ').html(function (a, cambiar) {
                        //     return cambiar.replace('‚úî' , '‚úò');
                        // });
                        app.preloader.hide();
                    },
                    function (tx, error) {
                        swal("Error al guardar", error.message, "error");
                        app.preloader.hide();
                    }
                );
            },
            function (error) { },
            function () { }
        );
    }
    function guardarCierrePL() {
        if ($("#comentario_cliente").val() == "" || $("#signate").val() == "") {
            swal("", "Todos los campos son obligatorios", "warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var Comentario = $("#comentario_cliente").val();
        var calificacion = $("#eval").val();
        var fecha = new Date();
        var fecha_firma =
            fecha.getFullYear() +
            "-" +
            (fecha.getMonth() + 1) +
            "-" +
            fecha.getDate() +
            " " +
            fecha.getHours() +
            ":" +
            fecha.getMinutes() +
            ":" +
            fecha.getSeconds();
        var recorrido = 0;
        var proceso = 0;
        var titulo2 = "firma_cliente"
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql(
                    "UPDATE DG_PlatoL SET Nombre_R = ?,Comentarios_Cierre = ? WHERE DG_ID_Cedula = ?",
                    [nombrefirma, Comentario, id_cedula],
                    function (tx, results) {
                        productHandler.PLFotos(id_cedula, recorrido, proceso, titulo2,  fecha_firma, firmaCliente);
                        databaseHandler.db.transaction(
                            function (tx) {
                                tx.executeSql(
                                    "UPDATE cedulas_general SET nombre_evalua = ?, horario_programado = ?, calificacion = ? WHERE id_cedula = ?",
                                    [nombrefirma, fecha_firma, calificacion, id_cedula],
                                    function (tx, results) {
                                        swal("", "Guardado correctamente", "success");
                                        app.views.main.router.back("/yamevoyPL/", {
                                            force: true,
                                            ignoreCache: true,
                                            reload: true,
                                        });
                                    },
                                    function (tx, error) {
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function (error) { },
                            function () { }
                        );
                    },
                    function (tx, error) {
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function (error) { },
            function () { }
        );
    }
    function terminarPL() {
        var FirmaTec = $("#signate").val();
        var fotoSalida = $("#ImaCe").val();
        console.log("fotoSalida", fotoSalida);
        var id_cedula = localStorage.getItem("IdCedula");
        var fecha = new Date();
        var fecha_salida =
            fecha.getFullYear() +
            "-" +
            (fecha.getMonth() + 1) +
            "-" +
            fecha.getDate() +
            " " +
            fecha.getHours() +
            ":" +
            fecha.getMinutes() +
            ":" +
            fecha.getSeconds();
        var ubicacion_salida = $("#geolocation").val();
        var estatus = 1;
        var titulo = "Firma Tecnico"
        var titulo2 = "Foto Salida"
        var recorrido = 0;
        var proceso = 0;
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql(
                    "UPDATE cedulas_general SET fecha_salida = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                    [fecha_salida, ubicacion_salida, estatus, id_cedula],
                    function (tx, results) {
                        productHandler.PLFotos(id_cedula, recorrido, proceso, titulo, fecha_salida,  FirmaTec);
                        productHandler.PLFotos(id_cedula, recorrido, proceso, titulo2, fecha_salida,  fotoSalida);
                        window.location.href = "./menu.html";
                    },
                    function (tx, error) {
                        swal("Error al guardar", error.message, "error");
                    }
                );
            },
            function (error) {
                console.log("Error al guardar", error.message, "error");
            },
            function () { }
        )
    }
    function TerminarRecorridoPL(Recorrido) {
        let id_cedula = localStorage.getItem("IdCedula");
        var CC = 0;
        var FH = 0;
        var SN = 0;
        if (Recorrido == 1) {
            CC = 1
            databaseHandler.db.transaction(
                function (tx) {
                    tx.executeSql("UPDATE DG_PlatoL SET CC = ? WHERE DG_ID_Cedula = ?",
                        [CC, id_cedula],
                        function (tx, results) {
                            DireccionarPL();
                        },
                        function (tx, error) {
                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                        }
                    );
                },
                function (error) {
                    console.error("Error al actualizar el tipo de cedula: " + error.message);
                },
                function () { }
            );
        } else if (Recorrido == 2) {
            FH = 1;
            databaseHandler.db.transaction(
                function (tx) {
                    tx.executeSql("UPDATE DG_PlatoL SET  FH = ? WHERE DG_ID_Cedula = ?",
                        [FH, id_cedula],
                        function (tx, results) {
                            DireccionarPL();
    
                        },
                        function (tx, error) {
                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                        }
                    );
                },
                function (error) {
                    console.error("Error al actualizar el tipo de cedula: " + error.message);
                },
                function () { }
            );
        } else if (Recorrido == 3) {
            SN = 1;
            databaseHandler.db.transaction(
                function (tx) {
                    tx.executeSql("UPDATE DG_PlatoL SET  SN = ? WHERE DG_ID_Cedula = ?",
                        [SN, id_cedula],
                        function (tx, results) {
                            DireccionarPL();
    
                        },
                        function (tx, error) {
                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                        }
                    );
                },
                function (error) {
                    console.error("Error al actualizar el tipo de cedula: " + error.message);
                },
                function () { }
            );
        }
    }
    function DireccionarPL() {
        let id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql("select * from DG_PlatoL WHERE DG_ID_Cedula = ?",
                    [id_cedula],
                    function (tx, results) {
                        var item = results.rows.item(i);
                        if (item.CC == 1 && item.FH == 1 && item.SN == 1) {
                            swal({
                                title: "Aviso",
                                text: "¬øQuieres Finalizar la cedula?",
                                icon: "warning",
                                buttons: true,
                                dangerMode: true,
                            })
                                .then((RESP) => {
                                    if (RESP == true) {
                                        //app.views.main.router.navigate({name: 'cierrePL4'});
                                        app.views.main.router.back('/cierrePL4/', { force: true, reload: true });
                                    } else {
                                        //app.views.main.router.navigate({name: 'menuPlatoLimpio'});
                                    app.views.main.router.back('/menuPlatoLimpio/', { force: true,  reload: true });
                                    }
                                });
    
                        } else {
                            //app.views.main.router.navigate({name: 'menuPlatoLimpio'});
                        app.views.main.router.back('/menuPlatoLimpio/', { force: true, reload: true });
                        }
    
                    },
                    function (tx, error) {
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function (error) { },
            function () { }
        );
    }
    function continuarPL(id_cedula,tipo){
        localStorage.setItem("IdCedula",id_cedula);
        localStorage.setItem("Opcion", '1');
        if(tipo == 1){
            app.views.main.router.navigate({ name: 'menuPlatoLimpio'});
        } 
    }
    function FactorHumano(){
        app.views.main.router.navigate({name: 'recorridoPL2'});
    }
    function SanitizacionLava(){
        app.views.main.router.navigate({name: 'recorridoPL3'});
    }
    function regeresarPLR1(){
        app.views.main.router.back('/recorridoPL1/', {force: true, ignoreCache: true, reload: true});
    }
    function regeresarPLR2(){
        app.views.main.router.back('/recorridoPL2/', {force: true, ignoreCache: true, reload: true});
    }
    function regeresarPLR3(){
        app.views.main.router.back('/recorridoPL3/', {force: true, ignoreCache: true, reload: true});
    }
    function terminarCiclo1(){
        app.views.main.router.back('/menuPlatoLimpio/', {force: true, ignoreCache: true, reload: true});
    }
    //Fin PlatoLimpio
   //Inicio Servind
   function eliminarFilaServ(index, opc){
    if(opc == 1) {
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql(
                    "DELETE FROM fotos_check WHERE id_foto = ?",
                    [index],
                    function(tx, results){
                         swal("","El registro se elimino satisfactoriamente","success");
                         $("#fila" + index).remove();
                    },
                    function(tx, error){
                        swal("Error al eliminar registro",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    if(opc == 2) {
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql(
                    "DELETE FROM fotos_diagnostico WHERE id_foto = ?",
                    [index],
                    function(tx, results){
                         swal("","El registro se elimino satisfactoriamente","success");
                         $("#fila" + index).remove();
                    },
                    function(tx, error){
                        swal("Error al eliminar registro",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    if(opc == 3) {
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql(
                    "DELETE FROM papeleta WHERE id_papeleta = ?",
                    [index],
                    function(tx, results){
                         swal("","El registro se elimino satisfactoriamente","success");
                         $("#fila" + index).remove();
                    },
                    function(tx, error){
                        swal("Error al eliminar registro",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    if(opc == 4) {
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql(
                    "DELETE FROM refacciones WHERE id_refaccion = ?",
                    [index],
                    function(tx, results){
                         swal("","El registro se elimino satisfactoriamente","success");
                         $("#fila" + index).remove();
                    },
                    function(tx, error){
                        swal("Error al eliminar registro",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
}
function buscarClienteServInd(){
    var id_usuario = localStorage.getItem("id_usuario");
    var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
    var fecha = new Date();
    var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
    var geolocation = $("#geolocation").val();
    var id_cliente = $("#id_cliente").val();
    var horario_programado = $("#horario_programado").val();;
    var foto_llegada = $("#imagenC").val();
    var nombre_cliente = $("#nombre_comercial").val() + " " + $("#sucursal").val();
    var sucursal = $("#sucursal").val();
    var telefono = $("#telefono").val();
    var correo = $("#correo").val();
    var equipo = $("#equipo").val();
    var marca = $("#marca").val();
    var modelo = $("#modelo").val();
    var serie = $("#serie").val();
    var tipo_servicio = $("#tipo_servicio").val();
    var direccion = $("#direccion").val();
    var estatus = 0;
    
   // if(foto_llegada != ''){
        if(nombre_cliente != ''){
            productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                        [],
                        function(tx, results){
                            var item = results.rows.item(0);
                            localStorage.setItem("IdCedula", item.Id);
                            localStorage.setItem("nombreCliente", nombre_cliente);
                            localStorage.setItem("foto_llegada", foto_llegada);
                            localStorage.setItem("sucursal", sucursal);
                            localStorage.setItem("direccion", direccion);
                            localStorage.setItem("telefono", telefono);
                            localStorage.setItem("correo", correo);
                            app.views.main.router.navigate({name: 'menuServInd'});
                            app.preloader.hide();
                        },
                        function(tx, error){
                            console.log("Error al guardar cedula: " + error.message);
                            app.preloader.hide();
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else {
            swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }/*
    } else {
        swal("Falta un campo", "La fotograf√≠a es requerida para este proceso" ,"warning");
        app.preloader.hide();
    }*/
}


function generarReporteServInd(){
   /*
    let id_visita = localStorage.getItem("id_visita");
    let nombre_comercial = localStorage.getItem("nombre_comercial");
    let ciudad = localStorage.getItem("store");
    let direccion = localStorage.getItem("direccion");
    let telefono = localStorage.getItem("telefono");
    let correo = localStorage.getItem("correo");
    let equipo = localStorage.getItem("equipo");
    let marca = localStorage.getItem("marca");
    let modelo = localStorage.getItem("modelo");
    let serie = localStorage.getItem("serie");*/
    let id_cedula = localStorage.getItem("IdCedula");
    let nombre_cliente = localStorage.getItem("nombreCliente");
    let foto_llegada = localStorage.getItem("foto_llegada");
    let sucursal = localStorage.getItem("sucursal");
    let orden_servicio = localStorage.getItem("order_number");
    var fecha = new Date();
    var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
    let tipoCedula = "Caliente";
    let tipoCedulas = "correctivo";
    databaseHandler.db.transaction(
        function(tx){
            tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                [tipoCedula,id_cedula],
                function(tx, results){
                    localStorage.setItem("TipoVisita", tipoCedulas);
                    productHandler.addVisitaServ(id_cedula);
                    productHandler.addreporteCaliente(id_cedula, orden_servicio, fecha_llegada, foto_llegada, tipoCedula, nombre_cliente, sucursal);
                    app.views.main.router.navigate({name: 'recorridoServ2'});
                },
                function(tx, error){
                    console.error("Error al actualizar el tipo de cedula: " + error.message);
                }
            );
        },
        function(error){},
        function(){}
    );
}

function generarReporteServIndFrio(){
    /*
    let id_visita = localStorage.getItem("id_visita");
    let nombre_comercial = localStorage.getItem("nombre_comercial");
    let ciudad = localStorage.getItem("store");
    let direccion = localStorage.getItem("direccion");
    let telefono = localStorage.getItem("telefono");
    let correo = localStorage.getItem("correo");
    let equipo = localStorage.getItem("equipo");
    let marca = localStorage.getItem("marca");
    let modelo = localStorage.getItem("modelo");
    let serie = localStorage.getItem("serie");*/
    let id_cedula = localStorage.getItem("IdCedula");
    let nombre_cliente = localStorage.getItem("nombreCliente");
    let foto_llegada = localStorage.getItem("foto_llegada");
    let sucursal = localStorage.getItem("sucursal");
    let orden_servicio = localStorage.getItem("order_number");
    var fecha = new Date();
    var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
    let tipoCedula = "Frio";
    let tipoCedulas = "correctivo";
    databaseHandler.db.transaction(
        function(tx){
            tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                [tipoCedula,id_cedula],
                function(tx, results){
                    localStorage.setItem("TipoVisita", tipoCedulas);
                    productHandler.addVisitaServ(id_cedula);
                    productHandler.addreporteFrio(id_cedula, orden_servicio, fecha_llegada, foto_llegada, tipoCedula, nombre_cliente, sucursal);
                    app.views.main.router.navigate({name: 'recorridoServ1'});
                },
                function(tx, error){
                    console.error("Error al actualizar el tipo de cedula: " + error.message);
                }
            );
        },
        function(error){},
        function(){}
    );
}

function generarReporteServIndRational(){
    console.log('rational');/*
    let id_visita = localStorage.getItem("id_visita");
    let nombre_comercial = localStorage.getItem("nombre_comercial");
    let ciudad = localStorage.getItem("store");
    let direccion = localStorage.getItem("direccion");
    let telefono = localStorage.getItem("telefono");
    let correo = localStorage.getItem("correo");
    let equipo = localStorage.getItem("equipo");
    let marca = localStorage.getItem("marca");
    let modelo = localStorage.getItem("modelo");
    let serie = localStorage.getItem("serie");*/
    let id_cedula = localStorage.getItem("IdCedula");
    let nombre_cliente = localStorage.getItem("nombreCliente");
    let foto_llegada = localStorage.getItem("foto_llegada");
    let sucursal = localStorage.getItem("sucursal");
    let orden_servicio = localStorage.getItem("order_number");
    var fecha = new Date();
    var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
    let tipoCedula = "Rational";
    let tipoCedulas = "correctivo";
    databaseHandler.db.transaction(
        function(tx){
            tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                [tipoCedula,id_cedula],
                function(tx, results){
                    localStorage.setItem("TipoVisita", tipoCedulas);
                    productHandler.addreporteRatinal(id_cedula, orden_servicio, fecha_llegada, foto_llegada, tipoCedula, nombre_cliente, sucursal);
                    app.views.main.router.navigate({name: 'recorridoServ3'});
                },
                function(tx, error){
                    console.error("Error al actualizar el tipo de cedula: " + error.message);
                }
            );
        },
        function(error){},
        function(){}
    );
}
function continuarPapeleta(id_cedula,tipo){
    localStorage.setItem("IdCedula",id_cedula);
    if(tipo == 1){
        app.views.main.router.navigate({ name: 'papeletas'});
    }
}
function continuarCedServInd(id_cedula,tipo){
    localStorage.setItem("IdCedula",id_cedula);
    localStorage.setItem("Opcion", '1');
    if(tipo == 1){
        app.views.main.router.navigate({ name: 'recorridoServ1'});
        let tipoCedulas = "correctivo";
        localStorage.setItem("TipoVisita", tipoCedulas);
    } else if(tipo == 2){
        app.views.main.router.navigate({ name: 'recorridoServ2'});
        let tipoCedulas = "correctivo";
        localStorage.setItem("TipoVisita", tipoCedulas);
    } else if(tipo == 3){
        app.views.main.router.navigate({ name: 'recorridoServ3'});
        let tipoCedulas = "correctivo";
        localStorage.setItem("TipoVisita", tipoCedulas);
    }else if(tipo == 4){
        app.views.main.router.navigate({ name: 'recorridoServ8'});
        let tipoCedulas = "PMP1Caliente";
        localStorage.setItem("TipoVisita", tipoCedulas);
    }else if(tipo == 5){
        app.views.main.router.navigate({ name: 'recorridoServ7'});
        let tipoCedulas = "PMP1Frio";
        localStorage.setItem("TipoVisita", tipoCedulas);
    }else if(tipo == 6){
        app.views.main.router.navigate({ name: 'menuServPMPSOEC'});
        let tipoCedulas = "PMP2";
        localStorage.setItem("TipoVisita", tipoCedulas);
    }else if(tipo == 7){
        app.views.main.router.navigate({ name: 'recorridoServ6'});
        let tipoCedulas = "correctivo";
        localStorage.setItem("TipoVisita", tipoCedulas);
    }else if(tipo == 8){
        app.views.main.router.navigate({ name: 'recorridoServ9'});
        let tipoCedulas = "PMP1Rational";
        localStorage.setItem("TipoVisita", tipoCedulas);
    }
}
function checkAndSave(id,valor,parte){
    let id_cedula = localStorage.getItem("IdCedula");
    var currentId = id.split("-");
    if (parte==9){
        if(id.includes("1")){
            if($("#"+id).prop("checked") == true){
                $("#"+currentId[0]+"-2").prop("checked", false);
                //console.log("primerainst");//1-SI
                var correctoPMP='1';
            }
            if($("#"+id).prop("checked") == false && $("#"+currentId[0]+"-2").prop("checked") == false){
                valor = "0";
                var correctoPMP='3';
                //console.log("segundinst");//1-no
            }
        } else {
            if($("#"+id).prop("checked") == true){
                $("#"+currentId[0]+"-1").prop("checked", false);
                //console.log("tercer ints");//2-SI
                var correctoPMP='0';
            }
            if($("#"+id).prop("checked") == false && $("#"+currentId[0]+"-1").prop("checked") == false){
                valor = "0";
                var correctoPMP='3';
                //console.log("cuartainst");//2-no
            }
        }
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("SELECT * from diagnosticos_PMP WHERE id_cedula = ?",
                [id_cedula],
                    function(tx, results){
                        if(results.rows.length == 0){
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("INSERT INTO diagnosticos_PMP(id_cedula,diagnostico) VALUES (?,?)",
                                        [id_cedula, correctoPMP],
                                        function(tx, results){
                                            //console.log('Inserta');
                                            //swal("", "Datos actualizados correctamente", "success");
                                        },
                                        function(tx, error){
                                            swal("Error al guardar",error.message,"error");
                                            app.preloader.hide();
                                        }
                                    );
                                },function(error){},function(){}
                            );
                        } else {
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("UPDATE diagnosticos_PMP SET diagnostico = ? WHERE id_cedula = ?",
                                        [correctoPMP, id_cedula],
                                        function(tx, results){
                                            //console.log('update');
                                            //swal("", "Datos actualizados correctamente", "success");
                                        },
                                        function(tx, error){
                                            swal("Error al guardar",error.message,"error");
                                            app.preloader.hide();
                                        }
                                    );
                                },function(error){},function(){}
                            );
                        }
                    },
                    function(tx, error){
                        console.log("Error al guardar checklits: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }else if (parte==3 || parte==4){
        if(id.includes("1")){
            if($("#"+id).prop("checked") == true){
                $("#"+currentId[0]+"-2").prop("checked", false);
                valor = "1";
                //console.log("primerainst");//1-SI
            }
            if($("#"+id).prop("checked") == false && $("#"+currentId[0]+"-2").prop("checked") == false){
                valor = "0";
                //console.log("segundinst");//1-no
            }
        } else {
            if($("#"+id).prop("checked") == true){
                $("#"+currentId[0]+"-1").prop("checked", false);
                valor = "0";
                //console.log("tercer ints");//2-No
            }
            if($("#"+id).prop("checked") == false && $("#"+currentId[0]+"-1").prop("checked") == false){
                valor = "0";
                //console.log("cuartainst");//2-no
            }
        }
        if(parte == 3){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * from diagnostico_servInd WHERE id_cedula = ?",
                    [id_cedula],
                        function(tx, results){
                            if(results.rows.length == 0){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("INSERT INTO diagnostico_servInd(id_cedula,filtro) VALUES (?,?)",
                                            [id_cedula, valor],
                                            function(tx, results){
                                                //console.log('Inserta');
                                                //swal("", "Datos actualizados correctamente", "success");
                                            },
                                            function(tx, error){
                                                swal("Error al guardar",error.message,"error");
                                                app.preloader.hide();
                                            }
                                        );
                                    },function(error){},function(){}
                                );
                            } else {
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("UPDATE diagnostico_servInd SET filtro = ? WHERE id_cedula = ?",
                                            [valor, id_cedula],
                                            function(tx, results){
                                                //console.log('update');
                                                //swal("", "Datos actualizados correctamente", "success");
                                            },
                                            function(tx, error){
                                                swal("Error al guardar",error.message,"error");
                                                app.preloader.hide();
                                            }
                                        );
                                    },function(error){},function(){}
                                );
                            }
                        },
                        function(tx, error){
                            console.log("Error al guardar checklits: " + error.message);
                            app.preloader.hide();
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else if(parte == 4){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * from diagnostico_servInd WHERE id_cedula = ?",
                    [id_cedula],
                        function(tx, results){
                            if(results.rows.length == 0){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("INSERT INTO diagnostico_servInd(id_cedula,extracion) VALUES (?,?)",
                                            [id_cedula, valor],
                                            function(tx, results){
                                                //console.log('Inserta');
                                                //swal("", "Datos actualizados correctamente", "success");
                                            },
                                            function(tx, error){
                                                swal("Error al guardar",error.message,"error");
                                                app.preloader.hide();
                                            }
                                        );
                                    },function(error){},function(){}
                                );
                            } else {
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("UPDATE diagnostico_servInd SET extracion = ? WHERE id_cedula = ?",
                                            [valor, id_cedula],
                                            function(tx, results){
                                                //console.log('update');
                                                //swal("", "Datos actualizados correctamente", "success");
                                            },
                                            function(tx, error){
                                                swal("Error al guardar",error.message,"error");
                                                app.preloader.hide();
                                            }
                                        );
                                    },function(error){},function(){}
                                );
                            }
                        },
                        function(tx, error){
                            console.log("Error al guardar checklits: " + error.message);
                            app.preloader.hide();
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }else{
        if(id.includes("1")){
            if($("#"+id).prop("checked") == true){
                $("#"+currentId[0]+"-2").prop("checked", false);
                $("#"+currentId[0]+"-3").prop("checked", false);
            }
            if($("#"+id).prop("checked") == false && $("#"+currentId[0]+"-2").prop("checked") == false && $("#"+currentId[0]+"-3").prop("checked") == false){
                valor = "0";
            }
        } else if(id.includes("2")){
            if($("#"+id).prop("checked") == true){
                $("#"+currentId[0]+"-1").prop("checked", false);
                $("#"+currentId[0]+"-3").prop("checked", false);
            }
            if($("#"+id).prop("checked") == false && $("#"+currentId[0]+"-1").prop("checked") == false && $("#"+currentId[0]+"-3").prop("checked") == false){
                valor = "0";
            }
        } else if(id.includes("3")){
            if($("#"+id).prop("checked") == true){
                $("#"+currentId[0]+"-1").prop("checked", false);
                $("#"+currentId[0]+"-2").prop("checked", false);
            }
            if($("#"+id).prop("checked") == false && $("#"+currentId[0]+"-1").prop("checked") == false && $("#"+currentId[0]+"-2").prop("checked") == false){
                valor = "0";
            }
        }
    }
}
function comentadiagnostico(){
    var id_cedula = localStorage.getItem("IdCedula");
    var comentario_cliente = $('#comentario_cliente').val();
    databaseHandler.db.transaction(
        function(tx){
            tx.executeSql("SELECT * from diagnosticos_PMP WHERE id_cedula = ?",
            [id_cedula],
                function(tx, results){
                    if(results.rows.length == 0){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("INSERT INTO diagnosticos_PMP(id_cedula,comentario_cliente) VALUES (?,?)",
                                    [id_cedula, comentario_cliente],
                                    function(tx, results){
                                        //console.log('Inserta');
                                        //swal("", "Datos actualizados correctamente", "success");
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },function(error){},function(){}
                        );
                    } else {
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE diagnosticos_PMP SET comentario_cliente = ? WHERE id_cedula = ?",
                                    [comentario_cliente, id_cedula],
                                    function(tx, results){
                                        //console.log('update');
                                        //swal("", "Datos actualizados correctamente", "success");
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },function(error){},function(){}
                        );
                    }
                },
                function(tx, error){
                    console.log("Error al guardar checklits: " + error.message);
                    app.preloader.hide();
                }
            );
        },
        function(error){},
        function(){}
    );
}
function guardarFotoDiagnostico(){
    var tipoVisita = localStorage.getItem("TipoVisita");
    if (tipoVisita=="PMP1Caliente"){
        tipo='Caliente';
    }else if (tipoVisita=="PMP1Frio"){
        tipo='Frio';
    }else if (tipoVisita=="PMP1Rational"){
        tipo='Rational';
    }else if (tipoVisita=="PMP2"){
        tipo='Comedor Industrial';
    }else if (tipoVisita=="correctivo"){
        tipo='Correctivo';
    }else{tipo='HEB'}
    var id_cedula = localStorage.getItem("IdCedula");
    var foto = $("#imagenC").val();
    var fecha = new Date();
    var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
    if (foto){
        $("#tabla_diagnostico tbody").empty(""); 
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql("insert into fotos_diagnostico(id_cedula,foto,fecha,tipo ) values(?,?,?,?)",
                [id_cedula,foto,fecha_llegada,tipo],
                function (tx, results) {
                    var item = results.rows.item(0);
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("Select * from fotos_diagnostico where id_cedula = ? AND tipo = ? ORDER BY id_foto DESC",
                            [id_cedula, tipo],
                                function(tx, results){
                                    let length = results.rows.length;
                                    console.log(length);
                                    if (length ==0){
                                        $('.preloader').remove();
                                        $('.infinite-scroll-preloader').remove();
                                    }else{
                                        $("#message-nr").css("display", "none");
                                        $("#imagenC").val("");                                            
                                        $("#smallImage").attr("src","img/blank.png");
                                        $("#photoIcon").attr("src","img/camera.svg");
                                        $('.preloader').remove();
                                        $('.infinite-scroll-preloader').remove();
                                        app.preloader.hide();
                                        for(var i = 0; i< length; i++){
                                            var item = results.rows.item(i);
                                            $("#tabla_diagnostico").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.fecha + "</td></tr>");
                                            swal("", "Se guardo la foto", "success");
                                                        
                                        }
                                    }
                                  
                                },
                                function(tx, error){
                                    console.log("Error al mostrar datos cedula: " + error.message);
                                    app.preloader.hide();
                                }
                            );
                        },
                        function(error){console.log("Error al mostrar datos cedula: " + error.message);},
                        function(){}
                    );
                },
                function (tx, error) {
                    console.error("Error al registrar Resultado: " + error.message);
                }
                );
            },
            function (error) { },
            function () { });
    }else{
        swal("", "Debe de tomar fotografia" ,"warning");
    }
}
function guardarDatoscheckServind(){
    var id_cedula = localStorage.getItem("IdCedula");
    //console.log("guardardatso");
   var no_orden=$('#orden').val();
   var fecha=$('#fecha').val();
   var id_cliente=1;
   var cliente=$('#cliente').val();
   var suc_cliente=$('#suc_cliente').val();
   var direccion=$('#direccion').val();
   var ciudad=$('#ciudad').val();
   var telefono=$('#telefono').val();
   var correo=$('#correo').val();
   var tipo_servicio=$('#tipo_servicio').val();

    if (orden && fecha && id_cliente && cliente && suc_cliente && direccion && ciudad && telefono && correo && tipo_servicio){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE visita_servInd SET no_orden = ?, fecha = ?, id_cliente = ?, cliente = ?, sucursal_cliente = ?, direccion = ?, ciudad = ?, telefono = ?, correo = ?, tipo_servicio = ? WHERE id_cedula = ?",
                    [no_orden, fecha, id_cliente, cliente, suc_cliente, direccion, ciudad, telefono, correo, tipo_servicio ,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET nombre_cliente = ? WHERE id_cedula = ?",
                                    [cliente ,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        $('#orden').css("background-color", "#ffffff");
                                        $('#fecha').css("background-color", "#ffffff");
                                        $('#cliente').css("background-color", "#ffffff");
                                        $('#suc_cliente').css("background-color", "#ffffff");
                                        $('#direccion').css("background-color", "#ffffff");
                                        $('#ciudad').css("background-color", "#ffffff");
                                        $('#telefono').css("background-color", "#ffffff");
                                        $('#correo').css("background-color", "#ffffff");                                            
                                        $('#tipo_servicio').css("background-color", "#ffffff");
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar datos generales: " + error.message);
                                    }
                                );
                            },
                            function(error){
                                console.error("Error al guardar datos generales: " + error.message);
                            },
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar datos generales: " + error.message);
                    }
                );
            },
            function(error){
                console.error("Error al guardar datos generales: " + error.message);
            },
            function(){}
        );
    }else{
            swal("", "Todos los campos son requeridos" ,"warning");
    }    
}
function guardarDatoscheckServind2(){
    var id_cedula = localStorage.getItem("IdCedula");
    //console.log("guardardatso");
   var orden=$('#orden').val();
   var fecha=$('#fecha').val();
   var id_cliente=1;
   var cliente=$('#cliente').val();
   var suc_cliente=$('#suc_cliente').val();
   var direccion=$('#direccion').val();
   var ciudad=$('#ciudad').val();
   var telefono=$('#telefono').val();
   var correo=$('#correo').val();
   var equipo=$('#equipo').val();
   var marca=$('#marca').val();
   var modelo=$('#modelo').val();
   var serie=$('#serie').val();
   var ml=$('#ml').val();
   var tipo_servicio=$('#tipo_servicio').val();

    if (orden && fecha && id_cliente && cliente && suc_cliente && direccion && ciudad && telefono && correo && equipo && marca && modelo && serie && ml && tipo_servicio){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datos_generales_serv SET no_orden = ?, fecha = ?, id_cliente = ?, cliente = ?, sucursal_cliente = ?, direccion = ?, ciudad = ?, telefono = ?, correo = ?, equipo = ?, marca = ?, modelo = ?, serie = ?, ml = ?, tipo_servicio = ? WHERE id_cedula = ?",
                    [orden, fecha, id_cliente, cliente, suc_cliente, direccion, ciudad, telefono, correo, equipo, marca, modelo, serie, ml, tipo_servicio ,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET nombre_cliente = ? WHERE id_cedula = ?",
                                    [cliente ,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        $('#orden').css("background-color", "#ffffff");
                                        $('#fecha').css("background-color", "#ffffff");
                                        $('#cliente').css("background-color", "#ffffff");
                                        $('#suc_cliente').css("background-color", "#ffffff");
                                        $('#direccion').css("background-color", "#ffffff");
                                        $('#ciudad').css("background-color", "#ffffff");
                                        $('#telefono').css("background-color", "#ffffff");
                                        $('#correo').css("background-color", "#ffffff");
                                        $('#equipo').css("background-color", "#ffffff");
                                        $('#marca').css("background-color", "#ffffff");
                                        $('#modelo').css("background-color", "#ffffff");
                                        $('#serie').css("background-color", "#ffffff");
                                        $('#ml').css("background-color", "#ffffff");
                                        $('#tipo_servicio').css("background-color", "#ffffff");
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar datos generales: " + error.message);
                                    }
                                );
                            },
                            function(error){
                                console.error("Error al guardar datos generales: " + error.message);
                            },
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar datos generales: " + error.message);
                    }
                );
            },
            function(error){
                console.error("Error al guardar datos generales: " + error.message);
            },
            function(){}
        );
    }else{
            swal("", "Todos los campos son requeridos" ,"warning");
    }    
}
function guardarDatoscheckServind3(){
    var id_cedula = localStorage.getItem("IdCedula");
    //console.log("guardardatso");
   var no_orden=$('#orden').val();
   var fecha=$('#fecha').val();
   var id_cliente=1;
   var cliente=$('#cliente').val();
   var suc_cliente=$('#suc_cliente').val();
   var direccion=$('#direccion').val();
   var ciudad=$('#ciudad').val();
   var telefono=$('#telefono').val();
   var correo=$('#correo').val();
   var equipo=$('#equipo').val();
   var marca=$('#marca').val();
   var modelo=$('#modelo').val();
   var serie=$('#serie').val();
   var ml=$('#ml').val();
   var tipo_servicio=$('#tipo_servicio').val();

    if (orden && fecha && id_cliente && cliente && suc_cliente && direccion && ciudad && telefono && correo && equipo && marca && modelo && serie && ml && tipo_servicio){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE visita_servInd SET no_orden = ?, fecha = ?, id_cliente = ?, cliente = ?, sucursal_cliente = ?, direccion = ?, ciudad = ?, telefono = ?, correo = ?, equipo = ?, marca = ?, modelo = ?, serie = ?, ml = ?, tipo_servicio = ? WHERE id_cedula = ?",
                    [no_orden, fecha, id_cliente, cliente, suc_cliente, direccion, ciudad, telefono, correo, equipo, marca, modelo, serie, ml, tipo_servicio ,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET nombre_cliente = ? WHERE id_cedula = ?",
                                    [cliente ,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        $('#orden').css("background-color", "#ffffff");
                                        $('#fecha').css("background-color", "#ffffff");
                                        $('#cliente').css("background-color", "#ffffff");
                                        $('#suc_cliente').css("background-color", "#ffffff");
                                        $('#direccion').css("background-color", "#ffffff");
                                        $('#ciudad').css("background-color", "#ffffff");
                                        $('#telefono').css("background-color", "#ffffff");
                                        $('#correo').css("background-color", "#ffffff");
                                        $('#equipo').css("background-color", "#ffffff");
                                        $('#marca').css("background-color", "#ffffff");
                                        $('#modelo').css("background-color", "#ffffff");
                                        $('#serie').css("background-color", "#ffffff");
                                        $('#ml').css("background-color", "#ffffff");
                                        $('#tipo_servicio').css("background-color", "#ffffff");
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar datos generales: " + error.message);
                                    }
                                );
                            },
                            function(error){
                                console.error("Error al guardar datos generales: " + error.message);
                            },
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar datos generales: " + error.message);
                    }
                );
            },
            function(error){
                console.error("Error al guardar datos generales: " + error.message);
            },
            function(){}
        );
    }else{
            swal("", "Todos los campos son requeridos" ,"warning");
    }    
}
function guardarDatoscheckServind5(){
    var id_cedula = localStorage.getItem("IdCedula");
    //console.log("guardardatso");
   var no_orden=$('#orden').val();
   var fecha=$('#fecha').val();
   var id_cliente=1;
   var cliente=$('#cliente').val();
   var suc_cliente=$('#suc_cliente').val();
   var direccion=$('#direccion').val();
   var ciudad=$('#ciudad').val();
   var telefono=$('#telefono').val();
   var correo=$('#correo').val();
   var equipo=$('#equipo').val();
   var marca=$('#marca').val();
   var modelo=$('#modelo').val();
   var serie=$('#serie').val();
   var ml=$('#ml').val();
   var tipo_servicio=$('#tipo_servicio').val();

    if (orden && fecha && id_cliente && cliente && suc_cliente && direccion && ciudad && telefono && correo && equipo && marca && modelo && serie && ml && tipo_servicio){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datos_generales_serv SET no_orden = ?, fecha = ?, id_cliente = ?, cliente = ?, sucursal_cliente = ?, direccion = ?, ciudad = ?, telefono = ?, correo = ?, equipo = ?, marca = ?, modelo = ?, serie = ?, ml = ?, tipo_servicio = ? WHERE id_cedula = ?",
                    [no_orden, fecha, id_cliente, cliente, suc_cliente, direccion, ciudad, telefono, correo, equipo, marca, modelo, serie, ml, tipo_servicio ,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET nombre_cliente = ? WHERE id_cedula = ?",
                                    [cliente ,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        $('#orden').css("background-color", "#ffffff");
                                        $('#fecha').css("background-color", "#ffffff");
                                        $('#cliente').css("background-color", "#ffffff");
                                        $('#suc_cliente').css("background-color", "#ffffff");
                                        $('#direccion').css("background-color", "#ffffff");
                                        $('#ciudad').css("background-color", "#ffffff");
                                        $('#telefono').css("background-color", "#ffffff");
                                        $('#correo').css("background-color", "#ffffff");
                                        $('#equipo').css("background-color", "#ffffff");
                                        $('#marca').css("background-color", "#ffffff");
                                        $('#modelo').css("background-color", "#ffffff");
                                        $('#serie').css("background-color", "#ffffff");
                                        $('#ml').css("background-color", "#ffffff");
                                        $('#tipo_servicio').css("background-color", "#ffffff");
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar datos generales: " + error.message);
                                    }
                                );
                            },
                            function(error){
                                console.error("Error al guardar datos generales: " + error.message);
                            },
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar datos generales: " + error.message);
                    }
                );
            },
            function(error){
                console.error("Error al guardar datos generales: " + error.message);
            },
            function(){}
        );
    }else{
            swal("", "Todos los campos son requeridos" ,"warning");
    }    
}
function datosDiagnostico(id,value){
    var id_cedula = localStorage.getItem("IdCedula");
    var como_encontro = $('#como_encontro').val();
    var volt = $('#volt').val();
    var amp = $('#amp').val();
    var wc = $('#wc').val();
    var tierra_fisica = $('#tierra_fisica').val();
    if (id=='como_encontro'){
        if (como_encontro){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE visita_servInd SET como_encontro = ? WHERE id_cedula = ?",
                        [como_encontro, id_cedula],
                        function(tx, results){
                        },
                        function(tx, error){
                            console.error("Error al guardar datos generales: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }else if (id=='volt'){
        if (volt){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE visita_servInd SET voltaje = ? WHERE id_cedula = ?",
                        [volt, id_cedula],
                        function(tx, results){
                        },
                        function(tx, error){
                            console.error("Error al guardar datos generales: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }else if (id=='amp'){
        if (amp){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE visita_servInd SET amp = ? WHERE id_cedula = ?",
                        [amp, id_cedula],
                        function(tx, results){
                        },
                        function(tx, error){
                            console.error("Error al guardar datos generales: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }else if (id=='wc'){
        if (wc){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE visita_servInd SET wc = ? WHERE id_cedula = ?",
                        [wc, id_cedula],
                        function(tx, results){
                        },
                        function(tx, error){
                            console.error("Error al guardar datos generales: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }else if (id=='tierra_fisica'){
        if (tierra_fisica){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE visita_servInd SET tierra_fisica = ? WHERE id_cedula = ?",
                        [tierra_fisica, id_cedula],
                        function(tx, results){
                        },
                        function(tx, error){
                            console.error("Error al guardar datos generales: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
}
function guardarDiagnosticoServ(clave){
    var id_cedula = localStorage.getItem("IdCedula");
    var falla = $('#falla').val();
    var como_encontro = $('#como_encontro').val();
    var volt = $('#volt').val();
    var amp = $('#amp').val();
    var wc = $('#wc').val();
    var tierra_fisica = $('#tierra_fisica').val();
    if (clave == 1){
        if (como_encontro==0){
            swal("", "Todos los campos son requeridos." ,"warning");
        }else{
            if (falla && como_encontro && volt && amp && wc && tierra_fisica){
                swal("","Datos Guardados correctamente","success");
                app.views.main.router.back('/formServ2/', {force: true, ignoreCache: true, reload: true});
            }else{
                swal("", "Todos los campos son requeridos" ,"warning");
            }
        }
    }else{}
}

function requiereCotizacion(){
    var id_cedula = localStorage.getItem("IdCedula");
    var TipoVisita = localStorage.getItem("TipoVisita");
    var id_equipo = localStorage.getItem("insertId");
        var diag = '';
        if($("#cotizacion-1").prop("checked") == true){
            $("#cotizacion").css("display","block")
            diag= 'S√≠';
        } else {
            $("#cotizacion").css("display","none")
            diag= 'No';
        }
        if(TipoVisita=='PMP2'){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE datos_eq SET papeleta = ? WHERE id_datos = ?",
                        [diag,id_equipo],
                        function(tx, results){
                            
                        },
                        function(tx, error){
                            console.error("Error al guardar: " + error.message);
                        }
                    );
                },
                function(error){
                    console.error("Error al guardar: " + error.message);
                },
                function(){}
            );
        }else{
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE visita_servInd SET papeleta = ? WHERE id_cedula = ?",
                    [diag,id_cedula],
                    function(tx, results){
                        
                    },
                    function(tx, error){
                        console.error("Error al guardar: " + error.message);
                    }
                );
            },
            function(error){
                console.error("Error al guardar: " + error.message);
            },
            function(){}
        );
    }
}
function norequiereCotizacion(){
    var id_cedula = localStorage.getItem("IdCedula");
    var TipoVisita = localStorage.getItem("TipoVisita");
    var id_equipo = localStorage.getItem("insertId");
    var diag = '';
    if($("#cotizacion-2").prop("checked") == true){
        $("#cotizacion").css("display","none")
        diag= 'No';  
    }
    if($("#cotizacion-3").prop("checked") == true){
        $("#cotizacion").css("display","none")
        diag= 'Pendiente';  
    }
    if(TipoVisita=='PMP2'){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datos_eq SET papeleta = ? WHERE id_datos = ?",
                    [diag,id_equipo],
                    function(tx, results){
                        
                    },
                    function(tx, error){
                        console.error("Error al guardar: " + error.message);
                    }
                );
            },
            function(error){
                console.error("Error al guardar: " + error.message);
            },
            function(){}
        );
    }else{
    databaseHandler.db.transaction(
        function(tx){
            tx.executeSql("UPDATE visita_servInd SET papeleta = ? WHERE id_cedula = ?",
                [diag,id_cedula],
                function(tx, results){
                    
                },
                function(tx, error){
                    console.error("Error al guardar: " + error.message);
                }
            );
        },
        function(error){
            console.error("Error al guardar: " + error.message);
        },
        function(){}
    );
    }
}

function siviaticos(){
    var id_cedula = localStorage.getItem("IdCedula");
    var TipoVisita = localStorage.getItem("TipoVisita");
    var id_equipo = localStorage.getItem("insertId");
    var viatico = '';
    if($("#viaticos-1").prop("checked") == true){
        viatico= 'S√≠';
    } else {
        viatico= 'No';
    }
    if(TipoVisita=='PMP2'){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datos_eq SET viaticos = ? WHERE id_datos = ?",
                    [viatico,id_equipo],
                    function(tx, results){
                        
                    },
                    function(tx, error){
                        console.error("Error al guardar: " + error.message);
                    }
                );
            },
            function(error){
                console.error("Error al guardar: " + error.message);
            },
            function(){}
        );
    }else{
    databaseHandler.db.transaction(
        function(tx){
            tx.executeSql("UPDATE visita_servInd SET viaticos = ? WHERE id_cedula = ?",
                [viatico,id_cedula],
                function(tx, results){
                    
                },
                function(tx, error){
                    console.error("Error al guardar: " + error.message);
                }
            );
        },
        function(error){
            console.error("Error al guardar: " + error.message);
        },
        function(){}
    );
    }
}

function noviaticos(){
    var id_cedula = localStorage.getItem("IdCedula");
    var TipoVisita = localStorage.getItem("TipoVisita");
    var id_equipo = localStorage.getItem("insertId");
    var viatico = '';
    if($("#viaticos-2").prop("checked") == true){
        viatico= 'No';  
    }
    if(TipoVisita=='PMP2'){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datos_eq SET viaticos = ? WHERE id_datos = ?",
                    [viatico,id_equipo],
                    function(tx, results){
                        
                    },
                    function(tx, error){
                        console.error("Error al guardar: " + error.message);
                    }
                );
            },
            function(error){
                console.error("Error al guardar: " + error.message);
            },
            function(){}
        );
    }else{
    databaseHandler.db.transaction(
        function(tx){
            tx.executeSql("UPDATE visita_servInd SET viaticos = ? WHERE id_cedula = ?",
                [viatico,id_cedula],
                function(tx, results){
                    
                },
                function(tx, error){
                    console.error("Error al guardar: " + error.message);
                }
            );
        },
        function(error){
            console.error("Error al guardar: " + error.message);
        },
        function(){}
    );
    }
}

function guardarReporteGeneralServ(){
    if($("#NombreFirma").val() == "" || $("#signate").val() == ""){
        swal("","El campo de nombre y firma son obligatorios","warning");
        return false;
    }
    if($("#imagenC").val() == ""){
        swal("","Debes tomar la fotograf√≠a del sello para poder continuar","warning");
        return false;
    }
    var foto_sello = $("#imagenC").val();
    var id_cedula = localStorage.getItem("IdCedula");
    var nombrefirma = $("#NombreFirma").val();
    var firmaCliente = $("#signate").val();
    var fecha = new Date();
    var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
    
    databaseHandler.db.transaction(
        function(tx){
            tx.executeSql("UPDATE datos_generales_serv SET firma_cliente = ?, foto_sello = ? WHERE id_cedula = ?",
                [firmaCliente,foto_sello,id_cedula],
                function(tx, results){
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("UPDATE cedulas_general SET nombre_evalua = ? WHERE id_cedula = ?",
                                [nombrefirma,id_cedula],
                                function(tx, results){
                                    swal("","Guardado correctamente","success");
                                    app.views.main.router.back('/yamevoyserv2/', {force: true, reload: true});
                                },
                                function(tx, error){
                                    console.error("Error al guardar cierre: " + error.message);
                                }
                            );
                        },
                        function(error){},
                        function(){}
                    );
                },
                function(tx, error){
                    console.error("Error al guardar cierre: " + error.message);
                }
            );
        },
        function(error){},
        function(){}
    );
}

function verimg2(route){
    //console.log(route);
    localStorage.setItem("ruta", route);
    //app.views.main.router.navigate({ name: "verimgs2" });
    app.views.main.router.back('/verimgs2/', {force: true, ignoreCache: true, reload: true});
}

function regresarVerImg(){
    app.views.main.router.back('/menuServInd/', {force: true, ignoreCache: true, reload: true});
    window.localStorage.removeItem("ruta");
}
function mostrarHistoricoServ(){
    var historico = app.popup.create({
        content: `
              <div class="popup popup-historico" id="historico">
                    <br/>
                    <div class="headerPopupPhoto" style="width: 90%;display: flex;justify-content: end;padding-left: 20px;">
                        <a id="closeP" class="link popup-close">X</a>
                    </div>
                  <div class="app">
                    <div class="page">
                        <div class="page-content" style="background-color: #f6f7f9; ">
                            <div style="text-align: center; justify-content:center; margin-right:auto; margin-left:auto; width: 99%;">
                                <div style="text-align: left;">
                                    <div class="item-inner">
                                        <div class="block-title" style="text-align: center; font-size: 20px;"><h2 style="color:#505759;font-size: 22px;font-family: 'ITC Avant Garde Gothic', sans-serif;">Hist√≥rico</h2></div>
                                    </div>
                                </div>
                                <div style="text-align: left;">
                        
                                <div class="card data-table">
                                    <div class="infinite-scroll-content">
                                        <table id="tabla_diagnostico7">
                                            <thead>
                                                <tr>
                                                    <th class="numeric-cell" style="text-align: center;background-color: #063E7F;color: white;">Tipo</th>
                                                    <th class="numeric-cell" style="text-align: center;background-color: #063E7F;color: white;">Hrs.</th>
                                                    <th class="numeric-cell" style="text-align: center;background-color: #063E7F;color: white;">Min.</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>Abrillantado</td>
                                                    <td>01</td>
                                                    <td>23</td>
                                                </tr>
                                                <tr>
                                                    <td>Sin pastillas</td>
                                                    <td>0</td>
                                                    <td>23</td>
                                                </tr>
                                                <tr>
                                                    <td>Eco Ligero</td>
                                                    <td>01</td>
                                                    <td>19</td>
                                                </tr>
                                                <tr>
                                                    <td>Eco Medio/Intermedio</td>
                                                    <td>0</td>
                                                    <td>38</td>
                                                </tr>
                                                <tr>
                                                    <td>R√°pido/Ligero</td>
                                                    <td>01</td>
                                                    <td>26</td>
                                                </tr>
                                                <tr>
                                                    <td>Eco Intenso</td>
                                                    <td>01</td>
                                                    <td>23</td>
                                                </tr>
                                                <tr>
                                                    <td>Normal Ligero</td>
                                                    <td>0</td>
                                                    <td>29</td>
                                                </tr>
                                                <tr>
                                                    <td>Normal Medio</td>
                                                    <td>1</td>
                                                    <td>00</td>
                                                </tr>
                                                <tr>
                                                    <td>Normal Intenso/Fuerte</td>
                                                    <td>02</td>
                                                    <td>00</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                </div>
                                <fwm></fwm>
                            </div> 
                        </div>
                    </div>
                  </div>
              </div>
            `,
            on: {
                open: function (popup) {

                    
                },
            }
      });
      historico.open();
}
function showTPMV(){
    var manual = app.popup.create({
        content: `
              <div class="popup popup-Manual" id="camera">
                    <br/>
                    <div class="headerPopupPhoto" style="width: 90%;display: flex;justify-content: end;padding-left: 20px;">
                        <a id="closeP" class="link popup-close">X</a>
                    </div>
                  <div class="app">
                    <div class="page">
                        <div class="page-content" style="background-color: #f6f7f9; ">
                            <div style="text-align: center; justify-content:center; margin-right:auto; margin-left:auto; width: 99%;">
                                <div style="text-align: left;">
                                    <div class="item-inner">
                                        <div class="block-title" style="text-align: center; font-size: 20px;"><h2 style="color:#505759;font-size: 22px;font-family: 'ITC Avant Garde Gothic', sans-serif;">TPM¬¥s</h2></div>
                                    </div>
                                </div>
                                <div style="text-align: left;">
                                    <div class="list FWM-fixing-form">
                                        <span class="span FWM-span-form">Buscar TPMs:</span>
                                        <input type="text" class="FWM-input" id="manual"/>
                                        <input type="hidden" class="FWM-input" id="route"/>
                                    </div>
                                </div>
                                <fwm></fwm>
                            </div> 
                        </div>
                    </div>
                  </div>
              </div>
            `,
            on: {
                open: function (popup) {

                    var NomJson = 'Serve_tpm';
    
                    self.autocompleteDropdownAjax = app.autocomplete.create({
                        inputEl: '#manual',
                        openIn: 'dropdown',
                        preloader: true, //enable preloader
                        valueProperty: 'id', //object's "value" property name
                        textProperty:  'name', //object's "text" property name
                        limit: 10, //limit to 20 results
                        dropdownPlaceholderText: 'Seleccionar TPM...',
                        source: function (query, render) {
                            var autocomplete = this;
                            var results = [];
                            if (query.length === 0) {
                                render(results);
                                return;
                            }
                            // Show Preloader
                            autocomplete.preloaderShow();
                            // Do Ajax request to Autocomplete data
                            app.request({
                                url: cordova.file.dataDirectory + "jsons/"+NomJson+".json",
                                method: 'GET',
                                dataType: 'json',
                                data: {
                                    query: query,
                                },success: function (data) {
                                    for (var i = 0; i < data.length; i++) {
                                        if (data[i].name.toLowerCase().indexOf(query.toLowerCase()) >= 0) results.push(data[i]);
                                    }
                                    autocomplete.preloaderHide();
                                    render(results);
                                }
                            }); 
                        }
                    });


                    $('#manual').change(function () {
                        var id = $("#manual").val();
                        app.request.get(cordova.file.dataDirectory + "jsons/"+NomJson+".json", function (data) {
                            var content2 = JSON.parse(data);
                            for(var x = 0; x < content2.length; x++) {
                                if(content2[x].id == id){
                                    $("#manual").val(content2[x].name);
                                    $("#route").val(content2[x].route);
                                    var route =$("#route").val();
                                    manual.close();
                                    verimg2(route);
                                }         
                            }
                        });
                    });

                    $('#manual').click(function () {
                        $("#manual").val('');
                        $('#route').val('');
                    });

                    $('#closeP').click(function () {
                        manual.close();
                    });
                },
            }
      });
      manual.open();
}

function showManual(){
    var manual = app.popup.create({
        content: `
              <div class="popup popup-Manual" id="camera">
                    <br/>
                    <div class="headerPopupPhoto" style="width: 90%;display: flex;justify-content: end;padding-left: 20px;">
                        <a id="closeP" class="link popup-close">X</a>
                    </div>
                  <div class="app">
                    <div class="page">
                        <div class="page-content" style="background-color: #f6f7f9; ">
                            <div style="text-align: center; justify-content:center; margin-right:auto; margin-left:auto; width: 99%;">
                                <div style="text-align: left;">
                                    <div class="item-inner">
                                        <div class="block-title" style="text-align: center; font-size: 20px;"><h2 style="color:#505759;font-size: 22px;font-family: 'ITC Avant Garde Gothic', sans-serif;">Manuales</h2></div>
                                    </div>
                                </div>
                                <div style="text-align: left;">
                                    <div class="list FWM-fixing-form">
                                    <span class="span FWM-span-form">Buscar Manual:</span>
                                        <input type="text" class="FWM-input" id="manualM"/>
                                        <input type="hidden" class="FWM-input" id="routeM"/>
                                    </div>
                                    <div class="list FWM-fixing-form" style="margin-top:10px">
                                    <a href="" target="_system" id="abrir1"><img src="img/iconsMenu/zona.svg" width="55.81pt" height="74.41pt">
                                    <p style="margin-top:0px;" class="bottom-third">Consular repositorio online</p>
                                    </a>
                                    </div>
                                </div>
                                <fwm></fwm>
                            </div> 
                        </div>
                    </div>
                  </div>
              </div>`,
              on: {
                open: function (popup) {
                    var ruta2 = "https://drive.google.com/drive/folders/1iyOjr9xZBhJxnrYh4X18wFqYSd2LL3PZ?usp=sharing";
                    var NomJson = 'jsonArchivos_SerV';

                    $("#abrir1").click(function(){
                        var ruta_actual = app.views.main.router.url;
                        localStorage.setItem("RutaActual", ruta_actual);
                        localStorage.setItem("RutaManual", 1);
                        manual.close(); 
                        window.location.href = ruta2;
                    });
    
                    self.autocompleteDropdownAjax = app.autocomplete.create({
                        inputEl: '#manualM',
                        openIn: 'dropdown',
                        preloader: true, //enable preloader
                        valueProperty: 'id', //object's "value" property name
                        textProperty:  'name', //object's "text" property name
                        limit: 10, //limit to 20 results
                        dropdownPlaceholderText: 'Seleccionar Manual...',
                        source: function (query, render) {
                            var autocomplete = this;
                            var results = [];
                            if (query.length === 0) {
                                render(results);
                                return;
                            }
                            // Show Preloader
                            autocomplete.preloaderShow();
                            // Do Ajax request to Autocomplete data
                            app.request({
                                url: cordova.file.dataDirectory + "jsons/"+NomJson+".json",
                                method: 'GET',
                                dataType: 'json',
                                data: {
                                    query: query,
                                },success: function (data) {
                                    for (var i = 0; i < data.length; i++) {
                                        if (data[i].name.toLowerCase().indexOf(query.toLowerCase()) >= 0) results.push(data[i]);
                                    }
                                    autocomplete.preloaderHide();
                                    render(results);
                                }
                            }); 
                        }
                    });

                    $('#manualM').change(function () {
                        var id = $("#manualM").val();
                        app.request.get(cordova.file.dataDirectory + "jsons/"+NomJson+".json", function (data) {
                            var content2 = JSON.parse(data);
                            for(var x = 0; x < content2.length; x++) {
                                if(content2[x].id == id){
                                    $("#manualM").val(content2[x].name);
                                    $("#routeM").val(content2[x].url);
                                    var route =$("#routeM").val();
                                    var ruta_actual = app.views.main.router.url;
                                    localStorage.setItem("RutaActual", ruta_actual);
                                    localStorage.setItem("RutaManual", 1);
                                    manual.close();
                                    window.location.href = route;
                                }         
                            }
                        });
                    });

                    $('#manualM').click(function () {
                        $("#manualM").val('');
                        $('#routeM').val('');
                    });

                    $('#closeP').click(function () {
                        manual.close();
                    });
                },
            }
      });
      manual.open();
}

function showPDFinApp(route){
    if (route == undefined){
        var pdf ="Manuales/OP-AMA-MICRO-AMC4080-00.pdf";
    }
    else{var pdf = "Manuales/"+route;}
    const documentPath = "file:///mnt/ext_sdcard/"+pdf;
    console.log(documentPath);
    cordova.plugins.fileOpener2.open(
        documentPath,
        'application/pdf', 
        {
            error : function(e){ console.log('Error status: ' + e.status + ' - Error message: ' + e.message);}, 
            success : function(){ } 
        } 
    );
}
function terminarReporteServ(){
    if($('#imagenC').val() == ""){
        swal("","La fotografia es obligatoria","warning");
        return false;
    }
    if($('#signate').val() == ""){
        swal("","La firma es obligatoria","warning");
        return false;
    }
    var id_cedula = localStorage.getItem("IdCedula");
    var foto_salida = $('#imagenC').val();
    var firma_tec = $('#signate').val();
    var fecha = new Date();
    var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
    var ubicacion_salida = $('#geolocation').val();
    var estatus = 1;
    databaseHandler.db.transaction(
        function(tx){
            tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                [fecha_salida,ubicacion_salida,estatus,id_cedula],
                function(tx, results){
                    databaseHandler.db.transaction(
                        function(tx){//firma_tecnico
                            tx.executeSql("UPDATE datos_generales_serv SET firma_tecnico = ?, foto_salida = ? WHERE id_cedula = ?",
                                [firma_tec,foto_salida,id_cedula],
                                function(tx, results){
                                    window.location.href = "./menu.html";
                                },
                                function(tx, error){
                                    swal("Error al guardar",error.message,"error");
                                }
                            );
                        },
                        function(error){},
                        function(){}
                    );
                },
                function(tx, error){
                    swal("Error al guardar",error.message,"error");
                }
            );
        },
        function(error){},
        function(){}
    );
}
function terminarReporteServRe(){
    if($('#imagenC').val() == ""){
        swal("","La fotografia es obligatoria","warning");
        return false;
    }
    if($('#signate').val() == ""){
        swal("","La firma es obligatoria","warning");
        return false;
    }
    var id_cedula = localStorage.getItem("IdCedula");
    var foto_salida = $('#imagenC').val();
    var firma_tec = $('#signate').val();
    var fecha = new Date();
    var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
    var ubicacion_salida = $('#geolocation').val();
    var estatus = 0;
    databaseHandler.db.transaction(
        function(tx){
            tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                [fecha_salida,ubicacion_salida,estatus,id_cedula],
                function(tx, results){
                    databaseHandler.db.transaction(
                        function(tx){//firma_tecnico
                            tx.executeSql("UPDATE visita_servInd SET firma_tecnico = ?, foto_salida = ? WHERE id_cedula = ?",
                                [firma_tec,foto_salida,id_cedula],
                                function(tx, results){
                                    window.location.href = "./menu.html";
                                },
                                function(tx, error){
                                    swal("Error al guardar",error.message,"error");
                                }
                            );
                        },
                        function(error){},
                        function(){}
                    );
                },
                function(tx, error){
                    swal("Error al guardar",error.message,"error");
                }
            );
        },
        function(error){},
        function(){}
    );
}
function checkSelect(val, id){
    //console.log(val, id);
    if (val==0){//#212121
        document.getElementById(id).style.setProperty('background-color', '#fff', 'important');
        document.getElementById(id).style.setProperty('color', '#212121', 'important');
    }else if(val==1){
        document.getElementById(id).style.setProperty('background-color', '#2BEB00', 'important');
        document.getElementById(id).style.setProperty('color', '#212121', 'important');
    }else if(val==2){
        document.getElementById(id).style.setProperty('background-color', 'yellow', 'important');
        document.getElementById(id).style.setProperty('color', '#212121', 'important');
    }else if(val==3){
        document.getElementById(id).style.setProperty('background-color', 'red', 'important');
        document.getElementById(id).style.setProperty('color', 'white', 'important');
        TomaEvidencia(id);
    }else if(val==4){
        document.getElementById(id).style.setProperty('background-color', 'gray', 'important');
        document.getElementById(id).style.setProperty('color', 'white', 'important');
        TomaEvidencia(id);
    }else if(val==5){
        document.getElementById(id).style.setProperty('background-color', '#EAEAEA', 'important');
        document.getElementById(id).style.setProperty('color', '#212121', 'important');
    }
}

function TomaEvidencia(id){
    var popEvidencia = app.popup.create({
        content: `
        <div class="sheet-modal my-sheet" id="sheet-modal" name="sheet">
        <div class="toolbar">
            <div class="toolbar-inner">
                <div class="left"></div>
                <div class="right"><a class="link" id="close_sheet" href="#">Cerrar</a></div>
            </div>
        </div>
        <div class="sheet-modal-inner">
            <div class="block">
                <h3 class="FWN-titulo-2">Agregar Evidencia</h3>
                <form class="list FWM-fixing-form"> 
                    <input type="hidden" id="inputEvidencia" value=`+id+`>
                    <input type="hidden" id="pasa" value="0">
                        <span class="span FWM-span-form">Observaciones:</span>
                        <textarea class ="FWM-input" id="falla" name="falla"  cols="30" rows="10" onchange="inputLleno(this.id,this.value)"></textarea>
                            <span class="span FWM-span-form">Foto:</span>
                                <div class="FWM-photo-container">
                                    <div class="border-capture">
                                        <a onclick="capturePhoto();">
                                            <img class="FWM-photo" src="img/camera.svg" id="photoIcon" width="45px" style="margin-left: 50px;"/>
                                        </a>
                                    </div>
                                    <img class="FWM-photo-hide" id="smallImage" src=""/>
                                    <input type="hidden" id="imagenC" name="imagenC"/>
                                </div>
                                <br>
                            <div class="block grid-resizable-demo" style="margin-bottom: 70px;">
                                <div class="row align-items-stretch" style="text-align: center;">
                                    <div class="col-100 medium-50" style="min-width: 50px; border-style: none;">
                                        <span class="resize-handler"></span>
                                        <a href="#" onclick="guardarEvidencia();" style="background-color: #063E7F;" class="boton-equipo">Guardar</a>
                                    </div>
                                </div>
                            </div>
                </form>
            </div>
        </div>
    </div>`,
    swipeToClose:false,
    closeByOutsideClick:false,
    closeByBackdropClick:false,
    closeOnEscape:false,
              on: {
                open: function (popup) {

                    $('#close_sheet').click(function () {
                        if($('#pasa').val()!=0){
                            app.sheet.close('#sheet-modal');
                        }else{
                            swal({
                                title: "Aviso",
                                text: "A√∫n no agregas una evidencia, ¬øEstas seguro que deseas regresar?",
                                icon: "warning",
                                buttons: true,
                                dangerMode: false,
                            }).then((willGoBack) => {
                                if (willGoBack){
                                    app.sheet.close('#sheet-modal');
                                } else {}
                            });
                        }
                    });
                },
            }
      });
      popEvidencia.open();
}

function guardarEvidencia(){
    var id_cedula = localStorage.getItem("IdCedula");
    var foto = $("#imagenC").val();
    var observa = $("#falla").val();
    var data = $("#inputEvidencia").val().split("-");
    var pregunta = data[1];
    var fase = data[0];
    var fecha = new Date();
    var fecha_foto = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
    var select = document.getElementById($("#inputEvidencia").val());
    var name = select.getAttribute("name");
    var data = name.split("-");
    var no_pregunta=data[1];
    var id_equ = localStorage.getItem("insertId");
    if(!id_equ){id_equ=0};
    if (observa){
        if (foto){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("INSERT INTO fotos_check(id_cedula, foto, pregunta, fase,  observaciones, fecha_foto, no_pregunta,id_equipo) VALUES (?,?,?,?,?,?,?,?)",
                        [id_cedula, foto, pregunta, fase, observa, fecha_foto, no_pregunta,id_equ],
                        function(tx, results){
                            app.preloader.hide();
                            swal("","Datos guardados correctamente","success");
                            $('#pasa').val('1');
                            $('#imagenC').val("");
                            $('#falla').val("");
                            $('#falla').css("background-color", "#ffffff");
                            //app.sheet.close('#sheet-modal');
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("Select * from fotos_check where id_cedula = ? AND fase = ? ORDER BY id_foto DESC",
                                    [id_cedula, fase],
                                        function(tx, results){
                                            var item = results.rows.item(0);
                                            $("#smallImage").attr("src","img/blank.png");
                                            $("#photoIcon").attr("src","img/camera.svg");
                                            if (fase==1){
                                                $("#tabla_suministros").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase==2){
                                                $("#tabla_calentamiento").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 3){
                                                $("#tabla_electricos").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 4){
                                                $("#tabla_sensores").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 5){
                                                $("#tabla_microondas").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 6){
                                                $("#tabla_gabinete").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 7){
                                                $("#tabla_suministros").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 8){
                                                $("#tabla-refri").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 9){
                                                $("#tabla_control").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 10){
                                                $("#tabla_partes").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 11){
                                                $("#tabla_gabinete").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 12){
                                                $("#tabla_diagnostico").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 13){
                                                $("#tabla_diagnostico1").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 14){
                                                $("#tabla_diagnostico2").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 15){
                                                $("#tabla_diagnostico3").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 16){
                                                $("#tabla_diagnostico4").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 17){
                                                $("#tabla_diagnostico5").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 18){
                                                $("#tabla_diagnostico6").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 19){
                                                $("#tabla_diagnostico7").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 20){
                                                $("#tabla_diagnostico8").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 21){
                                                $("#tabla_diagnostico9").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 22){
                                                $("#tabla_hbe22").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 23){
                                                $("#tabla_hbe23").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 24){
                                                $("#tabla_hbe24").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 25){
                                                $("#tabla_hbe25").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 26){
                                                $("#tabla_hbe26").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 27){
                                                $("#tabla_hbe27").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 28){
                                                $("#tabla_hbe28").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 29){
                                                $("#tabla_hbe29").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 30){
                                                $("#tabla_hbe30").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 31){
                                                $("#tabla_hbe31").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 32){
                                                $("#tabla_hbe32").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 33){
                                                $("#tabla_hbe33").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 34){
                                                $("#tabla_hbe34").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 35){
                                                $("#tabla_hbe35").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 36){
                                                $("#tabla_hbe36").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 37){
                                                $("#tabla_hbe37").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 38){
                                                $("#tabla_hbe38").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 39){
                                                $("#tabla_hbe39").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 40){
                                                $("#tabla_hbe40").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }
                                            if (fase <= 21){
                                                $("#message-nr").css("display", "none");
                                            }else{
                                                $("#message-nr"+fase).css("display", "none");
                                            }
                                            $('.preloader').remove();
                                            $('.infinite-scroll-preloader').remove();
                                            app.preloader.hide();
                                        },
                                        function(tx, error){
                                            console.log("Error al mostrar datos cedula: " + error.message);
                                            app.preloader.hide();
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        },
                        function(tx, error){
                            app.preloader.hide();
                            swal("Error al guardar",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else{
            swal("", "Debes tomar una fotograf√≠a" ,"warning");
        }
    }else{
        swal("", "Debes colocar un comentario" ,"warning");
    }
}
function refasinstaladas(){
    var id_cedula = localStorage.getItem("IdCedula");
    var TipoVisita = localStorage.getItem("TipoVisita");
    var id_equipo = localStorage.getItem("insertId");
    var refas = '';    
    if($("#refaccion-1").prop("checked") == true){
        $("#refacciones").css("display","block")
        refas='S√≠';
    } else {
        $("#refacciones").css("display","none")
        refas='No';
    }
    if(TipoVisita=='PMP2'){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datos_eq SET refacciones = ? WHERE id_datos = ?",
                    [refas,id_equipo],
                    function(tx, results){
                    },
                    function(tx, error){
                        console.error("Error al guardar: " + error.message);
                    }
                );
            },
            function(error){
                console.error("Error al guardar: " + error.message);
            },
            function(){}
        );
    }
    else{
    databaseHandler.db.transaction(
        function(tx){
            tx.executeSql("UPDATE visita_servInd SET refacciones = ? WHERE id_cedula = ?",
                [refas,id_cedula],
                function(tx, results){
                },
                function(tx, error){
                    console.error("Error al guardar: " + error.message);
                }
            );
        },
        function(error){
            console.error("Error al guardar: " + error.message);
        },
        function(){}
    );}
}

function refasnoinstaladas(){
    var id_cedula = localStorage.getItem("IdCedula");
    var TipoVisita = localStorage.getItem("TipoVisita");
    var id_equipo = localStorage.getItem("insertId");
    var refas = '';
    if($("#refaccion-2").prop("checked") == true){
        $("#refacciones").css("display","none")
        refas = 'No';
    }
    if(TipoVisita=='PMP2'){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datos_eq SET refacciones = ? WHERE id_datos = ?",
                    [refas,id_equipo],
                    function(tx, results){
                    },
                    function(tx, error){
                        console.error("Error al guardar: " + error.message);
                    }
                );
            },
            function(error){
                console.error("Error al guardar: " + error.message);
            },
            function(){}
        );
    }else{
    databaseHandler.db.transaction(
        function(tx){
            tx.executeSql("UPDATE visita_servInd SET refacciones = ? WHERE id_cedula = ?",
                [refas,id_cedula],
                function(tx, results){
                },
                function(tx, error){
                    console.error("Error al guardar: " + error.message);
                }
            );
        },
        function(error){
            console.error("Error al guardar: " + error.message);
        },
        function(){}
    );}
}

function regresarRecorridoServInd3(){
    var tipoVisita = localStorage.getItem("TipoVisita");
    if (tipoVisita=="PMP1Rational"){
        app.views.main.router.back('/recorridoServ9/', {force: true, ignoreCache: true, reload: true});
    }else{
        app.views.main.router.back('/recorridoServ3/', {force: true, ignoreCache: true, reload: true});
    }
    
}


function selectChanged(id1,val,puntos){
    var puntos1=100/puntos;
    var punto=puntos1.toFixed(2);
    var id=id1;
    var data = $("#"+id).attr("id").split("-");
    var idtpm=data[0];
    var i=data[1];
    let total=localStorage.getItem("avanceTPM");
    var totales=parseFloat(total);
    punto=parseFloat(punto);
        if (val==1){
            $('#'+idtpm+'-'+i+'-value').text(punto+'%');
            totales=totales+puntos1;
            total=totales.toFixed();
            localStorage.setItem("avanceTPM", totales);
            $('#total').text(total+'%');
        }else if (val==0){
            $('#'+idtpm+'-'+i+'-value').text('0%');
            totales=totales-puntos1;
            total=totales.toFixed();
            localStorage.setItem("avanceTPM", totales);
            $('#total').text(total+'%');
        }

    var id_cedula = localStorage.getItem("IdCedula");
    var valor=val;
    
    databaseHandler.db.transaction(
        function(tx){
            tx.executeSql("SELECT * from tpms WHERE id_cedula = ? AND id_tpm = ? AND pregunta_tpm = ?",
            [id_cedula,idtpm,i],
                function(tx, results){
                    if(results.rows.length == 0){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("INSERT INTO tpms(id_cedula,id_tpm,valor,pregunta_tpm) VALUES (?,?,?,?)",
                                    [id_cedula,idtpm,valor,i],
                                    function(tx, results){
                                        //console.log('Inserta');
                                        //swal("", "Datos actualizados correctamente", "success");
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },function(error){},function(){}
                        );
                    } else {
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE tpms SET valor = ? WHERE id_cedula = ? AND id_tpm = ? AND pregunta_tpm = ?",
                                    [valor,id_cedula,idtpm,i],
                                    function(tx, results){
                                        //console.log('update');
                                        //swal("", "Datos actualizados correctamente", "success");
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },function(error){},function(){}
                        );
                    }
                },
                function(tx, error){
                    console.log("Error al guardar checklits: " + error.message);
                    app.preloader.hide();
                }
            );
        },
        function(error){},
        function(){}
    );
}

function guardarSuministrosServind(no_preguntas, fase){
    for(i = 1;i <= no_preguntas;i++){
        if($("#"+fase+"-"+i+"-select").val() == "0"){
            swal("", "Debes llenar todos los campos" ,"warning");
            app.preloader.hide();
            return false;
        }
    }
    
    for(i = 1;i <= no_preguntas;i++){
        if($("#"+fase+"-"+i+"-input").val() == ""){
            swal("", "Debes llenar todos los campos" ,"warning");
            app.preloader.hide();
            return false;
        }
    }

    swal("", "Datos actualizados correctamente" ,"success");

    if (fase==1){
        app.views.main.router.back('/formServ3/', {force: true, ignoreCache: true, reload: true});
    }else if (fase==2){
        app.views.main.router.back('/formServ4/', {force: true, ignoreCache: true, reload: true});
    }else if (fase==3){
        app.views.main.router.back('/formServ5/', {force: true, ignoreCache: true, reload: true});
    }else if (fase==4){
        app.views.main.router.back('/formServ6/', {force: true, ignoreCache: true, reload: true});
    }else if (fase==5){
        app.views.main.router.back('/formServ7/', {force: true, ignoreCache: true, reload: true});
    }else if (fase==6){
        app.views.main.router.back('/formServ8/', {force: true, ignoreCache: true, reload: true});
    }else if (fase==7){
        app.views.main.router.back('/formServ13/', {force: true, ignoreCache: true, reload: true});
    }else if (fase==8){
        app.views.main.router.back('/formServ14/', {force: true, ignoreCache: true, reload: true});
    }else if (fase==9){
        app.views.main.router.back('/formServ15/', {force: true, ignoreCache: true, reload: true});
    }else if (fase==10){
        app.views.main.router.back('/formServ17/', {force: true, ignoreCache: true, reload: true});
    }else if (fase==11){
        app.views.main.router.back('/formServ18/', {force: true, ignoreCache: true, reload: true});
    }else if (fase==12){
        app.views.main.router.back('/formServ22/', {force: true, ignoreCache: true, reload: true});
    }else if (fase==13){
        app.views.main.router.back('/formServ23/', {force: true, ignoreCache: true, reload: true});
    }else if (fase==14){
        app.views.main.router.back('/formServ24/', {force: true, ignoreCache: true, reload: true});
    }else if (fase==15){
        app.views.main.router.back('/formServ25/', {force: true, ignoreCache: true, reload: true});
    }else if (fase==16){
        app.views.main.router.back('/formServ26/', {force: true, ignoreCache: true, reload: true});
    }else if (fase==17){
        app.views.main.router.back('/formServ27/', {force: true, ignoreCache: true, reload: true});
    }else if (fase==18){
        app.views.main.router.back('/formServ28/', {force: true, ignoreCache: true, reload: true});
    }else if (fase==19){
        app.views.main.router.back('/formServ29/', {force: true, ignoreCache: true, reload: true});
    }else if (fase==20){
        app.views.main.router.back('/formServ30/', {force: true, ignoreCache: true, reload: true});
    }else if (fase==21){
        app.views.main.router.back('/formServ31/', {force: true, ignoreCache: true, reload: true});
    }
}
function guardarSelectServ(ids){
    var id_cedula = localStorage.getItem("IdCedula");
    var data = $("#"+ids).attr("id").split("-");
    var fase=data[0];
    var id=data[1];
    var tipo = data[2];
    if(tipo == 'check'){
        var valor =   $("#" + ids).prop('checked')
      }else{
          var valor = $("#" + ids).val();  
      }
    if (tipo == 'select') {
        var select = document.getElementById(ids);
        var name = select.getAttribute("name");
        var data = name.split("-");
        var no_pregunta=data[1];
    }else{
        no_pregunta = '0';
    }
    var id_equ = localStorage.getItem("insertId");
    if(!id_equ){ id_equ = 0};
    //console.log(data[0],data[1],$("#"+ids).val(),data[2]);
    databaseHandler.db.transaction(
        function(tx){
            tx.executeSql("SELECT * from checklist_servind WHERE id_cedula = ? AND fase = ? AND pregunta = ? AND id_equipo = ? and tipo = ?",
            [id_cedula,fase,id,id_equ,tipo],
                function(tx, results){
                    var item = results.rows.item(0);
                    //console.log(item);
                    if(results.rows.length == 0){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("INSERT INTO checklist_servind(id_cedula,fase,pregunta,valor,tipo,no_pregunta,id_equipo) VALUES (?,?,?,?,?,?,?)",
                                    [id_cedula,fase,id,valor,tipo,no_pregunta,id_equ],
                                    function(tx, results){
                                        //console.log('Inserta');
                                        //swal("", "Datos actualizados correctamente", "success");
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },function(error){},function(){
                            }
                        );
                    } else {
                        
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE checklist_servind SET tipo = ?, valor = ?, id_equipo=? WHERE id_cedula = ? AND fase = ? AND pregunta = ? AND no_pregunta = ?",
                                    [tipo,valor,id_equ,id_cedula,fase,id,no_pregunta],
                                    function(tx, results){
                                        //console.log('update');
                                        //swal("", "Datos actualizados correctamente", "success");
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },function(error){},function(){}
                        );
                    }
                },
                function(tx, error){
                    console.log("Error al guardar checklits: " + error.message);
                    app.preloader.hide();
                }
            );
        },
        function(error){},
        function(){}
    );
}
function Sidiagnostico(){
    var id_cedula = localStorage.getItem("IdCedula");
    var correcto = '';
    if($("#diagnostico-1").prop("checked") == true){
       
        correcto='S√≠';
    } else {
       
        correcto='No';
    }

    databaseHandler.db.transaction(
        function(tx){
            tx.executeSql("UPDATE visita_servInd SET diagnotico_corecto = ? WHERE id_cedula = ?",
                [correcto,id_cedula],
                function(tx, results){
                },
                function(tx, error){
                    console.error("Error al guardar: " + error.message);
                }
            );
        },
        function(error){
            console.error("Error al guardar: " + error.message);
        },
        function(){}
    );
}

function Nodiagnostico(){
    var id_cedula = localStorage.getItem("IdCedula");
    var correcto = '';
    if($("#diagnostico-2").prop("checked") == true){
        correcto = 'No';
    }
    databaseHandler.db.transaction(
        function(tx){
            tx.executeSql("UPDATE visita_servInd SET diagnotico_corecto = ? WHERE id_cedula = ?",
                [correcto,id_cedula],
                function(tx, results){
                },
                function(tx, error){
                    console.error("Error al guardar: " + error.message);
                }
            );
        },
        function(error){
            console.error("Error al guardar: " + error.message);
        },
        function(){}
    );
}

function guardarEntregaServicio(){
    var id_cedula = localStorage.getItem("IdCedula");
    var id_equ = localStorage.getItem("insertId");
    var tipoVisita = localStorage.getItem("TipoVisita");
    var comenta = $('#comentarios').val();
    var trabajo = $('#trabajo').val();
    var entrega = $('#entrega_equipo').val();
    if(!id_equ){ id_equ = 0};    
    if (comenta && trabajo){
        if ($("#diagnostico-1").prop("checked") == false && $("#diagnostico-2").prop("checked") == false){
            swal("", "Favor de contestar la pregunta del di√°gnostico" , "warning");
            return false;
            }
        if (entrega==0){
            swal("", "Selecciona como se entrego el equipo" , "warning");
            return false;
        }
        if(tipoVisita == 'PMP2'){
            console.log('pmp');
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE datos_eq SET comentarios_entrega = ?, trabajo_realizado = ?, como_entrego = ? WHERE id_datos = ?",
                        [comenta, trabajo, entrega ,id_equ],
                        function(tx, results){
                            swal("","Guardado correctamente","success");
                            $('#comentarios').css("background-color", "#ffffff");
                            $('#trabajo').css("background-color", "#ffffff");
                            $('#entrega_equipo').css("background-color", "#ffffff");
                            app.views.main.router.back('/formServ39/', {force: true, ignoreCache: true, reload: true});
                        },
                        function(tx, error){
                            console.error("Error al guardar entrega: " + error.message);
                        }
                    );
                },
                function(error){
                    console.error("Error al guardar entrega: " + error.message);
                },
                function(){}
            );
        }else{
            console.log('no pmp');
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE visita_servInd SET comentarios_entrega = ?, trabajo_realizado = ?, como_entrego = ? WHERE id_cedula = ?",
                        [comenta, trabajo, entrega ,id_cedula],
                        function(tx, results){
                            swal("","Guardado correctamente","success");
                            $('#comentarios').css("background-color", "#ffffff");
                            $('#trabajo').css("background-color", "#ffffff");
                            $('#entrega_equipo').css("background-color", "#ffffff");
                            app.views.main.router.back('/formServ19/', {force: true, ignoreCache: true, reload: true});
                        },
                        function(tx, error){
                            console.error("Error al guardar entrega: " + error.message);
                        }
                    );
                },
                function(error){
                    console.error("Error al guardar entrega: " + error.message);
                },
                function(){}
            );
        }
    }else{
        swal("", "Escribe un comentario y el trabajo realizado" , "warning");
    }
}

function guardarEntregaServicio2(){
    var id_cedula = localStorage.getItem("IdCedula");
    var id_equ = localStorage.getItem("insertId");
    var tipoVisita = localStorage.getItem("TipoVisita");
    var comenta = $('#comentarios').val();
    var trabajo = $('#trabajo').val();
    var entrega = $('#entrega_equipo').val();
    if(!id_equ){ id_equ = 0};
    if (comenta && trabajo){
        if ($("#diagnostico-1").prop("checked") == false && $("#diagnostico-2").prop("checked") == false){
            swal("", "Favor de contestar la pregunta del di√°gnostico" , "warning");
            return false;
            }
        if (entrega==0){
            swal("", "Selecciona como se entrego el equipo" , "warning");
            return false;
        }
        if(tipoVisita == 'PMP2'){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE datos_eq SET comentarios_entrega = ?, trabajo_realizado = ?, como_entrego = ? WHERE id_datos = ?",
                        [comenta, trabajo, entrega ,id_equ],
                        function(tx, results){
                            swal("","Guardado correctamente","success");
                            $('#comentarios').css("background-color", "#ffffff");
                            $('#trabajo').css("background-color", "#ffffff");
                            $('#entrega_equipo').css("background-color", "#ffffff");
                            app.views.main.router.back('/formServ38/', {force: true, ignoreCache: true, reload: true});
                        },
                        function(tx, error){
                            console.error("Error al guardar entrega: " + error.message);
                        }
                    );
                },
                function(error){
                    console.error("Error al guardar entrega: " + error.message);
                },
                function(){}
            );
        }else{
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE visita_servInd SET comentarios_entrega = ?, trabajo_realizado = ?, como_entrego = ? WHERE id_cedula = ?",
                        [comenta, trabajo, entrega ,id_cedula],
                        function(tx, results){
                            swal("","Guardado correctamente","success");
                            $('#comentarios').css("background-color", "#ffffff");
                            $('#trabajo').css("background-color", "#ffffff");
                            $('#entrega_equipo').css("background-color", "#ffffff");
                            app.views.main.router.back('/formServ9/', {force: true, ignoreCache: true, reload: true});
                        },
                        function(tx, error){
                            console.error("Error al guardar entrega: " + error.message);
                        }
                    );
                },
                function(error){
                    console.error("Error al guardar entrega: " + error.message);
                },
                function(){}
            );
        }
    }else{
        swal("", "Escribe un comentario y el trabajo realizado" , "warning");
    }
}

function guardarPapeletaServ(){
    var id_equ = localStorage.getItem("insertId");
    if(!id_equ){ id_equ = 0};
    var id_cedula = localStorage.getItem("IdCedula");
    var noParteC = $('#numero_parteC').val();
    var descripcionC = $('#descripcionC').val();
    var prioridadC = $('#prioridadC').val();
    var cantidadC = $('#cantidadC').val();
    var foto = $("#imagenC").val();
    var motivo_pr = $("#motivo_pr").val();
    var fecha = new Date();
    var fecha_reg = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();

    if(noParteC && descripcionC && motivo_pr){
        if (prioridadC == 0){
            swal("", "Selecciona una prioridad" , "warning");
            return false;
        }else{
            if (cantidadC){
                if (foto){
                    databaseHandler.db.transaction(
                        function(tx){//id_cedula, foto_papeleta, numero_parte, descripcion, prioridad, cantidad, fecha_registro
                            tx.executeSql("INSERT INTO papeleta(id_cedula, foto_papeleta, numero_parte, descripcion, prioridad, cantidad, fecha_registro, motivo_pr, id_equipo) VALUES (?,?,?,?,?,?,?,?,?)",
                                [id_cedula, foto, noParteC, descripcionC, prioridadC, cantidadC, fecha_reg, motivo_pr, id_equ],
                                function(tx, results){
                                    app.preloader.hide();
                                    swal("","Datos guardados correctamente","success");
                                    $("#numero_parteC").val('');
                                    $('#numero_parteC').css("background-color", "#ffffff");
                                    $("#descripcionC").val('');
                                    $('#descripcionC').css("background-color", "#ffffff");
                                    $("#prioridadC").val(0);
                                    $("#cantidadC").val('');
                                    $('#cantidadC').css("background-color", "#ffffff");
                                    $("#motivo_pr").val();
                                    $("#motivo_pr").css("background-color", "#ffffff");
                                    $("imagenC").val('');
                                    $("#smallImage").attr("src","img/blank.png");
                                    $("#photoIcon").attr("src","img/camera.svg");
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("Select * from papeleta where id_cedula = ? ORDER BY id_papeleta DESC",
                                            [id_cedula],
                                                function(tx, results){
                                                    var item = results.rows.item(0);
                                                    $("#table_papeleta").append("<tr id='fila"+ item.id_papeleta +
                                                    "'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ 
                                                    item.id_papeleta +",3);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+
                                                    item.foto_papeleta+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + 
                                                    item.numero_parte + "</td><td style='text-align: center;'>" + 
                                                     item.descripcion + "</td><td style='text-align: center;'>" + 
                                                     item.prioridad + "</td><td style='text-align: center;'>" + 
                                                     item.motivo_pr + "</td><td style='text-align: center;'>" + 
                                                     item.cantidad + "</td></tr>");
                                                    $("#message-nr").css("display", "none");
                                                    $('.preloader').remove();
                                                    $('.infinite-scroll-preloader').remove();
                                                    app.preloader.hide();
                                                },
                                                function(tx, error){
                                                    console.log("Error al guardar cedula: " + error.message);
                                                    app.preloader.hide();
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                },
                                function(tx, error){
                                    app.preloader.hide();
                                    swal("Error al guardar",error.message,"error");
                                }
                            );
                        },
                        function(error){},
                        function(){}
                    );
                }else{
                    swal("", "Favor de tomar una fotograf√≠a" , "warning");
                    return false;
                }
            }else{
                swal("", "Ingresa una Cantidad" , "warning");
                return false;
            }
        }
    }else{
        swal("", "Todos los datos son requeridos" , "warning");
    }
}

function guardarRefasServ(){
    var id_cedula = localStorage.getItem("IdCedula");
    var id_equ = localStorage.getItem("insertId");
    if(!id_equ){ id_equ = 0};
    var noParte = $('#numero_parte').val();
    var descripcion = $('#descripcion').val();
    var parte = $('#parte').val();
    var foto_r = $("#imagenC1").val();
    var fecha = new Date();
    var fecha_reg = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();

    if(noParte && descripcion && parte){
        if (foto_r){
            databaseHandler.db.transaction(
                function(tx){//id_refaccion, id_cedula, foto_refa, numero_parte, descripcion, parte, fecha_registro
                    tx.executeSql("INSERT INTO refacciones(id_cedula, foto_refa, numero_parte, descripcion, parte, fecha_registro, id_equipo) VALUES (?,?,?,?,?,?,?)",
                        [id_cedula, foto_r, noParte, descripcion, parte, fecha_reg, id_equ],
                        function(tx, results){
                            app.preloader.hide();
                            swal("","Datos guardados correctamente","success");
                            $("#numero_parte").val('');
                            $('#numero_parte').css("background-color", "#ffffff");
                            $("#descripcion").val('');
                            $('#descripcion').css("background-color", "#ffffff");
                            $("#parte").val('');
                            $('#parte').css("background-color", "#ffffff");
                            $("imagenC1").val('');
                            $("#smallImage1").attr("src","img/blank.png");
                            $("#photoIcon1").attr("src","img/camera.svg");
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("Select * from refacciones where id_cedula = ? ORDER BY id_refaccion DESC",
                                    [id_cedula],
                                        function(tx, results){
                                            var item = results.rows.item(0);
                                            $("#tabla_refacciones").append("<tr id='fila"+ item.id_refaccion +
                                            "'><td><a href='#' onclick='eliminarFilaServ("+ 
                                            item.id_refaccion +",4);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+
                                            item.foto_refa +"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + 
                                            item.numero_parte + "</td><td style='text-align: center;'>" + 
                                             item.descripcion + "</td><td style='text-align: center;'>" + 
                                             item.parte + "</td></tr>");
                                            $("#message-nr1").css("display", "none");
                                            $('.preloader').remove();
                                            $('.infinite-scroll-preloader').remove();
                                            app.preloader.hide();
                                        },
                                        function(tx, error){
                                            console.log("Error al guardar cedula: " + error.message);
                                            app.preloader.hide();
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        },
                        function(tx, error){
                            app.preloader.hide();
                            swal("Error al guardar",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );

        }else{
            swal("", "Favor de tomar una fotograf√≠a" , "warning");
            return false;
        }
    }else{
        swal("", "Todos los datos son requeridos" , "warning");
    }
}

function guardarCotiza(){
    var tipoVisita = localStorage.getItem("TipoVisita");
    var id_cedula = localStorage.getItem("IdCedula");
    var horasT = $('#cantidadTotal').val();
    if (tipoVisita=='PMP2'){
        console.log('PMP2');
        app.views.main.router.back('/formServ36/', {force: true, ignoreCache: true, reload: true});
    }else{
        console.log('No es PMP2');
        if (horasT==0){
            swal({
                title: "Aviso",
                text: "Tus horas totales estan en '0', ¬øEstas seguro que deseas continuar?",
                icon: "warning",
                buttons: true,
                dangerMode: false,
            })
            .then((willGoBack) => {
                app.views.main.router.back('/cierreServInd2/', {force: true, ignoreCache: true, reload: true});
            });
        }else{
            //H_viaje, H_espera, H_trabajo, H_totales
            var H_viaje=$('#cantidadViaje').val()
            var H_espera=$('#cantidadEspera').val()
            var H_trabajo=$('#cantidadTrabajo').val()
            var H_totales=$('#cantidadTotal').val()
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE visita_servInd SET H_viaje = ?, H_espera = ?, H_trabajo = ?, H_totales = ? WHERE id_cedula = ?",
                        [H_viaje, H_espera, H_trabajo, H_totales, id_cedula],
                        function(tx, results){
                            swal("","Guardado correctamente","success");
                            $('#cantidadViaje').css("background-color", "#ffffff");
                            $('#cantidadEspera').css("background-color", "#ffffff");
                            $('#cantidadTrabajo').css("background-color", "#ffffff");
                            $('#cantidadTotal').css("background-color", "#ffffff");
                                app.views.main.router.back('/cierreServInd2/', {force: true, ignoreCache: true, reload: true});
                        },
                        function(tx, error){
                            console.error("Error al guardar entrega: " + error.message);
                        }
                    );
                },
                function(error){
                    console.error("Error al guardar entrega: " + error.message);
                },
                function(){}
            );
        }
    }
}

function Sumahoras(){
    var totalH = 0;
    var cantidadViaje = 0;
    var cantidadEspera = 0;
    var cantidadTrabajo = 0;
    if ($('#cantidadViaje').val()==''){
        cantidadViaje = 0
    }else{
        cantidadViaje = parseFloat($('#cantidadViaje').val());
    }
    if ($('#cantidadEspera').val()==''){
        cantidadEspera = 0
    }else{
        cantidadEspera = parseFloat($('#cantidadEspera').val());
    }
    if ($('#cantidadTrabajo').val()==''){
        cantidadTrabajo = 0
    }else{
        cantidadTrabajo = parseFloat($('#cantidadTrabajo').val());
    }

    totalH = (cantidadViaje+cantidadEspera+cantidadTrabajo);
    totalH = parseFloat(totalH);
    //console.log(totalH);
    
    $('#cantidadTotal').val(totalH);
}
function capturePhoto1() {
    var camera = localStorage.getItem("camera");
    if(camera == 0){
        var camera = app.popup.create({
            content: `
                <div class="popup" id="camera">
                    <div class="app">
                    <div id="deviceready">
                        <div class="top"></div>
                        <canvas class="raster" id="fullsize"></canvas>
                        <div class="camera">
                            <div class="take" id="take" onClick="onTake()">
                                <div class="bubble-take"></div>
                            </div>
                            <div class="select popup-close" id="select" style="display: none;" onClick="onDone()"><img id="img-select" src="img/validar_camera.svg"></div>
                        </div>
                        <div class="left-action">
                            <div class="switch" id="switch" onClick="onSwitch()"><img class="image-switch" src="img/flip.svg"></div>
                            <div class="cancel" id="cancel" style="display: none;" onClick="onCancel()"><img class="image-cancel" src="img/cerrar_camera.svg"></div>
                        </div>
                        <div class="actions">
                            <div class="action torch" id="torch" onClick="onTorch()"><img id="flash" src="img/flash_off.svg" width="30px"></div>
                            <div class="action torch" id="rotateRight" onClick="onRotateRight()" style="display:none"><img id="flash" src="img/rotate-right.svg" width="30px"></div>
                            <div class="action torch" id="rotateLeft" onClick="onRotateLeft()" style="display:none"><img id="flash" src="img/rotate-left.svg" width="30px"></div>
                        </div>
                        <audio id="audio" controls style="display: none;">
                            <source type="audio/mp3" src="img/camera.mp3">
                        </audio>
                        <input type="hidden" id="deviceOrientation" name="deviceOrientation"/>
                    </div>
                    </div>
                </div>
            `,
            on: {
                open: function (popup) {
                cargarEmpresa(`./js/camera-field.js`, empresaCargada());
                function empresaCargada(){
                    // console.log(`camera-field.js ya ha sido cargado`);
                    setTimeout(()=>{receivedEvent(onPhotoDataSuccess1)},150);
                }
                function cargarEmpresa(url, callback){
                    var pie = document.getElementsByTagName('fwm')[0];
                    var script = document.createElement('script');
                    script.type = 'text/javascript';
                    script.src = url;
                    script.onreadystatechange = callback;
                    script.onload = callback;
                    pie.appendChild(script);
                }
                },
                opened: function (popup) {},
            }
        });
        camera.open();
    } else {
        navigator.camera.getPicture(onPhotoDataSuccess1, onFail, {
            quality: 100,
            destinationType: destinationType.DATA_URL,
            targetWidth: 500,
            targetHeight: 500,
            correctOrientation: true
        });
    }
}
function guardaEncuesta(){
    var fecha = new Date();
    var fecha_encuesta = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
    var id_cedula = localStorage.getItem("IdCedula");
    var recomienda=0;
    var RCcarita = 0;
    var CCcarita = 0;
    var ACcarita = 0;
    var SCcarita = 0;

    for(i = 1;i <= 10; i++){
        if($("#rat"+i).prop("checked") == true){
            recomienda=i;
        }
    }
    for(i = 1;i <= 10; i++){
        if($("#RCcarita"+i).prop("checked") == true){
            RCcarita=i;
        }
    }
    for(i = 1;i <= 10; i++){
        if($("#CCcarita"+i).prop("checked") == true){
            CCcarita=i;
        }
    }

    for(i = 1;i <= 10; i++){
        if($("#ACcarita"+i).prop("checked") == true){
            ACcarita=i;
        }
    }

    for(i = 1;i <= 10; i++){
        if($("#SCcarita"+i).prop("checked") == true){
            SCcarita=i;
        }
    }

    if (recomienda==0 || RCcarita==0 || CCcarita==0 || ACcarita==0 || SCcarita==0){
        //console.log("no");
        app.dialog.alert('Debes colocar una calificaci√≥n en todos', 'Aviso');
    }else{
        app.preloader.show('blue');
        //console.log(recomienda,RCcarita, CCcarita, ACcarita, SCcarita);
        productHandler.encuestaservInd(id_cedula, recomienda,RCcarita,CCcarita,ACcarita,SCcarita,fecha_encuesta);
        app.preloader.hide();
        app.dialog.alert('Encuesta guardada', 'Confirmaci√≥n');
        $("#encuesta").css("display", "none");
        $("#realizada").css("display", "block");
        $("#btnEncuesta").css("display", "none");
        $("#btnQR").css("display", "none");
        app.sheet.close('#SheetEncuesta');
    }
}
function guardarEntregaServicioF(){
    var id_cedula = localStorage.getItem("IdCedula");
    var comenta = $('#comentarios').val();
    var trabajo = $('#trabajo').val();
    var entrega = $('#entrega_equipo').val();        
    if (comenta && trabajo){
        if ($("#diagnostico-1").prop("checked") == false && $("#diagnostico-2").prop("checked") == false){
            swal("", "Favor de contestar la pregunta del di√°gnostico" , "warning");
            return false;
            }
        if (entrega==0){
            swal("", "Selecciona como se entrego el equipo" , "warning");
            return false;
        }
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE visita_servInd SET comentarios_entrega = ?, trabajo_realizado = ?, como_entrego = ? WHERE id_cedula = ?",
                    [comenta, trabajo, entrega ,id_cedula],
                    function(tx, results){
                        swal("","Guardado correctamente","success");
                        $('#comentarios').css("background-color", "#ffffff");
                        $('#trabajo').css("background-color", "#ffffff");
                        $('#entrega_equipo').css("background-color", "#ffffff");
                        app.views.main.router.back('/formServ19/', {force: true, ignoreCache: true, reload: true});
                    },
                    function(tx, error){
                        console.error("Error al guardar entrega: " + error.message);
                    }
                );
            },
            function(error){
                console.error("Error al guardar entrega: " + error.message);
            },
            function(){}
        );
    }else{
        swal("", "Escribe un comentario y el trabajo realizado" , "warning");
    }
}
function guardarEntregaServicioR(){
    var id_cedula = localStorage.getItem("IdCedula");
    var comenta = $('#comentarios').val();
    var trabajo = $('#trabajo').val();
    var entrega = $('#entrega_equipo').val();        
    if (comenta && trabajo){
        if ($("#diagnostico-1").prop("checked") == false && $("#diagnostico-2").prop("checked") == false){
            swal("", "Favor de contestar la pregunta del di√°gnostico" , "warning");
            return false;
            }
        if (entrega==0){
            swal("", "Selecciona como se entrego el equipo" , "warning");
            return false;
        }
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE visita_servInd SET comentarios_entrega = ?, trabajo_realizado = ?, como_entrego = ? WHERE id_cedula = ?",
                    [comenta, trabajo, entrega ,id_cedula],
                    function(tx, results){
                        swal("","Guardado correctamente","success");
                        $('#comentarios').css("background-color", "#ffffff");
                        $('#trabajo').css("background-color", "#ffffff");
                        $('#entrega_equipo').css("background-color", "#ffffff");
                        app.views.main.router.back('/formServ32/', {force: true, ignoreCache: true, reload: true});
                    },
                    function(tx, error){
                        console.error("Error al guardar entrega: " + error.message);
                    }
                );
            },
            function(error){
                console.error("Error al guardar entrega: " + error.message);
            },
            function(){}
        );
    }else{
        swal("", "Escribe un comentario y el trabajo realizado" , "warning");
    }
}
function guardarCotiza1(){
    var id_cedula = localStorage.getItem("IdCedula");
    var tipoVisita = localStorage.getItem("TipoVisita");
    var horasT = $('#cantidadTotal').val();
    if (horasT==0){
        swal({
            title: "Aviso",
            text: "Tus horas totales estan en '0', ¬øEstas seguro que deseas continuar?",
            icon: "warning",
            buttons: true,
            dangerMode: false,
        })
        .then((willGoBack) => {
            if (willGoBack){
                if (tipoVisita=='PMP2'){
                    app.views.main.router.back('/formServ35/', {force: true, ignoreCache: true, reload: true});
                }else{
                    app.views.main.router.back('/cierreServInd1/', {force: true, ignoreCache: true, reload: true});
                }
            } else {}
        });
    }else{
        //H_viaje, H_espera, H_trabajo, H_totales
        var H_viaje=$('#cantidadViaje').val()
        var H_espera=$('#cantidadEspera').val()
        var H_trabajo=$('#cantidadTrabajo').val()
        var H_totales=$('#cantidadTotal').val()
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE visita_servInd SET H_viaje = ?, H_espera = ?, H_trabajo = ?, H_totales = ? WHERE id_cedula = ?",
                    [H_viaje, H_espera, H_trabajo, H_totales, id_cedula],
                    function(tx, results){
                        swal("","Guardado correctamente","success");
                        $('#cantidadViaje').css("background-color", "#ffffff");
                        $('#cantidadEspera').css("background-color", "#ffffff");
                        $('#cantidadTrabajo').css("background-color", "#ffffff");
                        $('#cantidadTotal').css("background-color", "#ffffff");
                        if (tipoVisita=='PMP2'){
                            app.views.main.router.back('/formServ35/', {force: true, ignoreCache: true, reload: true});
                        }else{
                            app.views.main.router.back('/cierreServInd1/', {force: true, ignoreCache: true, reload: true});
                        }
                    },
                    function(tx, error){
                        console.error("Error al guardar entrega: " + error.message);
                    }
                );
            },
            function(error){
                console.error("Error al guardar entrega: " + error.message);
            },
            function(){}
        );
    }
}
function guardarCotiza2(){
    var id_cedula = localStorage.getItem("IdCedula");
    var horasT = $('#cantidadTotal').val();
    if (horasT==0){
        swal({
            title: "Aviso",
            text: "Tus horas totales estan en '0', ¬øEstas seguro que deseas continuar?",
            icon: "warning",
            buttons: true,
            dangerMode: false,
        })
        .then((willGoBack) => {
            if (willGoBack){
                app.views.main.router.back('/cierreServInd3/', {force: true, ignoreCache: true, reload: true});
            } else {}
        });
    }else{
        //H_viaje, H_espera, H_trabajo, H_totales
        var H_viaje=$('#cantidadViaje').val()
        var H_espera=$('#cantidadEspera').val()
        var H_trabajo=$('#cantidadTrabajo').val()
        var H_totales=$('#cantidadTotal').val()
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE visita_servInd SET H_viaje = ?, H_espera = ?, H_trabajo = ?, H_totales = ? WHERE id_cedula = ?",
                    [H_viaje, H_espera, H_trabajo, H_totales, id_cedula],
                    function(tx, results){
                        swal("","Guardado correctamente","success");
                        $('#cantidadViaje').css("background-color", "#ffffff");
                        $('#cantidadEspera').css("background-color", "#ffffff");
                        $('#cantidadTrabajo').css("background-color", "#ffffff");
                        $('#cantidadTotal').css("background-color", "#ffffff");
                        app.views.main.router.back('/cierreServInd3/', {force: true, ignoreCache: true, reload: true});
                    },
                    function(tx, error){
                        console.error("Error al guardar entrega: " + error.message);
                    }
                );
            },
            function(error){
                console.error("Error al guardar entrega: " + error.message);
            },
            function(){}
        );
    }
}
function guardarDiagnosticoServRe(){
    var id_cedula = localStorage.getItem("IdCedula");
    var foto = $("#imagenC").val();
    var falla = $('#falla').val();
    var como = $( "select#Como-select option:checked" ).val();
    var sw = $('#sw').val();
    if($("#viaticos-1").prop("checked")){
        var usb1 = 1;
    }else{
        var usb1 = 0;
    }
    if($("#viaticos-2").prop("checked")){
        var usb2 = 1;
    }else{
        var usb2 = 0;
    }
    if (falla && como && sw ){
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql("select count(*) as Cuenta from diagnostico_servInd WHERE id_cedula = ?",
                    [id_cedula],
                    function (tx, results) {
                        var item = results.rows.item(0);
                        console.log(item);
                        if (item.Cuenta == 0) {
                            tx.executeSql("insert into diagnostico_servInd(id_cedula,falla_en, diagnostico , sw , usbInfo,usbHa  ) values(?,?,?,?,?,?)",
                                [id_cedula,falla,como,sw,usb1,usb2],
                                function (tx, results) {
                                    var item = results.rows.item(0);
                                    swal("", "Se guardaron los datos correctamente", "success");
                                },
                                function (tx, error) {
                                    console.error("Error al registrar Resultado: " + error.message);
                                }
                            );
    
                        } else {
                            tx.executeSql("UPDATE diagnostico_servInd  SET   falla_en  = ? ,diagnostico = ?, sw = ? , usbInfo  = ? , usbHa = ? WHERE id_cedula = ?",
                                [falla,como,sw,usb1,usb2,id_cedula],
                                function (tx, results) {
                                    var item = results.rows.item(0);
                                    swal("", "Se actualizaron los datos correctamente", "success");
                                },
                                function (tx, error) {
                                    console.error("Error al registrar Resultado: " + error.message);
                                }
                            );
                        }  
                        $('#falla').css("background-color", "#ffffff");
                        $('#sw').css("background-color", "#ffffff");
                        $('#Como-select').css("background-color", "#ffffff");
                        app.preloader.hide();
                    },
                    function (tx, error) {
                        swal("Error al guardar", error.message, "error");
                        app.preloader.hide();
                    }
                );
            },
            function (error) { },
            function () { }
        );
    }else{
        swal("", "Todos los campos son requeridos" ,"warning");
    }
}
function equipoPMPCI(){
    /*console.log(results.insertId);
    localStorage.setItem("insertId", results.insertId); */
    var id_cedula=localStorage.getItem("IdCedula");
    var equipoPMP = $("#equipoPMP").val();
    if (equipoPMP==2){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO datos_eq(id_cedula, fase) VALUES (?,?)",
                    [id_cedula,equipoPMP],
                    function(tx, results){
                        app.preloader.hide();
                        console.log(results.insertId);
                        localStorage.setItem("insertId", results.insertId);
                       // swal("","Datos guardados correctamente","success"); 
                       app.views.main.router.back('/recorridoServ10/', {force: true, reload: true});
                    },
                    function(tx, error){
                        app.preloader.hide();
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }else if (equipoPMP==1){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO datos_eq(id_cedula, fase) VALUES (?,?)",
                    [id_cedula,equipoPMP],
                    function(tx, results){
                        app.preloader.hide();
                        console.log(results.insertId);
                        localStorage.setItem("insertId", results.insertId);
                       // swal("","Datos guardados correctamente","success"); 
                       app.views.main.router.back('/recorridoServ11/', {force: true, reload: true});
                    },
                    function(tx, error){
                        app.preloader.hide();
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }   
}
function guardarDatosPMP(){
    //console.log("guardardatso");
    var id_cedula = localStorage.getItem("IdCedula");
   var orden=$('#orden').val();
   var fecha=$('#fecha').val();
   var id_cliente=1;
   var cliente=$('#cliente').val();
   var suc_cliente=$('#suc_cliente').val();
   var direccion=$('#direccion').val();
   var ciudad=$('#ciudad').val();
   var telefono=$('#telefono').val();
   var correo=$('#correo').val();

    if (orden && fecha && id_cliente && cliente && suc_cliente && direccion && ciudad && telefono && correo){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datos_generales_serv SET no_orden = ?, fecha = ?, id_cliente = ?, cliente = ?, sucursal_cliente = ?, direccion = ?, ciudad = ?, telefono = ?, correo = ? WHERE id_cedula = ?",
                    [orden, fecha, id_cliente, cliente, suc_cliente, direccion, ciudad, telefono, correo ,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET nombre_cliente = ? WHERE id_cedula = ?",
                                    [cliente ,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        $('#orden').css("background-color", "#ffffff");
                                        $('#fecha').css("background-color", "#ffffff");
                                        $('#cliente').css("background-color", "#ffffff");
                                        $('#suc_cliente').css("background-color", "#ffffff");
                                        $('#direccion').css("background-color", "#ffffff");
                                        $('#ciudad').css("background-color", "#ffffff");
                                        $('#telefono').css("background-color", "#ffffff");
                                        $('#correo').css("background-color", "#ffffff");
                                        $('#tipo_servicio').css("background-color", "#ffffff");
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar datos generales: " + error.message);
                                    }
                                );
                            },
                            function(error){
                                console.error("Error al guardar datos generales: " + error.message);
                            },
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar datos generales: " + error.message);
                    }
                );
            },
            function(error){
                console.error("Error al guardar datos generales: " + error.message);
            },
            function(){}
        );
    }else{
            swal("", "Todos los campos son requeridos" ,"warning");
    }    
}
function guardarDiagnosticoPMP(){
    var id_cedula = localStorage.getItem("IdCedula");
    var foto = $("#imagenC").val();
    var fase='diagnosticoPMP';
    var fecha = new Date();
    var fecha_registro = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
    var comentario_cliente = $('#comentario_cliente').val();
    if($("#viaticos-1").prop("checked")){
        var funcionamiento = 1;
    }
    if($("#viaticos-2").prop("checked")){
        var funcionamiento = 0;
    }

    if (funcionamiento && foto && comentario_cliente){//id_cedula integer, foto blob, pregunta text, fase text, observaciones text, fecha_foto text, no_pregunta
        tx.executeSql("insert into fotos_check(id_cedula,foto, fase, fecha_foto) values(?,?,?,?)",
            [id_cedula,foto,fase,fecha_registro],
            function (tx, results) {
                $("#imagenC").val("");
                $("#smallImage").attr('src', 'img/blank.png');
                $("#photoIcon").attr("src", "img/camera.svg");
                swal("", "Se guardaron los datos correctamente", "success");
            },
            function (tx, error) {
                console.error("Error al registrar Resultado: " + error.message);
            }
        );
    }else{
        swal("", "Todos los campos son requeridos" ,"warning");
    }
}
function generarPMP1Caliente(){
    /*
    let id_visita = localStorage.getItem("id_visita");
    let nombre_comercial = localStorage.getItem("nombre_comercial");
    let ciudad = localStorage.getItem("store");
    let direccion = localStorage.getItem("direccion");
    let telefono = localStorage.getItem("telefono");
    let correo = localStorage.getItem("correo");
    let equipo = localStorage.getItem("equipo");
    let marca = localStorage.getItem("marca");
    let modelo = localStorage.getItem("modelo");
    let serie = localStorage.getItem("serie");*/
    let id_cedula = localStorage.getItem("IdCedula");
    let nombre_cliente = localStorage.getItem("nombreCliente");
    let foto_llegada = localStorage.getItem("foto_llegada");
    let sucursal = localStorage.getItem("sucursal");
    let orden_servicio = localStorage.getItem("order_number");
    var fecha = new Date();
    var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
    let tipoCedula = "PMP_Caliente";
    let tipoCedulas = "PMP1Caliente";
    databaseHandler.db.transaction(
        function(tx){
            tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                [tipoCedula,id_cedula],
                function(tx, results){
                    productHandler.addVisitaServ(id_cedula);
                    productHandler.addreporteCaliente(id_cedula, orden_servicio, fecha_llegada, foto_llegada, tipoCedula, nombre_cliente, sucursal);
                    localStorage.setItem("TipoVisita", tipoCedulas);
                    app.views.main.router.navigate({name: 'recorridoServ8'});
                },
                function(tx, error){
                    console.error("Error al actualizar el tipo de cedula: " + error.message);
                }
            );
        },
        function(error){},
        function(){}
    );
}
 function generarPMP1Frio(){
     /*
    let id_visita = localStorage.getItem("id_visita");
    let nombre_comercial = localStorage.getItem("nombre_comercial");
    let ciudad = localStorage.getItem("store");
    let direccion = localStorage.getItem("direccion");
    let telefono = localStorage.getItem("telefono");
    let correo = localStorage.getItem("correo");
    let equipo = localStorage.getItem("equipo");
    let marca = localStorage.getItem("marca");
    let modelo = localStorage.getItem("modelo");
    let serie = localStorage.getItem("serie");*/
    let id_cedula = localStorage.getItem("IdCedula");
    let nombre_cliente = localStorage.getItem("nombreCliente");
    let foto_llegada = localStorage.getItem("foto_llegada");
    let sucursal = localStorage.getItem("sucursal");
    let orden_servicio = localStorage.getItem("order_number");
    var fecha = new Date();
    var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
    let tipoCedula = "PMP_Frio";
    let tipoCedulas = "PMP1Frio";
    databaseHandler.db.transaction(
        function(tx){
            tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                [tipoCedula,id_cedula],
                function(tx, results){
                    localStorage.setItem("TipoVisita", tipoCedulas);
                    productHandler.addVisitaServ(id_cedula);
                    productHandler.addreporteFrio(id_cedula, orden_servicio, fecha_llegada, foto_llegada, tipoCedula, nombre_cliente, sucursal);
                    localStorage.setItem("TipoVisita", tipoCedulas);
                    app.views.main.router.navigate({name: 'recorridoServ7'});
                },
                function(tx, error){
                    console.error("Error al actualizar el tipo de cedula: " + error.message);
                }
            );
        },
        function(error){},
        function(){}
    );
}
 function generarPMP1Rational(){
    console.log('rational');/*
    let id_visita = localStorage.getItem("id_visita");
    let nombre_comercial = localStorage.getItem("nombre_comercial");
    let ciudad = localStorage.getItem("store");
    let direccion = localStorage.getItem("direccion");
    let telefono = localStorage.getItem("telefono");
    let correo = localStorage.getItem("correo");
    let equipo = localStorage.getItem("equipo");
    let marca = localStorage.getItem("marca");
    let modelo = localStorage.getItem("modelo");
    let serie = localStorage.getItem("serie");*/
    let id_cedula = localStorage.getItem("IdCedula");
    let nombre_cliente = localStorage.getItem("nombreCliente");
    let foto_llegada = localStorage.getItem("foto_llegada");
    let sucursal = localStorage.getItem("sucursal");
    let orden_servicio = localStorage.getItem("order_number");
    var fecha = new Date();
    var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
    let tipoCedula = "PMP_Rational";
    let tipoCedulas = "PMP1Rational";
    databaseHandler.db.transaction(
        function(tx){
            tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                [tipoCedula,id_cedula],
                function(tx, results){
                    productHandler.addVisitaServ(id_cedula);
                    productHandler.addreporteRatinal(id_cedula, orden_servicio, fecha_llegada, foto_llegada, tipoCedula, nombre_cliente, sucursal);
                    app.views.main.router.navigate({name: 'recorridoServ9'});
                    localStorage.setItem("TipoVisita", tipoCedulas);
                },
                function(tx, error){
                    console.error("Error al actualizar el tipo de cedula: " + error.message);
                }
            );
        },
        function(error){},
        function(){}
    );
    
}
 function generarPMP2(){
     /*
    let id_visita = localStorage.getItem("id_visita");
    let nombre_comercial = localStorage.getItem("nombre_comercial");
    let ciudad = localStorage.getItem("store");
    let direccion = localStorage.getItem("direccion");
    let telefono = localStorage.getItem("telefono");
    let correo = localStorage.getItem("correo");
    let equipo = localStorage.getItem("equipo");
    let marca = localStorage.getItem("marca");
    let modelo = localStorage.getItem("modelo");
    let serie = localStorage.getItem("serie");*/
    let id_cedula = localStorage.getItem("IdCedula");
    let nombre_cliente = localStorage.getItem("nombreCliente");
    let foto_llegada = localStorage.getItem("foto_llegada");
    let sucursal = localStorage.getItem("sucursal");
    let orden_servicio = localStorage.getItem("order_number");
    var fecha = new Date();
    var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
    let tipoCedula = "PMP";
    let tipoCedulas = "PMP2";
    databaseHandler.db.transaction(
        function(tx){
            tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                [tipoCedula,id_cedula],
                function(tx, results){
                    productHandler.addreporteRatinal(id_cedula, orden_servicio, fecha_llegada, foto_llegada, tipoCedula, nombre_cliente, sucursal);
                    localStorage.setItem("TipoVisita", tipoCedulas);
                    app.views.main.router.navigate({name: 'menuServPMPSOEC'});
                },
                function(tx, error){
                    console.error("Error al actualizar el tipo de cedula: " + error.message);
                }
            );
        },
        function(error){},
        function(){}
    );
}
function generarHEB(){
    let id_cedula = localStorage.getItem("IdCedula");
    let nombre_cliente = localStorage.getItem("nombreCliente");
    let foto_llegada = localStorage.getItem("foto_llegada");
    let sucursal = localStorage.getItem("sucursal");
    let orden_servicio = localStorage.getItem("order_number");
    var fecha = new Date();
    var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
    let tipoCedula = "HEB";
    databaseHandler.db.transaction(
        function(tx){
            tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                [tipoCedula,id_cedula],
                function(tx, results){
                    productHandler.addreporteRatinal(id_cedula, orden_servicio, fecha_llegada, foto_llegada, tipoCedula, nombre_cliente, sucursal);
                    app.views.main.router.navigate({name: 'recorridoServ6'});
                },
                function(tx, error){
                    console.error("Error al actualizar el tipo de cedula: " + error.message);
                }
            );
        },
        function(error){},
        function(){}
    );
}
function GCheckPapeleta(nom){
    var pregunta = $('input:radio[name=pregunta'+nom+']:checked').val();
    console.log('Rsp',pregunta);
    var id_equ = localStorage.getItem("insertId");
    var fase = localStorage.getItem("Faseeq");
    if(nom == 1){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datos_eq SET papeleta = ? WHERE id_datos = ?",
                    [pregunta,id_equ],
                    function(tx, results){
                        if(pregunta == 1){
                            $("#cotizacion-"+fase).css("display","block")
                        }else{
                            $("#cotizacion-"+fase).css("display","none")
                        }
                        
                    },
                    function(tx, error){
                        console.error("Error al guardar: " + error.message);
                    }
                );
            },
            function(error){
                console.error("Error al guardar: " + error.message);
            },
            function(){}
        );
    }else if(nom == 2){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datos_eq SET refacciones = ? WHERE id_datos = ?",
                    [pregunta,id_equ],
                    function(tx, results){
                        if(pregunta == 1){
                            $("#refacciones-"+fase).css("display","block")
                        }else{
                            $("#refacciones-"+fase).css("display","none")
                        }
                    },
                    function(tx, error){
                        console.error("Error al guardar: " + error.message);
                    }
                );
            },
            function(error){
                console.error("Error al guardar: " + error.message);
            },
            function(){}
        );
    }else if(nom == 3){
        console.log('asas');
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datos_eq SET viaticos = ? WHERE id_datos = ?",
                    [pregunta,id_equ],
                    function(tx, results){  
                    },
                    function(tx, error){
                        console.error("Error al guardar: " + error.message);
                    }
                );
            },
            function(error){
                console.error("Error al guardar: " + error.message);
            },
            function(){}
        );
    }   
}
function regresarRecorridoServInd4(){
    app.views.main.router.back('/formServ33/', {force: true, ignoreCache: true, reload: true});
}
function regresarRecorridoServInd6(){
    app.views.main.router.back('/recorridoServ6/', {force: true, ignoreCache: true, reload: true});
}
function regresarRecorridoServComedor(){
    app.views.main.router.back('/menuServPMPSOEC/', {force: true, ignoreCache: true, reload: true});
}
function equipoinicio(id_datos,fase){
    console.log('id_datos',id_datos)
    console.log('fase',fase)
    localStorage.setItem("insertId", id_datos);
    localStorage.setItem("Faseeq", fase);
    app.views.main.router.back('/formServ34/', {force: true, ignoreCache: true, reload: true}); 
}
function equipoinicioPMP(id_datos,fase){
    console.log('id_datos',id_datos)
    console.log('fase',fase)
    localStorage.setItem("insertId", id_datos);
    localStorage.setItem("Faseeq", fase);
    if (fase==1){
        app.views.main.router.back('/recorridoServ11/', {force: true, ignoreCache: true, reload: true}); 
    }else if (fase==2){
        app.views.main.router.back('/recorridoServ10/', {force: true, ignoreCache: true, reload: true}); 
    }
    
}
function equipoeliminar(id_datos){
    console.log('id_datos',id_datos)
    swal({
        title: "Aviso",
        text: "Estas apunto de eliminar todos los datos del equipo, ¬øEstas seguro continuar con la acci√≥n?",
        icon: "warning",
        buttons: true,
        dangerMode: true,
    })
    .then((willGoBack) => {
        if (willGoBack){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM datos_eq WHERE id_datos = ?",
                        [id_datos],
                        function(tx, results){
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql(
                                        "DELETE FROM fotos_check WHERE id_equipo = ?",
                                        [id_datos],
                                        function(tx, results){
                                            databaseHandler.db.transaction(
                                                function(tx){
                                                    tx.executeSql(
                                                        "DELETE FROM checklist_servind WHERE id_equipo = ?",
                                                        [id_datos],
                                                        function(tx, results){
                                                             swal("","El registro se elimino satisfactoriamente","success");                     
                                                             $("#fila" + id_datos).remove();
                                                            app.views.main.router.back('/formServ33/', {force: true, ignoreCache: true, reload: true}); 
                                                        },
                                                        function(tx, error){
                                                            swal("Error al eliminar registro",error.message,"error");
                                                        }
                                                    );
                                                },
                                                function(error){},
                                                function(){}
                                            );
                                        },
                                        function(tx, error){
                                            swal("Error al eliminar registro",error.message,"error");
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }});
}
function guardarDiagnosticoHEB(){
    var id_cedula = localStorage.getItem("IdCedula");
    if($('input:radio[name=pregunta1]:checked').val() == 1 || $('input:radio[name=pregunta1]:checked').val() == 2){
        var pregunta = $('input:radio[name=pregunta1]:checked').val();
    } else {
        swal("","Para avanzar necesitas contestar la pregunta","warning");
        return false;
    }
    var comentario  = $("#cometario_cliente").val();
    
    if (comentario){
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql("select count(*) as Cuenta from diagnostico_servIndHBE WHERE id_cedula = ?",
                    [id_cedula],
                    function (tx, results) {
                        var item = results.rows.item(0);
                        console.log(item);
                        if (item.Cuenta == 0) {
                            tx.executeSql("insert into diagnostico_servIndHBE(id_cedula,comentario,pregunta ) values(?,?,?)",
                                [id_cedula,comentario,pregunta],
                                function (tx, results) {
                                    var item = results.rows.item(0);
                                    swal("", "Se guardaron los datos correctamente", "success");
                                },
                                function (tx, error) {
                                    console.error("Error al registrar Resultado: " + error.message);
                                }
                            );
    
                        } else {
                            tx.executeSql("UPDATE diagnostico_servIndHBE  SET  comentario = ?, pregunta = ?  WHERE id_cedula = ?",
                                [comentario,pregunta,id_cedula],
                                function (tx, results) {
                                    var item = results.rows.item(0);
                                    swal("", "Se actualizaron los datos correctamente", "success");
                                },
                                function (tx, error) {
                                    console.error("Error al registrar Resultado: " + error.message);
                                }
                            );
                        }  
                        $('#cometario_cliente').css("background-color", "#ffffff");
                        app.preloader.hide();
                    },
                    function (tx, error) {
                        swal("Error al guardar", error.message, "error");
                        app.preloader.hide();
                    }
                );
            },
            function (error) { },
            function () { }
        );
    }else{
        swal("", "Todos los campos son requeridos" ,"warning");
    }
}
function guardarFotoSERV(fase){
    console.log("Guardar foto FASE ",fase)
    var id_cedula = localStorage.getItem("IdCedula");
    var id_equ = localStorage.getItem("insertId");
    var foto = $("#imagenC"+fase).val();
    var no_pregunta = 0;
    var fecha = new Date();
    var fecha_foto = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
    var fases = "";
    if ( fase==22){
        fases="?Cafetera Benn";
    }else if ( fase==23){
        fases="?Capuchinera";
    }else if ( fase == 24){
        fases="?Vitrina de postres";
    }else if ( fase == 25){
        fases="?Rostricero";
    }else if ( fase == 26){
        fases="?Conservador Caliente";
    }else if ( fase == 27){
        fases="?Molino de cafe";
    }else if ( fase == 28){
        fases="?Tostador";
    }else if ( fase == 29){
        fases="";
    }else if ( fase == 30){
        fases="?Vitrina Caliente";
    }else if ( fase == 31){
        fases="?Freidora";
    }else if ( fase == 32){
        fases="?Horno de pizza";
    }else if ( fase == 33){
        fases="?Plancha";
    }else if ( fase == 34){
        fases="?Vitrina Pizza";
    }else if ( fase == 35){
        fases="?Display de pollos";
    }else if ( fase == 36){
        fases="";
    }else if ( fase == 37){
        fases="?Refrigerador";
    }else if ( fase == 38){
        fases="?Mesa fria";
    }else if ( fase == 39){
        fases="?Congelador";
    }else if ( fase == 40){
        fases="?Fabricador de Hielo";
    }
    if (foto){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO fotos_check(id_cedula, foto,  fase,  observaciones, fecha_foto, no_pregunta,id_equipo) VALUES (?,?,?,?,?,?,?)",
                    [id_cedula, foto, fase, fases, fecha_foto, no_pregunta,id_equ],
                    function(tx, results){
                        app.preloader.hide();
                        swal("","Datos guardados correctamente","success");
                        $('#imagenC'+fase).val("");
                        //app.sheet.close('#sheet-modal');
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select * from fotos_check where id_cedula = ? AND fase = ? ORDER BY id_foto DESC",
                                [id_cedula, fase],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        console.log('item',item)
                                        $("#smallImage"+fase).attr("src","img/blank.png");
                                        $("#photoIcon"+fase).attr("src","img/camera.svg");
                                      if (fase == 22){
                                            $("#tabla_hbe22").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                        }else if (fase == 23){
                                            $("#tabla_hbe23").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                        }else if (fase == 24){
                                            $("#tabla_hbe24").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                        }else if (fase == 25){
                                            $("#tabla_hbe25").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                        }else if (fase == 26){
                                            $("#tabla_hbe26").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                        }else if (fase == 27){
                                            $("#tabla_hbe27").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                        }else if (fase == 28){
                                            $("#tabla_hbe28").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                        }else if (fase == 29){
                                            $("#tabla_hbe29").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                        }else if (fase == 30){
                                            $("#tabla_hbe30").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                        }else if (fase == 31){
                                            $("#tabla_hbe31").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                        }else if (fase == 32){
                                            $("#tabla_hbe32").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                        }else if (fase == 33){
                                            $("#tabla_hbe33").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                        }else if (fase == 34){
                                            $("#tabla_hbe34").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                        }else if (fase == 35){
                                            $("#tabla_hbe35").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                        }else if (fase == 36){
                                            $("#tabla_hbe36").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                        }else if (fase == 37){
                                            $("#tabla_hbe37").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                        }else if (fase == 38){
                                            $("#tabla_hbe38").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                        }else if (fase == 39){
                                            $("#tabla_hbe39").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                        }else if (fase == 40){
                                            $("#tabla_hbe40").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                        }
                                        $("#message-nr"+fase).css("display", "none");
                                        $('.preloader').remove();
                                        $('.infinite-scroll-preloader').remove();
                                        app.preloader.hide();
                                    },
                                    function(tx, error){
                                        console.log("Error al mostrar datos cedula: " + error.message);
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        app.preloader.hide();
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }else{
        swal("", "Debes tomar una fotograf√≠a" ,"warning");
    }
}
function guardarequipoSERV(fase,no_preguntas){
    var id_cedula = localStorage.getItem("IdCedula");    
    var id_equ = localStorage.getItem("insertId");    
    var marca = $("#marcaeq").val();
    var modelo = $("#modeloeq").val();
    var serie = $("#serieeq").val();
    var id = $("#id").val();
    var volts = $("#volts").val();
    var amp = $("#amp").val();
    var tierra = $("#tierra").val();
    var capacidad = $("#capacidad").val();
    var obs = $("#obs"+fase).val();
    var estatus = $( "#estatuseq"+fase ).val();
    var ml = $("#ml").val();
    var num = 0;
    for(i = 1;i <= no_preguntas;i++){
        if($("#"+fase+"-"+i+"-select").val() == "0"){
        num++;
        }
    }
    for(i = 1;i <= no_preguntas;i++){
        if($("#"+fase+"-"+i+"-input").val() == ""){
           num++;
        }
    }
    if(marca && modelo && serie && id && volts && amp && tierra && capacidad && obs && ml){
        if(num != 0){
            swal({
                title: "Aviso",
                text: "Faltan campos por contestar, ¬øEstas seguro que deseas continuar?",
                icon: "warning",
                buttons: true,
                dangerMode: false,
            })
            .then((willGoBack) => {
                if (willGoBack){
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("UPDATE datos_eq SET marca = ? ,modelo = ?, serie = ?, numero_id = ?, volts = ?,amp = ?, tierra = ?, breaker = ? , observaciones = ?, estatus = ? , ml = ? WHERE id_datos= ? ",
                                [marca,modelo,serie,id,volts,amp,tierra,capacidad,obs,estatus,ml,id_equ],
                                function(tx, results){
                                    swal("", "Se guardo los datos corrcetamnete", "success");
                                    app.views.main.router.back('/formServ33/', {force: true, ignoreCache: true, reload: true});
                                },
                                function(tx, error){
                                    console.error("Error al actualizar el tipo de cedula: " + error.message);
                                }
                            );
                        },
                        function(error){},
                        function(){}
                    );
                    
                } else {}
            });
        }else{
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE datos_eq SET marca = ? ,modelo = ?, serie = ?, numero_id = ?, volts = ?,amp = ?, tierra = ?, breaker = ? , observaciones = ?, estatus = ? , ml = ? WHERE id_datos= ? ",
                        [marca,modelo,serie,id,volts,amp,tierra,capacidad,obs,estatus,ml,id_equ],
                        function(tx, results){
                            swal("", "Se guardo los datos corrcetamnete", "success");
                            app.views.main.router.back('/formServ33/', {force: true, ignoreCache: true, reload: true});
                        },
                        function(tx, error){
                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );   
        }
    }else{
        swal("", "Faltan datos del equipo por llenar" ,"warning");
    }        
}
function regresarmenuPMP(){
    app.views.main.router.navigate({name: 'formServ36'});
}
function guardarPapeletaServHEB(fase){
    var id_equ = localStorage.getItem("insertId");
    if(!id_equ){ id_equ = 0};
    var id_cedula = localStorage.getItem("IdCedula");
    var noParteC = $('#numero_parteC'+fase).val();
    var descripcionC = $('#descripcionC'+fase).val();
    var prioridadC = $('#prioridadC'+fase).val();
    var cantidadC = $('#cantidadC'+fase).val();
    var foto = $("#imagenC"+id_equ).val();
    var fecha = new Date();
    var fecha_reg = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
  
    if(noParteC && descripcionC){
        console.log('prioridadC',prioridadC)
        if (prioridadC == 0){
            swal("", "Selecciona una prioridad" , "warning");
            return false;
        }else{
            if (cantidadC){
                if (foto){
                    console.log("ENTRO")
                    databaseHandler.db.transaction(
                        function(tx){//id_cedula, foto_papeleta, numero_parte, descripcion, prioridad, cantidad, fecha_registro
                            tx.executeSql("INSERT INTO papeleta(id_cedula, foto_papeleta, numero_parte, descripcion, prioridad, cantidad, fecha_registro,id_equipo) VALUES (?,?,?,?,?,?,?,?)",
                                [id_cedula, foto, noParteC, descripcionC, prioridadC, cantidadC, fecha_reg,id_equ],
                                function(tx, results){
                                    app.preloader.hide();
                                    swal("","Datos guardados correctamente","success");
                                    $("#numero_parteC"+fase).val('');
                                    $('#numero_parteC'+fase).css("background-color", "#ffffff");
                                    $("#descripcionC"+fase).val('');
                                    $('#descripcionC'+fase).css("background-color", "#ffffff");
                                    $("#prioridadC"+fase).val(0);
                                    $("#cantidadC"+fase).val('');
                                    $('#cantidadC'+fase).css("background-color", "#ffffff");
                                    $("imagenC"+id_equ).val('');
                                    $("#smallImage"+id_equ).attr("src","img/blank.png");
                                    $("#photoIcon"+id_equ).attr("src","img/camera.svg");
                                    console.log("INSERT")
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("Select * from papeleta where id_cedula = ? and id_equipo = ? ORDER BY id_papeleta DESC",
                                            [id_cedula,id_equ],
                                                function(tx, results){
                                                    var item = results.rows.item(0);
                                                    $("#table_papeleta"+fase).append("<tr id='fila"+ item.id_papeleta +
                                                    "'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ 
                                                    item.id_papeleta +",5);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+
                                                    item.foto_papeleta+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + 
                                                    item.numero_parte + "</td><td style='text-align: center;'>" + 
                                                     item.descripcion + "</td><td style='text-align: center;'>" + 
                                                     item.prioridad + "</td><td style='text-align: center;'>" + 
                                                     item.cantidad + "</td></tr>");
                                                    $("#message-nr").css("display", "none");
                                                    $('.preloader').remove();
                                                    $('.infinite-scroll-preloader').remove();
                                                    app.preloader.hide();
                                                },
                                                function(tx, error){
                                                    console.log("Error al guardar cedula: " + error.message);
                                                    app.preloader.hide();
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                },
                                function(tx, error){
                                    app.preloader.hide();
                                    swal("Error al guardar",error.message,"error");
                                }
                            );
                        },
                        function(error){},
                        function(){}
                    );
                }else{
                    swal("", "Favor de tomar una fotograf√≠a" , "warning");
                    return false;
                }
            }else{
                swal("", "Ingresa una Cantidad" , "warning");
                return false;
            }
        }
    }else{
        swal("", "Todos los datos son requeridos" , "warning");
    }
}

function guardarRefasServHEB(fase){
    var id_equ = localStorage.getItem("insertId");
    if(!id_equ){ id_equ = 0};
    var id_cedula = localStorage.getItem("IdCedula");
    var noParte = $('#numero_parte'+fase).val();
    var descripcion = $('#descripcion'+fase).val();
    var parte = $('#parte'+fase).val();
    var foto_r = $("#imagenC1"+id_equ).val();
    var fecha = new Date();
    var fecha_reg = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
   
    if(noParte && descripcion && parte){
        if (foto_r){
            
            databaseHandler.db.transaction(
                function(tx){//id_refaccion, id_cedula, foto_refa, numero_parte, descripcion, parte, fecha_registro
                    tx.executeSql("INSERT INTO refacciones(id_cedula, foto_refa, numero_parte, descripcion, parte, fecha_registro,id_equipo) VALUES (?,?,?,?,?,?,?)",
                        [id_cedula, foto_r, noParte, descripcion, parte, fecha_reg,id_equ],
                        function(tx, results){
                            app.preloader.hide();
                            swal("","Datos guardados correctamente","success");
                            $("#numero_parte").val('');
                            $('#numero_parte').css("background-color", "#ffffff");
                            $("#descripcion").val('');
                            $('#descripcion').css("background-color", "#ffffff");
                            $("#parte").val('');
                            $('#parte').css("background-color", "#ffffff");
                            $("imagenC1"+id_equ).val('');
                            $("#smallImage1"+id_equ).attr("src","img/blank.png");
                            $("#photoIcon1"+id_equ).attr("src","img/camera.svg");
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("Select * from refacciones where id_cedula = ? and id_equipo = ? ORDER BY id_refaccion DESC",
                                    [id_cedula,id_equ],
                                        function(tx, results){
                                            var item = results.rows.item(0);
                                            $("#tabla_refacciones"+fase).append("<tr id='fila"+ item.id_refaccion +
                                            "'><td><a href='#' onclick='eliminarFilaServ("+ 
                                            item.id_refaccion +",5);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+
                                            item.foto_refa +"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + 
                                            item.numero_parte + "</td><td style='text-align: center;'>" + 
                                             item.descripcion + "</td><td style='text-align: center;'>" + 
                                             item.parte + "</td></tr>");
                                            $("#message-nr1").css("display", "none");
                                            $('.preloader').remove();
                                            $('.infinite-scroll-preloader').remove();
                                            app.preloader.hide();
                                        },
                                        function(tx, error){
                                            console.log("Error al guardar cedula: " + error.message);
                                            app.preloader.hide();
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        },
                        function(tx, error){
                            app.preloader.hide();
                            swal("Error al guardar",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );

        }else{
            swal("", "Favor de tomar una fotograf√≠a" , "warning");
            return false;
        }
    }else{
        swal("", "Todos los datos son requeridos" , "warning");
    }
}
function equipoHEB(){
    var id_cedula = localStorage.getItem("IdCedula");
    var select = $( "#seleEquipo" ).val();
    localStorage.setItem("Faseeq", select);       
    if(select != 0){
        if(select != 29 && select != 36){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO datos_eq(id_cedula,fase) VALUES (?,?)",
                    [id_cedula,select],
                    function(tx, results){
                        app.preloader.hide();
                        console.log(results.insertId);
                        localStorage.setItem("insertId", results.insertId);
                        // swal("","Datos guardados correctamente","success"); 
                        app.views.main.router.back('/formServ34/', {force: true, ignoreCache: true, reload: true}); 
                    },
                    function(tx, error){
                        app.preloader.hide();
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
        }else{
            app.dialog.prompt("Ingrese nombre del equipo", 'FIELD',function (name) {
                var nombre_eq= name;
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("INSERT INTO datos_eq(id_cedula,fase,nombre) VALUES (?,?,?)",
                            [id_cedula,select,nombre_eq],
                            function(tx, results){
                                app.preloader.hide();
                                console.log(results.insertId);
                                localStorage.setItem("insertId", results.insertId);
                                // swal("","Datos guardados correctamente","success"); 
                                app.views.main.router.back('/formServ34/', {force: true, ignoreCache: true, reload: true}); 
                            },
                            function(tx, error){
                                app.preloader.hide();
                                swal("Error al guardar",error.message,"error");
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
                });
        }
    }else{
        swal("", "Debes seleccionar equipo" ,"warning");
    } 
}
function guardarReporteGeneralServRe(){
    if($("#NombreFirma").val() == "" || $("#signate").val() == ""){
        swal("","El campo de nombre y firma son obligatorios","warning");
        return false;
    }
    if($("#imagenC").val() == ""){
        swal("","Debes tomar la fotograf√≠a del sello para poder continuar","warning");
        return false;
    }
    var foto_sello = $("#imagenC").val();
    var id_cedula = localStorage.getItem("IdCedula");
    var nombrefirma = $("#NombreFirma").val();
    var firmaCliente = $("#signate").val();
    var fecha = new Date();
    var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
    
    databaseHandler.db.transaction(
        function(tx){
            tx.executeSql("UPDATE visita_servInd SET firma_cliente = ?, foto_sello = ? WHERE id_cedula = ?",
                [firmaCliente,foto_sello,id_cedula],
                function(tx, results){
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("UPDATE cedulas_general SET nombre_evalua = ? WHERE id_cedula = ?",
                                [nombrefirma,id_cedula],
                                function(tx, results){
                                    swal("","Guardado correctamente","success");
                                    app.views.main.router.back('/yamevoyserv3/', {force: true, reload: true});
                                },
                                function(tx, error){
                                    console.error("Error al guardar cierre: " + error.message);
                                }
                            );
                        },
                        function(error){},
                        function(){}
                    );
                },
                function(tx, error){
                    console.error("Error al guardar cierre: " + error.message);
                }
            );
        },
        function(error){},
        function(){}
    );
}
function guardarCotiza3(){
    var id_cedula = localStorage.getItem("IdCedula");
    var horasT = $('#cantidadTotal').val();
    console.log('Entro');
    if (horasT==0){
        swal({
            title: "Aviso",
            text: "Tus horas totales estan en '0', ¬øEstas seguro que deseas continuar?",
            icon: "warning",
            buttons: true,
            dangerMode: false,
        })
        .then((willGoBack) => {
            if (willGoBack){
                var tipoVisita = localStorage.getItem("TipoVisita");
                if (tipoVisita=='PMP2'){
                    app.views.main.router.back('/cierreServInd5/', {force: true, ignoreCache: true, reload: true});
                }else{
                    app.views.main.router.back('/cierreServInd4/', {force: true, ignoreCache: true, reload: true});
                }
            } else {}
        });
    }else{
        //H_viaje, H_espera, H_trabajo, H_totales
        var H_viaje=$('#cantidadViaje').val()
        var H_espera=$('#cantidadEspera').val()
        var H_trabajo=$('#cantidadTrabajo').val()
        var H_totales=$('#cantidadTotal').val()
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE visita_servInd SET H_viaje = ?, H_espera = ?, H_trabajo = ?, H_totales = ? WHERE id_cedula = ?",
                    [H_viaje, H_espera, H_trabajo, H_totales, id_cedula],
                    function(tx, results){
                        swal("","Guardado correctamente","success");
                        $('#cantidadViaje').css("background-color", "#ffffff");
                        $('#cantidadEspera').css("background-color", "#ffffff");
                        $('#cantidadTrabajo').css("background-color", "#ffffff");
                        $('#cantidadTotal').css("background-color", "#ffffff");
                        var tipoVisita = localStorage.getItem("TipoVisita");
                        if (tipoVisita=='PMP2'){
                            app.views.main.router.back('/cierreServInd5/', {force: true, ignoreCache: true, reload: true});
                        }else{
                            app.views.main.router.back('/cierreServInd4/', {force: true, ignoreCache: true, reload: true});
                        }
                    },
                    function(tx, error){
                        console.error("Error al guardar entrega: " + error.message);
                    }
                );
            },
            function(error){
                console.error("Error al guardar entrega: " + error.message);
            },
            function(){}
        );
    }
}
function guardarCotiza4(){
    var id_cedula = localStorage.getItem("IdCedula");
    var horasT = $('#cantidadTotal').val();
    console.log('Entro');
    if (horasT==0){
        swal({
            title: "Aviso",
            text: "Tus horas totales estan en '0', ¬øEstas seguro que deseas continuar?",
            icon: "warning",
            buttons: true,
            dangerMode: false,
        })
        .then((willGoBack) => {
            if (willGoBack){
                app.views.main.router.back('/cierreServInd5/', {force: true, ignoreCache: true, reload: true});
            } else {}
        });
    }else{
        //H_viaje, H_espera, H_trabajo, H_totales
        var H_viaje=$('#cantidadViaje').val()
        var H_espera=$('#cantidadEspera').val()
        var H_trabajo=$('#cantidadTrabajo').val()
        var H_totales=$('#cantidadTotal').val()
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE visita_servInd SET H_viaje = ?, H_espera = ?, H_trabajo = ?, H_totales = ? WHERE id_cedula = ?",
                    [H_viaje, H_espera, H_trabajo, H_totales, id_cedula],
                    function(tx, results){
                        swal("","Guardado correctamente","success");
                        $('#cantidadViaje').css("background-color", "#ffffff");
                        $('#cantidadEspera').css("background-color", "#ffffff");
                        $('#cantidadTrabajo').css("background-color", "#ffffff");
                        $('#cantidadTotal').css("background-color", "#ffffff");
                        app.views.main.router.back('/cierreServInd5/', {force: true, ignoreCache: true, reload: true});
                    },
                    function(tx, error){
                        console.error("Error al guardar entrega: " + error.message);
                    }
                );
            },
            function(error){
                console.error("Error al guardar entrega: " + error.message);
            },
            function(){}
        );
    }
}
function guardarDatoscheckServind4(){
    var id_cedula = localStorage.getItem("IdCedula");    
    var id_equ = localStorage.getItem("insertId");    
    var equipo = $("#equipo").val();
    var marca = $("#marca").val();
    var modelo= $("#modelo").val();
    var serie= $("#serie").val();
    var ml= $("#ml").val();
    var volts= $("#volt").val();
    var amp= $("#amp").val();
    var wc= $("#wc").val();
    var tierra= $("#tierra").val();

    if(equipo && marca && modelo && serie && ml && volts && amp && wc && tierra){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datos_eq SET nombre = ?,marca = ? ,modelo = ?, serie = ?, ml = ?, volts = ?,amp = ?, tierra = ?,wc = ? WHERE id_datos= ? ",
                    [equipo, marca,modelo,serie,ml,volts,amp,tierra,wc,id_equ],
                    function(tx, results){
                        swal("", "Se guardo los datos correctamente", "success");
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }else{
        swal("", "Faltan datos del equipo por llenar" ,"warning");
    }
}
function regresarRecorridoServInd1(){
    var tipoVisita = localStorage.getItem("TipoVisita");
    if (tipoVisita=='PMP1Frio'){
        app.views.main.router.back('/recorridoServ7/', {force: true, ignoreCache: true, reload: true});
    }else if (tipoVisita=='correctivo'){
        app.views.main.router.back('/recorridoServ1/', {force: true, ignoreCache: true, reload: true});
    }else if (tipoVisita=='PMP2'){
        app.views.main.router.back('/recorridoServ10/', {force: true, ignoreCache: true, reload: true});
    }
}
function regresarRecorridoServInd2(){
    var tipoVisita = localStorage.getItem("TipoVisita");
    if (tipoVisita=='PMP1Caliente'){
        app.views.main.router.back('/recorridoServ8/', {force: true, ignoreCache: true, reload: true});
    }else if (tipoVisita=='correctivo'){
        app.views.main.router.back('/recorridoServ2/', {force: true, ignoreCache: true, reload: true});
    }else if (tipoVisita=='PMP2'){
        app.views.main.router.back('/recorridoServ11/', {force: true, ignoreCache: true, reload: true});
    }else if (tipoVisita=='PMP1Frio'){
        app.views.main.router.back('/recorridoServ7/', {force: true, ignoreCache: true, reload: true});
    }
    else if (tipoVisita=='PMP1Rational'){
        app.views.main.router.back('/recorridoServ9/', {force: true, ignoreCache: true, reload: true});
    }
}
function regresardeEquipoPMP(){//Caliente
    app.views.main.router.back('/recorridoServ11/', {force: true, ignoreCache: true, reload: true});
}
function regresardeEquipoPMP1(){//Frio
    app.views.main.router.back('/recorridoServ10/', {force: true, ignoreCache: true, reload: true});
}
function moveDatosGenerales(){
    app.views.main.router.back('/diagnosticoHEB3/', {force: true, ignoreCache: true, reload: true});
}
function movedatosG(){
    var tipoVisita = localStorage.getItem("TipoVisita");
    if (tipoVisita=='PMP1Caliente'){
        app.views.main.router.back('/diagnosticoHEB3/', {force: true, ignoreCache: true, reload: true});
    }else  if (tipoVisita=='PMP1Frio'){
        app.views.main.router.back('/diagnosticoHEB3/', {force: true, ignoreCache: true, reload: true});
    }else if (tipoVisita=='correctivo'){
        app.views.main.router.back('/formServ1/', {force: true, ignoreCache: true, reload: true});
    }
}
function movedatosG1(){
    var tipoVisita = localStorage.getItem("TipoVisita");
    if (tipoVisita=='PMP1Caliente'){
        app.views.main.router.back('/diagnosticoHEB3/', {force: true, ignoreCache: true, reload: true});
    }else  if (tipoVisita=='PMP1Frio'){
        app.views.main.router.back('/diagnosticoHEB3/', {force: true, ignoreCache: true, reload: true});
    }else if (tipoVisita=='correctivo'){
        app.views.main.router.back('/formServ11/', {force: true, ignoreCache: true, reload: true});
    }else if (tipoVisita=='PMP1Rational'){
        app.views.main.router.back('/diagnosticoHEB3/', {force: true, ignoreCache: true, reload: true});
    }
}
function empezarPMP(){
    var tipoVisita = localStorage.getItem("TipoVisita");
    if (tipoVisita=='PMP1Caliente'){
        app.views.main.router.back('/formServ2/', {force: true, ignoreCache: true, reload: true});
    }else  if (tipoVisita=='PMP1Frio'){
        app.views.main.router.back('/formServ12/', {force: true, ignoreCache: true, reload: true});
    } else if (tipoVisita=='PMP2'){
        app.views.main.router.back('/formServ36/', {force: true, ignoreCache: true, reload: true});
    } else if (tipoVisita=='PMP1Rational'){
        app.views.main.router.back('/formServ21/', {force: true, ignoreCache: true, reload: true});
    }
}
//Fin ServInd
    // Inicio MT
    function buscarClienteMT(){
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_cliente = $("#IdCliente").val();
        var nombre_contacto = $("#nombre_contacto").val();
        var puesto_contacto = $("#puesto_contacto").val();
        var telefono_contacto = $("#telefono_contacto").val();
        var correo_contacto = $("#correo_contacto").val();
        var horario_programado = fecha_llegada;
        var nombre_cliente = $("#autocomplete-dropdown-ajax").val();
        var tipo = "Visita";
        var estatus = 0;
        if(nombre_cliente != ''){
            productHandler.addCedulaCompleta(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus,tipo);
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                        [],
                        function(tx, results){
                            var item = results.rows.item(0);
                            localStorage.setItem("IdCedula", item.Id);
                            productHandler.addDatosMT(item.Id,nombre_cliente,nombre_contacto,puesto_contacto,telefono_contacto,correo_contacto);
                            app.views.main.router.navigate({name: 'recorridoMT1'});
                            app.preloader.hide();
                        },
                        function(tx, error){
                            console.log("Error al guardar cedula: " + error.message);
                            app.preloader.hide();
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else {
            swal("Falta un campo", "El nombre del cliente es requerido, por favor colocalo para poder iniciar." ,"warning");
            app.preloader.hide();
        }
    }
    function regresarRecorridoMT1(){
        app.views.main.router.back('/recorridoMT1/', {force: true, ignoreCache: true, reload: true});
    }
    function continuarCedMT(id_cedula,tipo){
        localStorage.setItem("IdCedula",id_cedula);
        localStorage.setItem("Opcion", '1');
        if(tipo == 1){
            app.views.main.router.navigate({ name: 'recorridoMT1'});
        }
    }
    function terminarVisitaMT(){
        // var id_cedula = localStorage.getItem("IdCedula");
        // var fecha = new Date();
        // var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        // var ubicacion_salida = $('#geolocation').val();
        // databaseHandler.db.transaction(
        //     function(tx){
        //         tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
        //             [fecha_salida,ubicacion_salida,estatus,id_cedula],
        //             function(tx, results){
                        window.location.href = "./menu.html";
        //             },
        //             function(tx, error){
        //                 swal("Error al guardar",error.message,"error");
        //             }
        //         );
        //     },
        //     function(error){},
        //     function(){}
        // );
    }
    // Fin MT
    //Inicio Carnes Ideal
    function buscarClienteCI(){
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_cliente = $("#IdCliente").val();
        var nombre_contacto = $("#nombre_contacto").val();
        var puesto_contacto = $("#puesto_contacto").val();
        var telefono_contacto = $("#telefono_contacto").val();
        var correo_contacto = $("#correo_contacto").val();
        var horario_programado = fecha_llegada;
        var foto_llegada = $("#imagenC").val();
        var nombre_cliente = $("#autocomplete-dropdown-ajax").val();
        var estatus = 0;
        if(nombre_cliente != ''){
            productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                        [],
                        function(tx, results){
                            var item = results.rows.item(0);
                            localStorage.setItem("IdCedula", item.Id);
                            localStorage.setItem("nombre_cliente", nombre_cliente);
                            localStorage.setItem("nombre_contacto", nombre_contacto);
                            localStorage.setItem("puesto_contacto", puesto_contacto);
                            localStorage.setItem("telefono_contacto", telefono_contacto);
                            localStorage.setItem("correo_contacto", correo_contacto);
                            localStorage.setItem("foto_llegada", foto_llegada);
                            app.views.main.router.navigate({name: 'menuCI'});
                            app.preloader.hide();
                        },
                        function(tx, error){
                            console.log("Error al guardar cedula: " + error.message);
                            app.preloader.hide();
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else {
            swal("Falta un campo", "El nombre del cliente es requerido, por favor colocalo para poder iniciar." ,"warning");
            app.preloader.hide();
        }
    }
    function regresarRecorridoCI1(){
        app.views.main.router.back('/recorridoCI/', {force: true, ignoreCache: true, reload: true});
    }
    function regresarRecorridoCI2(){
        app.views.main.router.back('/recorridoCI2/', {force: true, ignoreCache: true, reload: true});
    }
    function temperaturaLlena(id,value){
        id = "#"+id;
        if(value > 4){
            $(id).css("background-color","#fb2c2c");
            $(id).css("color","white");
        } else {
            $(id).css("background-color","#E0F8F7");
            $(id).css("color","black");
        }
    }
    function generarEntregaCI(){
        let id_cedula = localStorage.getItem("IdCedula");
        let nombre_cliente = localStorage.getItem("nombre_cliente");
        let nombre_contacto = localStorage.getItem("nombre_contacto");
        let puesto_contacto = localStorage.getItem("puesto_contacto");
        let telefono_contacto = localStorage.getItem("telefono_contacto");
        let correo_contacto = localStorage.getItem("correo_contacto");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let tipoCedula = "Entrega";
        productHandler.addDatosCI(id_cedula,nombre_cliente,nombre_contacto,puesto_contacto,telefono_contacto,correo_contacto,foto_llegada);
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        app.views.main.router.navigate({name: 'recorridoCI'});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function generarVentaCI(){
        let id_cedula = localStorage.getItem("IdCedula");
        let tipoCedula = "Venta";
        productHandler.addDatosVentaCI(id_cedula);
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        app.views.main.router.navigate({name: 'recorridoCI2'});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarTemperaturaCI(){
        app.preloader.show('blue');
        if($("#temperatura").val() == "" || $('#comentario').val() == "" || $('#imagenC').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var temperatura = $("#temperatura").val();
        var comentario = $('#comentario').val();
        var foto = $('#imagenC').val();
        var unidad = $('#unidad').val();
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datos_entrega SET temperatura = ?,unidad = ? WHERE id_cedula = ?",
                    [temperatura,unidad,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("INSERT INTO fotos_entrega(id_cedula,foto,comentarios,fecha_evidencia) VALUES (?,?,?,?)",
                                    [id_cedula,foto,comentario,fecha_registro],
                                    function(tx, results){
                                        app.preloader.hide();
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select MAX(id_evidencia) as Id from fotos_entrega",
                                                    [],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        var id_evidencia = item.Id;
                                                        app.preloader.hide();
                                                        //Consultar el producto
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("Select * from fotos_entrega where id_evidencia = ?",
                                                                [id_evidencia],
                                                                    function(tx, results){
                                                                        var item = results.rows.item(0);
                                                                        $("#comentario").css("background-color", "#FFFFFF");
                                                                        $("#imagenC").css("background-color", "#FFFFFF");
                                                                        $("#comentario").val("");
                                                                        $("#smallImage").attr("src","img/blank.png");
                                                                        $('#imagenC').val("");
                                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                                        $("#temperatura tbody").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaCI("+ item.id_evidencia +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.comentarios) + "</td><td style='text-align: center;'>" + item.fecha_evidencia + "</td></tr>");
                                                                        $("#message-nr").css("display", "none");
                                                                        $('.preloader').remove();
                                                                        $('.infinite-scroll-preloader').remove();
                                                                        app.preloader.hide();
                                                                    },
                                                                    function(tx, error){
                                                                        console.log("Error al guardar cedula: " + error.message);
                                                                        app.preloader.hide();
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                        swal("","Registro guardado","success");
                                        app.preloader.hide();
                                    },
                                    function(tx, error){
                                        swal("Error al guardar plaga",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarCierreEntregaCI(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#eval").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        if($("#eval").val() <= '2' && $("#comentario_cliente").val() == ""){
            swal("","Por favor, ingresa el motivo de tu calificacion","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var calificacion = $("#eval").val();
        var comentarioCliente = $('#comentario_cliente').val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datos_entrega SET firma_cliente = ?,fecha_cliente = ? WHERE id_cedula = ?",
                    [firmaCliente,fecha_firma,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                    [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoyEntregaCI/', {force: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarEntregaCI(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datos_entrega SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function continuarCedCI(id_cedula,tipo){
        localStorage.setItem("IdCedula",id_cedula);
        localStorage.setItem("Opcion", '1');
        if(tipo == 1){
            app.views.main.router.navigate({ name: 'recorridoCI'});
        } else if(tipo == 2){
            app.views.main.router.navigate({ name: 'recorridoCI2'});
        }
    }
    function eliminarFilaCI(index, opc){
        if(opc == 1) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM fotos_entrega WHERE id_evidencia = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function guardarProyecto(op){
        //console.log('Guarda proyecto');
        var id_cedula = localStorage.getItem("IdCedula");
        var metodo=$('#metodo').val();
        var grupo=$('#grupo').val();
        var nombre_proyecto=$('#nombre_proyecto').val();   
        var potencial=$('#potencial').val();
        var segmento=$('#segmento').val();
        var estrategia=$('#estrategia').val();
        var division=1;
        var estatus=0;
        var enviado=0;
        var id_usuario = localStorage.getItem("id_usuario");
        var fecha = new Date();
        var fecha_creacion = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate();
        var estatusEn = 1;
       
        if (nombre_proyecto!=''){
            if (potencial!=''){
                if(segmento!='0'){
                //console.log(nombre_proyecto +", "+potencial + ", " +segmento);
                //console.log(id_usuario, nombre_proyecto, potencial, segmento, division, fecha_creacion, estatus, enviado);
                var nivel = 0;
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("Insert into proyectos_vic (id_usuario, nombre_proyecto, potencial, segmento, division, fecha_creacion, estatus, enviado,estrategia,metodo,grupo,nivel) VALUES (?,?,?,?,?,?,?,?,?,?,?,?)",
                            [id_usuario, nombre_proyecto, potencial, segmento, division, fecha_creacion, estatus, enviado,estrategia,metodo,grupo,nivel],
                            function(tx, results){
                               // console.log("guardado",id_usuario, nombre_proyecto, potencial, segmento, division, fecha_creacion, estatus, enviado,estrategia,metodo,grupo,nivel);
                                var id_proyecto = results.insertId;
                                $('#nombre_proyecto').val('');
                                $('#potencial').val('');
                                $('#segmentos').val('0');
                                $('#Estrategias').val('0');
                                $('#grupo').val('');
                                $('#metodo').val('');
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("Select * from proyectos_vic where id_usuario = ? ORDER BY id_proyecto DESC",
                                        [id_usuario],
                                            function(tx, results){
                                                var length = results.rows.length;  
                                                var item = results.rows.item(0);                                                                                  
                                               
                                                    databaseHandler.db.transaction(
                                                        function(tx){
                                                            tx.executeSql("UPDATE ventas_bennetts SET id_proyecto = ?, nivel = ? WHERE id_cedula = ?",
                                                                [id_proyecto,nivel,id_cedula],
                                                                function(tx, results){
                                                                    if(op==2){
                                                                    databaseHandler.db.transaction(
                                                                        function(tx){
                                                                            tx.executeSql("UPDATE cedulas_general SET estatus = ?, fecha_salida = ? WHERE id_cedula = ?",
                                                                                [estatusEn,fecha_creacion,id_cedula],
                                                                                function(tx, results){                                                                   
                                                                                    swal("","El proyecto se guardo correctamente", "success"); 
                                                                                    window.location.href = "./menu.html";
                                                                                },
                                                                                function(tx, error){
                                                                                    swal("Error al guardar",error.message,"error");
                                                                                }
                                                                            );
                                                                        },
                                                                        function(error){},
                                                                        function(){}
                                                                    );
                                                                }else{
                                                                    $("#proyectos").append("<option value="+item.id_proyecto+">"+item.nombre_proyecto+"</option>");
                                                                    app.sheet.close('.my-sheet')
                                                                    swal("","El proyecto se guardo correctamente", "success");
                                                                }
                                                                },
                                                                function(tx, error){
                                                                    console.error("Error al actualizar: " + error.message);
                                                                }
                                                            );
                                                        },
                                                        function(error){},
                                                        function(){}
                                                    );

                                               

                                                
                                                
                                            },
                                            function(tx, error){
                                                console.log("Error al guardar: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            },
                            function(tx, error){
                                swal("Error al guardar",error.message,"error");
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
                }else {
                    app.dialog.alert('El segmento es requerido.', 'Aviso');
                }
            }else{
                app.dialog.alert('El potencial es requerido.', 'Aviso');
            }
        }else{
            app.dialog.alert('El nombre es requerido.', 'Aviso');
        }
    }
    function guardarDatosVentaCI(){
        let id_cedula = localStorage.getItem("IdCedula");
        let id_proyecto= $('#proyectos').val();
        let nombre_proyecto = $('select[name="proyectos"] option:selected').text();
        var Patiende=$('#Patiende').val();
        var Ppuesto=$('#Ppuesto').val();
        var Ptelefono=$('#Ptelefono').val();
        var Pcorreo=$('#Pcorreo').val();
        if (id_proyecto==0){
            swal("", "Favor de seleccionar un proyecto", "warning");
        }else{
            if (Patiende && Ppuesto && Ptelefono && Pcorreo){
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("UPDATE datos_ventas SET nombre_cliente = ?, puesto_cliente = ?, telefono = ?, correo= ?, id_proyecto=? WHERE id_cedula = ?",
                                [Patiende,Ppuesto,Ptelefono,Pcorreo,id_proyecto,id_cedula],
                                function(tx, results){
                                swal("","Se guardaron los datos correctamente", "success");
                                $('#Patiende').css("background-color","#ffffff");
                                $('#Ppuesto').css("background-color","#ffffff");
                                $('#Ptelefono').css("background-color","#ffffff");
                                $('#Pcorreo').css("background-color","#ffffff");
                                },
                                function(tx, error){
                                    console.error("Error al actualizar: " + error.message);
                                }
                            );
                        },
                        function(error){},
                        function(){}
                    );
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("UPDATE cedulas_general SET nombre_cliente = ? WHERE id_cedula = ?",
                                [nombre_proyecto,id_cedula],
                                function(tx, results){
                                swal("","Se guardaron los datos correctamente", "success");
                                },
                                function(tx, error){
                                    console.error("Error al actualizar: " + error.message);
                                }
                            );
                        },
                        function(error){},
                        function(){}
                    );
            }else{
                swal("", "Todos los campos son obligatorios", "warning");
            }
        }   
    }
    function guardarActividadComercialCI(){
        let id_cedula = localStorage.getItem("IdCedula");
        var foto_visita=$('#imagenC').val();
        var nivel = $('#niveles').val();
        var pendiente_vendedor=$('#pendiente_vendor').val();
        if($("#reparadoSi").prop("checked") == true){
            var actualizaNivel = "1";
        } else if($("#reparadoNo").prop("checked")){
            var actualizaNivel = "2";
        }
        if($('#V1').is(':checked') || $('#V2').is(':checked')){ 
            if($('#V1').is(':checked')){ 
                var tipo_visita=$('#V1').val();
            }else if ($('#V2').is(':checked')){
                var tipo_visita=$('#V2').val();
            }
            if(foto_visita){
                if(nivel != 0){
                    if(pendiente_vendedor){
                        //console.log(tipo_visita, nivel, pendiente_vendedor);
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE datos_ventas SET tipo_visita = ?, foto_visita = ?, nivel = ?, pendiente_vendedor= ?,nivel_sube = ?WHERE id_cedula = ?",
                                    [tipo_visita,foto_visita,nivel,pendiente_vendedor,actualizaNivel,id_cedula],
                                    function(tx, results){
                                    //console.log("actualizados datos de evidencia");
                                    swal("","Se guardaron los datos correctamente", "success");
                                    },
                                    function(tx, error){
                                        console.error("Error al actualizar: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }else{
                        swal("", "Todos los campos son requeridos para continuar", "warning");    
                    }
                }else{
                    swal("", "Favor de seleccionar una actividad", "warning");
                }
            }else{
                swal("", "La foto es requerida", "warning");
            }
        }else{
            swal("", "Favor de seleccionar el tipo de visita", "warning");
        }

    }
    function guardarMinutaCI(){
        let id_cedula = localStorage.getItem("IdCedula");
        var tema=$('#tema').val();
        var compromiso=$('#compromiso').val();
        var fecha_compromiso=$('#fecha').val();
        var foto=$('#imagenC').val();
        var fecha = new Date();
        var fecha_tomada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        if (tema && compromiso && fecha_compromiso && foto){
                app.preloader.show('blue');
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("INSERT INTO minuta(id_cedula,tema,compromiso,fecha,foto,fecha_foto) VALUES (?,?,?,?,?,?)",
                            [id_cedula,tema,compromiso,fecha_compromiso,foto,fecha_tomada],
                            function(tx, results){
                                console.log("Datos Guardados");
                                swal("","Se guardaron los datos correctamente", "success");
                                $('#tema').val('');
                                $('#compromiso').val('');
                                $('#fecha').val('');
                                $('#imagenC').val('');
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("Select * from minuta where id_cedula = ? ORDER BY id_minuta DESC",
                                        [id_cedula],
                                            function(tx, results){
                                                var item = results.rows.item(0);
                                                $("#smallImage").attr("src","img/blank.png");
                                                $("#photoIcon").attr("src","img/camera.svg");
                                                $("#VentasBennetts_content").append("<tr id='fila"+ item.id_minuta +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaVIC("+ item.id_minuta +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td id='tdtema' style='text-align: center;'>" + item.tema + "</td><td id='tdfoto'><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td id='tdcompromiso' style='text-align: center;'>" + item.compromiso + "</td><td id='tdfecha' style='text-align: center;'>" + item.fecha + "</td></tr>");
                                                $("#message-nr").css("display", "none");
                                                $('.preloader').remove();
                                                $('.infinite-scroll-preloader').remove();
                                                app.preloader.hide();
                                            },
                                            function(tx, error){
                                                console.log("Error al Mostrar los datos: " + error.message);
                                                app.preloader.hide();
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                        },
                            function(tx, error){
                                console.error("Error al guardar: " + error.message);
                                swal("","Ha ocurrido un error al guardar", "error");
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
        }else{
            swal("", "Todos los campos son obligatorios", "warning");
        }
    }
    //Fin Carnes Ideal
    //Inicio Proteus
    function buscarClienteProteus(){
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_cliente = $("#id_cliente").val();
        var horario_programado = fecha_llegada;
        var foto_llegada = $("#imagenC").val();
        var nombre_cliente = $("#autocomplete-dropdown-ajax").val();
        var orden_servicio = $("#orden_servicio").val();
        var id_visita = $("#id_visita").val();
        var razon_social = $("#razon_social").val();
        var ruc = $("#ruc").val();
        var local = $("#local").val();
        var direccion = $("#direccion").val();
        var nombre_contacto = $("#nombre_contacto").val();
        var telefono1 = $("#telefono1").val();
        var telefono2 = $("#telefono2").val();
        var correo = $("#correo").val();

        var estatus = 0;
        if(foto_llegada != ''){
            if(nombre_cliente != ''){
                productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                            [],
                            function(tx, results){
                                var item = results.rows.item(0);
                                localStorage.setItem("IdCedula", item.Id);
                                localStorage.setItem("nombreCliente", nombre_cliente);
                                localStorage.setItem("foto_llegada", foto_llegada);
                                localStorage.setItem("orden_servicio", orden_servicio);
                                localStorage.setItem("id_visita", id_visita);
                                localStorage.setItem("razon_social", razon_social);
                                localStorage.setItem("ruc", ruc);
                                localStorage.setItem("local", local);
                                localStorage.setItem("direccion", direccion);
                                localStorage.setItem("nombre_contacto", nombre_contacto);
                                localStorage.setItem("telefono1", telefono1);
                                localStorage.setItem("telefono1", telefono1);
                                localStorage.setItem("correo", correo);
                                app.views.main.router.navigate({name: 'menuProteus'});
                                app.preloader.hide();
                            },
                            function(tx, error){
                                console.log("Error al guardar cedula: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            } else {
                swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        } else {
            swal("Falta un campo", "La fotograf√≠a es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }
    }
    function generarReposicionProteus(){
        let id_cedula = localStorage.getItem("IdCedula");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let orden_servicio = localStorage.getItem("orden_servicio");
        let razon_social = localStorage.getItem("razon_social");
        let ruc = localStorage.getItem("ruc");
        let local = localStorage.getItem("local");
        let direccion = localStorage.getItem("direccion");
        let nombre_contacto = localStorage.getItem("nombre_contacto");
        let telefono1 = localStorage.getItem("telefono1");
        let telefono2 = localStorage.getItem("telefono2");
        let email = localStorage.getItem("email");
        let tipoCedula = "Reposicion";
        var tipo = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addDatosGenerales(id_cedula,orden_servicio,foto_llegada,razon_social,ruc,local,direccion,nombre_contacto,telefono1,telefono2,email,tipoCedula);
                        addequiposProteus(orden_servicio);
                        localStorage.setItem("tipoServicio", tipo);
                        app.views.main.router.back('/recorridoProteus1/', {force: true, ignoreCache: true, reload: true});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function generarPreventivoProteus(){
        let id_cedula = localStorage.getItem("IdCedula");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let orden_servicio = localStorage.getItem("orden_servicio");
        let razon_social = localStorage.getItem("razon_social");
        let ruc = localStorage.getItem("ruc");
        let local = localStorage.getItem("local");
        let direccion = localStorage.getItem("direccion");
        let nombre_contacto = localStorage.getItem("nombre_contacto");
        let telefono1 = localStorage.getItem("telefono1");
        let telefono2 = localStorage.getItem("telefono2");
        let email = localStorage.getItem("email");
        let tipoCedula = "Preventivo";
        var tipo = 2;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addDatosGenerales(id_cedula,orden_servicio,foto_llegada,razon_social,ruc,local,direccion,nombre_contacto,telefono1,telefono2,email,tipoCedula);
                        addequiposProteus(orden_servicio);
                        localStorage.setItem("tipoServicio", tipo);
                        app.views.main.router.back('/recorridoProteus2/', {force: true, ignoreCache: true, reload: true});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function generarCorrectivoProteus(){
        let id_cedula = localStorage.getItem("IdCedula");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let orden_servicio = localStorage.getItem("orden_servicio");
        let razon_social = localStorage.getItem("razon_social");
        let ruc = localStorage.getItem("ruc");
        let local = localStorage.getItem("local");
        let direccion = localStorage.getItem("direccion");
        let nombre_contacto = localStorage.getItem("nombre_contacto");
        let telefono1 = localStorage.getItem("telefono1");
        let telefono2 = localStorage.getItem("telefono2");
        let email = localStorage.getItem("email");
        let tipoCedula = "Correctivo";
        var tipo = 3;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addDatosGenerales(id_cedula,orden_servicio,foto_llegada,razon_social,ruc,local,direccion,nombre_contacto,telefono1,telefono2,email,tipoCedula);
                        addequiposProteus(orden_servicio);
                        localStorage.setItem("tipoServicio", tipo);
                        app.views.main.router.back('/recorridoProteus3/', {force: true, ignoreCache: true, reload: true});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    
    function generarInstalacionProteus(){
        let id_cedula = localStorage.getItem("IdCedula");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let orden_servicio = localStorage.getItem("orden_servicio");
        let razon_social = localStorage.getItem("razon_social");
        let ruc = localStorage.getItem("ruc");
        let local = localStorage.getItem("local");
        let direccion = localStorage.getItem("direccion");
        let nombre_contacto = localStorage.getItem("nombre_contacto");
        let telefono1 = localStorage.getItem("telefono1");
        let telefono2 = localStorage.getItem("telefono2");
        let email = localStorage.getItem("email");
        let tipoCedula = "Instalacion";
        var tipo = 4;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addDatosGenerales(id_cedula,orden_servicio,foto_llegada,razon_social,ruc,local,direccion,nombre_contacto,telefono1,telefono2,email,tipoCedula);
                        addequiposProteus(orden_servicio);
                        localStorage.setItem("tipoServicio", tipo);
                        app.views.main.router.back('/recorridoProteus4/', {force: true, ignoreCache: true, reload: true});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDatosGeneralesProteus(){
        //app.preloader.show('blue');
        if($("#orden_servicio").val() == "" || $("#razon_social").val() == "" || $("#ruc").val() == "" || $("#local").val() == "" || $("#direccion").val() == "" || $("#nombre_contacto").val() == "" || $("#telefono1").val() == "" || $("#telefono2").val() == "" || $("#email").val() == ""){
            swal("", "Debes llenar todos los campos" ,"warning");
            app.preloader.hide();
            return false;
        }
        var orden_servicio = $("#orden_servicio").val();
        var razon_social = $("#razon_social").val();
        var ruc = $("#ruc").val();
        var local = $("#local").val();
        var direccion = $("#direccion").val();
        var nombre_contacto = $("#nombre_contacto").val();
        var telefono1 = $("#telefono1").val();
        var telefono2 = $("#telefono2").val();
        var email = $("#email").val();
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datos_generales_proteus SET orden_servicio =?,razon_social =?,ruc =?,local =?,direccion =?,nombre_contacto =?,telefono1 =?,telefono2 =?,email = ? WHERE id_cedula = ?",
                    [orden_servicio,razon_social,ruc,local,direccion,nombre_contacto,telefono1,telefono2,email,id_cedula],
                    function(tx, results){
                        swal("","Se guardaron los datos correctamente", "success");
                        $("#orden_servicio").css("background-color", "#FFFFFF");
                        $("#razon_social").css("background-color", "#FFFFFF");
                        $("#ruc").css("background-color", "#FFFFFF");
                        $("#local").css("background-color", "#FFFFFF");
                        $("#direccion").css("background-color", "#FFFFFF");
                        $("#nombre_contacto").css("background-color", "#FFFFFF");
                        $("#telefono1").css("background-color", "#FFFFFF");
                        $("#telefono2").css("background-color", "#FFFFFF");
                        $("#email").css("background-color", "#FFFFFF");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function continuarCedProteus(id_cedula,tipo){
        localStorage.setItem("IdCedula",id_cedula);
        localStorage.setItem("tipoServicio", tipo);
        localStorage.setItem("Opcion", '1');
        if(tipo == 1){
            app.views.main.router.navigate({ name: 'recorridoProteus1'});
        }else if(tipo == 2){
            app.views.main.router.navigate({ name: 'recorridoProteus2'});
        }else if(tipo == 3){
            app.views.main.router.navigate({ name: 'recorridoProteus3'});
        }else if(tipo == 4){
            app.views.main.router.navigate({ name: 'recorridoProteus4'});
        }
    }
    function regresarProteus(){
        var servicio = localStorage.getItem("tipoServicio");
        if(servicio == 1){
            app.views.main.router.back('/recorridoProteus1/', {force: true, ignoreCache: true, reload: true});
        }else if(servicio == 2){
            app.views.main.router.back('/recorridoProteus2/', {force: true, ignoreCache: true, reload: true});
        }else if(servicio == 3){
            app.views.main.router.back('/recorridoProteus3/', {force: true, ignoreCache: true, reload: true});
        }else if (servicio == 4){
            app.views.main.router.back('/recorridoProteus4/', {force: true, ignoreCache: true, reload: true});
        }
    }
    function guardarEquipoProteus(){
        let id_cedula = localStorage.getItem("IdCedula");
        let id_cliente = 1;
        let modelo = $('select[name="modelo"] option:selected').text();
        let marca = $('select[name="contenedor"] option:selected').text();
        let contenedor=$("#contenedor").val();
        let modelos=$("#modelo").val();
        let ubicacion = $("#ubicacion").val();
        if (modelos== 0){
            swal("", "Debes seleccionar un modelo" ,"warning");
        }else{
            if (contenedor== 'Selecciona un modelo primero'){
                swal("", "Debes seleccionar un contenedor" ,"warning");
            }else{
                if (ubicacion){
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("UPDATE datos_equipos_proteus SET ubicacion=? WHERE id_equipo = ?",
                                [ubicacion, modelos],
                                function(tx, results){
                                    swal("","Se guardaron los datos correctamente", "success");
                                    $("#ubicacion").css("background-color", "#FFFFFF");
                                    $("#ubicacion").val('');
                                    $("#tabla_equipos").empty("");
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("SELECT * from datos_equipos_proteus WHERE id_cedula = ? AND ubicacion <> ''",
                                            [id_cedula],
                                                function(tx, results){
                                                    var length = results.rows.length;
                                                    for(var i = 0; i< length; i++){
                                                        var item = results.rows.item(i);
                                                        $("#tabla_equipos").append("<tr id='fila"+ item.id_equipo +"'><td><a href='#' onclick='eliminarFilaProteus("+item.id_equipo +",4);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td style='text-align: center;'>" + 
                                                            item.modelo + "</td><td style='text-align: center;'>" + 
                                                            item.marca + "</td><td style='text-align: center;'>" + 
                                                            item.ubicacion + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                    }
                                                    $("#modelo").html("<option value='0'>Seleccione una opci√≥n</option>");
                                                    $("#contenedor").val('Selecciona un modelo primero');
                                                    databaseHandler.db.transaction(
                                                        function(tx){
                                                            tx.executeSql("SELECT * from datos_equipos_proteus WHERE id_cedula = ? AND ubicacion == ''",
                                                            [id_cedula],
                                                                function(tx, results){
                                                                    var length = results.rows.length;
                                                                    for(var i = 0; i< length; i++){
                                                                        var item = results.rows.item(i);
                                                                        $("#modelo").append("<option value='"+item.id_equipo+"'>"+item.modelo+"</option>");
                                                                    }
                                                                },
                                                                function(tx, error){
                                                                    console.log("Error:" + error.message);
                                                                    app.preloader.hide();
                                                                }
                                                            );
                                                        },
                                                        function(error){},
                                                        function(){}
                                                    );
                                                },
                                                function(tx, error){
                                                    console.log("Error:" + error.message);
                                                    app.preloader.hide();
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                },
                                function(tx, error){
                                    swal("Error al guardar",error.message,"error");
                                    app.preloader.hide();
                                }
                            );
                        },function(error){},function(){
                        }
                    );
                }else{
                    swal("", "Indica la ubicaci√≥n del equipo" ,"warning");
                }
            }
        }
    }
    function guardarReposicionProteus(){
        var clave = $("#clave").val();
        var id_cedula = localStorage.getItem("IdCedula");
        var equipo = $('select[name="equipo"] option:selected').text();
        var ubicacion = $("#ubicacion").val();
        var kit_micro = $("#kit").val();
        var micro_activados = $("#microorganismos").val();
        var nivelador = $("#nivelador").val();
        var observaciones = $("#observaciones").val();
        if (clave == 1){//niveladorPH
            if(nivelador){
            }else{
                swal("", "Debes llenar el campo de Nivelador" ,"warning");
                return false;
            }
        }else if (clave == 2){//microorganismos
            if(kit_micro || micro_activados){
            }else{
                swal("", "Debes llenar almenos un campo de Microorganismos" ,"warning");
                return false;
            }
        }
        if(observaciones){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * from reposicion_proteus WHERE id_cedula = ?",
                    [id_cedula],
                        function(tx, results){
                            var item = results.rows.item(0);
                            if(results.rows.length == 0){
                                databaseHandler.db.transaction(
                                    function(tx){//id_cedula text,kit_micro text,micro_activados text,nivelador text,observaciones text)",
                                        tx.executeSql("INSERT INTO reposicion_proteus(id_cedula,kit_micro,micro_activados,nivelador,observaciones) VALUES (?,?,?,?,?)",
                                            [id_cedula,kit_micro,micro_activados,nivelador,observaciones],
                                            function(tx, results){
                                                swal("","Se guardaron los datos correctamente", "success");
                                                $("#ubicacion").css("background-color", "#FFFFFF");
                                                $("#kit").css("background-color", "#FFFFFF");
                                                $("#microorganismos").css("background-color", "#FFFFFF");
                                                $("#nivelador").css("background-color", "#FFFFFF");
                                                $("#observaciones").css("background-color", "#FFFFFF");
                                            },
                                            function(tx, error){
                                                swal("Error al guardar",error.message,"error");
                                                app.preloader.hide();
                                            }
                                        );
                                    },function(error){},function(){
                                    }
                                );
                            } else {
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("UPDATE reposicion_proteus SET kit_micro = ?,micro_activados = ?,nivelador = ?,observaciones = ? WHERE id_cedula = ?",
                                            [kit_micro, micro_activados, nivelador, observaciones, id_cedula],
                                            function(tx, results){
                                                swal("","Se guardaron los datos correctamente", "success");
                                                $("#ubicacion").css("background-color", "#FFFFFF");
                                                $("#kit").css("background-color", "#FFFFFF");
                                                $("#microorganismos").css("background-color", "#FFFFFF");
                                                $("#nivelador").css("background-color", "#FFFFFF");
                                                $("#observaciones").css("background-color", "#FFFFFF");
                                            },
                                            function(tx, error){
                                                swal("Error al guardar",error.message,"error");
                                                app.preloader.hide();
                                            }
                                        );
                                    },function(error){},function(){}
                                );
                            }
                        },
                        function(tx, error){
                            console.log("Error:" + error.message);
                            app.preloader.hide();
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else{
            swal("", "Debes colocar una observaci√≥n para poder guardar" ,"warning");
        }
    }
    function guardarEvidenciaProteus(){
        let id_cedula = localStorage.getItem("IdCedula");
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var foto = $("#imagenC").val();
        var comentario = $("#comentario").val();
        var page = 1;
        if (foto){
            if(comentario){}else{comentario='Sin comentario'}
            databaseHandler.db.transaction(
                function(tx){//id_cedula text,comentario text,foto blob,fecha text
                    tx.executeSql("INSERT INTO evidencias_proteus(id_cedula, comentario, foto, fecha,page) VALUES (?,?,?,?,?)",
                        [id_cedula,comentario, foto, fecha_registro, page],
                        function(tx, results){
                        swal("","Se guardaron los datos correctamente", "success");
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql( 
                                        "Select * from evidencias_proteus where id_cedula = ? AND page=? ORDER BY id_evidencia DESC",
                                            [id_cedula,page],
                                            function(tx, results){ 
                                                var item = results.rows.item(0);
                                                $("#tabla_evidencias").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaProteus("+item.id_evidencia +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+
                                                "' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.comentario
                                                + "</td><td style='text-align: center;'>" + item.fecha + "</td></tr>");
                                                $("#comentario").val('');
                                                $("#comentario").css("background-color", "#FFFFFF");
                                                $("#smallImage").attr("src","img/blank.png");
                                                $("#photoIcon").attr("src","img/camera.svg");
                                                $("#imagenC").val('');
                                                    $("#message-nr").css("display", "none");
                                                    $('.preloader').remove();
                                                    $('.infinite-scroll-preloader').remove();
                                            },
                                            function(tx, error){
                                                console.log("Error: " + error.message);
                                                app.preloader.hide();  
                                            }
                                    );  
                                },
                                    function(error){
                                        console.log("Error: " + error.message);
                                    },
                                    function(){}
                            );                
                        },
                        function(tx, error){
                            console.error("Error al actualizar: " + error.message);
                        }
                    );
                },
                function(error){
                    console.error("Error: " + error.message);
                },
                function(){}
            );
        }else{
            swal("", "La fotograf√≠a es requerida" ,"warning");
        }
    }
    function eliminarFilaProteus(index, opc){
        if(opc == 1) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM evidencias_proteus WHERE id_evidencia = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimino satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else if(opc == 2) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM fotos_proteus WHERE id_foto = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimino satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else if(opc == 3) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM datos_equipos_proteus WHERE id_equipo = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimino satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        else if(opc == 4) {
            var id_cedula = localStorage.getItem("IdCedula");
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "UPDATE datos_equipos_proteus SET ubicacion='' WHERE id_equipo = ?",
                        [index],
                        function(tx, results){
                            swal("","El registro se elimino satisfactoriamente","success");
                            $("#fila" + index).remove();
                            $("#modelo").html("<option value='0'>Seleccione una opci√≥n</option>");
                            $("#contenedor").html("<option value='0'>Selecciona un modelo primero</option>");
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("SELECT * from datos_equipos_proteus WHERE id_cedula = ? AND ubicacion == ''",
                                    [id_cedula],
                                        function(tx, results){
                                            var length = results.rows.length;
                                            for(var i = 0; i< length; i++){
                                                var item = results.rows.item(i);
                                                $("#modelo").append("<option value='"+item.id_equipo+"'>"+item.modelo+"</option>");
                                            }
                                        },
                                        function(tx, error){
                                            console.log("Error:" + error.message);
                                            app.preloader.hide();
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function selectProteus(){
        var modelo = $("#modelo").val();
        if (modelo==0){
            $("#contenedor").val('Selecciona un modelo primero');
        }else{
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * from datos_equipos_proteus WHERE id_equipo = ?",
                    [modelo],
                        function(tx, results){
                            var length = results.rows.length;
                            for(var i = 0; i< length; i++){
                                var item = results.rows.item(0);
                                $("#contenedor").val(item.marca);
                            }
                        },
                        function(tx, error){
                            console.log("Error:" + error.message);
                            app.preloader.hide();
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function guardarChecklistProteus(fase,apartado){
        let id_cedula = localStorage.getItem("IdCedula");
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        if (apartado==1){
            var foto =$("#imagenC").val();
        }else {
            var foto =$("#imagenC"+apartado).val();
        }
        if(foto){
            databaseHandler.db.transaction(
                function(tx){//id_cedula, fase text,apartado text, foto blob, fecha
                    tx.executeSql("INSERT INTO fotos_proteus(id_cedula, fase, apartado, foto, fecha) VALUES (?,?,?,?,?)",
                        [id_cedula,fase, apartado,foto, fecha_registro],
                        function(tx, results){
                        swal("","Se guardaron los datos correctamente", "success");
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql( 
                                        "Select * from fotos_proteus where id_cedula = ? ORDER BY id_foto DESC",
                                            [id_cedula],
                                            function(tx, results){ 
                                                var item = results.rows.item(0);
                                                var apartado = '';
                                                if(item.fase==1 && item.apartado == 1){
                                                    apartado='Limpieza interna del bidon/tanque';
                                                }else if(item.fase==1 && item.apartado == 2){
                                                    apartado='Limpieza de filtros';
                                                }else if(item.fase==1 && item.apartado == 3){
                                                    apartado='Limpieza de m√≥dulo de calor';
                                                }else if(item.fase==1 && item.apartado == 4){
                                                    apartado='Limpieza interna de mangueras';
                                                }else if(item.fase==2 && item.apartado == 1){
                                                    apartado='Revisi√≥n de sistema de dispensaci√≥n';
                                                }else if(item.fase==2 && item.apartado == 2){
                                                    apartado="Revisi√≥n de LED's";
                                                }else if(item.fase==3 && item.apartado == 1){
                                                    apartado='Foto de la trampa de grasa abierta';
                                                }else if(item.fase==3 && item.apartado == 2){
                                                    apartado='Foto de la salida de la trampa de grasa';
                                                }else if(item.fase==3 && item.apartado == 3){
                                                    apartado='Punto de muestreo';
                                                }
                                                if(item.fase==1){
                                                    $("#tabla_fotos").append("<tr id='fila"+ item.id_foto +"'><td style='padding-left: 25px;padding-right: 25px;'><a href='#' onclick='eliminarFilaProteus("+item.id_foto +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td style='padding: 10px;'><img src='"+item.foto+
                                                    "' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;padding-left: 18px;padding-right: 18px;'>" + apartado
                                                    + "</td><td style='text-align: center;padding-left: 10px;padding-right: 10px;'>" + item.fecha + "</td></tr>");
                                                }else if(item.fase==2){
                                                    $("#tabla_fotos1").append("<tr id='fila"+ item.id_foto +"'><td style='padding-left: 25px;padding-right: 25px;'><a href='#' onclick='eliminarFilaProteus("+item.id_foto +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td style='padding: 10px;'><img src='"+item.foto+
                                                    "' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;padding-left: 18px;padding-right: 18px;'>" + apartado
                                                    + "</td><td style='text-align: center;padding-left: 10px;padding-right: 10px;'>" + item.fecha + "</td></tr>");
                                                }else if(item.fase==3){
                                                    $("#tabla_fotos2").append("<tr id='fila"+ item.id_foto +"'><td style='padding-left: 25px;padding-right: 25px;'><a href='#' onclick='eliminarFilaProteus("+item.id_foto +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td style='padding: 10px;'><img src='"+item.foto+
                                                    "' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;padding-left: 18px;padding-right: 18px;'>" + apartado
                                                    + "</td><td style='text-align: center;padding-left: 10px;padding-right: 10px;'>" + item.fecha + "</td></tr>");
                                                }
                                                if (item.apartado==1){
                                                    $("#smallImage").attr("src","img/blank.png");
                                                    $("#photoIcon").attr("src","img/camera.svg");
                                                    $("#imagenC").val('');
                                                }else{
                                                    $("#smallImage"+item.apartado).attr("src","img/blank.png");
                                                    $("#photoIcon"+item.apartado).attr("src","img/camera.svg");
                                                    $("#imagenC"+item.apartado).val('');
                                                }
                                                $("#message-nr").css("display", "none");
                                                $('.preloader').remove();
                                                $('.infinite-scroll-preloader').remove();
                                            },
                                            function(tx, error){
                                                console.log("Error: " + error.message);
                                                app.preloader.hide();  
                                            }
                                    );  
                                },
                                    function(error){
                                        console.log("Error: " + error.message);
                                    },
                                    function(){}
                            );                
                        },
                        function(tx, error){
                            console.error("Error al actualizar: " + error.message);
                        }
                    );
                },
                function(error){
                    console.error("Error: " + error.message);
                },
                function(){}
            );
        }else{
            swal("", "La fotograf√≠a es requerida para poder guardar" ,"warning");
        }
    }
    function capturePhoto2() {
        navigator.camera.getPicture(onPhotoSucceess2, onPhotoFail2, {
          quality: 50,
          destinationType: destinationType.DATA_URL,
          targetWidth: 500,
          targetHeight: 500,
          correctOrientation: true
        });
    }
    function onPhotoSucceess2(imageData) {
        var smallImage = document.getElementById('smallImage2');
        smallImage.style.display = 'flex';
        var nameima = "data:image/jpeg;base64," + imageData;
        smallImage.src = "data:image/jpeg;base64," + imageData;
        $("#imagenC2").val(nameima);
        $("#photoIcon2").attr("src","img/reload.svg");
    }
    function onPhotoFail2(message) {
        swal("Error al tomar foto:",message,"error");
    }
    function capturePhoto3() {
        navigator.camera.getPicture(onPhotoSucceess3, onPhotoFail3, {
          quality: 50,
          destinationType: destinationType.DATA_URL,
          targetWidth: 500,
          targetHeight: 500,
          correctOrientation: true
        });
    }
    function onPhotoSucceess3(imageData) {
        var smallImage = document.getElementById('smallImage3');
        smallImage.style.display = 'flex';
        var nameima = "data:image/jpeg;base64," + imageData;
        smallImage.src = "data:image/jpeg;base64," + imageData;
        $("#imagenC3").val(nameima);
        $("#photoIcon3").attr("src","img/reload.svg");
    }
    function onPhotoFail3(message) {
        swal("Error al tomar foto:",message,"error");
    }
    function capturePhoto4() {
        navigator.camera.getPicture(onPhotoSucceess4, onPhotoFail4, {
          quality: 50,
          destinationType: destinationType.DATA_URL,
          targetWidth: 500,
          targetHeight: 500,
          correctOrientation: true
        });
    }
    function onPhotoSucceess4(imageData) {
        var smallImage = document.getElementById('smallImage4');
        smallImage.style.display = 'flex';
        var nameima = "data:image/jpeg;base64," + imageData;
        smallImage.src = "data:image/jpeg;base64," + imageData;
        $("#imagenC4").val(nameima);
        $("#photoIcon4").attr("src","img/reload.svg");
    }
    function onPhotoFail4(message) {
        swal("Error al tomar foto:",message,"error");
    }
    function capturePhoto5() {
        navigator.camera.getPicture(onPhotoSucceess5, onPhotoFail5, {
          quality: 50,
          destinationType: destinationType.DATA_URL,
          targetWidth: 500,
          targetHeight: 500,
          correctOrientation: true
        });
    }
    function onPhotoSucceess5(imageData) {
        var smallImage = document.getElementById('smallImage5');
        smallImage.style.display = 'flex';
        var nameima = "data:image/jpeg;base64," + imageData;
        smallImage.src = "data:image/jpeg;base64," + imageData;
        $("#imagenC5").val(nameima);
        $("#photoIcon5").attr("src","img/reload.svg");
    }
    function onPhotoFail5(message) {
        swal("Error al tomar foto:",message,"error");
    }
    function fallosProteus(id,fase){
        var id_cedula = localStorage.getItem("IdCedula");
        var ids = id.split("_");
        var fallo='';
        if(ids[1] == "1"){
            if($("#"+id).prop("checked") == true){
                $("#fallos_2").prop("checked", false);
            }else{
                $("#fallos_2").prop("true", false);
            }
        }else{
            if($("#"+id).prop("checked") == true){
                $("#fallos_1").prop("checked", false);
            }else{
                $("#fallos_1").prop("true", false);
            }   
        }
        if($("#fallos_1").prop("checked") == true){
            fallo='Si';
        }else if($("#fallos_2").prop("checked") == true){
            fallo='No';
        }
        if(fallo){
            if (fase==1){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("UPDATE check_limpieza SET fallos = ? WHERE id_cedula = ?",
                            [fallo, id_cedula],
                            function(tx, results){
                            },
                            function(tx, error){
                                swal("Error al guardar",error.message,"error");
                                app.preloader.hide();
                            }
                        );
                    },function(error){},function(){}
                );
            }else if (fase==2){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("UPDATE check_revision SET fallos = ? WHERE id_cedula = ?",
                            [fallo, id_cedula],
                            function(tx, results){
                            },
                            function(tx, error){
                                swal("Error al guardar",error.message,"error");
                                app.preloader.hide();
                            }
                        );
                    },function(error){},function(){}
                );
            }
        }
    }
    function componente(id, fase){
        var id_cedula = localStorage.getItem("IdCedula");
        var ids = id.split("_");
        var componente='';
        if(ids[1] == "1"){
            if($("#"+id).prop("checked") == true){
                $("#componente_2").prop("checked", false);
            }else{
                $("#componente_2").prop("true", false);
            }
        }else{
            if($("#"+id).prop("checked") == true){
                $("#componente_1").prop("checked", false);
            }else{
                $("#componente_1").prop("true", false);
            }   
        }
        if($("#componente_1").prop("checked") == true){
            componente='Si';
            $("#piezas").css("display", "block");
            $("#piezas1").css("display", "block");
        }else if($("#componente_2").prop("checked") == true){
            componente='No';
            $("#piezas").css("display", "none");
            $("#piezas").val('');
            $("#piezas1").css("display", "none");
        }
        if(componente){
            if (fase==1){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("UPDATE check_limpieza SET componente = ? WHERE id_cedula = ?",
                            [componente, id_cedula],
                            function(tx, results){
                            },
                            function(tx, error){
                                swal("Error al guardar",error.message,"error");
                                app.preloader.hide();
                            }
                        );
                    },function(error){},function(){}
                );
            }else if (fase==2){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("UPDATE check_revision SET componente = ? WHERE id_cedula = ?",
                            [componente, id_cedula],
                            function(tx, results){
                            },
                            function(tx, error){
                                swal("Error al guardar",error.message,"error");
                                app.preloader.hide();
                            }
                        );
                    },function(error){},function(){}
                );
            }
        }
    }
    function guardaDatosCheckProteus(id,fase){
        var id_cedula = localStorage.getItem("IdCedula");
        if(id=='comentarios'){
            var comentario = $("#"+id).val();
            if (fase==1){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("UPDATE check_limpieza SET comentarios = ? WHERE id_cedula = ?",
                            [comentario, id_cedula],
                            function(tx, results){
                            },
                            function(tx, error){
                                swal("Error al guardar",error.message,"error");
                                app.preloader.hide();
                            }
                        );
                    },function(error){},function(){}
                );  
            }else if (fase==2){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("UPDATE check_revision SET comentarios = ? WHERE id_cedula = ?",
                            [comentario, id_cedula],
                            function(tx, results){
                            },
                            function(tx, error){
                                swal("Error al guardar",error.message,"error");
                                app.preloader.hide();
                            }
                        );
                    },function(error){},function(){}
                );  
            }
        }else if (id=='piezas'){
            var piezas = $("#"+id).val();
            if (fase==1){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("UPDATE check_limpieza SET piezas = ? WHERE id_cedula = ?",
                            [piezas, id_cedula],
                            function(tx, results){
                            },
                            function(tx, error){
                                swal("Error al guardar",error.message,"error");
                                app.preloader.hide();
                            }
                        );
                    },function(error){},function(){}
                );  
            }else if (fase==2){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("UPDATE check_revision SET piezas = ? WHERE id_cedula = ?",
                            [piezas, id_cedula],
                            function(tx, results){
                            },
                            function(tx, error){
                                swal("Error al guardar",error.message,"error");
                                app.preloader.hide();
                            }
                        );
                    },function(error){},function(){}
                );  
            }
        }else if (id=='observaciones'){
            var observaciones = $("#"+id).val();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE check_revision SET observaciones = ? WHERE id_cedula = ?",
                        [observaciones, id_cedula],
                        function(tx, results){
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                            app.preloader.hide();
                        }
                    );
                },function(error){},function(){}
            );  
        }
    }
    function formRevisionProteus(){
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("SELECT * from check_limpieza WHERE id_cedula = ?",
                [id_cedula],
                    function(tx, results){
                        var item = results.rows.item(0);
                        if(results.rows.length == 0){
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("INSERT INTO check_limpieza(id_cedula) VALUES (?)",
                                        [id_cedula],
                                        function(tx, results){
                                            app.views.main.router.navigate({ name: 'formProteus2'});
                                        },
                                        function(tx, error){
                                            swal("Error al guardar",error.message,"error");
                                            app.preloader.hide();
                                        }
                                    );
                                },function(error){},function(){
                                }
                            );
                        } else {
                            app.views.main.router.navigate({ name: 'formProteus2'});
                        }
                    },
                    function(tx, error){
                        console.log("Error:" + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function formEvidenciasProteus(check){
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("SELECT * from check_revision WHERE id_cedula = ?",
                [id_cedula],
                    function(tx, results){
                        var item = results.rows.item(0);
                        if(results.rows.length == 0){
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("INSERT INTO check_revision(id_cedula) VALUES (?)",
                                        [id_cedula],
                                        function(tx, results){
                                            if(check==1){
                                                app.views.main.router.navigate({ name: 'formProteus3'});
                                            }else{
                                                app.views.main.router.navigate({ name: 'formProteus8'});
                                            }
                                        },
                                        function(tx, error){
                                            swal("Error al guardar",error.message,"error");
                                            app.preloader.hide();
                                        }
                                    );
                                },function(error){},function(){
                                }
                            );
                        } else {
                            if(check==1){
                                app.views.main.router.navigate({ name: 'formProteus3'});
                            }else{
                                app.views.main.router.navigate({ name: 'formProteus8'});
                            }
                        }
                    },
                    function(tx, error){
                        console.log("Error:" + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function fuenteProteus(id){
        var id_cedula = localStorage.getItem("IdCedula");
        var ids = id.split("_");
        var fuente='';
        if(ids[1] == "1"){
            if($("#"+id).prop("checked") == true){
                $("#fuente_2").prop("checked", false);
            }else{
                $("#fuente_2").prop("true", false);
            }
        }else{
            if($("#"+id).prop("checked") == true){
                $("#fuente_1").prop("checked", false);
            }else{
                $("#fuente_1").prop("true", false);
            }   
        }
        if($("#fuente_1").prop("checked") == true){
            fuente='Si';
        }else if($("#fuente_2").prop("checked") == true){
            fuente='No';
        }
        if(fuente){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE check_revision SET fuente = ? WHERE id_cedula = ?",
                        [fuente, id_cedula],
                        function(tx, results){
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                            app.preloader.hide();
                        }
                    );
                },function(error){},function(){}
            );
        }
    }
    function funcionamientoProteus(id){
        var id_cedula = localStorage.getItem("IdCedula");
        var ids = id.split("_");
        var funcionamiento='';
        if(ids[1] == "1"){
            if($("#"+id).prop("checked") == true){
                $("#funcionamiento_2").prop("checked", false);
            }else{
                $("#funcionamiento_2").prop("true", false);
            }
        }else{
            if($("#"+id).prop("checked") == true){
                $("#funcionamiento_1").prop("checked", false);
            }else{
                $("#funcionamiento_1").prop("true", false);
            }   
        }
    }
    function guardarMmtoCorrectivo(){
        var id_cedula = localStorage.getItem("IdCedula");
        var reparacion = $("#reparacion").val();
        var funcionamiento = '';
        if($("#funcionamiento_1").prop("checked") == true){
            funcionamiento='Si';
        }else if($("#funcionamiento_2").prop("checked") == true){
            funcionamiento='No';
        }else{
            funcionamiento = '';
        }
        if (reparacion){
            if(funcionamiento != ''){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("SELECT * from mmto_correctivo WHERE id_cedula = ?",
                        [id_cedula],
                            function(tx, results){
                                var item = results.rows.item(0);
                                if(results.rows.length == 0){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("INSERT INTO mmto_correctivo(id_cedula,reparacion,funcionamiento) VALUES (?,?,?)",
                                                [id_cedula,reparacion,funcionamiento],
                                                function(tx, results){
                                                    swal("","Se guardaron los datos correctamente", "success");
                                                    $("#reparacion").css("background-color", "#FFFFFF");
                                                },
                                                function(tx, error){
                                                    swal("Error al guardar",error.message,"error");
                                                    app.preloader.hide();
                                                }
                                            );
                                        },function(error){},function(){
                                        }
                                    );
                                } else {
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("UPDATE mmto_correctivo SET reparacion = ?, funcionamiento = ? WHERE id_cedula = ?",
                                                [reparacion, funcionamiento, id_cedula],
                                                function(tx, results){
                                                    swal("","Se guardaron los datos correctamente", "success");
                                                    $("#reparacion").css("background-color", "#FFFFFF");
                                                },
                                                function(tx, error){
                                                    swal("Error al guardar",error.message,"error");
                                                    app.preloader.hide();
                                                }
                                            );
                                        },function(error){},function(){}
                                    );
                                }
                            },
                            function(tx, error){
                                console.log("Error:" + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            }
            else{
                swal("", "Falta indicar si se v√°lido el funcionamiento." ,"warning");
            }
        }else{
            swal("", "Debes describir la reparaci√≥n a realizar." ,"warning");
        }
    }
    function guardarCierreProteus(){
        var dni ='';
        if($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#eval").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        if($("#cargo").val() == ""){
            swal("","Falta agregar el cargo","warning");
            return false;
        }
        if($("#dni").val() == ""){}else{dni=$("#dni").val();}
        if($("#eval").val() <= '2' && $("#comentario_cliente").val() == ""){
            swal("","Por favor, ingresa el motivo de tu calificacion","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var calificacion = $("#eval").val();
        var comentarioCliente = $('#comentario_cliente').val();
        var cargo = $("#cargo").val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datos_generales_proteus SET firma_cliente = ?,fecha_cliente = ?,cargo = ?,dni = ? WHERE id_cedula = ?",
                    [firmaCliente,fecha_firma,cargo,dni,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                    [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoyProteus/', {force: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarProteus(){
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;

        if($('#imagenC').val() == ""){
            swal({
                title: "Aviso",
                text: "La foto de salida esta vac√≠a, ¬øEstas seguro que deseas continuar as√≠?",
                icon: "warning",
                buttons: true,
                dangerMode: false,
            })
            .then((willGoBack) => {
                if (willGoBack){
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("UPDATE datos_generales_proteus SET foto_salida = ? WHERE id_cedula = ?",
                                [foto_salida,id_cedula],
                                function(tx, results){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("UPDATE cedulas_general SET fecha_salida = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                                [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                                function(tx, results){
                                                    window.location.href = "./menu.html";
                                                },
                                                function(tx, error){
                                                    swal("Error al guardar",error.message,"error");
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                },
                                function(tx, error){
                                    swal("Error al guardar",error.message,"error");
                                }
                            );
                        },
                        function(error){},
                        function(){}
                    );
                } else {}
            });
            return false;
        }
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datos_generales_proteus SET foto_salida = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    
function regresarProteuscheck(fase){
    var id_cedula = localStorage.getItem("IdCedula");
    var paso=0; var paso1=0; var paso2=0;
    if (fase == 1){
        databaseHandler.db.transaction(
            function(tx1){
                tx1.executeSql(
                    "Select * from fotos_proteus where id_cedula= ? AND fase=1 AND apartado IN (2)",
                    [id_cedula],
                    function(tx, results){
                        var length = results.rows.length;
                        if (length == 0){}else{paso=1;}
                        databaseHandler.db.transaction(
                            function(tx1){
                                tx1.executeSql(
                                    "Select * from fotos_proteus where id_cedula= ? AND fase=1 AND apartado IN (4)",
                                    [id_cedula],
                                    function(tx, results){
                                        var length = results.rows.length;
                                        if (length == 0){}else{paso1=1;}
                                        if(paso == 0 || paso1 == 0){
                                            swal({
                                                title: "Aviso",
                                                text: "Aun no agregas evidencias en el apartado de: Limpieza de filtros y/o Limpieza Interna de mangueras. ¬øEstas seguro que deseas regresar?",
                                                icon: "warning",
                                                buttons: true,
                                                dangerMode: false,
                                            })
                                            .then((willGoBack) => {
                                                if (willGoBack){
                                                    app.views.main.router.back('/recorridoProteus2/', {force: true, ignoreCache: true, reload: true});
                                                } else {}
                                            });
                                        } else {
                                            app.views.main.router.back('/recorridoProteus2/', {force: true, ignoreCache: true, reload: true});
                                        }
                                    },
                                    function(tx, error){
                                        console.log("Error al consultar: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.log("Error al consultar: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    if (fase == 2){
        databaseHandler.db.transaction(
            function(tx1){
                tx1.executeSql(
                    "Select * from fotos_proteus where id_cedula= ? AND fase=2 AND apartado IN (1)",
                    [id_cedula],
                    function(tx, results){
                        var length = results.rows.length;
                        if (length == 0){}else{paso=1;}
                        databaseHandler.db.transaction(
                            function(tx1){
                                tx1.executeSql(
                                    "Select * from fotos_proteus where id_cedula= ? AND fase=2 AND apartado IN (2)",
                                    [id_cedula],
                                    function(tx, results){
                                        var length = results.rows.length;
                                        if (length == 0){}else{paso1=1;}
                                        if(paso == 0 || paso1 == 0){
                                            swal({
                                                title: "Aviso",
                                                text: "Aun no agregas evidencias en el apartado de: Revisi√≥n de sistema de dispensaci√≥n y/o Revisi√≥n de LED's. ¬øEstas seguro que deseas regresar?",
                                                icon: "warning",
                                                buttons: true,
                                                dangerMode: false,
                                            })
                                            .then((willGoBack) => {
                                                if (willGoBack){
                                                    app.views.main.router.back('/recorridoProteus2/', {force: true, ignoreCache: true, reload: true});
                                                } else {}
                                            });
                                        } else {
                                            app.views.main.router.back('/recorridoProteus2/', {force: true, ignoreCache: true, reload: true});
                                        }
                                    },
                                    function(tx, error){
                                        console.log("Error al consultar: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.log("Error al consultar: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    if (fase == 3){
        databaseHandler.db.transaction(
            function(tx1){
                tx1.executeSql(
                    "Select * from fotos_proteus where id_cedula= ? AND fase=3 AND apartado IN (1)",
                    [id_cedula],
                    function(tx, results){
                        var length = results.rows.length;
                        if (length == 0){}else{paso=1;}
                        databaseHandler.db.transaction(
                            function(tx1){
                                tx1.executeSql(
                                    "Select * from fotos_proteus where id_cedula= ? AND fase=3 AND apartado IN (2)",
                                    [id_cedula],
                                    function(tx, results){
                                        var length = results.rows.length;
                                        if (length == 0){}else{paso1=1;}
                                        databaseHandler.db.transaction(
                                            function(tx1){
                                                tx1.executeSql(
                                                    "Select * from fotos_proteus where id_cedula= ? AND fase=3 AND apartado IN (3)",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        var length = results.rows.length;
                                                        if (length == 0){}else{paso2=1;}
                                                        if(paso == 0 || paso1 == 0 || paso2 == 0){
                                                            swal({
                                                                title: "Aviso",
                                                                text: "Aun no agregas evidencias en el apartado de: Foto de la trampa de grasa abierta, Foto de la salida de la trampa de grasa y/o Punto de muestreo. ¬øEstas seguro que deseas regresar?",
                                                                icon: "warning",
                                                                buttons: true,
                                                                dangerMode: false,
                                                            })
                                                            .then((willGoBack) => {
                                                                if (willGoBack){
                                                                    app.views.main.router.back('/recorridoProteus2/', {force: true, ignoreCache: true, reload: true});
                                                                } else {}
                                                            });
                                                        } else {
                                                            app.views.main.router.back('/recorridoProteus2/', {force: true, ignoreCache: true, reload: true});
                                                        }
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al consultar: " + error.message);
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        console.log("Error al consultar: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.log("Error al consultar: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
}
    function addequiposProteus(os){
        var id_cedula = localStorage.getItem("IdCedula");
        app.preloader.show('blue');
        var NomDescCli = "equipo_proteus";
        app.request.get(cordova.file.dataDirectory + "jsons/"+NomDescCli+".json", function (data) {
            var content = JSON.parse(data);
            for (var i = 0; i < content.length; i++) {
                if(content[i].os == os){
                    var modelo = content[i].modelo;
                    var id_cliente = content[i].id_cliente;
                    var contenedor = content[i].contenedor;
                    var ubicacion = content[i].ubicacion;
                    productHandler.addEquipoProteus(id_cedula,id_cliente,modelo,contenedor,ubicacion);
                }
            }
            app.preloader.hide();
        });
    }
    function guardarEvidenciaProteus1(page){
        let id_cedula = localStorage.getItem("IdCedula");
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var foto = $("#imagenC").val();
        var comentario = $("#comentario").val();
        if (foto){
            if(comentario){}else{comentario='Sin comentario'}
            databaseHandler.db.transaction(
                function(tx){//id_cedula text,comentario text,foto blob,fecha text
                    tx.executeSql("INSERT INTO evidencias_proteus(id_cedula, comentario, foto, fecha, page) VALUES (?,?,?,?,?)",
                        [id_cedula,comentario, foto, fecha_registro,page],
                        function(tx, results){
                        swal("","Se guardaron los datos correctamente", "success");
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql( 
                                        "Select * from evidencias_proteus where id_cedula = ? AND page = ? ORDER BY id_evidencia DESC",
                                            [id_cedula,page],
                                            function(tx, results){ 
                                                var item = results.rows.item(0);
                                                $("#tabla_evidencias").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaProteus("+item.id_evidencia +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+
                                                "' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.comentario
                                                + "</td><td style='text-align: center;'>" + item.fecha + "</td></tr>");
                                                $("#comentario").val('');
                                                $("#comentario").css("background-color", "#FFFFFF");
                                                $("#smallImage").attr("src","img/blank.png");
                                                $("#photoIcon").attr("src","img/camera.svg");
                                                $("#imagenC").val('');
                                                    $("#message-nr").css("display", "none");
                                                    $('.preloader').remove();
                                                    $('.infinite-scroll-preloader').remove();
                                            },
                                            function(tx, error){
                                                console.log("Error: " + error.message);
                                                app.preloader.hide();  
                                            }
                                    );  
                                },
                                    function(error){
                                        console.log("Error: " + error.message);
                                    },
                                    function(){}
                            );                
                        },
                        function(tx, error){
                            console.error("Error al actualizar: " + error.message);
                        }
                    );
                },
                function(error){
                    console.error("Error: " + error.message);
                },
                function(){}
            );
        }else{
            swal("", "La fotograf√≠a es requerida" ,"warning");
        }
    }
    //Fin Proteus
    //FIled Inicio
    function buscarClienteField(){
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_cliente = "N/A";
        var horario_programado = fecha_llegada;
        var foto_llegada = $("#imagenC").val();
        var nombre_cliente = $("#cliente-Field").val();
        var estatus = 0;
        if(foto_llegada != ''){
            if(nombre_cliente != ''){
                productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                            [],
                            function(tx, results){
                                var item = results.rows.item(0);
                                localStorage.setItem("IdCedula", item.Id);
                                localStorage.setItem("nombreCliente", nombre_cliente);
                                localStorage.setItem("foto_llegada", foto_llegada);
                                app.views.main.router.navigate({name: 'menuField'});
                                app.preloader.hide();
                            },
                            function(tx, error){
                                console.log("Error al guardar cedula: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            } else {
                swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        } else {
            swal("Falta un campo", "La fotograf√≠a es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }
    }
    function iniciarClienteField(){
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_cliente = "N/A";
        var horario_programado = fecha_llegada;
        var foto_llegada = $("#imagenC").val();
        
        var nombre_cliente = localStorage.getItem("nombreCliente");
        var tipo = localStorage.getItem("tipoServicio");
        var orden_servicio = localStorage.getItem("ordenServicio");
        var estatus = 0;
        if(tipo == "Levantamiento"){
            var tipoCedula = "levantamiento";
        } else if(tipo == "Mantenimiento"){
            var tipoCedula = "mantenimiento";
        }
        if(foto_llegada != ''){
            if(nombre_cliente != ''){
                productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                            [],
                            function(tx, results){
                                var item = results.rows.item(0);
                                var id_cedula = item.Id;
                                localStorage.setItem("IdCedula", item.Id);
                                if(tipo == "Levantamiento"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                                [tipoCedula,id_cedula],
                                                function(tx, results){
                                                    productHandler.addLevantamientoFieldC(id_cedula,foto_llegada,nombre_cliente,orden_servicio);
                                                    app.views.main.router.back('/recorridoField1/', {force: true, ignoreCache: true, reload: true});
                                                },
                                                function(tx, error){
                                                    console.error("Error al actualizar el tipo de cedula: " + error.message);
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                } else if(tipo == "Mantenimiento"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                                [tipoCedula,id_cedula],
                                                function(tx, results){
                                                    productHandler.addMantenimientoFieldC(id_cedula,foto_llegada,nombre_cliente,orden_servicio);
                                                    app.views.main.router.back('/recorridoField2/', {force: true, ignoreCache: true, reload: true});
                                                },
                                                function(tx, error){
                                                    console.error("Error al actualizar el tipo de cedula: " + error.message);
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                }
                                
                                // app.views.main.router.navigate({name: 'menuField'});
                                app.preloader.hide();
                            },
                            function(tx, error){
                                console.log("Error al guardar cedula: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            } else {
                swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        } else {
            swal("Falta un campo", "La fotograf√≠a es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }
    }
    function generarLevantamientoField(){
        let id_cedula = localStorage.getItem("IdCedula");
        let nombre_cliente = localStorage.getItem("nombreCliente");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let tipoCedula = "levantamiento";
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addLevantamientoField(id_cedula,foto_llegada,nombre_cliente);
                        app.views.main.router.navigate({name: 'recorridoField1'});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function generarMantenimientoField(){
        let id_cedula = localStorage.getItem("IdCedula");
        let nombre_cliente = localStorage.getItem("nombreCliente");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let tipoCedula = "mantenimiento";
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addMantenimientoField(id_cedula,foto_llegada,nombre_cliente);
                        app.views.main.router.navigate({name: 'recorridoField2'});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDatosLevantamientoField(){
        app.preloader.show('blue');
        if($("#nombreCliente").val() =="" || $("#nombreContacto").val() == "" || $("#telefonoContacto").val() == "" || $("#correoContacto").val() == ""){
            swal("", "Debes llenar todos los campos" ,"warning");
            app.preloader.hide();
            return false;
        }
        var cliente = $("#nombreCliente").val();
        var contacto = $("#nombreContacto").val();
        var telefono = $("#telefonoContacto").val();
        var correo = $("#correoContacto").val();
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE levantamiento_Field SET nombre_cliente = ?,nombre_contacto = ?,telefono_contacto = ?,correo_contacto = ? WHERE id_cedula = ?",
                    [cliente,contacto,telefono,correo,id_cedula],
                    function(tx, results){
                        $("#nombreCliente").css("background-color", "#FFFFFF");
                        $("#nombreContacto").css("background-color", "#FFFFFF");
                        $("#telefonoContacto").css("background-color", "#FFFFFF");
                        $("#correoContacto").css("background-color", "#FFFFFF");
                        swal("", "Se guardaron los datos correctamente" ,"success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDatosMantenimientoField(){
        app.preloader.show('blue');
        if($("#nombreCliente").val() =="" || $("#nombreContacto").val() == "" || $("#telefonoContacto").val() == "" || $("#correoContacto").val() == "" || ($("#servicioC").prop("checked") == false && $("#servicioP").prop("checked") == false)){
            swal("", "Debes llenar todos los campos" ,"warning");
            app.preloader.hide();
            return false;
        }
        var cliente = $("#nombreCliente").val();
        var contacto = $("#nombreContacto").val();
        var telefono = $("#telefonoContacto").val();
        var correo = $("#correoContacto").val();
        if($("#servicioC").prop("checked") == true){
            var servicio = "1";
        } else if($("#servicioP").prop("checked")){
            var servicio = "2";
        }
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE mantenimiento_Field SET nombre_cliente = ?,nombre_contacto = ?,telefono_contacto = ?,correo_contacto = ?,tipo_servicio = ? WHERE id_cedula = ?",
                    [cliente,contacto,telefono,correo,servicio,id_cedula],
                    function(tx, results){
                        $("#nombreCliente").css("background-color", "#FFFFFF");
                        $("#nombreContacto").css("background-color", "#FFFFFF");
                        $("#telefonoContacto").css("background-color", "#FFFFFF");
                        $("#correoContacto").css("background-color", "#FFFFFF");
                        swal("", "Se guardaron los datos correctamente" ,"success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarMantenimientoField(){
        app.preloader.show('blue');
        var id_cedula = localStorage.getItem("IdCedula");
        var orden = $("#ordenServicio").val();
        var marca = $("#marca").val();
        var modelo = $("#modelo").val();
        var serie = $("#numeroSerie").val();
        var descripcion = $('#descripcion').val();
        var foto = $('#imagenC').val()
        var equipo = $('#imagenC1').val()
        var fecha = new Date();
        var fase = "antes";
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE mantenimiento_Field SET orden_servicio = ?,marca = ?,modelo = ?,numero_serie = ?,foto_equipo = ? WHERE id_cedula = ?",
                    [orden,marca,modelo,serie,equipo,id_cedula],
                    function(tx, results){
                        $("#ordenServicio").css("background-color", "#FFFFFF");
                        $("#marca").css("background-color", "#FFFFFF");
                        $("#modelo").css("background-color", "#FFFFFF");
                        $("#numeroSerie").css("background-color", "#FFFFFF");
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("INSERT INTO evidencia_mantenimiento_Field(id_cedula,fase,descripcion,foto_decripcion,fecha_regristro) VALUES (?,?,?,?,?)",
                                    [id_cedula,fase,descripcion,foto,fecha_registro],
                                    function(tx, results){
                                        app.preloader.hide();
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select MAX(id_evidencia) as Id from evidencia_mantenimiento_Field",
                                                    [],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        var id_evidencia = item.Id;
                                                        app.preloader.hide();
                                                        //Consultar el producto
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("Select * from evidencia_mantenimiento_Field where id_evidencia = ?",
                                                                [id_evidencia],
                                                                    function(tx, results){
                                                                        var item = results.rows.item(0);
                                                                        $("#smallImage").attr("src","img/blank.png");
                                                                        $("#descripcion").val("");
                                                                        $('#imagenC').val("");
                                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                                        $("#tabla_mantenimiento tbody").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaField("+ item.id_evidencia +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto_decripcion+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.descripcion) + "</td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                                        $("#message-nr").css("display", "none");
                                                                        $('.preloader').remove();
                                                                        $('.infinite-scroll-preloader').remove();
                                                                        app.preloader.hide();
                                                                    },
                                                                    function(tx, error){
                                                                        console.log("Error al guardar cedula: " + error.message);
                                                                        app.preloader.hide();
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                        swal("","Registro guardado","success");
                                        app.preloader.hide();
                                    },
                                    function(tx, error){
                                        swal("Error al guardar plaga",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarEquipoField(){
        app.preloader.show('blue');
        var id_cedula = localStorage.getItem("IdCedula");
        var orden = $("#ordenServicio").val();
        var marca = $("#marca").val();
        var modelo = $("#modelo").val();
        var serie = $("#numeroSerie").val();
        var motor = $("#tipoMotor").val();
        var boquilla = $("#tipoBoquilla").val();
        var combustible = $("#tipoCombustible").val();
        var mastil = $("#tipoMastil").val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE levantamiento_Field SET orden_servicio = ?,marca = ?,modelo = ?,numero_serie = ?,tipo_motor = ?,tipo_boquilla = ?,tipo_combustible = ?,tipo_mastil = ? WHERE id_cedula = ?",
                    [orden,marca,modelo,serie,motor,boquilla,combustible,mastil,id_cedula],
                    function(tx, results){
                        $("#ordenServicio").css("background-color", "#FFFFFF");
                        $("#marca").css("background-color", "#FFFFFF");
                        $("#modelo").css("background-color", "#FFFFFF");
                        $("#numeroSerie").css("background-color", "#FFFFFF");
                        $("#tipoMotor").css("background-color", "#FFFFFF");
                        $("#tipoBoquilla").css("background-color", "#FFFFFF");
                        $("#tipoCombustible").css("background-color", "#FFFFFF");
                        $("#tipoMastil").css("background-color", "#FFFFFF");
                        swal("", "Se guardaron los datos correctamente" ,"success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarLevantamientoField(){
        app.preloader.show('blue');
        if($("#comentariosEquipo").val() == "" || $('#lugarReparacion').val() == "0" || ($("#reparadoSi").prop("checked") == false && $("#reparadoNo").prop("checked") == false) || $('#observaciones').val() == "" || $('#imagenC').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var comentariosEquipo = $("#comentariosEquipo").val();
        var lugarReparacion = $('#lugarReparacion').val()
        if($("#reparadoSi").prop("checked") == true){
            var reparado = "1";
        } else if($("#reparadoNo").prop("checked")){
            var reparado = "2";
        }
        var observaciones = $('#observaciones').val();
        var foto = $('#imagenC').val()
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE levantamiento_Field SET comentario_equipo = ?,lugar_reparacion = ?,reparo_visita = ? WHERE id_cedula = ?",
                    [comentariosEquipo,lugarReparacion,reparado,id_cedula],
                    function(tx, results){
                        $("#comentariosEquipo").css("background-color", "#FFFFFF");
                        $("#lugarReparacion").css("background-color", "#FFFFFF");
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("INSERT INTO evidencia_levantamiento_Field(id_cedula,observacion,foto_observacion,fecha_regristro) VALUES (?,?,?,?)",
                                    [id_cedula,observaciones,foto,fecha_registro],
                                    function(tx, results){
                                        app.preloader.hide();
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select MAX(id_evidencia) as Id from evidencia_levantamiento_Field",
                                                    [],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        var id_evidencia = item.Id;
                                                        app.preloader.hide();
                                                        //Consultar el producto
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("Select * from evidencia_levantamiento_Field where id_evidencia = ?",
                                                                [id_evidencia],
                                                                    function(tx, results){
                                                                        var item = results.rows.item(0);
                                                                        $("#smallImage").attr("src","img/blank.png");
                                                                        $("#observaciones").val("");
                                                                        $('#imagenC').val("");
                                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                                        $("#tabla_levantamiento tbody").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaField("+ item.id_evidencia +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto_observacion+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.observacion) + "</td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                                        $("#message-nr").css("display", "none");
                                                                        $('.preloader').remove();
                                                                        $('.infinite-scroll-preloader').remove();
                                                                        app.preloader.hide();
                                                                    },
                                                                    function(tx, error){
                                                                        console.log("Error al guardar cedula: " + error.message);
                                                                        app.preloader.hide();
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                        swal("","Registro guardado","success");
                                        app.preloader.hide();
                                    },
                                    function(tx, error){
                                        swal("Error al guardar plaga",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function continuarCedField(id_cedula,tipo){
        localStorage.setItem("IdCedula",id_cedula);
        localStorage.setItem("Opcion", '1');
        if(tipo == 1){
            app.views.main.router.navigate({ name: 'recorridoField1'});
        } else if(tipo == 2){
            app.views.main.router.navigate({ name: 'recorridoField2'});
        }
    }
    function continuarCedMer(id_cedula,tipo){
        localStorage.setItem("IdCedula",id_cedula);
        localStorage.setItem("Opcion", '1');
        if(tipo == 1){
            app.views.main.router.navigate({ name: 'recorridoMerGroup'});
        }
    }
    function eliminarFilaField(index, opc){
        if(opc == 1) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM evidencia_levantamiento_Field WHERE id_evidencia = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 2) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM evidencia_mantenimiento_Field WHERE id_evidencia = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 3) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM evidencia_mantenimiento_Field WHERE id_evidencia = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 4) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM evidencia_mantenimiento_Field WHERE id_evidencia = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function guardarPiezaField(){
        app.preloader.show('blue');
        if($("#pieza").val() == "" || $('#imagenC1').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var pieza = $("#pieza").val();
        var foto = $('#imagenC1').val();
        var fase = "pieza";
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO evidencia_mantenimiento_Field(id_cedula,fase,descripcion,foto_decripcion,fecha_regristro) VALUES (?,?,?,?,?)",
                    [id_cedula,fase,pieza,foto,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_evidencia) as Id from evidencia_mantenimiento_Field",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from evidencia_mantenimiento_Field where id_evidencia = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage1").attr("src","img/blank.png");
                                                        $("#pieza").val("");
                                                        $('#imagenC1').val("");
                                                        $("#photoIcon1").attr("src","img/camera.svg");
                                                        $("#pieza").css("background-color", "#FFFFFF");
                                                        $("#tabla_pieza tbody").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaField("+ item.id_evidencia +",3);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto_decripcion+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.descripcion) + "</td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                        $("#message-nr1").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar la pieza guardada",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Pieza guardada","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarCambioField(){
        app.preloader.show('blue');
        if($("#cambio").val() == "" || $('#imagenC').val() == "" || ($("#piezaChk").prop("checked") == false && $("#cambioChk").prop("checked") == false)){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var pieza = $("#cambio").val();
        var foto = $('#imagenC').val();
        if($("#piezaChk").prop("checked") == true){
            var fase = "pieza";
        } else {
            var fase = "cambio";
        }
        // var fase = "cambio";
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO evidencia_mantenimiento_Field(id_cedula,fase,descripcion,foto_decripcion,fecha_regristro) VALUES (?,?,?,?,?)",
                    [id_cedula,fase,pieza,foto,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_evidencia) as Id from evidencia_mantenimiento_Field",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from evidencia_mantenimiento_Field where id_evidencia = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $("#cambio").val("");
                                                        $('#imagenC').val("");
                                                        $("#cambioChk").prop("checked", false);
                                                        $("#piezaChk").prop("checked", false);
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        $("#cambio").css("background-color", "#FFFFFF");
                                                        $("#tabla_cambio tbody").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaField("+ item.id_evidencia +",4);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto_decripcion+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.descripcion) + "</td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar la pieza guardada",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Pieza guardada","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarCierreLevantamientoField(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#eval").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        if($("#eval").val() <= '2' && $("#comentario_cliente").val() == ""){
            swal("","Por favor, ingresa el motivo de tu calificacion","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var calificacion = $("#eval").val();
        var comentarioCliente = $('#comentario_cliente').val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE levantamiento_Field SET firma_cliente = ?,fecha_cliente = ? WHERE id_cedula = ?",
                    [firmaCliente,fecha_firma,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                    [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoylevantamientoField/', {force: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarCierreMantenimientoField(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#eval").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        if($("#eval").val() <= '2' && $("#comentario_cliente").val() == ""){
            swal("","Por favor, ingresa el motivo de tu calificacion","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var calificacion = $("#eval").val();
        var comentarioCliente = $('#comentario_cliente').val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE mantenimiento_Field SET firma_cliente = ?,fecha_cliente = ? WHERE id_cedula = ?",
                    [firmaCliente,fecha_firma,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                    [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoymantenimientoField/', {force: true, ignoreCache: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarLevantamientoField(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE levantamiento_Field SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarMantenimientooField(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE mantenimiento_Field SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function singleCheck1(valor){
        if($("#reparadoNo").prop("checked") === true){
            $("#reparadoNo").prop("checked", false);
        }
    }
    function singleCheck2(valor){
        if($("#reparadoSi").prop("checked") === true){
            $("#reparadoSi").prop("checked", false);
        }
    }
    function datosCheck1(valor){
        if($("#servicioP").prop("checked") === true){
            $("#servicioP").prop("checked", false);
        }
    }
    function datosCheck2(valor){
        if($("#servicioC").prop("checked") === true){
            $("#servicioC").prop("checked", false);
        }
    }
    function ingressCheck1(valor){
        if($("#cambioChk").prop("checked") === true){
            $("#cambioChk").prop("checked", false);
        }
    }
    function ingressCheck2(valor){
        if($("#piezaChk").prop("checked") === true){
            $("#piezaChk").prop("checked", false);
        }
    }
    function startFromProgramField(nombre,tipo,orden,descripcion){
        localStorage.setItem("nombreCliente", nombre);
        localStorage.setItem("tipoServicio", tipo);
        localStorage.setItem("ordenServicio", orden);
        localStorage.setItem("descripcion", descripcion);
        app.views.main.router.navigate({name: 'yallegueField2'});
    }
    function regresarRecorridoField1(){
        app.views.main.router.back('/recorridoField1/', {force: true, ignoreCache: true, reload: true});
    }
    function regresarRecorridoField2(){
        app.views.main.router.back('/recorridoField2/', {force: true, ignoreCache: true, reload: true});
    }
    function captureSingleField() {
        navigator.camera.getPicture(onSinglePhotoFieldSucceess, onSinglePhotoFieldFail, {
          quality: 100,
          destinationType: destinationType.DATA_URL,
          targetWidth: 500,
          targetHeight: 500,
          correctOrientation: true
        });
    }
    function onSinglePhotoFieldSucceess(imageData) {
        var smallImage = document.getElementById('smallImage1');
        smallImage.style.display = 'flex';
        var nameima = "data:image/jpeg;base64," + imageData;
        smallImage.src = "data:image/jpeg;base64," + imageData;
        $("#imagenC1").val(nameima);
        $("#photoIcon1").attr("src","img/reload.svg");
    }
    function onSinglePhotoFieldFail(message) {
        swal("Error al tomar foto:",message,"error");
    }
    //Field Fin
    //SMC Inicio
    function generarVentaSMC(){
        let id_cedula = localStorage.getItem("IdCedula");
        let nombre_cliente = localStorage.getItem("nombreCliente");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let RFC = localStorage.getItem("RFC");
        let nombrecontacto = localStorage.getItem("nombrecontacto");
        let telefono = localStorage.getItem("telefono");
        let correo = localStorage.getItem("correo");
        let tiposervicio = localStorage.getItem("tiposervicio");
        var orden_servicio = localStorage.getItem("ordenServicio");
        let tipoCedula = "ventaSMC";
        var datosEquipo = localStorage.getItem("datosCliente");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){
            },
            function(){
            }
        );
        productHandler.addVentaSMC(id_cedula,foto_llegada,nombre_cliente,RFC,nombrecontacto,telefono,correo,tiposervicio,orden_servicio);
        var equipoData = datosEquipo.split("/+/");
        if(equipoData[0] == "0"){
            var marca = "";
        } else {
            var marca = equipoData[0];
        }
        if(equipoData[1] == "0"){
            var tipo_motor = "";
        } else {
            var tipo_motor = equipoData[1];
        }
        if(equipoData[2] == "0"){
            var marca_motor = "";
        } else {
            var marca_motor = equipoData[2];
        }
        if(equipoData[3] == "0"){
            var modelo = "";
        } else {
            var modelo = equipoData[3];
        }
        if(equipoData[4] == "0"){
            var serie = "";
        } else {
            var serie = equipoData[4];
        }
        if(equipoData[5] == "0"){
            var aditamentos = "";
        } else {
            var aditamentos = equipoData[5];
        }
        productHandler.addEquipoSMC(id_cedula,marca,tipo_motor,marca_motor,modelo,serie,aditamentos);
        app.views.main.router.navigate({name: 'recorridoSMC3'});
    }
    function buscarClienteSMC(){
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_cliente = $("#id_cliente").val();
        var horario_programado = $("#HorarioProgramado").val();
        var foto_llegada = $("#imagenC").val();
        var RFC = $("#RFC").val();
        var NombreContacto = $("#NombreContacto").val();
        var TelefonoContacto = $("#TelefonoContacto").val();
        var CorreoContacto = $("#CorreoContacto").val();
        var TipoServicio = $("#TipoServicio").val();
        var nombre_cliente = $("#cliente-smc").val();
        var order_service = $("#order_service").val();
        
        if($("#brand").val() == ""){
            var brand = "0";
        } else {
            var brand = $("#brand").val();
        }
        
        if($("#motor_type").val() == ""){
            var motor_type = "0";
        } else {
            var motor_type = $("#motor_type").val();
        }
        
        if($("#motor_brand").val() == ""){
            var motor_brand = "0";
        } else {
            var motor_brand = $("#motor_brand").val();
        }
        
        if($("#motor_model").val() == ""){
            var motor_model = "0";
        } else {
            var motor_model = $("#motor_model").val();
        }
        
        if($("#serie").val() == ""){
            var serie = "0";
        } else {
            var serie = $("#serie").val();
        }
        
        if($("#aditaments").val() == ""){
            var aditaments = "0";
        } else {
            var aditaments = $("#aditaments").val();
        }
        var datosCliente = brand +"/+/"+motor_type+"/+/"+motor_brand+"/+/"+motor_model+"/+/"+serie+"/+/"+aditaments; 
        var estatus = 0;
        if(foto_llegada != ''){
            if(nombre_cliente != ''){
                productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                            [],
                            function(tx, results){
                                var item = results.rows.item(0);
                                localStorage.setItem("IdCedula", item.Id);
                                localStorage.setItem("nombreCliente", nombre_cliente);
                                localStorage.setItem("foto_llegada", foto_llegada);
                                localStorage.setItem("RFC", RFC);
                                localStorage.setItem("nombrecontacto", NombreContacto);
                                localStorage.setItem("telefono", TelefonoContacto);
                                localStorage.setItem("correo", CorreoContacto);
                                localStorage.setItem("tiposervicio", TipoServicio);
                                localStorage.setItem("datosCliente", datosCliente);
                                localStorage.setItem("ordenServicio",order_service);//se agrego
                                app.views.main.router.navigate({name: 'menuSMC'});
                                app.preloader.hide();
                            },
                            function(tx, error){
                                console.log("Error al guardar cedula: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            } else {
                swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        } else {
            swal("Falta un campo", "La fotograf√≠a es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }
    }
    function iniciarClienteSMC(){
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_cliente = localStorage.getItem("IdCte");
        var horario_programado = fecha_llegada;
        var foto_llegada = $("#imagenC").val();
        var nombre_cliente = localStorage.getItem("nombreCliente");
        var tipo = localStorage.getItem("tipoServicio");
        var orden_servicio = localStorage.getItem("ordenServicio");
        var nombre = localStorage.getItem("contact_name");
        var datosCliente = localStorage.getItem("datosCliente");
        var rfc = localStorage.getItem("rfc");
        var telefono = localStorage.getItem("contact_phone");
        var correo = localStorage.getItem("contact_mail");
        var tipo = localStorage.getItem("tipoServicio");
        var marca = localStorage.getItem("brand");
        var tipo_motor = localStorage.getItem("motoy_type");
        var estatus = 0;
        var marca_motor = localStorage.getItem("motor_brand");
        var modelo = localStorage.getItem("brand");
        var serie = localStorage.getItem("serie");
        var aditamentos = localStorage.getItem("aditaments");
        var id_visita = localStorage.getItem("id");
        if(tipo == "Levantamiento"){
            var tipoCedula = "levantamiento";
        } else if(tipo == "Mantenimiento"){
            var tipoCedula = "mantenimiento";
        } else if(tipo == "Ventas"){
            var tipoCedula = "ventaSMC";
        } else if(tipo == "Servicios"){
            var tipoCedula = "servicioSMC";
        }
        if(foto_llegada != ''){
            if(nombre_cliente != ''){
                productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                            [],
                            function(tx, results){
                                var item = results.rows.item(0);
                                var id_cedula = item.Id;
                                localStorage.setItem("IdCedula", item.Id);
                                if(tipo == "Levantamiento"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                                [tipoCedula,id_cedula],
                                                function(tx, results){
                                                    productHandler.addLevantamientoSMCC(id_cedula,foto_llegada,nombre_cliente,orden_servicio);
                                                    app.views.main.router.back('/recorridoSMC1/', {force: true, ignoreCache: true, reload: true});
                                                },
                                                function(tx, error){
                                                    console.error("Error al actualizar el tipo de cedula: " + error.message);
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                } else if(tipo == "Mantenimiento"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                                [tipoCedula,id_cedula],
                                                function(tx, results){
                                                    productHandler.addMantenimientoSMCC(id_cedula,foto_llegada,nombre_cliente,orden_servicio);
                                                    app.views.main.router.back('/recorridoSMC2/', {force: true, ignoreCache: true, reload: true});
                                                },
                                                function(tx, error){
                                                    console.error("Error al actualizar el tipo de cedula: " + error.message);
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                } else if(tipo == "Ventas"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                                [tipoCedula,id_cedula],
                                                function(tx, results){
                                                    productHandler.addVentaSMC(id_cedula,foto_llegada,nombre_cliente,rfc,nombre,telefono,correo,tipo,orden_servicio,id_visita);
                                                    productHandler.addEquipoSMC(id_cedula,marca,tipo_motor,marca_motor,modelo,serie,aditamentos);
                                                    app.views.main.router.back('/recorridoSMC3/', {force: true, ignoreCache: true, reload: true});
                                                },
                                                function(tx, error){
                                                    console.error("Error al actualizar el tipo de cedula: " + error.message);
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                } else if(tipo == "Servicios"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                                [tipoCedula,id_cedula],
                                                function(tx, results){
                                                    productHandler.addServicioSMC(id_cedula,foto_llegada,nombre_cliente,rfc,nombre,telefono,correo,tipo,orden_servicio,id_visita);
                                                    productHandler.addEquipoSMC2(id_cedula,marca,tipo_motor,marca_motor,modelo,serie,aditamentos);
                                                    app.views.main.router.back('/recorridoSMC4/', {force: true, ignoreCache: true, reload: true});
                                                },
                                                function(tx, error){
                                                    console.error("Error al actualizar el tipo de cedula: " + error.message);
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                }
                                
                                // app.views.main.router.navigate({name: 'menuSMC'});
                                app.preloader.hide();
                            },
                            function(tx, error){
                                console.log("Error al guardar cedula: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            } else {
                swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        } else {
            swal("Falta un campo", "La fotograf√≠a es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }
    }
    function generarLevantamientoSMC(){
        let id_cedula = localStorage.getItem("IdCedula");
        let nombre_cliente = localStorage.getItem("nombreCliente");
        let nombrecontacto = localStorage.getItem("nombrecontacto");
        let telefono = localStorage.getItem("telefono");
        let correo = localStorage.getItem("correo");
        var order_service = localStorage.getItem("ordenServicio");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let id_visita = localStorage.getItem("id_visita");
        let tipoCedula = "levantamiento";
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
        productHandler.addLevantamientoSMC(id_cedula,foto_llegada,nombre_cliente,nombrecontacto,telefono,correo,order_service,id_visita);
        app.views.main.router.navigate({name: 'recorridoSMC1'});
    }
    function generarMantenimientoSMC(){
        let id_cedula = localStorage.getItem("IdCedula");
        let nombre_cliente = localStorage.getItem("nombreCliente");
        let nombrecontacto = localStorage.getItem("nombrecontacto");
        let telefono = localStorage.getItem("telefono");
        let correo = localStorage.getItem("correo");
        var order_service = localStorage.getItem("ordenServicio");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let id_visita = localStorage.getItem("id_visita");
        let tipoCedula = "mantenimiento";
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
        productHandler.addMantenimientoSMC(id_cedula,foto_llegada,nombre_cliente,nombrecontacto,telefono,correo,order_service,id_visita);
        app.views.main.router.navigate({name: 'recorridoSMC2'});
    }
    
    function generarServicioSMC(){
        let id_cedula = localStorage.getItem("IdCedula");
        let nombre_cliente = localStorage.getItem("nombreCliente");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let RFC = localStorage.getItem("RFC");
        let nombrecontacto = localStorage.getItem("nombrecontacto");
        let telefono = localStorage.getItem("telefono");
        let correo = localStorage.getItem("correo");
        let tiposervicio = localStorage.getItem("tiposervicio");
        let tipoCedula = "servicioSMC";
        var datosEquipo = localStorage.getItem("datosCliente");
        var id_visita = localStorage.getItem("id_visita");
        var order_service = localStorage.getItem("ordenServicio");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){}
        );
        productHandler.addServicioSMC(id_cedula,foto_llegada,nombre_cliente,RFC,nombrecontacto,telefono,correo,tiposervicio,order_service,id_visita);
        var equipoData = datosEquipo.split("/+/");
        if(equipoData[0] == "0"){
            var marca = "";
        } else {
            var marca = equipoData[0];
        }
        if(equipoData[1] == "0"){
            var tipo_motor = "";
        } else {
            var tipo_motor = equipoData[1];
        }
        if(equipoData[2] == "0"){
            var marca_motor = "";
        } else {
            var marca_motor = equipoData[2];
        }
        if(equipoData[3] == "0"){
            var modelo = "";
        } else {
            var modelo = equipoData[3];
        }
        if(equipoData[4] == "0"){
            var serie = "";
        } else {
            var serie = equipoData[4];
        }
        if(equipoData[5] == "0"){
            var aditamentos = "";
        } else {
            var aditamentos = equipoData[5];
        }
        productHandler.addEquipoSMC2(id_cedula,marca,tipo_motor,marca_motor,modelo,serie,aditamentos);
        app.views.main.router.navigate({name: 'recorridoSMC4'});
    }
    function guardarDatosLevantamientoSMC(){
        app.preloader.show('blue');
        if($("#nombreCliente").val() =="" || $("#nombreContacto").val() == "" || $("#telefonoContacto").val() == "" || $("#correoContacto").val() == ""){
            swal("", "Debes llenar todos los campos" ,"warning");
            app.preloader.hide();
            return false;
        }
        var cliente = $("#nombreCliente").val();
        var contacto = $("#nombreContacto").val();
        var telefono = $("#telefonoContacto").val();
        var correo = $("#correoContacto").val();
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE levantamiento_smc SET nombre_cliente = ?,nombre_contacto = ?,telefono_contacto = ?,correo_contacto = ? WHERE id_cedula = ?",
                    [cliente,contacto,telefono,correo,id_cedula],
                    function(tx, results){
                        $("#nombreCliente").css("background-color", "#FFFFFF");
                        $("#nombreContacto").css("background-color", "#FFFFFF");
                        $("#telefonoContacto").css("background-color", "#FFFFFF");
                        $("#correoContacto").css("background-color", "#FFFFFF");
                        swal("", "Se guardaron los datos correctamente" ,"success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDatosGMantenimientoSMC(){
        app.preloader.show('blue');
        if($("#nombreCliente").val() =="" || $("#nombreContacto").val() == "" || $("#telefonoContacto").val() == "" || $("#correoContacto").val() == "" || ($("#servicioC").prop("checked") == false && $("#servicioP").prop("checked") == false)){
            swal("", "Debes llenar todos los campos" ,"warning");
            app.preloader.hide();
            return false;
        }
        var cliente = $("#nombreCliente").val();
        var contacto = $("#nombreContacto").val();
        var telefono = $("#telefonoContacto").val();
        var correo = $("#correoContacto").val();
        if($("#servicioC").prop("checked") == true){
            var servicio = "1";
        } else if($("#servicioP").prop("checked")){
            var servicio = "2";
        }
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE mantenimiento_smc SET nombre_cliente = ?,nombre_contacto = ?,telefono_contacto = ?,correo_contacto = ?,tipo_servicio = ? WHERE id_cedula = ?",
                    [cliente,contacto,telefono,correo,servicio,id_cedula],
                    function(tx, results){
                        $("#nombreCliente").css("background-color", "#FFFFFF");
                        $("#nombreContacto").css("background-color", "#FFFFFF");
                        $("#telefonoContacto").css("background-color", "#FFFFFF");
                        $("#correoContacto").css("background-color", "#FFFFFF");
                        swal("", "Se guardaron los datos correctamente" ,"success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDatosVentaSMC(){
        app.preloader.show('blue');
        if($("#nombreCliente").val() =="" || $("#rfc").val() == "" || $("#nombreContacto").val() == "" || $("#telefonoContacto").val() == "" || $("#correoContacto").val() == "" || $("#tipoVisita").val() == ""){
            swal("", "Debes llenar todos los campos" ,"warning");
            app.preloader.hide();
            return false;
        }
        var cliente = $("#nombreCliente").val();
        var rfc = $("#rfc").val();
        var nombreContacto = $("#nombreContacto").val();
        var telefonoContacto = $("#telefonoContacto").val();
        var correoContacto = $("#correoContacto").val();
        var tipoVisita = $("#tipoVisita").val();
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE ventaSMC SET nombre_cliente = ?,rfc_cliente = ?,nombre_contacto = ?,telefono_contacto = ?,correo_contacto = ?,tipo_visita = ? WHERE id_cedula = ?",
                    [cliente,rfc,nombreContacto,telefonoContacto,correoContacto,tipoVisita,id_cedula],
                    function(tx, results){
                        $("#nombreCliente").css("background-color", "#FFFFFF");
                        $("#rfc").css("background-color", "#FFFFFF");
                        $("#nombreContacto").css("background-color", "#FFFFFF");
                        $("#telefonoContacto").css("background-color", "#FFFFFF");
                        $("#correoContacto").css("background-color", "#FFFFFF");
                        $("#tipoVisita").css("background-color", "#FFFFFF");
                        swal("", "Se guardaron los datos correctamente" ,"success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDatosServicioSMC(){
        app.preloader.show('blue');
        if($("#nombreCliente").val() =="" || $("#rfc").val() == "" || $("#nombreContacto").val() == "" || $("#telefonoContacto").val() == "" || $("#correoContacto").val() == "" || $("#tipoVisita").val() == ""){
            swal("", "Debes llenar todos los campos" ,"warning");
            app.preloader.hide();
            return false;
        }
        var cliente = $("#nombreCliente").val();
        var rfc = $("#rfc").val();
        var nombreContacto = $("#nombreContacto").val();
        var telefonoContacto = $("#telefonoContacto").val();
        var correoContacto = $("#correoContacto").val();
        var tipoVisita = $("#tipoVisita").val();
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE servicioSMC SET nombre_cliente = ?,rfc_cliente = ?,nombre_contacto = ?,telefono_contacto = ?,correo_contacto = ?,tipo_visita = ? WHERE id_cedula = ?",
                    [cliente,rfc,nombreContacto,telefonoContacto,correoContacto,tipoVisita,id_cedula],
                    function(tx, results){
                        $("#nombreCliente").css("background-color", "#FFFFFF");
                        $("#rfc").css("background-color", "#FFFFFF");
                        $("#nombreContacto").css("background-color", "#FFFFFF");
                        $("#telefonoContacto").css("background-color", "#FFFFFF");
                        $("#correoContacto").css("background-color", "#FFFFFF");
                        $("#tipoVisita").css("background-color", "#FFFFFF");
                        swal("", "Se guardaron los datos correctamente" ,"success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarMantenimientoSMC(){
        app.preloader.show('blue');
        var id_cedula = localStorage.getItem("IdCedula");
        var orden = $("#ordenServicio").val();
        var marca = $("#marca").val();
        var modelo = $("#modelo").val();
        var serie = $("#numeroSerie").val();
        var descripcion = $('#descripcion').val();
        var foto = $('#imagenC').val()
        var equipo = $('#imagenC1').val()
        var fecha = new Date();
        var fase = "antes";
        if (foto && descripcion && orden && marca && modelo && serie && equipo){
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE mantenimiento_smc SET orden_servicio = ?,marca = ?,modelo = ?,numero_serie = ?,foto_equipo = ? WHERE id_cedula = ?",
                    [orden,marca,modelo,serie,equipo,id_cedula],
                    function(tx, results){
                        $("#ordenServicio").css("background-color", "#FFFFFF");
                        $("#marca").css("background-color", "#FFFFFF");
                        $("#modelo").css("background-color", "#FFFFFF");
                        $("#numeroSerie").css("background-color", "#FFFFFF");
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("INSERT INTO evidencia_mantenimiento_smc(id_cedula,fase,descripcion,foto_decripcion,fecha_regristro) VALUES (?,?,?,?,?)",
                                    [id_cedula,fase,descripcion,foto,fecha_registro],
                                    function(tx, results){
                                        app.preloader.hide();
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select MAX(id_evidencia) as Id from evidencia_mantenimiento_smc",
                                                    [],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        var id_evidencia = item.Id;
                                                        app.preloader.hide();
                                                        //Consultar el producto
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("Select * from evidencia_mantenimiento_smc where id_evidencia = ?",
                                                                [id_evidencia],
                                                                    function(tx, results){
                                                                        var item = results.rows.item(0);
                                                                        $("#smallImage").attr("src","img/blank.png");
                                                                        $("#descripcion").val("");
                                                                        $("#descripcion").css("background-color", "#FFFFFF");
                                                                        $('#imagenC').val("");
                                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                                        $("#tabla_mantenimiento tbody").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaSMC("+ item.id_evidencia +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto_decripcion+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.descripcion) + "</td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                                        $("#message-nr").css("display", "none");
                                                                        $('.preloader').remove();
                                                                        $('.infinite-scroll-preloader').remove();
                                                                        app.preloader.hide();
                                                                    },
                                                                    function(tx, error){
                                                                        console.log("Error al guardar cedula: " + error.message);
                                                                        app.preloader.hide();
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                        swal("","Registro guardado","success");
                                        app.preloader.hide();
                                    },
                                    function(tx, error){
                                        swal("Error al guardar plaga",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
        }else{
            swal("","Todos los campos son obligatorios","warning");
            app.preloader.hide();
        }
    }
    function guardarVentasAntesSMC(){
        app.preloader.show('blue');
        var id_cedula = localStorage.getItem("IdCedula");
        var foto = $('#imagenC').val();
        var comentarios = $('#comentarios').val();
        var fecha = new Date();
        var fase = "antes";
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        if(foto == "" || comentarios == ""){
            swal("","La foto y/o el comentario son obligatorios","warning");
            app.preloader.hide();
        } else {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("INSERT INTO evidencia_venta_smc(id_cedula,fase,foto,comentario,fecha_regristro) VALUES (?,?,?,?,?)",
                        [id_cedula,fase,foto,comentarios,fecha_registro],
                        function(tx, results){
                            app.preloader.hide();
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("Select MAX(id_evidencia) as Id from evidencia_venta_smc",
                                        [],
                                        function(tx, results){
                                            var item = results.rows.item(0);
                                            var id_evidencia = item.Id;
                                            app.preloader.hide();
                                            //Consultar el producto
                                            databaseHandler.db.transaction(
                                                function(tx){
                                                    tx.executeSql("Select * from evidencia_venta_smc where id_evidencia = ?",
                                                    [id_evidencia],
                                                        function(tx, results){
                                                            var item = results.rows.item(0);
                                                            $("#smallImage").attr("src","img/blank.png");
                                                            $('#imagenC').val("");
                                                            $('#comentarios').val("");
                                                            $("#comentarios").css("background-color", "#FFFFFF");
                                                            $("#photoIcon").attr("src","img/camera.svg");
                                                            $("#tabla_ventas tbody").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaSMC("+ item.id_evidencia +",5);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px'/></td><td style='text-align: center;'>" + item.comentario + "</td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                            $("#message-nr").css("display", "none");
                                                            $('.preloader').remove();
                                                            $('.infinite-scroll-preloader').remove();
                                                            app.preloader.hide();
                                                        },
                                                        function(tx, error){
                                                            console.log("Error al guardar cedula: " + error.message);
                                                            app.preloader.hide();
                                                        }
                                                    );
                                                },
                                                function(error){},
                                                function(){}
                                            );
                                        },
                                        function(tx, error){
                                            swal("Error al mostrar Registro guardado",error.message,"error");
                                            app.preloader.hide();
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                            swal("","Registro guardado","success");
                            app.preloader.hide();
                        },
                        function(tx, error){
                            swal("Error al guardar plaga",error.message,"error");
                            app.preloader.hide();
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function guardarServicioAntesSMC(){
        app.preloader.show('blue');
        var id_cedula = localStorage.getItem("IdCedula");
        var foto = $('#imagenC').val();
        var comentarios = $('#comentarios').val();
        var fecha = new Date();
        var fase = "antes";
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        if(foto == "" || comentarios == ""){
            swal("","La foto y/o el comentario son obligatorios","warning");
            app.preloader.hide();
        } else {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("INSERT INTO evidencia_servicio_smc(id_cedula,fase,foto,comentario,fecha_regristro) VALUES (?,?,?,?,?)",
                        [id_cedula,fase,foto,comentarios,fecha_registro],
                        function(tx, results){
                            app.preloader.hide();
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("Select MAX(id_evidencia) as Id from evidencia_servicio_smc",
                                        [],
                                        function(tx, results){
                                            var item = results.rows.item(0);
                                            var id_evidencia = item.Id;
                                            app.preloader.hide();
                                            //Consultar el producto
                                            databaseHandler.db.transaction(
                                                function(tx){
                                                    tx.executeSql("Select * from evidencia_servicio_smc where id_evidencia = ?",
                                                    [id_evidencia],
                                                        function(tx, results){
                                                            var item = results.rows.item(0);
                                                            $("#smallImage").attr("src","img/blank.png");
                                                            $('#imagenC').val("");
                                                            $('#comentarios').val("");
                                                            $("#photoIcon").attr("src","img/camera.svg");
                                                            $("#tabla_ventas tbody").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaSMC("+ item.id_evidencia +",6);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px'/></td><td style='text-align: center;'>" + item.comentario + "</td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                            $("#message-nr").css("display", "none");
                                                            $('.preloader').remove();
                                                            $('.infinite-scroll-preloader').remove();
                                                            app.preloader.hide();
                                                        },
                                                        function(tx, error){
                                                            console.log("Error al guardar cedula: " + error.message);
                                                            app.preloader.hide();
                                                        }
                                                    );
                                                },
                                                function(error){},
                                                function(){}
                                            );
                                        },
                                        function(tx, error){
                                            swal("Error al mostrar Registro guardado",error.message,"error");
                                            app.preloader.hide();
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                            swal("","Registro guardado","success");
                            $('#comentarios').css("background-color", "#FFFFFF")
                            app.preloader.hide();
                        },
                        function(tx, error){
                            swal("Error al guardar plaga",error.message,"error");
                            app.preloader.hide();
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function guardarVentasDespuesSMC(){
        app.preloader.show('blue');
        var id_cedula = localStorage.getItem("IdCedula");
        var foto = $('#imagenC').val();
        var comentarios = $('#comentarios').val();
        var fecha = new Date();
        var fase = "despues";
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE ventaSMC SET comentario_despues = ? WHERE id_cedula = ?",
                    [comentarios,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                if(foto){
                                    tx.executeSql("INSERT INTO evidencia_venta_smc(id_cedula,fase,foto,fecha_regristro) VALUES (?,?,?,?)",
                                        [id_cedula,fase,foto,fecha_registro],
                                        function(tx, results){
                                            app.preloader.hide();
                                            databaseHandler.db.transaction(
                                                function(tx){
                                                    tx.executeSql("Select MAX(id_evidencia) as Id from evidencia_venta_smc",
                                                        [],
                                                        function(tx, results){
                                                            var item = results.rows.item(0);
                                                            var id_evidencia = item.Id;
                                                            app.preloader.hide();
                                                            //Consultar el producto
                                                            databaseHandler.db.transaction(
                                                                function(tx){
                                                                    tx.executeSql("Select * from evidencia_venta_smc where id_evidencia = ?",
                                                                    [id_evidencia],
                                                                        function(tx, results){
                                                                            var item = results.rows.item(0);
                                                                            $("#smallImage").attr("src","img/blank.png");
                                                                            $('#imagenC').val("");
                                                                            $("#photoIcon").attr("src","img/camera.svg");
                                                                            $("#tabla_ventas tbody").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaSMC("+ item.id_evidencia +",5);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                                            $("#message-nr").css("display", "none");
                                                                            $('.preloader').remove();
                                                                            $('.infinite-scroll-preloader').remove();
                                                                            app.preloader.hide();
                                                                        },
                                                                        function(tx, error){
                                                                            console.log("Error al guardar cedula: " + error.message);
                                                                            app.preloader.hide();
                                                                        }
                                                                    );
                                                                },
                                                                function(error){},
                                                                function(){}
                                                            );
                                                        },
                                                        function(tx, error){
                                                            swal("Error al mostrar Registro guardado",error.message,"error");
                                                            app.preloader.hide();
                                                        }
                                                    );
                                                },
                                                function(error){},
                                                function(){}
                                            );
                                            swal("","Registro guardado","success");
                                            app.preloader.hide();
                                        },
                                        function(tx, error){
                                            swal("Error al guardar plaga",error.message,"error");
                                            app.preloader.hide();
                                        }
                                    );
                                } else {
                                    if(comentarios){
                                        swal("","Comentario general Actualizado","success");
                                        app.preloader.hide();
                                    } else {
                                        swal("","No hay datos para guardar, ingresa una foto o un comentario.","warning");
                                        app.preloader.hide();
                                    }
                                    
                                }
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarServicioDespuesSMC(){
        app.preloader.show('blue');
        var id_cedula = localStorage.getItem("IdCedula");
        var foto = $('#imagenC').val();
        var comentarios = $('#comentarios').val();
        var fecha = new Date();
        var fase = "despues";
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        if(foto == "" || comentarios == ""){
            swal("","La foto y/o el comentario son obligatorios","warning");
            app.preloader.hide();
        } else {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("INSERT INTO evidencia_servicio_smc(id_cedula,fase,foto,comentario,fecha_regristro) VALUES (?,?,?,?,?)",
                        [id_cedula,fase,foto,comentarios,fecha_registro],
                        function(tx, results){
                            app.preloader.hide();
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("Select MAX(id_evidencia) as Id from evidencia_servicio_smc",
                                        [],
                                        function(tx, results){
                                            var item = results.rows.item(0);
                                            var id_evidencia = item.Id;
                                            app.preloader.hide();
                                            //Consultar el producto
                                            databaseHandler.db.transaction(
                                                function(tx){
                                                    tx.executeSql("Select * from evidencia_servicio_smc where id_evidencia = ?",
                                                    [id_evidencia],
                                                        function(tx, results){
                                                            var item = results.rows.item(0);
                                                            $("#smallImage").attr("src","img/blank.png");
                                                            $('#imagenC').val("");
                                                            $('#comentarios').val("");
                                                            $("#comentarios").css("background-color", "#FFFFFF");
                                                            $("#photoIcon").attr("src","img/camera.svg");
                                                            $("#tabla_ventas tbody").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaSMC("+ item.id_evidencia +",6);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px'/></td><td style='text-align: center;'>" + item.comentario + "</td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                            $("#message-nr").css("display", "none");
                                                            $('.preloader').remove();
                                                            $('.infinite-scroll-preloader').remove();
                                                            app.preloader.hide();
                                                        },
                                                        function(tx, error){
                                                            console.log("Error al guardar cedula: " + error.message);
                                                            app.preloader.hide();
                                                        }
                                                    );
                                                },
                                                function(error){},
                                                function(){}
                                            );
                                        },
                                        function(tx, error){
                                            swal("Error al mostrar Registro guardado",error.message,"error");
                                            app.preloader.hide();
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                            swal("","Registro guardado","success");
                            app.preloader.hide();
                        },
                        function(tx, error){
                            swal("Error al guardar plaga",error.message,"error");
                            app.preloader.hide();
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function guardarEquipoSMC(){
        app.preloader.show('blue');
        var id_cedula = localStorage.getItem("IdCedula");
        var orden = $("#ordenServicio").val();
        var marca = $("#marca").val();
        var modelo = $("#modelo").val();
        var serie = $("#numeroSerie").val();
        var motor = $("#tipoMotor").val();
        var boquilla = $("#tipoBoquilla").val();
        var combustible = $("#tipoCombustible").val();
        var mastil = $("#tipoMastil").val();
        if (orden && marca && modelo && serie && motor && boquilla && combustible && mastil){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE levantamiento_smc SET orden_servicio = ?,marca = ?,modelo = ?,numero_serie = ?,tipo_motor = ?,tipo_boquilla = ?,tipo_combustible = ?,tipo_mastil = ? WHERE id_cedula = ?",
                        [orden,marca,modelo,serie,motor,boquilla,combustible,mastil,id_cedula],
                        function(tx, results){
                            $("#ordenServicio").css("background-color", "#FFFFFF");
                            $("#marca").css("background-color", "#FFFFFF");
                            $("#modelo").css("background-color", "#FFFFFF");
                            $("#numeroSerie").css("background-color", "#FFFFFF");
                            $("#tipoMotor").css("background-color", "#FFFFFF");
                            $("#tipoBoquilla").css("background-color", "#FFFFFF");
                            $("#tipoCombustible").css("background-color", "#FFFFFF");
                            $("#tipoMastil").css("background-color", "#FFFFFF");
                            swal("", "Se guardaron los datos correctamente" ,"success");
                            app.preloader.hide();
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                            app.preloader.hide();
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else{
            swal("","Favor de llenar todos los campos.","warning");
            app.preloader.hide();
        }
    }
    function guardarLevantamientoSMC(){
        app.preloader.show('blue');
        if($("#comentariosEquipo").val() == "" || $('#lugarReparacion').val() == "0" || ($("#reparadoSi").prop("checked") == false && $("#reparadoNo").prop("checked") == false) || $('#observaciones').val() == "" || $('#imagenC').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var comentariosEquipo = $("#comentariosEquipo").val();
        var lugarReparacion = $('#lugarReparacion').val()
        if($("#reparadoSi").prop("checked") == true){
            var reparado = "1";
        } else if($("#reparadoNo").prop("checked")){
            var reparado = "2";
        }
        var observaciones = $('#observaciones').val();
        var foto = $('#imagenC').val()
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE levantamiento_smc SET comentario_equipo = ?,lugar_reparacion = ?,reparo_visita = ? WHERE id_cedula = ?",
                    [comentariosEquipo,lugarReparacion,reparado,id_cedula],
                    function(tx, results){
                        $("#comentariosEquipo").css("background-color", "#FFFFFF");
                        $("#lugarReparacion").css("background-color", "#FFFFFF");
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("INSERT INTO evidencia_levantamiento_smc(id_cedula,observacion,foto_observacion,fecha_regristro) VALUES (?,?,?,?)",
                                    [id_cedula,observaciones,foto,fecha_registro],
                                    function(tx, results){
                                        app.preloader.hide();
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select MAX(id_evidencia) as Id from evidencia_levantamiento_smc",
                                                    [],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        var id_evidencia = item.Id;
                                                        app.preloader.hide();
                                                        //Consultar el producto
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("Select * from evidencia_levantamiento_smc where id_evidencia = ?",
                                                                [id_evidencia],
                                                                    function(tx, results){
                                                                        var item = results.rows.item(0);
                                                                        $("#smallImage").attr("src","img/blank.png");
                                                                        $("#observaciones").val("");
                                                                        $("#observaciones").css("background-color", "#FFFFFF");
                                                                        $('#imagenC').val("");
                                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                                        $("#tabla_levantamiento tbody").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaSMC("+ item.id_evidencia +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto_observacion+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.observacion) + "</td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                                        $("#message-nr").css("display", "none");
                                                                        $('.preloader').remove();
                                                                        $('.infinite-scroll-preloader').remove();
                                                                        app.preloader.hide();
                                                                    },
                                                                    function(tx, error){
                                                                        console.log("Error al guardar cedula: " + error.message);
                                                                        app.preloader.hide();
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                        swal("","Registro guardado","success");
                                        app.preloader.hide();
                                    },
                                    function(tx, error){
                                        swal("Error al guardar plaga",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarProspeccionSMC(){
        app.preloader.show('blue');
        if($("#objetivo").val() == "" ||
            $("#necesidad").val() == "" || 
            $("#marca").val() == "" || 
            $("#numeroActivo").val() == ""||
            $("#marcall").val()== "" ||
            $("#llantas").val()== "" ||
            $("#medidas").val()== "" ||
            $("#porque").val()== "" ||
            $("#competencia").val()== "" ||
            $("#sugerencia").val()== "" || 
            $("#comentarios").val()== ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var objetivo = $("#objetivo").val();
        var necesidad = $("#necesidad").val();
        var marca = $("#marca").val();
        var numero = $("#numeroActivo").val();
        var pregunta1 = $('input:radio[name=pregunta1]:checked').val();
        var cuandoc = $("#demo-calendar-modal").val();
        var marcall = $("#marcall").val();
        var llantas = $("#llantas").val();
        var medidas = $("#medidas").val();
        var pregunta2 = $('input:radio[name=pregunta2]:checked').val();
        var porque = $("#porque").val();
        var pregunta3 = $('input:radio[name=pregunta3]:checked').val();
        var cuando = $("#demo-calendar-modal1").val();
        var pregunta4 = $('input:radio[name=pregunta4]:checked').val();
        var cuales = $("#cuales").val();
        var competencia = $("#competencia").val();
        var sugerencia = $("#sugerencia").val();
        var comentarios = $("#comentarios").val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE ventaSMC SET objetivo_prospeccion = ?,necesidad_prospeccion = ?,marca_montacargas_prospeccion = ?,numero_montacargas_prospeccion = ?,status_montacarga_prospeccion = ?,venc_contrato = ?,marca_llantas_prospeccion = ?,tipo_llantas_prospeccion = ?,mediadas_prospeccion = ?,resolvio_prospeccion = ?,por_que_prospeccion = ?,vista_prospeccion = ?,cuando_prospeccion =?, presente_prospeccion = ?,cuales_prospeccion = ?,copetencia_prospeccion = ?,sugerencia_prospeccion = ?,comentarios_prospeccion = ? WHERE id_cedula = ?",
                    [objetivo,necesidad,marca,numero,pregunta1,cuandoc,marcall,llantas,medidas,pregunta2,porque,pregunta3,cuando,pregunta4,cuales,competencia,sugerencia,comentarios,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                swal("","Registro guardado","success");
                                $("#objetivo").css("background-color", "#FFFFFF");
                                $("#necesidad").css("background-color", "#FFFFFF");
                                $("#marca").css("background-color", "#FFFFFF");
                                $("#numeroActivo").css("background-color", "#FFFFFF");
                                $("#marcall").css("background-color", "#FFFFFF");
                                $("#llantas").css("background-color", "#FFFFFF");
                                $("#medidas").css("background-color", "#FFFFFF");
                                $("#porque").css("background-color", "#FFFFFF");
                                $("#competencia").css("background-color", "#FFFFFF");
                                $("#sugerencia").css("background-color", "#FFFFFF");
                                $("#comentarios").css("background-color", "#FFFFFF");
                                $("#demo-calendar-modal1").css("background-color", "#FFFFFF");
                                $("#cuales").css("background-color", "#FFFFFF");
                                $("#demo-calendar-modal").css("background-color", "#FFFFFF");
                                app.preloader.hide();
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDatosMantenimientoSMC(){
        app.preloader.show('blue');
        if($("#observaciones").val() == "" || $('#estadoGeneral').val() == "0" || $('#numeroMontacargas').val() == "0" || ($("#tipo1").prop("checked") == false && $("#tipo0").prop("checked") == false) || $('#marca').val() == "" || $('#requiereMantenimiento').val() == "0"){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var observaciones = $("#observaciones").val();
        var estadoGeneral = $('#estadoGeneral').val();
        var numeroMontacargas = $('#numeroMontacargas').val();
        if($("#tipo1").prop("checked") == true){
            var tipo = "1";
        } else if($("#tipo0").prop("checked")){
            var tipo = "0";
        }
        var marca = $('#marca').val();
        var requiereMantenimiento = $('#requiereMantenimiento').val()
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE servicioSMC SET observaciones_prospeccion = ?,estado_monta = ?,numero_monta = ?,tipo_monta = ?,marca = ?,mantenimiento = ? WHERE id_cedula = ?",
                    [observaciones,estadoGeneral,numeroMontacargas,tipo,marca,requiereMantenimiento,id_cedula],
                    function(tx, results){
                        $("#observaciones").css("background-color", "#FFFFFF");
                        $("#estadoGeneral").css("background-color", "#FFFFFF");
                        $("#numeroMontacargas").css("background-color", "#FFFFFF");
                        $("#marca").css("background-color", "#FFFFFF");
                        databaseHandler.db.transaction(
                            function(tx){
                                swal("","Registro guardado","success");
                                app.preloader.hide();
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarValoresVentaSMC(){
        app.preloader.show('blue');
        if($("#numeroActivo").val() == "" || $('#numeroContrato').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var numeroActivo = $("#numeroActivo").val();
        var numeroContrato = $('#numeroContrato').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE ventaSMC SET no_activo = ?,no_contrato = ? WHERE id_cedula = ?",
                    [numeroActivo,numeroContrato,id_cedula],
                    function(tx, results){
                        $("#numeroActivo").css("background-color", "#FFFFFF");
                        $("#numeroContrato").css("background-color", "#FFFFFF");
                        databaseHandler.db.transaction(
                            function(tx){
                                swal("","Registro guardado","success");
                                app.preloader.hide();
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarValoresServicioSMC(){
        app.preloader.show('blue');
        if($("#numeroActivo").val() == "" || $('#numeroContrato').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var numeroActivo = $("#numeroActivo").val();
        var numeroContrato = $('#numeroContrato').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE servicioSMC SET no_activo = ?,no_contrato = ? WHERE id_cedula = ?",
                    [numeroActivo,numeroContrato,id_cedula],
                    function(tx, results){
                        $("#numeroActivo").css("background-color", "#FFFFFF");
                        $("#numeroContrato").css("background-color", "#FFFFFF");
                        databaseHandler.db.transaction(
                            function(tx){
                                swal("","Registro guardado","success");
                                app.preloader.hide();
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarEquipoVentaSMC(){
        app.preloader.show('blue');
        if($("#marca").val() == "" || $('#tipoMotor').val() == "" || $('#marcaMotor').val() == "" || $('#modelo').val() == "" || $('#serie').val() == "" || $('#aditamentos').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var marca = $("#marca").val();
        var tipoMotor = $('#tipoMotor').val();
        var marcaMotor = $('#marcaMotor').val();
        var modelo = $('#modelo').val();
        var serie = $('#serie').val();
        var aditamentos = $('#aditamentos').val();

        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO datos_equipo_smc(id_cedula,marca,tipo_motor,marca_motor,modelo,serie,aditamentos) VALUES (?,?,?,?,?,?,?)",
                    [id_cedula,marca,tipoMotor,marcaMotor,modelo,serie,aditamentos],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_equipo) as Id from datos_equipo_smc",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_equipo = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from datos_equipo_smc where id_equipo = ?",
                                                [id_equipo],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#marca").css("background-color", "#FFFFFF");
                                                        $("#tipoMotor").css("background-color", "#FFFFFF");
                                                        $("#marcaMotor").css("background-color", "#FFFFFF");
                                                        $("#modelo").css("background-color", "#FFFFFF");
                                                        $("#serie").css("background-color", "#FFFFFF");
                                                        $("#aditamentos").css("background-color", "#FFFFFF");
                                                        
                                                        $("#marca").val("");
                                                        $("#tipoMotor").val("");
                                                        $("#marcaMotor").val("");
                                                        $("#modelo").val("");
                                                        $("#serie").val("");
                                                        $("#aditamentos").val("");
                                                        $("#tabla_equipos tbody").append("<tr id='fila"+ item.id_equipo +"'><td><a href='#' onclick='eliminarFilaSMC("+ item.id_equipo +",7);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td style='text-align: center;'>" + unescape(item.marca) + "</td><td style='text-align: center;'>" + unescape(item.tipo_motor) + "</td><td style='text-align: center;'>" + unescape(item.marca_motor) + "</td><td style='text-align: center;'>" + unescape(item.modelo) + "</td><td style='text-align: center;'>" + unescape(item.serie) + "</td><td style='text-align: center;'>" + unescape(item.aditamentos) + "</td></tr>");
                                                        
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar la pieza guardada",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Registro guardado","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
        // databaseHandler.db.transaction(
        //     function(tx1){
        //         tx1.executeSql(
        //             "Select id_cedula from datos_equipo_smc where id_cedula= ?",
        //             [id_cedula],
        //             function(tx, results){
        //                 var item = results.rows.item(0);
        //                 if(item){
        //                     databaseHandler.db.transaction(
        //                         function(tx){
        //                             tx.executeSql("UPDATE datos_equipo_smc SET marca = ?,tipo_motor = ?,marca_motor = ?,modelo = ?,serie = ?,aditamentos = ? WHERE id_cedula = ?",
        //                                 [marca,tipoMotor,marcaMotor,modelo,serie,aditamentos,id_cedula],
        //                                 function(tx, results){
        //                                     $("#marca").css("background-color", "#FFFFFF");
        //                                     $("#tipoMotor").css("background-color", "#FFFFFF");
        //                                     $("#marcaMotor").css("background-color", "#FFFFFF");
        //                                     $("#modelo").css("background-color", "#FFFFFF");
        //                                     $("#serie").css("background-color", "#FFFFFF");
        //                                     $("#aditamentos").css("background-color", "#FFFFFF");
        //                                     databaseHandler.db.transaction(
        //                                         function(tx){
        //                                             swal("","Registro actualizado","success");
        //                                             app.preloader.hide();
        //                                         },
        //                                         function(error){},
        //                                         function(){}
        //                                     );
        //                                 },
        //                                 function(tx, error){
        //                                     swal("Error al guardar",error.message,"error");
        //                                     app.preloader.hide();
        //                                 }
        //                             );
        //                         },
        //                         function(error){},
        //                         function(){}
        //                     );
        //                 } else {
        //                     databaseHandler.db.transaction(
        //                         function(tx){
        //                             tx.executeSql("INSERT INTO datos_equipo_smc(id_cedula,marca,tipo_motor,marca_motor,modelo,serie,aditamentos) VALUES (?,?,?,?,?,?,?)",
        //                                 [id_cedula,marca,tipoMotor,marcaMotor,modelo,serie,aditamentos],
        //                                 function(tx, results){
        //                                     $("#marca").css("background-color", "#FFFFFF");
        //                                     $("#tipoMotor").css("background-color", "#FFFFFF");
        //                                     $("#marcaMotor").css("background-color", "#FFFFFF");
        //                                     $("#modelo").css("background-color", "#FFFFFF");
        //                                     $("#serie").css("background-color", "#FFFFFF");
        //                                     $("#aditamentos").css("background-color", "#FFFFFF");
        //                                     databaseHandler.db.transaction(
        //                                         function(tx){
        //                                             swal("","Registro guardado","success");
        //                                             app.preloader.hide();
        //                                         },
        //                                         function(error){},
        //                                         function(){}
        //                                     );
        //                                 },
        //                                 function(tx, error){
        //                                     swal("Error al guardar",error.message,"error");
        //                                     app.preloader.hide();
        //                                 }
        //                             );
        //                         },
        //                         function(error){},
        //                         function(){}
        //                     );
        //                 }
        //             },
        //             function(tx, error){
        //                 console.log("Error al consultar: " + error.message);
        //             }
        //         );
        //     },
        //     function(error){},
        //     function(){}
        // );
    }
    function guardarEquipoServicioSMC(){
        app.preloader.show('blue');
        if($("#marca").val() == "" || $('#tipoMotor').val() == "" || $('#marcaMotor').val() == "" || $('#modelo').val() == "" || $('#serie').val() == "" || $('#aditamentos').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var marca = $("#marca").val();
        var tipoMotor = $('#tipoMotor').val();
        var marcaMotor = $('#marcaMotor').val();
        var modelo = $('#modelo').val();
        var serie = $('#serie').val();
        var aditamentos = $('#aditamentos').val();
        databaseHandler.db.transaction(
            function(tx1){
                tx1.executeSql(
                    "Select id_cedula from datos_servicio_smc where id_cedula= ?",
                    [id_cedula],
                    function(tx, results){
                        var item = results.rows.item(0);
                        if(item){
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("UPDATE datos_servicio_smc SET marca = ?,tipo_motor = ?,marca_motor = ?,modelo = ?,serie = ?,aditamentos = ? WHERE id_cedula = ?",
                                        [marca,tipoMotor,marcaMotor,modelo,serie,aditamentos,id_cedula],
                                        function(tx, results){
                                            $("#marca").css("background-color", "#FFFFFF");
                                            $("#tipoMotor").css("background-color", "#FFFFFF");
                                            $("#marcaMotor").css("background-color", "#FFFFFF");
                                            $("#modelo").css("background-color", "#FFFFFF");
                                            $("#serie").css("background-color", "#FFFFFF");
                                            $("#aditamentos").css("background-color", "#FFFFFF");
                                            databaseHandler.db.transaction(
                                                function(tx){
                                                    swal("","Registro actualizado","success");
                                                    app.preloader.hide();
                                                },
                                                function(error){},
                                                function(){}
                                            );
                                        },
                                        function(tx, error){
                                            swal("Error al guardar",error.message,"error");
                                            app.preloader.hide();
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        } else {
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("INSERT INTO datos_servicio_smc(id_cedula,marca,tipo_motor,marca_motor,modelo,serie,aditamentos) VALUES (?,?,?,?,?,?,?)",
                                        [id_cedula,marca,tipoMotor,marcaMotor,modelo,serie,aditamentos],
                                        function(tx, results){
                                            $("#marca").css("background-color", "#FFFFFF");
                                            $("#tipoMotor").css("background-color", "#FFFFFF");
                                            $("#marcaMotor").css("background-color", "#FFFFFF");
                                            $("#modelo").css("background-color", "#FFFFFF");
                                            $("#serie").css("background-color", "#FFFFFF");
                                            $("#aditamentos").css("background-color", "#FFFFFF");
                                            databaseHandler.db.transaction(
                                                function(tx){
                                                    swal("","Registro guardado","success");
                                                    app.preloader.hide();
                                                },
                                                function(error){},
                                                function(){}
                                            );
                                        },
                                        function(tx, error){
                                            swal("Error al guardar",error.message,"error");
                                            app.preloader.hide();
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        }
                    },
                    function(tx, error){
                        console.log("Error al consultar: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function continuarCedSMC(id_cedula,tipo){
        localStorage.setItem("IdCedula",id_cedula);
        localStorage.setItem("Opcion", '1');
        if(tipo == 1){
            app.views.main.router.navigate({ name: 'recorridoSMC1'});
        } else if(tipo == 2){
            app.views.main.router.navigate({ name: 'recorridoSMC2'});
        } else if(tipo == 3){
            app.views.main.router.navigate({ name: 'recorridoSMC3'});
        } else if(tipo == 4){
            app.views.main.router.navigate({ name: 'recorridoSMC4'});
        }
    }
    function eliminarFilaSMC(index, opc){
        if(opc == 1) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM evidencia_levantamiento_smc WHERE id_evidencia = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 2) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM evidencia_mantenimiento_smc WHERE id_evidencia = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 3) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM evidencia_mantenimiento_smc WHERE id_evidencia = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 4) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM evidencia_mantenimiento_smc WHERE id_evidencia = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 5) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM evidencia_venta_smc WHERE id_evidencia = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 6) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM evidencia_servicio_smc WHERE id_evidencia = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 7) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM datos_equipo_smc WHERE id_equipo = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function guardarPiezaSMC(){
        app.preloader.show('blue');
        if($("#pieza").val() == "" || $('#imagenC1').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var pieza = $("#pieza").val();
        var foto = $('#imagenC1').val();
        var fase = "pieza";
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO evidencia_mantenimiento_smc(id_cedula,fase,descripcion,foto_decripcion,fecha_regristro) VALUES (?,?,?,?,?)",
                    [id_cedula,fase,pieza,foto,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_evidencia) as Id from evidencia_mantenimiento_smc",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from evidencia_mantenimiento_smc where id_evidencia = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage1").attr("src","img/blank.png");
                                                        $("#pieza").val("");
                                                        $('#imagenC1').val("");
                                                        $("#photoIcon1").attr("src","img/camera.svg");
                                                        $("#pieza").css("background-color", "#FFFFFF");
                                                        $("#tabla_pieza tbody").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaSMC("+ item.id_evidencia +",3);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto_decripcion+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.descripcion) + "</td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                        $("#message-nr1").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar la pieza guardada",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Pieza guardada","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarCambioSMC(){
        app.preloader.show('blue');
        if($("#cambio").val() == "" || $('#imagenC').val() == "" || ($("#piezaChk").prop("checked") == false && $("#cambioChk").prop("checked") == false)){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var pieza = $("#cambio").val();
        var foto = $('#imagenC').val();
        if($("#piezaChk").prop("checked") == true){
            var fase = "pieza";
        } else {
            var fase = "cambio";
        }
        // var fase = "cambio";
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO evidencia_mantenimiento_smc(id_cedula,fase,descripcion,foto_decripcion,fecha_regristro) VALUES (?,?,?,?,?)",
                    [id_cedula,fase,pieza,foto,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_evidencia) as Id from evidencia_mantenimiento_smc",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from evidencia_mantenimiento_smc where id_evidencia = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $("#cambio").val("");
                                                        $('#imagenC').val("");
                                                        $("#cambioChk").prop("checked", false);
                                                        $("#piezaChk").prop("checked", false);
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        $("#cambio").css("background-color", "#FFFFFF");
                                                        $("#tabla_cambio tbody").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaSMC("+ item.id_evidencia +",4);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto_decripcion+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.descripcion) + "</td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar la pieza guardada",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Pieza guardada","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarCierreLevantamientoSMC(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#eval").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        if($("#eval").val() <= '2' && $("#comentario_cliente").val() == ""){
            swal("","Por favor, ingresa el motivo de tu calificacion","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var calificacion = $("#eval").val();
        var comentarioCliente = $('#comentario_cliente').val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE levantamiento_smc SET firma_cliente = ?,fecha_cliente = ? WHERE id_cedula = ?",
                    [firmaCliente,fecha_firma,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                    [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoylevantamientoSMC/', {force: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarCierreMantenimientoSMC(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#eval").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        if($("#eval").val() <= '2' && $("#comentario_cliente").val() == ""){
            swal("","Por favor, ingresa el motivo de tu calificacion","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var calificacion = $("#eval").val();
        var comentarioCliente = $('#comentario_cliente').val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE mantenimiento_smc SET firma_cliente = ?,fecha_cliente = ? WHERE id_cedula = ?",
                    [firmaCliente,fecha_firma,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                    [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoymantenimientoSMC/', {force: true, ignoreCache: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarCierreServicioSMC(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#eval").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        if($("#eval").val() <=  '3' && $("#comentario_cliente").val() == ""){
            swal("","Por favor, ingresa el motivo de tu calificacion","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var calificacion = $("#eval").val();
        var comentarioCliente = $('#comentario_cliente').val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE servicioSMC SET firma_cliente = ?,fecha_cliente = ? WHERE id_cedula = ?",
                    [firmaCliente,fecha_firma,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                    [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoyservicioSMC/', {force: true, ignoreCache: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarCierreVentaSMC(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#eval").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        if($("#eval").val() <=  '3' && $("#comentario_cliente").val() == ""){
            swal("","Por favor, ingresa el motivo de tu calificacion","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var calificacion = $("#eval").val();
        var comentarioCliente = $('#comentario_cliente').val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE ventaSMC SET firma_cliente = ?,fecha_cliente = ? WHERE id_cedula = ?",
                    [firmaCliente,fecha_firma,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                    [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoyventaSMC/', {force: true, ignoreCache: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarLevantamientoSMC(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE levantamiento_smc SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarMantenimientooSMC(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE mantenimiento_smc SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarVentaSMC(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE ventaSMC SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarServicioSMC(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE servicioSMC SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function singleCheck1(valor){
        if($("#reparadoNo").prop("checked") === true){
            $("#reparadoNo").prop("checked", false);
        }
    }
    function singleCheck2(valor){
        if($("#reparadoSi").prop("checked") === true){
            $("#reparadoSi").prop("checked", false);
        }
    }
    function datosCheck1(valor){
        if($("#servicioP").prop("checked") === true){
            $("#servicioP").prop("checked", false);
        }
    }
    function datosCheck2(valor){
        if($("#servicioC").prop("checked") === true){
            $("#servicioC").prop("checked", false);
        }
    }
    function ingressCheck1(valor){
        if($("#cambioChk").prop("checked") === true){
            $("#cambioChk").prop("checked", false);
        }
    }
    function ingressCheck2(valor){
        if($("#piezaChk").prop("checked") === true){
            $("#piezaChk").prop("checked", false);
        }
    }
    function startFromProgram(nombre,tipo,orden,descripcion,id_cliente,client_rfc,contact_name,contact_phone,contact_mail,type_Service,brand,motoy_type,motor_brand,motor_model,serie,aditaments,id){
        localStorage.setItem("nombreCliente", nombre);
        localStorage.setItem("tipoServicio", tipo);
        localStorage.setItem("ordenServicio", orden);
        localStorage.setItem("descripcion", descripcion);
        localStorage.setItem("IdCte", id_cliente);
        localStorage.setItem("rfc", client_rfc);
        localStorage.setItem("contact_name", contact_name);
        localStorage.setItem("contact_phone", contact_phone);
        localStorage.setItem("contact_mail", contact_mail);
        localStorage.setItem("type_Service", type_Service);
        localStorage.setItem("brand", brand);
        localStorage.setItem("motoy_type", motoy_type);
        localStorage.setItem("motor_brand", motor_brand);
        localStorage.setItem("motor_model", motor_model);
        localStorage.setItem("serie", serie);
        localStorage.setItem("aditaments", aditaments);
        localStorage.setItem("id", id);
        app.views.main.router.navigate({name: 'yallegueSMC2'});
    }
    function sonRentados(){
        if($('input:radio[name=pregunta1]:checked').val() == 0){
            $("#contrato").css("display","block")
        } else {
            $("#contrato").css("display","none")
        }
    }
    function siguienteVisita(){
        if($('input:radio[name=pregunta3]:checked').val()== 1){
            $("#siguienteVisita").css("display","block")
        } else {
            $("#siguienteVisita").css("display","none")
        }
    }
    function dejaPresente(){
        if($('input:radio[name=pregunta4]:checked').val()== 1){
            $("#presente").css("display","block")
        } else {
            $("#presente").css("display","none")
        }
    }
    function mayusculas(e) {
        e.value = e.value.toUpperCase();
    }
    function guardarConclusion(){
        var id_cedula = localStorage.getItem("IdCedula");
        var conclusion = $('#conclusion').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE ventaSMC SET conclusion_servicio = ? WHERE id_cedula = ?",
                    [conclusion,id_cedula],
                    function(tx, results){
                        swal("","Conclusion guardada correctamente","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarConclusion2(){
        var id_cedula = localStorage.getItem("IdCedula");
        var conclusion = $('#conclusion').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE servicioSMC SET conclusion_servicio = ? WHERE id_cedula = ?",
                    [conclusion,id_cedula],
                    function(tx, results){
                        swal("","Conclusion guardada correctamente","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    //SMC Fin
    // AyB Inicio
    function buscarCliente(){
        app.preloader.show('blue');
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_cliente = $('#id_cliente').val();
        var nombre_cliente = $("#nombre_cliente").val();
        var hora_programada = $("#horario_programado").val();
        var foto_llegada = $("#imagenC").val();
        var sucursal = $("#sucursal").val();
        var direccion = $("#direccion").val();
        var personaRecibe = $("#persona_recibe").val();
        var documentoIngresar = $("#documento_ingresar").val();
        var codigoPostal = $("#codigo_postal").val();
        var alcance = $("#alcance").val();
        var estatus = 0;
        // var correo = $("#correo").val(); //----
        if(localStorage.getItem("IdCedula"))
        {
            app.preloader.hide();
            var cedula = localStorage.getItem("IdCedula");
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [cedula],
                        function(tx5, results){
                            var item = results.rows.item(0);
                            if(nombre_cliente != item.nombre_cliente || foto_llegada != localStorage.getItem("foto_llegada")){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("UPDATE cedulas_general SET id_usuario = ?,nombre_usuario = ?,fecha_entrada = ?,geolocalizacion_entrada = ?,id_cliente = ?,nombre_cliente = ?,horario_programado = ? WHERE id_cedula = ?",
                                            [id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,hora_programada,cedula],
                                            function(tx, results){
                                                app.views.main.router.navigate({name: 'recorrido1'});
                                            },
                                            function(tx, error){
                                                console.log("Error al guardar cedula: " + error.message);
                                                app.preloader.hide();
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            } else {
                                app.views.main.router.navigate({name: 'recorrido1'});
                            }

                        },
                        function(tx5, error){
                            console.error("Error al consultar bandeja de salida: " + error.message);
                        }
                    );
                },
            function(error){},
            function(){}
            );
        } else {
            var NomDescCli = "Clientes";
            if(foto_llegada != ''){
                app.request.get(cordova.file.dataDirectory + "jsons/"+NomDescCli+".json", { IdCed: id_usuario}, function (data) {
                    var content = JSON.parse(data);
                    var aux = 0;
                    for(var i=0; i < content.length; i++){
                        for (var i = 0; i < content.length; i++) {
                            if(content[i].IdCte == id_cliente){
                                aux = 1;
                                productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,hora_programada,estatus);
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                                            [],
                                            function(tx, results){
                                                var item = results.rows.item(0);
                                                localStorage.setItem("IdCedula", item.Id);
                                                localStorage.setItem("nombreCliente", nombre_cliente);
                                                localStorage.setItem("IdCte", id_cliente);
                                                localStorage.setItem("foto_llegada", foto_llegada);
                                                localStorage.setItem("sucursal", sucursal);
                                                localStorage.setItem("personaRecibe", personaRecibe);
                                                localStorage.setItem("direccion", direccion);
                                                localStorage.setItem("documentoIngresar", documentoIngresar);
                                                localStorage.setItem("codigoPostal", codigoPostal);
                                                localStorage.setItem("alcance", alcance);
                                                // localStorage.setItem("correo", correo);
                                                app.views.main.router.navigate({name: 'recorrido1'});
                                                app.preloader.hide();
                                            },
                                            function(tx, error){
                                                console.log("Error al guardar cedula: " + error.message);
                                                app.preloader.hide();
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                        }
                    }
                    if(aux == 0){
                        app.preloader.hide();
                        swal("Cliente no encontrado", "No se tiene registro de ese cliente, Por favor sincroniza tus datos!" ,"error");
                    }
                });
            } else {
                swal("Falta un campo", "La fotograf√≠a es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        }
    }
    //Generar tipos de cedula
    function generarLevantamiento(){
        let id_cedula = localStorage.getItem("IdCedula");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let direccion = localStorage.getItem("direccion");
        let nombre_cliente = localStorage.getItem("nombreCliente");
        let tipoCedula = "levantamiento";
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addLevantamiento(id_cedula,foto_llegada,nombre_cliente,direccion);
                        app.views.main.router.navigate({name: 'recorrido3'});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function generarFumigacion(){
        let id_cedula = localStorage.getItem("IdCedula");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let sucursal = localStorage.getItem("sucursal");
        let direccion = localStorage.getItem("direccion");
        let persona_recibe = localStorage.getItem("personaRecibe");
        let documento_ingresar = localStorage.getItem("documentoIngresar");
        let alcance_servicio = localStorage.getItem("alcance");
        let tipoCedula = "fumigacion";
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addFumigacion(id_cedula,foto_llegada,sucursal,direccion,persona_recibe,documento_ingresar,alcance_servicio);
                        app.views.main.router.navigate({name: 'recorrido'});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function generarSanitizacion(){
        let id_cedula = localStorage.getItem("IdCedula");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let sucursal = localStorage.getItem("sucursal");
        let direccion = localStorage.getItem("direccion");
        let persona_recibe = localStorage.getItem("personaRecibe");
        let documento_ingresar = localStorage.getItem("documentoIngresar");
        let tipoCedula = "sanitizacion";
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addSanitizacion(id_cedula,foto_llegada,sucursal,direccion,persona_recibe,documento_ingresar);
                        app.views.main.router.navigate({name: 'recorrido2'});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    //Fin Generar tipos de cedula
    function guardarDatosLevantamiento(){
        app.preloader.show('blue');
        if($("#colonia").val() =="" || $("#revision").val() == ""){
            swal("", "Debes llenar todos los campos" ,"warning");
            app.preloader.hide();
            return false;
        }
        var colonia = $("#colonia").val();
        var revision = $("#revision").val();
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE levantamiento_servicio SET colonia = ?,revision = ? WHERE id_cedula = ?",
                    [colonia,revision,id_cedula],
                    function(tx, results){
                        $("#colonia").css("background-color", "#FFFFFF");
                        $("#revision").css("background-color", "#FFFFFF");
                        swal("", "Se guardaron los datos correctamente" ,"success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarLevantamiento(){
        app.preloader.show('blue');
        if($("#area").val() == "" || $('#imagenC').val() == "" || $('#plaga').val() == "" || $('#observaciones').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var area = $("#area").val();
        var foto_plaga = $('#imagenC').val();
        var plaga = $('#plaga').val();
        var observaciones = $('#observaciones').val();
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO levantamiento_evidencia(id_cedula,area,foto_plaga,descripcion_plaga,observacion,fecha_regristro) VALUES (?,?,?,?,?,?)",
                    [id_cedula,area,foto_plaga,plaga,observaciones,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_levantamiento_foto) as Id from levantamiento_evidencia",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from levantamiento_evidencia where id_levantamiento_foto = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $("#area").val("");
                                                        $("#plaga").val("");
                                                        $("#observaciones").val("");
                                                        $('#imagenC').val("");
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        $("#area").css("background-color", "#FFFFFF");
                                                        $("#plaga").css("background-color", "#FFFFFF");
                                                        $("#observaciones").css("background-color", "#FFFFFF");
                                                        $("#tabla_levantamiento tbody").append("<tr id='fila"+ item.id_levantamiento_foto +"'><td><a href='#' onclick='eliminarFila("+ item.id_levantamiento_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto_plaga+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.area + "</td><td style='text-align: center;'>" + unescape(item.descripcion_plaga) + "</td><td style='text-align: center;'>"+ item.observacion + "</td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Registro guardado","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function saveGradoLevantamiento(valor){
        var id_cedula = localStorage.getItem("IdCedula");
        if(valor == 1){
            var message = "BAJA: SERVICIO B√ÅSICO,ASPERSI√ìN,POLVO,PRESENCIA EN 1 √ÅREA";
            $("#descripcion_infeccion").val(message);
        } else if(valor == 2){
            var message = "MEDIA: SERVICIO REGULAR,ASPERSI√ìN,GEL,POLVO,PRESENCIA EN 2 √ÅREAS";
            $("#descripcion_infeccion").val(message);
        } else if(valor == 3){
            var message = "ALTA: SERVICIO PREMIUM ,MICRO INYECCI√ìN ,ASPERSI√ìN,GEL,POLVO,PRESENCIA EN TODAS LAS √ÅREAS";
            $("#descripcion_infeccion").val(message);
        } else {
            var message = "";
            $("#descripcion_infeccion").val("");
        }
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE levantamiento_servicio SET grado_infeccion = ?,descripcion = ? WHERE id_cedula = ?",
                    [valor,message,id_cedula],
                    function(tx, results){
                        if(valor == 0){
                            swal("","Debes seleccionar un grado de infestac√≠on valido","warning");
                        } else {
                            swal("", "Se guardo el grado de infestaci√≥n","success");
                        }
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function regresarLevantamiento(){
        let infestacion = $("#descripcion_infeccion").val();
        if(infestacion == ""){
            swal({
                title: "Aviso",
                text: "Aun no agregas el grado de infestaci√≥n, ¬øEstas seguro que deseas regresar?",
                icon: "warning",
                buttons: true,
                dangerMode: false,
            })
            .then((willGoBack) => {
                if (willGoBack){
                    app.views.main.router.back('/recorrido3/', {force: true, ignoreCache: true, reload: true});
                } else {}
            });
        } else {
            app.views.main.router.back('/recorrido3/', {force: true, ignoreCache: true, reload: true});
        }
    }
    function guardarCierreLevantamiento(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var comentarios = $("#comentarios").val();
        var nombreComentario = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE levantamiento_servicio SET comentarios_tecnico = ?,firma_cliente = ?,fecha_cliente = ? WHERE id_cedula = ?",
                    [comentarios,firmaCliente,fecha_firma,id_cedula],
                    function(tx, results){
                        app.views.main.router.back('/yamevoylevantamiento/', {force: true, ignoreCache: true, reload: true});
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET nombre_evalua = ? WHERE id_cedula = ?",
                    [nombreComentario,id_cedula],
                    function(tx, results){
                        app.views.main.router.back('/yamevoylevantamiento/', {force: true, ignoreCache: true, reload: true});
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarCierreFumigacion(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#eval").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        if($("#eval").val() <= '2' && $("#comentario_cliente").val() == ""){
            swal("","Por favor, ingresa el motivo de tu calificacion","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var calificacion = $("#eval").val();
        var comentarioCliente = $('#comentario_cliente').val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE fumigacion SET firma_evalua = ?,fecha_firma = ? WHERE id_cedula = ?",
                    [firmaCliente,fecha_firma,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                    [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoyfumigacion/', {force: true, ignoreCache: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarCierreSanitizacion(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#eval").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        if($("#eval").val() <= '2' && $("#comentario_cliente").val() == ""){
            swal("","Por favor, ingresa el motivo de tu calificacion","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var calificacion = $("#eval").val();
        var comentarioCliente = $('#comentario_cliente').val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE sanitizacion SET firma_evalua = ?,fecha_firma = ? WHERE id_cedula = ?",
                    [firmaCliente,fecha_firma,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                    [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoylevantamientoSMC/', {force: true, ignoreCache: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarLevantamiento(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE levantamiento_servicio SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarFumigacion(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE fumigacion SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarSanitizacion(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE sanitizacion SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function continuarCed(id_cliente, id_cedula,tipo){
        localStorage.setItem("IdCedula",id_cedula);
        localStorage.setItem("IdCte",id_cliente);
        localStorage.setItem("Opcion", '1');
        if(tipo == 1){
            app.views.main.router.navigate({ name: 'recorrido3'});
        } else if(tipo == 2){
            app.views.main.router.navigate({ name: 'recorrido'});
        } else if(tipo == 3) {
            app.views.main.router.navigate({ name: 'recorrido2'});
        }
    }
    function EliminarReg(id_cedula,tipo_cedula){

        swal({
            title: "Aviso",
            text: "Estas apunto de eliminar todos los datos de la cedula, ¬øEstas seguro continuar con la acci√≥n?",
            icon: "warning",
            buttons: true,
            dangerMode: true,
        })
        .then((willGoBack) => {
            if (willGoBack){
                var empresa = localStorage.getItem("nombre_empresa");
                console.log(empresa,id_cedula,tipo_cedula);
                if(empresa == "VIC"){
                    if (tipo_cedula == "ApoyoVIC") {
                        databaseHandler.db.transaction(
                          function (tx) {
                            tx.executeSql(
                              "DELETE FROM cedulas_general WHERE id_cedula = ?",
                              [id_cedula],
                              function (tx, results) {
                                databaseHandler.db.transaction(
                                  function (tx) {
                                    tx.executeSql(
                                      "DELETE FROM apoyo_bennetts WHERE id_cedula = ?",
                                      [id_cedula],
                                      function (tx, results) {
                                        databaseHandler.db.transaction(
                                            function (tx) {
                                              tx.executeSql(
                                                "DELETE FROM fotos_apoyo WHERE id_cedula = ?",
                                                [id_cedula],
                                                function (tx, results) {
                                                   
                                                    $("#conc" + id_cedula).remove();
                                                },
                                                function (tx, error) {
                                                  swal(
                                                    "Error al eliminar Apoyo VIC",
                                                    error.message,
                                                    "error"
                                                  );
                                                }
                                              );
                                            },
                                            function (error) { },
                                            function () { }
                                          );
                                      },
                                      function (tx, error) {
                                        swal(
                                          "Error al eliminar Apoyo VIC ",
                                          error.message,
                                          "error"
                                        );
                                      }
                                    );
                                  },
                                  function (error) { },
                                  function () { }
                                );
                              },
                              function (tx, error) {
                                swal(
                                  "Error al eliminar cedulas_general",
                                  error.message,
                                  "error"
                                );
                              }
                            );
                          },
                          function (error) { },
                          function () { }
                        );
                      } else if (tipo_cedula == "VentasVIC" || tipo_cedula == "VentasVIC_SinV" || tipo_cedula == "VentasVIC_ConV" || tipo_cedula == "VentasVIC_Acompa") {
                        databaseHandler.db.transaction(
                          function (tx) {
                            tx.executeSql(
                              "DELETE FROM cedulas_general WHERE id_cedula = ?",
                              [id_cedula],
                              function (tx, results) {
                                databaseHandler.db.transaction(
                                  function (tx) {
                                    tx.executeSql(
                                      "DELETE FROM ventas_bennetts WHERE id_cedula = ?",
                                      [id_cedula],
                                      function (tx, results) {
                                        databaseHandler.db.transaction(
                                            function (tx) {
                                              tx.executeSql(
                                                "DELETE FROM minuta WHERE id_cedula = ?",
                                                [id_cedula],
                                                function (tx, results) {
                                                   
                                                    $("#conc" + id_cedula).remove();
                                                },
                                                function (tx, error) {
                                                  swal(
                                                    "Error al eliminar Minuta de Ventas VIC",
                                                    error.message,
                                                    "error"
                                                  );
                                                }
                                              );
                                            },
                                            function (error) { },
                                            function () { }
                                          );
                                      },
                                      function (tx, error) {
                                        swal(
                                          "Error al eliminar Ventas VIC ",
                                          error.message,
                                          "error"
                                        );
                                      }
                                    );
                                  },
                                  function (error) { },
                                  function () { }
                                );
                              },
                              function (tx, error) {
                                swal(
                                  "Error al eliminar cedulas_general",
                                  error.message,
                                  "error"
                                );
                              }
                            );
                          },
                          function (error) { },
                          function () { }
                        );
                      } else if (tipo_cedula == "VIC") {
                        databaseHandler.db.transaction(
                          function (tx) {
                            tx.executeSql(
                              "DELETE FROM cedulas_general WHERE id_cedula = ?",
                              [id_cedula],
                              function (tx, results) {
                                databaseHandler.db.transaction(
                                  function (tx) {
                                    tx.executeSql(
                                      "DELETE FROM datosVIC WHERE id_cedula = ?",
                                      [id_cedula],
                                      function (tx, results) {
                                        databaseHandler.db.transaction(
                                            function (tx) {
                                              tx.executeSql(
                                                "DELETE FROM equiposVIC WHERE id_cedula = ?",
                                                [id_cedula],
                                                function (tx, results) {
                                                   
                                                    databaseHandler.db.transaction(
                                                        function (tx) {
                                                          tx.executeSql(
                                                            "DELETE FROM imagenVIC WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function (tx, results) {
                                                               
                                                                databaseHandler.db.transaction(
                                                                    function (tx) {
                                                                      tx.executeSql(
                                                                        "DELETE FROM entrenaVIC WHERE id_cedula = ?",
                                                                        [id_cedula],
                                                                        function (tx, results) {
                                                                           
                                                                            databaseHandler.db.transaction(
                                                                                function (tx) {
                                                                                  tx.executeSql(
                                                                                    "DELETE FROM almacenVIC WHERE id_cedula = ?",
                                                                                    [id_cedula],
                                                                                    function (tx, results) {
                                                                                       
                                                                                        databaseHandler.db.transaction(
                                                                                            function (tx) {
                                                                                              tx.executeSql(
                                                                                                "DELETE FROM pedidosVIC WHERE id_cedula = ?",
                                                                                                [id_cedula],
                                                                                                function (tx, results) {
                                                                                                   
                                                                                                    $("#conc" + id_cedula).remove();
                                                                                                },
                                                                                                function (tx, error) {
                                                                                                  swal(
                                                                                                    "Error al eliminar pedidosVIC de Ventas VIC",
                                                                                                    error.message,
                                                                                                    "error"
                                                                                                  );
                                                                                                }
                                                                                              );
                                                                                            },
                                                                                            function (error) { },
                                                                                            function () { }
                                                                                          );
                                                                                    },
                                                                                    function (tx, error) {
                                                                                      swal(
                                                                                        "Error al eliminar almacenVIC de Ventas VIC",
                                                                                        error.message,
                                                                                        "error"
                                                                                      );
                                                                                    }
                                                                                  );
                                                                                },
                                                                                function (error) { },
                                                                                function () { }
                                                                              );
                                                                        },
                                                                        function (tx, error) {
                                                                          swal(
                                                                            "Error al eliminar entrenaVIC de Ventas VIC",
                                                                            error.message,
                                                                            "error"
                                                                          );
                                                                        }
                                                                      );
                                                                    },
                                                                    function (error) { },
                                                                    function () { }
                                                                  );
                                                            },
                                                            function (tx, error) {
                                                              swal(
                                                                "Error al eliminar imagenVIC de Ventas VIC",
                                                                error.message,
                                                                "error"
                                                              );
                                                            }
                                                          );
                                                        },
                                                        function (error) { },
                                                        function () { }
                                                      );
                                                },
                                                function (tx, error) {
                                                  swal(
                                                    "Error al eliminar equiposVIC de Ventas VIC",
                                                    error.message,
                                                    "error"
                                                  );
                                                }
                                              );
                                            },
                                            function (error) { },
                                            function () { }
                                          );
                                      },
                                      function (tx, error) {
                                        swal(
                                          "Error al eliminar datos VIC ",
                                          error.message,
                                          "error"
                                        );
                                      }
                                    );
                                  },
                                  function (error) { },
                                  function () { }
                                );
                              },
                              function (tx, error) {
                                swal(
                                  "Error al eliminar cedulas_general",
                                  error.message,
                                  "error"
                                );
                              }
                            );
                          },
                          function (error) { },
                          function () { }
                        );
                    }
                } else if(empresa == "Proteus"){
                    var datosCedulaGeneral = new Array();
                    var cedulageneral = 0;
        
                    var datosGeneralesProteus = new Array();
                    var datos_equipos_proteus = new Array();
                    var reposicion_proteus = new Array();
                    var evidencias_proteus = new Array();
                    var fotos_proteus = new Array();
                    var check_limpieza = new Array();
                    var check_revision = new Array();
                    var mmto_correctivo = new Array();
        
                    var tipo = "";
                    var fecha = new Date();
                    var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                                [id_cedula],
                                function(tx, results){
                                    var length = results.rows.length;
                                    for(var i = 0; i< length; i++){
                                        var item = results.rows.item(i);
                                        tipo = item.tipo_cedula;
                                        datosCedulaGeneral[cedulageneral] = {'Valor':cedulageneral,'id_cedula':item.id_cedula,'tipo_cedula':item.tipo_cedula,'id_usuario':item.id_usuario,'nombre_usuario':item.nombre_usuario,'fecha_entrada':item.fecha_entrada,'geolocalizacion_entrada': item.geolocalizacion_entrada,'id_cliente': item.id_cliente,'nombre_cliente': item.nombre_cliente,'horario_programado': item.horario_programado,'calificacion': item.calificacion,'fecha_salida':item.fecha_salida,'geolocalizacion_salida':item.geolocalizacion_salida,'nombre_evalua':item.nombre_evalua,'comentario_cliente':item.comentario_cliente,'fecha_envio':fecha_envio};
                                        cedulageneral++;
                                    }
                                    if(tipo == "Preventivo"){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("SELECT * FROM datos_generales_proteus WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        var length = results.rows.length;
                                                        for(var i = 0; i< length; i++){
                                                            var item2 = results.rows.item(i);
                                                            datosGeneralesProteus[i] = {'Valor':i,
                                                            'direccion':item2.direccion,
                                                            'email':item2.email,
                                                            'fecha_cliente':item2.fecha_cliente,
                                                            'firma_cliente':item2.firma_cliente,
                                                            'foto_entrada':item2.foto_entrada,
                                                            'foto_salida':item2.foto_salida,
                                                            'local':item2.local,
                                                            'nombre_contacto':item2.nombre_contacto,
                                                            'orden_servicio':item2.orden_servicio,
                                                            'razon_social':item2.razon_social,
                                                            'ruc':item2.ruc,
                                                            'telefono1':item2.telefono1,
                                                            'telefono2':item2.telefono2,
                                                            'tipo_servicio':item2.tipo_servicio,
                                                            'cargo': item2.cargo,
                                                            'dni':item2.dni};
                                                        }
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("SELECT * from datos_equipos_proteus WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        var length = results.rows.length;
                                                                        for(var i = 0; i< length; i++){
                                                                            var item3 = results.rows.item(i);
                                                                            datos_equipos_proteus[i] = {'Valor':i,
                                                                            'id_cliente':item3.id_cliente,
                                                                            'id_equipo':item3.id_equipo,
                                                                            'marca':item3.marca,
                                                                            'modelo':item3.modelo,
                                                                            'ubicacion':item3.ubicacion};
                                                                        }
                                                                        databaseHandler.db.transaction(
                                                                            function(tx){
                                                                                tx.executeSql("SELECT * from evidencias_proteus WHERE id_cedula = ?",
                                                                                    [id_cedula],
                                                                                    function(tx, results){
                                                                                        var length = results.rows.length;
                                                                                        for(var i = 0; i< length; i++){
                                                                                            var item5 = results.rows.item(i);
                                                                                            evidencias_proteus[i] = {'Valor':i,
                                                                                            'comentario': item5.comentario,
                                                                                            'fecha': item5.fecha,
                                                                                            'foto': item5.foto};
                                                                                        }         
                                                                                        databaseHandler.db.transaction(
                                                                                            function(tx){
                                                                                                tx.executeSql("SELECT * from fotos_proteus WHERE id_cedula = ?",
                                                                                                    [id_cedula],
                                                                                                    function(tx, results){
                                                                                                        var length = results.rows.length;
                                                                                                        for(var i = 0; i< length; i++){
                                                                                                            var item6 = results.rows.item(i);
                                                                                                            fotos_proteus[i] = {'Valor':i,
                                                                                                            'apartado': item6.apartado,
                                                                                                            'fase': item6.fase,
                                                                                                            'fecha': item6.fecha,
                                                                                                            'foto': item6.foto};
                                                                                                        }
                                                                                                        databaseHandler.db.transaction(
                                                                                                            function(tx){
                                                                                                                tx.executeSql("SELECT * from check_limpieza WHERE id_cedula = ?",
                                                                                                                    [id_cedula],
                                                                                                                    function(tx, results){
                                                                                                                        var length = results.rows.length;
                                                                                                                        for(var i = 0; i< length; i++){
                                                                                                                            var item7 = results.rows.item(i);
                                                                                                                            check_limpieza[i] = {'Valor':i,
                                                                                                                            'comentarios': item7.comentarios,
                                                                                                                            'componente': item7.componente,
                                                                                                                            'fallos': item7.fallos,
                                                                                                                            'piezas': item7.piezas};
                                                                                                                        }
                                                                                                                        databaseHandler.db.transaction(
                                                                                                                            function(tx){
                                                                                                                                tx.executeSql("SELECT * from check_revision WHERE id_cedula = ?",
                                                                                                                                    [id_cedula],
                                                                                                                                    function(tx, results){
                                                                                                                                        var length = results.rows.length;
                                                                                                                                        for(var i = 0; i< length; i++){
                                                                                                                                            var item8 = results.rows.item(i);
                                                                                                                                            check_revision[i] = {'Valor':i,
                                                                                                                                            'comentarios': item8.comentarios,
                                                                                                                                            'componente': item8.componente,
                                                                                                                                            'fallos': item8.fallos,
                                                                                                                                            'fuente': item8.fuente,
                                                                                                                                            'piezas': item8.piezas,
                                                                                                                                            'observaciones': item8.observaciones};
                                                                                                                                        }
                                                                                                                                            $.ajax({
                                                                                                                                                type: "POST",
                                                                                                                                                async : true,
                                                                                                                                                url: "http://www.appbennetts.com/FWM2/app/guradarPreventivoProteus.php",
                                                                                                                                                dataType: 'html',
                                                                                                                                                data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),
                                                                                                                                                         'datosGeneralesProteus': JSON.stringify(datosGeneralesProteus),
                                                                                                                                                         'datos_equipos_proteus': JSON.stringify(datos_equipos_proteus),
                                                                                                                                                         'evidencias_proteus': JSON.stringify(evidencias_proteus),
                                                                                                                                                         'fotos_proteus': JSON.stringify(fotos_proteus),
                                                                                                                                                         'check_limpieza': JSON.stringify(check_limpieza),
                                                                                                                                                         'check_revision': JSON.stringify(check_revision)},
                                                                                                                                                success: function(respuesta){
                                                                                                                                                    var respu1 = respuesta.split("._.");
                                                                                                                                                    var dat1 = respu1[0];
                                                                                                                                                    var dat2 = respu1[1];
                                                                                                                                                    if(dat1 == "CEDULA"){
                                                                                                                                                        if(dat2 > 0){
                                                                                                                                                            databaseHandler.db.transaction(
                                                                                                                                                                function(tx7){
                                                                                                                                                                    tx7.executeSql(
                                                                                                                                                                        "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                                                                                        [id_cedula],
                                                                                                                                                                        function(tx7, results){
                                                                                                                                                                            localStorage.setItem("sendFlag", 0);
                                                                                                                                                                            swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                                                                                        }
                                                                                                                                                                    );
                                                                                                                                                                }
                                                                                                                                                            );
                                                                                                                                                        }
                                                                                                                                                    }
                                                                                                                                                },
                                                                                                                                                error: function(){
                                                                                                                                                    console.log("Error en la comunicacion");
                                                                                                                                                }
                                                                                                                                            });
                                                                                                                                    },
                                                                                                                                    function(tx, error){
                                                                                                                                        console.log("Error al consultar check_revision: " +error.message);
                                                                                                                                    }
                                                                                                                                );
                                                                                                                            },
                                                                                                                            function(error){},
                                                                                                                            function(){}
                                                                                                                        );
                                                                                                                    },
                                                                                                                    function(tx, error){
                                                                                                                        console.log("Error al consultar check_limpieza: " +error.message);
                                                                                                                    }
                                                                                                                );
                                                                                                            },
                                                                                                            function(error){},
                                                                                                            function(){}
                                                                                                        );
                                                                                                    },
                                                                                                    function(tx, error){
                                                                                                        console.log("Error al consultar fotos_proteus: " +error.message);
                                                                                                    }
                                                                                                );
                                                                                            },
                                                                                            function(error){},
                                                                                            function(){}
                                                                                        );
                                                                                    },
                                                                                    function(tx, error){
                                                                                        console.log("Error al consultar evidencias_proteus: " +error.message);
                                                                                    }
                                                                                );
                                                                            },
                                                                            function(error){},
                                                                            function(){}
                                                                        );
                                                                    },
                                                                    function(tx, error){
                                                                        console.log("Error al consultar datos_equipos_proteus: " +error.message);
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al consultar datos_generales_proteus: " + error.message);
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    }else if(tipo == "Reposicion"){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("SELECT * FROM datos_generales_proteus WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        var length = results.rows.length;
                                                        for(var i = 0; i< length; i++){
                                                            var item2 = results.rows.item(i);
                                                            datosGeneralesProteus[i] = {'Valor':i,
                                                            'direccion':item2.direccion,
                                                            'email':item2.email,
                                                            'fecha_cliente':item2.fecha_cliente,
                                                            'firma_cliente':item2.firma_cliente,
                                                            'foto_entrada':item2.foto_entrada,
                                                            'foto_salida':item2.foto_salida,
                                                            'local':item2.local,
                                                            'nombre_contacto':item2.nombre_contacto,
                                                            'orden_servicio':item2.orden_servicio,
                                                            'razon_social':item2.razon_social,
                                                            'ruc':item2.ruc,
                                                            'telefono1':item2.telefono1,
                                                            'telefono2':item2.telefono2,
                                                            'tipo_servicio':item2.tipo_servicio,
                                                            'cargo': item2.cargo,
                                                            'dni':item2.dni};
                                                        }
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("SELECT * from datos_equipos_proteus WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        var length = results.rows.length;
                                                                        for(var i = 0; i< length; i++){
                                                                            var item3 = results.rows.item(i);
                                                                            datos_equipos_proteus[i] = {'Valor':i,
                                                                            'id_cliente':item3.id_cliente,
                                                                            'id_equipo':item3.id_equipo,
                                                                            'marca':item3.marca,
                                                                            'modelo':item3.modelo,
                                                                            'ubicacion':item3.ubicacion};
                                                                        }
                                                                        databaseHandler.db.transaction(
                                                                            function(tx){
                                                                                tx.executeSql("SELECT * from reposicion_proteus WHERE id_cedula = ?",
                                                                                    [id_cedula],
                                                                                    function(tx, results){
                                                                                        var length = results.rows.length;
                                                                                        for(var i = 0; i< length; i++){
                                                                                            var item4 = results.rows.item(i);
                                                                                            reposicion_proteus[i] = {'Valor':i,
                                                                                            'kit_micro': item4.kit_micro,
                                                                                            'micro_activados': item4.micro_activados,
                                                                                            'nivelador': item4.nivelador,
                                                                                            'observaciones': item4.observaciones};
                                                                                        }
                                                                                        databaseHandler.db.transaction(
                                                                                            function(tx){
                                                                                                tx.executeSql("SELECT * from evidencias_proteus WHERE id_cedula = ?",
                                                                                                    [id_cedula],
                                                                                                    function(tx, results){
                                                                                                        var length = results.rows.length;
                                                                                                        for(var i = 0; i< length; i++){
                                                                                                            var item5 = results.rows.item(i);
                                                                                                            evidencias_proteus[i] = {'Valor':i,
                                                                                                            'comentario': item5.comentario,
                                                                                                            'fecha': item5.fecha,
                                                                                                            'foto': item5.foto};
                                                                                                        }
                                                                                                        $.ajax({
                                                                                                            type: "POST",
                                                                                                            async : true,
                                                                                                            url: "http://www.appbennetts.com/FWM2/app/guardarReposicionProteus.php",
                                                                                                            dataType: 'html',
                                                                                                            data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),
                                                                                                                     'datosGeneralesProteus': JSON.stringify(datosGeneralesProteus),
                                                                                                                     'datos_equipos_proteus': JSON.stringify(datos_equipos_proteus),
                                                                                                                     'reposicion_proteus': JSON.stringify(reposicion_proteus),
                                                                                                                     'evidencias_proteus': JSON.stringify(evidencias_proteus)},
                                                                                                            success: function(respuesta){
                                                                                                                var respu1 = respuesta.split("._.");
                                                                                                                var dat1 = respu1[0];
                                                                                                                var dat2 = respu1[1];
                                                                                                                if(dat1 == "CEDULA"){
                                                                                                                    if(dat2 > 0){
                                                                                                                        databaseHandler.db.transaction(
                                                                                                                            function(tx7){
                                                                                                                                tx7.executeSql(
                                                                                                                                    "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                                                    [id_cedula],
                                                                                                                                    function(tx7, results){
                                                                                                                                        localStorage.setItem("sendFlag", 0);
                                                                                                                                        swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                                                    }
                                                                                                                                );
                                                                                                                            }
                                                                                                                        );
                                                                                                                    }
                                                                                                                }
                                                                                                            },
                                                                                                            error: function(){
                                                                                                                console.log("Error en la comunicacion");
                                                                                                            }
                                                                                                        });
                                                                                                    },
                                                                                                    function(tx, error){
                                                                                                        console.log("Error al consultar evidencias_proteus: " +error.message);
                                                                                                    }
                                                                                                );
                                                                                            },
                                                                                            function(error){},
                                                                                            function(){}
                                                                                        );
                                                                                    },
                                                                                    function(tx, error){
                                                                                        console.log("Error al consultar reposicion_proteus: " +error.message);
                                                                                    }
                                                                                );
                                                                            },
                                                                            function(error){},
                                                                            function(){}
                                                                        );
                                                                    },
                                                                    function(tx, error){
                                                                        console.log("Error al consultar datos_equipos_proteus: " +error.message);
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al consultar datos_generales_proteus: " + error.message);
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    }else if(tipo == "Correctivo"){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("SELECT * FROM datos_generales_proteus WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        var length = results.rows.length;
                                                        for(var i = 0; i< length; i++){
                                                            var item2 = results.rows.item(i);
                                                            datosGeneralesProteus[i] = {'Valor':i,
                                                            'direccion':item2.direccion,
                                                            'email':item2.email,
                                                            'fecha_cliente':item2.fecha_cliente,
                                                            'firma_cliente':item2.firma_cliente,
                                                            'foto_entrada':item2.foto_entrada,
                                                            'foto_salida':item2.foto_salida,
                                                            'local':item2.local,
                                                            'nombre_contacto':item2.nombre_contacto,
                                                            'orden_servicio':item2.orden_servicio,
                                                            'razon_social':item2.razon_social,
                                                            'ruc':item2.ruc,
                                                            'telefono1':item2.telefono1,
                                                            'telefono2':item2.telefono2,
                                                            'tipo_servicio':item2.tipo_servicio,
                                                            'cargo': item2.cargo,
                                                            'dni':item2.dni};
                                                        }
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("SELECT * from datos_equipos_proteus WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        var length = results.rows.length;
                                                                        for(var i = 0; i< length; i++){
                                                                            var item3 = results.rows.item(i);
                                                                            datos_equipos_proteus[i] = {'Valor':i,
                                                                            'id_cliente':item3.id_cliente,
                                                                            'id_equipo':item3.id_equipo,
                                                                            'marca':item3.marca,
                                                                            'modelo':item3.modelo,
                                                                            'ubicacion':item3.ubicacion};
                                                                        }
                                                                        databaseHandler.db.transaction(
                                                                            function(tx){
                                                                                tx.executeSql("SELECT * from evidencias_proteus WHERE id_cedula = ?",
                                                                                    [id_cedula],
                                                                                    function(tx, results){
                                                                                        var length = results.rows.length;
                                                                                        for(var i = 0; i< length; i++){
                                                                                            var item5 = results.rows.item(i);
                                                                                            evidencias_proteus[i] = {'Valor':i,
                                                                                            'comentario': item5.comentario,
                                                                                            'fecha': item5.fecha,
                                                                                            'foto': item5.foto};
                                                                                        }         
                                                                                        databaseHandler.db.transaction(
                                                                                            function(tx){
                                                                                                tx.executeSql("SELECT * from mmto_correctivo WHERE id_cedula = ?",
                                                                                                    [id_cedula],
                                                                                                    function(tx, results){
                                                                                                        var length = results.rows.length;
                                                                                                        for(var i = 0; i< length; i++){
                                                                                                            var item9 = results.rows.item(i);
                                                                                                            mmto_correctivo[i] = {'Valor':i,
                                                                                                            'funcionamiento': item9.funcionamiento,
                                                                                                            'reparacion': item9.reparacion};
                                                                                                        }
                                                                                                        $.ajax({
                                                                                                            type: "POST",
                                                                                                            async : true,
                                                                                                            url: "http://www.appbennetts.com/FWM2/app/guardarCorrectivoProteus.php",
                                                                                                            dataType: 'html',
                                                                                                            data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),
                                                                                                                     'datosGeneralesProteus': JSON.stringify(datosGeneralesProteus),
                                                                                                                     'datos_equipos_proteus': JSON.stringify(datos_equipos_proteus),
                                                                                                                     'evidencias_proteus': JSON.stringify(evidencias_proteus),
                                                                                                                     'mmto_correctivo': JSON.stringify(mmto_correctivo)
                                                                                                                    },
                                                                                                            success: function(respuesta){
                                                                                                                var respu1 = respuesta.split("._.");
                                                                                                                var dat1 = respu1[0];
                                                                                                                var dat2 = respu1[1];
                                                                                                                if(dat1 == "CEDULA"){
                                                                                                                    if(dat2 > 0){
                                                                                                                        databaseHandler.db.transaction(
                                                                                                                            function(tx7){
                                                                                                                                tx7.executeSql(
                                                                                                                                    "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                                                    [id_cedula],
                                                                                                                                    function(tx7, results){
                                                                                                                                        localStorage.setItem("sendFlag", 0);
                                                                                                                                        swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                                                    }
                                                                                                                                );
                                                                                                                            }
                                                                                                                        );
                                                                                                                    }
                                                                                                                }
                                                                                                            },
                                                                                                            error: function(){
                                                                                                                console.log("Error en la comunicacion");
                                                                                                            }
                                                                                                        });
                                                                                                    },
                                                                                                    function(tx, error){
                                                                                                        console.log("Error al consultar mmto_correctivo: " +error.message);
                                                                                                    }
                                                                                                );
                                                                                            },
                                                                                            function(error){},
                                                                                            function(){}
                                                                                        );
                                                                                    },
                                                                                    function(tx, error){
                                                                                        console.log("Error al consultar evidencias_proteus: " +error.message);
                                                                                    }
                                                                                );
                                                                            },
                                                                            function(error){},
                                                                            function(){}
                                                                        );
                                                                    },
                                                                    function(tx, error){
                                                                        console.log("Error al consultar datos_equipos_proteus: " +error.message);
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al consultar datos_generales_proteus: " + error.message);
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    }else if(tipo == "Instalacion"){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("SELECT * FROM datos_generales_proteus WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        var length = results.rows.length;
                                                        for(var i = 0; i< length; i++){
                                                            var item2 = results.rows.item(i);
                                                            datosGeneralesProteus[i] = {'Valor':i,
                                                            'direccion':item2.direccion,
                                                            'email':item2.email,
                                                            'fecha_cliente':item2.fecha_cliente,
                                                            'firma_cliente':item2.firma_cliente,
                                                            'foto_entrada':item2.foto_entrada,
                                                            'foto_salida':item2.foto_salida,
                                                            'local':item2.local,
                                                            'nombre_contacto':item2.nombre_contacto,
                                                            'orden_servicio':item2.orden_servicio,
                                                            'razon_social':item2.razon_social,
                                                            'ruc':item2.ruc,
                                                            'telefono1':item2.telefono1,
                                                            'telefono2':item2.telefono2,
                                                            'tipo_servicio':item2.tipo_servicio,
                                                            'cargo': item2.cargo,
                                                            'dni':item2.dni};
                                                        }
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("SELECT * from datos_equipos_proteus WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        var length = results.rows.length;
                                                                        for(var i = 0; i< length; i++){
                                                                            var item3 = results.rows.item(i);
                                                                            datos_equipos_proteus[i] = {'Valor':i,
                                                                            'id_cliente':item3.id_cliente,
                                                                            'id_equipo':item3.id_equipo,
                                                                            'marca':item3.marca,
                                                                            'modelo':item3.modelo,
                                                                            'ubicacion':item3.ubicacion};
                                                                        }
                                                                        databaseHandler.db.transaction(
                                                                            function(tx){
                                                                                tx.executeSql("SELECT * from evidencias_proteus WHERE id_cedula = ?",
                                                                                    [id_cedula],
                                                                                    function(tx, results){
                                                                                        var length = results.rows.length;
                                                                                        for(var i = 0; i< length; i++){
                                                                                            var item5 = results.rows.item(i);
                                                                                            evidencias_proteus[i] = {'Valor':i,
                                                                                            'comentario': item5.comentario,
                                                                                            'fecha': item5.fecha,
                                                                                            'foto': item5.foto};
                                                                                        }
                                                                                        $.ajax({
                                                                                            type: "POST",
                                                                                            async : true,
                                                                                            url: "http://www.appbennetts.com/FWM2/app/guardarInstalacionProteus.php",
                                                                                            dataType: 'html',
                                                                                            data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),
                                                                                                     'datosGeneralesProteus': JSON.stringify(datosGeneralesProteus),
                                                                                                     'evidencias_proteus': JSON.stringify(evidencias_proteus),
                                                                                                     'datos_equipos_proteus': JSON.stringify(datos_equipos_proteus)
                                                                                                    },
                                                                                            success: function(respuesta){
                                                                                                var respu1 = respuesta.split("._.");
                                                                                                var dat1 = respu1[0];
                                                                                                var dat2 = respu1[1];
                                                                                                if(dat1 == "CEDULA"){
                                                                                                    if(dat2 > 0){
                                                                                                        databaseHandler.db.transaction(
                                                                                                            function(tx7){
                                                                                                                tx7.executeSql(
                                                                                                                    "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                                    [id_cedula],
                                                                                                                    function(tx7, results){
                                                                                                                        localStorage.setItem("sendFlag", 0);
                                                                                                                        swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                                    }
                                                                                                                );
                                                                                                            }
                                                                                                        );
                                                                                                    }
                                                                                                }
                                                                                            },
                                                                                            error: function(){
                                                                                                console.log("Error en la comunicacion");
                                                                                            }
                                                                                        });
                                                                                    },
                                                                                    function(tx, error){
                                                                                        console.log("Error al consultar evidencias_proteus: " +error.message);
                                                                                    }
                                                                                );
                                                                            },
                                                                            function(error){},
                                                                            function(){}
                                                                        );
                                                                    },
                                                                    function(tx, error){
                                                                        console.log("Error al consultar datos_equipos_proteus: " +error.message);
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al consultar datos_generales_proteus: " + error.message);
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    }
                                },
                                function(tx, error){
                                    console.log("Error al consultar cedulas generales: " + error.message);
                                }
                            );
                        },
                        function(error){},
                        function(){}
                    );
        
                } else if(empresa == "Dilimpio"){
                    if(tipo_cedula == "visitaDilimpio"){
                        databaseHandler.db.transaction(
                            function (tx) {
                              tx.executeSql(
                                "DELETE FROM cedulas_general WHERE id_cedula = ?",
                                [id_cedula],
                                function (tx, results) {
                                  databaseHandler.db.transaction(
                                    function (tx) {
                                      tx.executeSql(
                                        "DELETE FROM visitaDilimpio WHERE id_cedula = ?",
                                        [id_cedula],
                                        function (tx, results) {
                                          databaseHandler.db.transaction(
                                              function (tx) {
                                                tx.executeSql(
                                                  "DELETE FROM equiposDL WHERE id_cedula = ?",
                                                  [id_cedula],
                                                  function (tx, results) {
                                                     
                                                      databaseHandler.db.transaction(
                                                          function (tx) {
                                                            tx.executeSql(
                                                              "DELETE FROM imagenDL WHERE id_cedula = ?",
                                                              [id_cedula],
                                                              function (tx, results) {
                                                                 
                                                                  databaseHandler.db.transaction(
                                                                      function (tx) {
                                                                        tx.executeSql(
                                                                          "DELETE FROM entrenaDL WHERE id_cedula = ?",
                                                                          [id_cedula],
                                                                          function (tx, results) {
                                                                             
                                                                              databaseHandler.db.transaction(
                                                                                  function (tx) {
                                                                                    tx.executeSql(
                                                                                      "DELETE FROM almacenDL WHERE id_cedula = ?",
                                                                                      [id_cedula],
                                                                                      function (tx, results) {
                                                                                         
                                                                                          databaseHandler.db.transaction(
                                                                                              function (tx) {
                                                                                                tx.executeSql(
                                                                                                  "DELETE FROM pedidosDL WHERE id_cedula = ?",
                                                                                                  [id_cedula],
                                                                                                  function (tx, results) {
                                                                                                     
                                                                                                      $("#conc" + id_cedula).remove();
                                                                                                  },
                                                                                                  function (tx, error) {
                                                                                                    swal(
                                                                                                      "Error al eliminar pedidosVIC de Ventas DL",
                                                                                                      error.message,
                                                                                                      "error"
                                                                                                    );
                                                                                                  }
                                                                                                );
                                                                                              },
                                                                                              function (error) { },
                                                                                              function () { }
                                                                                            );
                                                                                      },
                                                                                      function (tx, error) {
                                                                                        swal(
                                                                                          "Error al eliminar almacenDL de Ventas DL",
                                                                                          error.message,
                                                                                          "error"
                                                                                        );
                                                                                      }
                                                                                    );
                                                                                  },
                                                                                  function (error) { },
                                                                                  function () { }
                                                                                );
                                                                          },
                                                                          function (tx, error) {
                                                                            swal(
                                                                              "Error al eliminar entrenaDL de Ventas DL",
                                                                              error.message,
                                                                              "error"
                                                                            );
                                                                          }
                                                                        );
                                                                      },
                                                                      function (error) { },
                                                                      function () { }
                                                                    );
                                                              },
                                                              function (tx, error) {
                                                                swal(
                                                                  "Error al eliminar imagenDL de Ventas DL",
                                                                  error.message,
                                                                  "error"
                                                                );
                                                              }
                                                            );
                                                          },
                                                          function (error) { },
                                                          function () { }
                                                        );
                                                  },
                                                  function (tx, error) {
                                                    swal(
                                                      "Error al eliminar equiposDL de Ventas DL",
                                                      error.message,
                                                      "error"
                                                    );
                                                  }
                                                );
                                              },
                                              function (error) { },
                                              function () { }
                                            );
                                        },
                                        function (tx, error) {
                                          swal(
                                            "Error al eliminar datos DL ",
                                            error.message,
                                            "error"
                                          );
                                        }
                                      );
                                    },
                                    function (error) { },
                                    function () { }
                                  );
                                },
                                function (tx, error) {
                                  swal(
                                    "Error al eliminar cedulas_general",
                                    error.message,
                                    "error"
                                  );
                                }
                              );
                            },
                            function (error) { },
                            function () { }
                          );
                    }else if(tipo_cedula == "Entregas"){
                        databaseHandler.db.transaction(
                            function (tx) {
                              tx.executeSql(
                                "DELETE FROM cedulas_general WHERE id_cedula = ?",
                                [id_cedula],
                                function (tx, results) {
                                  databaseHandler.db.transaction(
                                    function (tx) {
                                      tx.executeSql(
                                        "DELETE FROM DatosentregasDL WHERE id_cedula = ?",
                                        [id_cedula],
                                        function (tx, results) {
                                          databaseHandler.db.transaction(
                                              function (tx) {
                                                tx.executeSql(
                                                  "DELETE FROM entregasDL WHERE id_cedula = ?",
                                                  [id_cedula],
                                                  function (tx, results) {
                                                      $("#conc" + id_cedula).remove();
                                                  },
                                                  function (tx, error) {
                                                    swal(
                                                      "Error al eliminar entregasDL",
                                                      error.message,
                                                      "error"
                                                    );
                                                  }
                                                );
                                              },
                                              function (error) { },
                                              function () { }
                                            );
                                        },
                                        function (tx, error) {
                                          swal(
                                            "Error al eliminar DatosentregasDL ",
                                            error.message,
                                            "error"
                                          );
                                        }
                                      );
                                    },
                                    function (error) { },
                                    function () { }
                                  );
                                },
                                function (tx, error) {
                                  swal(
                                    "Error al eliminar cedulas_general",
                                    error.message,
                                    "error"
                                  );
                                }
                              );
                            },
                            function (error) { },
                            function () { }
                          );
                    }
                } if(empresa == "SMC"){
                    if(tipo_cedula == "levantamiento"){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                    [id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("DELETE FROM levantamiento_smc WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM evidencia_levantamiento_smc WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        $("#conc" + id_cedula).remove();
                                                                    },
                                                                    function(tx, error){
                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al eliminar cedulas_general",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }
                    if(tipo_cedula == "mantenimiento"){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                    [id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("DELETE FROM mantenimiento_smc WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM evidencia_mantenimiento_smc WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        $("#conc" + id_cedula).remove();
                                                                    },
                                                                    function(tx, error){
                                                                        swal("Error al eliminar mantenimiento servicio",error.message,"error");
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al eliminar cedulas_general",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }
                    if(tipo_cedula == "ventaSMC"){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                    [id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("DELETE FROM ventaSMC WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM evidencia_venta_smc WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        databaseHandler.db.transaction(
                                                                            function(tx){
                                                                                tx.executeSql("DELETE FROM datos_equipo_smc WHERE id_cedula = ?",
                                                                                    [id_cedula],
                                                                                    function(tx, results){
                                                                                        $("#conc" + id_cedula).remove();
                                                                                    },
                                                                                    function(tx, error){
                                                                                        swal("Error al eliminar mantenimiento servicio",error.message,"error");
                                                                                    }
                                                                                );
                                                                            },
                                                                            function(error){},
                                                                            function(){}
                                                                        );
                                                                    },
                                                                    function(tx, error){
                                                                        swal("Error al eliminar mantenimiento servicio",error.message,"error");
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al eliminar cedulas_general",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }
                    if(tipo_cedula == "servicioSMC"){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                    [id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("DELETE FROM servicioSMC WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM evidencia_servicio_smc WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        databaseHandler.db.transaction(
                                                                            function(tx){
                                                                                tx.executeSql("DELETE FROM datos_servicio_smc WHERE id_cedula = ?",
                                                                                    [id_cedula],
                                                                                    function(tx, results){
                                                                                        $("#conc" + id_cedula).remove();
                                                                                    },
                                                                                    function(tx, error){
                                                                                        swal("Error al eliminar mantenimiento servicio",error.message,"error");
                                                                                    }
                                                                                );
                                                                            },
                                                                            function(error){},
                                                                            function(){}
                                                                        );
                                                                    },
                                                                    function(tx, error){
                                                                        swal("Error al eliminar mantenimiento servicio",error.message,"error");
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al eliminar cedulas_general",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }
                } else if(empresa == "Field"){
                    if(tipo_cedula == "levantamiento"){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                    [id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("DELETE FROM levantamiento_Field WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM evidencia_levantamiento_Field WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        $("#conc" + id_cedula).remove();
                                                                    },
                                                                    function(tx, error){
                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al eliminar cedulas_general",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }
                    if(tipo_cedula == "mantenimiento"){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                    [id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("DELETE FROM mantenimiento_Field WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM evidencia_mantenimiento_Field WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        $("#conc" + id_cedula).remove();
                                                                    },
                                                                    function(tx, error){
                                                                        swal("Error al eliminar mantenimiento servicio",error.message,"error");
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al eliminar cedulas_general",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }
                } else if(empresa == "DIPREC"){
                    if(tipo_cedula == "reporteTecnico"){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                    [id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("DELETE FROM servicio_tecnico WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM datos_equipo WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        databaseHandler.db.transaction(
                                                                            function(tx){
                                                                                tx.executeSql("DELETE FROM evidencia_equipo WHERE id_cedula = ?",
                                                                                    [id_cedula],
                                                                                    function(tx, results){
                                                                                        databaseHandler.db.transaction(
                                                                                            function(tx){
                                                                                                tx.executeSql("DELETE FROM datos_equipo_antes WHERE id_cedula = ?",
                                                                                                    [id_cedula],
                                                                                                    function(tx, results){
                                                                                                        databaseHandler.db.transaction(
                                                                                                            function(tx){
                                                                                                                tx.executeSql("DELETE FROM evidencia_refacciones WHERE id_cedula = ?",
                                                                                                                    [id_cedula],
                                                                                                                    function(tx, results){
                                                                                                                        databaseHandler.db.transaction(
                                                                                                                            function(tx){
                                                                                                                                tx.executeSql("DELETE FROM check_list WHERE id_cedula = ?",
                                                                                                                                    [id_cedula],
                                                                                                                                    function(tx, results){
                                                                                                                                        databaseHandler.db.transaction(
                                                                                                                                            function(tx){
                                                                                                                                                tx.executeSql("DELETE FROM check_list2 WHERE id_cedula = ?",
                                                                                                                                                    [id_cedula],
                                                                                                                                                    function(tx, results){
                                                                                                                                                        databaseHandler.db.transaction(
                                                                                                                                                            function(tx){
                                                                                                                                                                tx.executeSql("DELETE FROM datos_equipo_despues WHERE id_cedula = ?",
                                                                                                                                                                    [id_cedula],
                                                                                                                                                                    function(tx, results){
                                                                                                                                                                        $("#conc" + id_cedula).remove();
                                                                                                                                                                    },
                                                                                                                                                                    function(tx, error){
                                                                                                                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                                                                                                                    }
                                                                                                                                                                );
                                                                                                                                                            },
                                                                                                                                                            function(error){},
                                                                                                                                                            function(){}
                                                                                                                                                        );
                                                                                                                                                    },
                                                                                                                                                    function(tx, error){
                                                                                                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                                                                                                    }
                                                                                                                                                );
                                                                                                                                            },
                                                                                                                                            function(error){},
                                                                                                                                            function(){}
                                                                                                                                        );
                                                                                                                                    },
                                                                                                                                    function(tx, error){
                                                                                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                                                                                    }
                                                                                                                                );
                                                                                                                            },
                                                                                                                            function(error){},
                                                                                                                            function(){}
                                                                                                                        );
                                                                                                                    },
                                                                                                                    function(tx, error){
                                                                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                                                                    }
                                                                                                                );
                                                                                                            },
                                                                                                            function(error){},
                                                                                                            function(){}
                                                                                                        );
                                                                                                    },
                                                                                                    function(tx, error){
                                                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                                                    }
                                                                                                );
                                                                                            },
                                                                                            function(error){},
                                                                                            function(){}
                                                                                        );
                                                                                    },
                                                                                    function(tx, error){
                                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                                    }
                                                                                );
                                                                            },
                                                                            function(error){},
                                                                            function(){}
                                                                        );
                                                                    },
                                                                    function(tx, error){
                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al eliminar cedulas_general",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    } else if(empresa == "ServInd"){
                        if (tipo_cedula == "Caliente") {
                            databaseHandler.db.transaction(
                                function (tx) {
                                  tx.executeSql(
                                    "DELETE FROM cedulas_general WHERE id_cedula = ?",
                                    [id_cedula],
                                    function (tx, results) {
                                        databaseHandler.db.transaction(
                                            function (tx) {
                                            tx.executeSql(
                                                "DELETE FROM visita_servInd WHERE id_cedula = ?",
                                                [id_cedula],
                                                function (tx, results) {
                                                    databaseHandler.db.transaction(
                                                        function (tx) {
                                                        tx.executeSql(
                                                            "DELETE FROM checklist_servind WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function (tx, results) {
                                                                databaseHandler.db.transaction(
                                                                    function (tx) {
                                                                    tx.executeSql(
                                                                        "DELETE FROM fotos_check WHERE id_cedula = ?",
                                                                        [id_cedula],
                                                                        function (tx, results) {
                                                                            databaseHandler.db.transaction(
                                                                                function (tx) {
                                                                                tx.executeSql(
                                                                                    "DELETE FROM papeleta WHERE id_cedula = ?",
                                                                                    [id_cedula],
                                                                                    function (tx, results) {
                                                                                        databaseHandler.db.transaction(
                                                                                            function (tx) {
                                                                                            tx.executeSql(
                                                                                                "DELETE FROM refacciones WHERE id_cedula = ?",
                                                                                                [id_cedula],
                                                                                                function (tx, results) {
                                                                                                    $("#conc" + id_cedula).remove();
                                                                                                },
                                                                                                function (tx, error) {
                                                                                                swal(
                                                                                                    "Error al refacciones Serv",
                                                                                                    error.message,
                                                                                                    "error"
                                                                                                );
                                                                                                }
                                                                                            );
                                                                                            },
                                                                                            function (error) { },
                                                                                            function () { }
                                                                                        );
                                                                                    },
                                                                                    function (tx, error) {
                                                                                    swal(
                                                                                        "Error al eliminar papeleta serv",
                                                                                        error.message,
                                                                                        "error"
                                                                                    );
                                                                                    }
                                                                                );
                                                                                },
                                                                                function (error) { },
                                                                                function () { }
                                                                            );
                                                                        },
                                                                        function (tx, error) {
                                                                        swal(
                                                                            "Error al eliminar fotos_check serv",
                                                                            error.message,
                                                                            "error"
                                                                        );
                                                                        }
                                                                    );
                                                                    },
                                                                    function (error) { },
                                                                    function () { }
                                                                );
                                                            },
                                                            function (tx, error) {
                                                            swal(
                                                                "Error al eliminar checklist serv",
                                                                error.message,
                                                                "error"
                                                            );
                                                            }
                                                        );
                                                        },
                                                        function (error) { },
                                                        function () { }
                                                    );
                                                },
                                                function (tx, error) {
                                                swal(
                                                    "Error al eliminar visita serv",
                                                    error.message,
                                                    "error"
                                                );
                                                }
                                            );
                                            },
                                            function (error) { },
                                            function () { }
                                        );
                                    },
                                    function (tx, error) {
                                    swal(
                                        "Error al eliminar cedulasG",
                                        error.message,
                                        "error"
                                    );
                                    }
                                );
                                },
                                function (error) { },
                                function () { }
                            );
                        }
                    } else {
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                    [id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("DELETE FROM minuta_coordinador WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM zonas_coordinador WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        databaseHandler.db.transaction(
                                                                            function(tx){
                                                                                tx.executeSql("DELETE FROM equipos_coordinador WHERE id_cedula = ?",
                                                                                    [id_cedula],
                                                                                    function(tx, results){
                                                                                        databaseHandler.db.transaction(
                                                                                            function(tx){
                                                                                                tx.executeSql("DELETE FROM datos_coordinador WHERE id_cedula = ?",
                                                                                                    [id_cedula],
                                                                                                    function(tx, results){
                                                                                                        databaseHandler.db.transaction(
                                                                                                            function(tx){
                                                                                                                tx.executeSql("DELETE FROM observaciones WHERE id_cedula = ?",
                                                                                                                    [id_cedula],
                                                                                                                    function(tx, results){
                                                                                                                        databaseHandler.db.transaction(
                                                                                                                            function(tx){
                                                                                                                                tx.executeSql("DELETE FROM notas WHERE id_cedula = ?",
                                                                                                                                    [id_cedula],
                                                                                                                                    function(tx, results){
                                                                                                                                        $("#conc" + id_cedula).remove();
                                                                                                                                    },
                                                                                                                                    function(tx, error){
                                                                                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                                                                                    }
                                                                                                                                );
                                                                                                                            },
                                                                                                                            function(error){},
                                                                                                                            function(){}
                                                                                                                        );
                                                                                                                    },
                                                                                                                    function(tx, error){
                                                                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                                                                    }
                                                                                                                );
                                                                                                            },
                                                                                                            function(error){},
                                                                                                            function(){}
                                                                                                        );
                                                                                                    },
                                                                                                    function(tx, error){
                                                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                                                    }
                                                                                                );
                                                                                            },
                                                                                            function(error){},
                                                                                            function(){}
                                                                                        );
                                                                                    },
                                                                                    function(tx, error){
                                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                                    }
                                                                                );
                                                                            },
                                                                            function(error){},
                                                                            function(){}
                                                                        );
                                                                    },
                                                                    function(tx, error){
                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al eliminar cedulas_general",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }
                } else if(empresa == "Bennetts"){
                    if(tipo_cedula == "baja"){
                        databaseHandler.db.transaction(
                          function(tx){
                              tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                  [id_cedula],
                                  function(tx, results){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM productos WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){
                                                    $("#conc" + id_cedula).remove();
                                                },
                                                function(tx, error){
                                                    swal("Error al eliminar baja de producto ",error.message,"error");
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                  },
                                  function(tx, error){
                                      swal("Error al eliminar cedulas_general",error.message,"error");
                                  }
                              );
                          },
                          function(error){},
                          function(){}
                      );
                    }
                    if(tipo_cedula == "conteo"){
                        databaseHandler.db.transaction(
                          function(tx){
                              tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                  [id_cedula],
                                  function(tx, results){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM inventario WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){
                                                    databaseHandler.db.transaction(
                                                        function(tx){
                                                            tx.executeSql("DELETE FROM conteo WHERE id_cedula = ?",
                                                                [id_cedula],
                                                                function(tx, results){
                                                                    $("#conc" + id_cedula).remove();
                                                                },
                                                                function(tx, error){
                                                                    swal("Error al eliminar baja de producto ",error.message,"error");
                                                                }
                                                            );
                                                        },
                                                        function(error){},
                                                        function(){}
                                                    );
                                                },
                                                function(tx, error){
                                                    swal("Error al eliminar baja de producto ",error.message,"error");
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                  },
                                  function(tx, error){
                                      swal("Error al eliminar cedulas_general",error.message,"error");
                                  }
                              );
                          },
                          function(error){},
                          function(){}
                      );
                    }
                } else if(empresa == "ServInd"){
                    if(tipo_cedula == "reporteGeneral"){
                        databaseHandler.db.transaction(
                          function(tx){
                              tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                  [id_cedula],
                                  function(tx, results){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM reporteGeneral WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){
                                                    databaseHandler.db.transaction(
                                                        function(tx){
                                                            tx.executeSql("DELETE FROM evidenciasReporte WHERE id_cedula = ?",
                                                                [id_cedula],
                                                                function(tx, results){
                                                                    databaseHandler.db.transaction(
                                                                        function(tx){
                                                                            tx.executeSql("DELETE FROM equiposReporte WHERE id_cedula = ?",
                                                                                [id_cedula],
                                                                                function(tx, results){
                                                                                    $("#conc" + id_cedula).remove();
                                                                                },
                                                                                function(tx, error){
                                                                                    swal("Error al eliminar baja de producto ",error.message,"error");
                                                                                }
                                                                            );
                                                                        },
                                                                        function(error){},
                                                                        function(){}
                                                                    );
                                                                },
                                                                function(tx, error){
                                                                    swal("Error al eliminar baja de producto ",error.message,"error");
                                                                }
                                                            );
                                                        },
                                                        function(error){},
                                                        function(){}
                                                    );
                                                },
                                                function(tx, error){
                                                    swal("Error al eliminar baja de producto ",error.message,"error");
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                  },
                                  function(tx, error){
                                      swal("Error al eliminar cedulas_general",error.message,"error");
                                  }
                              );
                          },
                          function(error){},
                          function(){}
                      );
                    } else if(tipo_cedula == "checklistServ"){
                        databaseHandler.db.transaction(
                          function(tx){
                              tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                  [id_cedula],
                                  function(tx, results){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM checklist WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){
                                                    databaseHandler.db.transaction(
                                                        function(tx){
                                                            tx.executeSql("DELETE FROM selectcheck WHERE id_cedula = ?",
                                                                [id_cedula],
                                                                function(tx, results){
                                                                    $("#conc" + id_cedula).remove();
                                                                },
                                                                function(tx, error){
                                                                    swal("Error al eliminar baja de producto ",error.message,"error");
                                                                }
                                                            );
                                                        },
                                                        function(error){},
                                                        function(){}
                                                    );
                                                },
                                                function(tx, error){
                                                    swal("Error al eliminar baja de producto ",error.message,"error");
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                  },
                                  function(tx, error){
                                      swal("Error al eliminar cedulas_general",error.message,"error");
                                  }
                              );
                          },
                          function(error){},
                          function(){}
                      );
                    } else if(tipo_cedula == "AuditoriaTecnico" || tipo_cedula == "AuditoriaSupervisorTecnico" || tipo_cedula == "AuditoriaLider"){
                        databaseHandler.db.transaction(
                          function(tx){
                              tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                  [id_cedula],
                                  function(tx, results){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM SV_Fotos WHERE SV_ID_Cedula = ?",
                                                [id_cedula],
                                                function(tx, results){
                                                    databaseHandler.db.transaction(
                                                        function(tx){
                                                            tx.executeSql("DELETE FROM Aud_Tec WHERE AT_ID_cedula = ?",
                                                                [id_cedula],
                                                                function(tx, results){
                                                                    databaseHandler.db.transaction(
                                                                        function(tx){
                                                                            tx.executeSql("DELETE FROM Aud_General WHERE AG_ID_cedula = ?",
                                                                                [id_cedula],
                                                                                function(tx, results){
                                                                                    $("#conc" + id_cedula).remove();
                                                                                },
                                                                                function(tx, error){
                                                                                    swal("Error al eliminar baja de producto ",error.message,"error");
                                                                                }
                                                                            );
                                                                        },
                                                                        function(error){},
                                                                        function(){}
                                                                    );
                                                                },
                                                                function(tx, error){
                                                                    swal("Error al eliminar baja de producto ",error.message,"error");
                                                                }
                                                            );
                                                        },
                                                        function(error){},
                                                        function(){}
                                                    );
                                                },
                                                function(tx, error){
                                                    swal("Error al eliminar baja de producto ",error.message,"error");
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                  },
                                  function(tx, error){
                                      swal("Error al eliminar cedulas_general",error.message,"error");
                                  }
                              );
                          },
                          function(error){},
                          function(){}
                      );
                    }
                } else if(empresa == "SURO"){
                    if (tipo_cedula == "sanitizacionSURO") {
                        databaseHandler.db.transaction(
                          function (tx) {
                            tx.executeSql(
                              "DELETE FROM cedulas_general WHERE id_cedula = ?",
                              [id_cedula],
                              function (tx, results) {
                                databaseHandler.db.transaction(
                                  function (tx) {
                                    tx.executeSql(
                                      "DELETE FROM sanitizacion_Suro WHERE id_cedula = ?",
                                      [id_cedula],
                                      function (tx, results) {
                                        databaseHandler.db.transaction(
                                            function (tx) {
                                              tx.executeSql(
                                                "DELETE FROM evidencia WHERE id_cedula = ?",
                                                [id_cedula],
                                                function (tx, results) {
                                                    databaseHandler.db.transaction(
                                                        function (tx) {
                                                          tx.executeSql(
                                                            "DELETE FROM grupos WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function (tx, results) {
                                                              $("#conc" + id_cedula).remove();
                                                            },
                                                            function (tx, error) {
                                                              swal(
                                                                "Error al eliminar sanitizacion ",
                                                                error.message,
                                                                "error"
                                                              );
                                                            }
                                                          );
                                                        },
                                                        function (error) { },
                                                        function () { }
                                                      );
                                                },
                                                function (tx, error) {
                                                  swal(
                                                    "Error al eliminar sanitizacion ",
                                                    error.message,
                                                    "error"
                                                  );
                                                }
                                              );
                                            },
                                            function (error) { },
                                            function () { }
                                          );
                                      },
                                      function (tx, error) {
                                        swal(
                                          "Error al eliminar sanitizacion ",
                                          error.message,
                                          "error"
                                        );
                                      }
                                    );
                                  },
                                  function (error) { },
                                  function () { }
                                );
                              },
                              function (tx, error) {
                                swal(
                                  "Error al eliminar cedulas_general",
                                  error.message,
                                  "error"
                                );
                              }
                            );
                          },
                          function (error) { },
                          function () { }
                        );
                      }else if (tipo_cedula == "recorridoSURO") {
                        databaseHandler.db.transaction(
                            function (tx) {
                              tx.executeSql(
                                "DELETE FROM cedulas_general WHERE id_cedula = ?",
                                [id_cedula],
                                function (tx, results) {
                                  databaseHandler.db.transaction(
                                    function (tx) {
                                      tx.executeSql(
                                        "DELETE FROM Recorrido_SURO WHERE id_cedula = ?",
                                        [id_cedula],
                                        function (tx, results) {
                                          databaseHandler.db.transaction(
                                              function (tx) {
                                                tx.executeSql(
                                                  "DELETE FROM Fotos_SURO WHERE id_cedula = ?",
                                                  [id_cedula],
                                                  function (tx, results) {
                                                    $("#conc" + id_cedula).remove();
                                                  },
                                                  function (tx, error) {
                                                    swal(
                                                      "Error al eliminar Recorrido_SURO ",
                                                      error.message,
                                                      "error"
                                                    );
                                                  }
                                                );
                                              },
                                              function (error) { },
                                              function () { }
                                            );
                                        },
                                        function (tx, error) {
                                          swal(
                                            "Error al eliminar Recorrido_SURO ",
                                            error.message,
                                            "error"
                                          );
                                        }
                                      );
                                    },
                                    function (error) { },
                                    function () { }
                                  );
                                },
                                function (tx, error) {
                                  swal(
                                    "Error al eliminar cedulas_general",
                                    error.message,
                                    "error"
                                  );
                                }
                              );
                            },
                            function (error) { },
                            function () { }
                          );
                      }else if (tipo_cedula == "visitaSURO") {
                        databaseHandler.db.transaction(
                            function (tx) {
                              tx.executeSql(
                                "DELETE FROM cedulas_general WHERE id_cedula = ?",
                                [id_cedula],
                                function (tx, results) {
                                  databaseHandler.db.transaction(
                                    function (tx) {
                                      tx.executeSql(
                                        "DELETE FROM Visita_SURO WHERE id_cedula = ?",
                                        [id_cedula],
                                        function (tx, results) {
                                          databaseHandler.db.transaction(
                                              function (tx) {
                                                tx.executeSql(
                                                  "DELETE FROM Fotos_SURO WHERE id_cedula = ?",
                                                  [id_cedula],
                                                  function (tx, results) {
                                                    $("#conc" + id_cedula).remove();
                                                  },
                                                  function (tx, error) {
                                                    swal(
                                                      "Error al eliminar Visita_SURO ",
                                                      error.message,
                                                      "error"
                                                    );
                                                  }
                                                );
                                              },
                                              function (error) { },
                                              function () { }
                                            );
                                        },
                                        function (tx, error) {
                                          swal(
                                            "Error al eliminar Visita_SURO ",
                                            error.message,
                                            "error"
                                          );
                                        }
                                      );
                                    },
                                    function (error) { },
                                    function () { }
                                  );
                                },
                                function (tx, error) {
                                  swal(
                                    "Error al eliminar cedulas_general",
                                    error.message,
                                    "error"
                                  );
                                }
                              );
                            },
                            function (error) { },
                            function () { }
                          );
                      }else if (tipo_cedula == "encuestaSURO") {
                        databaseHandler.db.transaction(
                            function (tx) {
                              tx.executeSql(
                                "DELETE FROM cedulas_general WHERE id_cedula = ?",
                                [id_cedula],
                                function (tx, results) {
                                  databaseHandler.db.transaction(
                                    function (tx) {
                                      tx.executeSql(
                                        "DELETE FROM Encuesta_SURO WHERE id_cedula = ?",
                                        [id_cedula],
                                        function (tx, results) {
                                          databaseHandler.db.transaction(
                                              function (tx) {
                                                tx.executeSql(
                                                  "DELETE FROM Fotos_SURO WHERE id_cedula = ?",
                                                  [id_cedula],
                                                  function (tx, results) {
                                                    $("#conc" + id_cedula).remove();
                                                  },
                                                  function (tx, error) {
                                                    swal(
                                                      "Error al eliminar encuestaSURO  ",
                                                      error.message,
                                                      "error"
                                                    );
                                                  }
                                                );
                                              },
                                              function (error) { },
                                              function () { }
                                            );
                                        },
                                        function (tx, error) {
                                          swal(
                                            "Error al eliminar encuestaSURO  ",
                                            error.message,
                                            "error"
                                          );
                                        }
                                      );
                                    },
                                    function (error) { },
                                    function () { }
                                  );
                                },
                                function (tx, error) {
                                  swal(
                                    "Error al eliminar cedulas_general",
                                    error.message,
                                    "error"
                                  );
                                }
                              );
                            },
                            function (error) { },
                            function () { }
                          );
                      }else if (tipo_cedula == "visitaBSURO") {
                        databaseHandler.db.transaction(
                            function (tx) {
                              tx.executeSql(
                                "DELETE FROM cedulas_general WHERE id_cedula = ?",
                                [id_cedula],
                                function (tx, results) {
                                  databaseHandler.db.transaction(
                                    function (tx) {
                                      tx.executeSql(
                                        "DELETE FROM VisitaB_SURO WHERE id_cedula = ?",
                                        [id_cedula],
                                        function (tx, results) {
                                          databaseHandler.db.transaction(
                                              function (tx) {
                                                tx.executeSql(
                                                  "DELETE FROM Fotos_SURO WHERE id_cedula = ?",
                                                  [id_cedula],
                                                  function (tx, results) {
                                                    $("#conc" + id_cedula).remove();
                                                  },
                                                  function (tx, error) {
                                                    swal(
                                                      "Error al eliminar visitaBSURO",
                                                      error.message,
                                                      "error"
                                                    );
                                                  }
                                                );
                                              },
                                              function (error) { },
                                              function () { }
                                            );
                                        },
                                        function (tx, error) {
                                          swal(
                                            "Error al eliminar visitaBSURO",
                                            error.message,
                                            "error"
                                          );
                                        }
                                      );
                                    },
                                    function (error) { },
                                    function () { }
                                  );
                                },
                                function (tx, error) {
                                  swal(
                                    "Error al eliminar cedulas_general",
                                    error.message,
                                    "error"
                                  );
                                }
                              );
                            },
                            function (error) { },
                            function () { }
                          );
                      }else if (tipo_cedula == "seguimientoSURO") {
                        databaseHandler.db.transaction(
                            function (tx) {
                              tx.executeSql(
                                "DELETE FROM cedulas_general WHERE id_cedula = ?",
                                [id_cedula],
                                function (tx, results) {
                                  databaseHandler.db.transaction(
                                    function (tx) {
                                      tx.executeSql(
                                        "DELETE FROM Seguimiento WHERE id_cedula = ?",
                                        [id_cedula],
                                        function (tx, results) {
                                          databaseHandler.db.transaction(
                                              function (tx) {
                                                tx.executeSql(
                                                  "DELETE FROM Fotos_SURO WHERE id_cedula = ?",
                                                  [id_cedula],
                                                  function (tx, results) {
                                                    $("#conc" + id_cedula).remove();
                                                  },
                                                  function (tx, error) {
                                                    swal(
                                                      "Error al eliminar seguimientoSURO",
                                                      error.message,
                                                      "error"
                                                    );
                                                  }
                                                );
                                              },
                                              function (error) { },
                                              function () { }
                                            );
                                        },
                                        function (tx, error) {
                                          swal(
                                            "Error al eliminar seguimientoSURO",
                                            error.message,
                                            "error"
                                          );
                                        }
                                      );
                                    },
                                    function (error) { },
                                    function () { }
                                  );
                                },
                                function (tx, error) {
                                  swal(
                                    "Error al eliminar cedulas_general",
                                    error.message,
                                    "error"
                                  );
                                }
                              );
                            },
                            function (error) { },
                            function () { }
                          );
                      }
                } else if(empresa == "PlatoLimpio"){
                    databaseHandler.db.transaction(
                        function (tx) {
                          tx.executeSql(
                            "DELETE FROM cedulas_general WHERE id_cedula = ?",
                            [id_cedula],
                            function (tx, results) {
                                databaseHandler.db.transaction(
                                    function (tx) {
                                      tx.executeSql(
                                        "DELETE FROM DG_PlatoL WHERE DG_ID_Cedula = ?",
                                        [id_cedula],
                                        function (tx, results) {
                                            databaseHandler.db.transaction(
                                                function (tx) {
                                                  tx.executeSql(
                                                    "DELETE FROM Ciclo_Charola WHERE CC_ID_Cedula = ?",
                                                    [id_cedula],
                                                    function (tx, results) {
                                                        databaseHandler.db.transaction(
                                                            function (tx) {
                                                              tx.executeSql(
                                                                "DELETE FROM Factor_Humano WHERE FH_ID_Cedula = ?",
                                                                [id_cedula],
                                                                function (tx, results) {
                                                                    databaseHandler.db.transaction(
                                                                        function (tx) {
                                                                          tx.executeSql(
                                                                            "DELETE FROM Info_Equipo WHERE IE_ID_Cedula = ?",
                                                                            [id_cedula],
                                                                            function (tx, results) {
                                                                                databaseHandler.db.transaction(
                                                                                    function (tx) {
                                                                                      tx.executeSql(
                                                                                        "DELETE FROM Capa_Equipo_A WHERE CE_ID_Cedula = ?",
                                                                                        [id_cedula],
                                                                                        function (tx, results) {
                                                                                            databaseHandler.db.transaction(
                                                                                                function (tx) {
                                                                                                  tx.executeSql(
                                                                                                    "DELETE FROM Capa_Equipo_B WHERE CE_ID_Cedula = ?",
                                                                                                    [id_cedula],
                                                                                                    function (tx, results) {
                                                                                                        databaseHandler.db.transaction(
                                                                                                            function (tx) {
                                                                                                              tx.executeSql(
                                                                                                                "DELETE FROM Tipo_Sistema WHERE TS_ID_Cedula = ?",
                                                                                                                [id_cedula],
                                                                                                                function (tx, results) {
                                                                                                                    databaseHandler.db.transaction(
                                                                                                                        function (tx) {
                                                                                                                          tx.executeSql(
                                                                                                                            "DELETE FROM Prueba_Calidad_Agua WHERE PCA_ID_Cedula = ?",
                                                                                                                            [id_cedula],
                                                                                                                            function (tx, results) {
                                                                                                                                databaseHandler.db.transaction(
                                                                                                                                    function (tx) {
                                                                                                                                      tx.executeSql(
                                                                                                                                        "DELETE FROM Insumos_A WHERE ID_Cedula = ?",
                                                                                                                                        [id_cedula],
                                                                                                                                        function (tx, results) {
                                                                                                                                            databaseHandler.db.transaction(
                                                                                                                                                function (tx) {
                                                                                                                                                  tx.executeSql(
                                                                                                                                                    "DELETE FROM Insumos_B WHERE ID_Cedula = ?",
                                                                                                                                                    [id_cedula],
                                                                                                                                                    function (tx, results) {
                                                                                                                                                        databaseHandler.db.transaction(
                                                                                                                                                            function (tx) {
                                                                                                                                                              tx.executeSql(
                                                                                                                                                                "DELETE FROM Insumos_C WHERE ID_Cedula = ?",
                                                                                                                                                                [id_cedula],
                                                                                                                                                                function (tx, results) {
                                                                                                                                                                    databaseHandler.db.transaction(
                                                                                                                                                                        function (tx) {
                                                                                                                                                                          tx.executeSql(
                                                                                                                                                                            "DELETE FROM Stress WHERE ID_Cedula = ?",
                                                                                                                                                                            [id_cedula],
                                                                                                                                                                            function (tx, results) {
                                                                                                                                                                                databaseHandler.db.transaction(
                                                                                                                                                                                    function (tx) {
                                                                                                                                                                                      tx.executeSql(
                                                                                                                                                                                        "DELETE FROM Resultado WHERE ID_Cedula = ?",
                                                                                                                                                                                        [id_cedula],
                                                                                                                                                                                        function (tx, results) {
                                                                                                                                                                                            databaseHandler.db.transaction(
                                                                                                                                                                                                function (tx) {
                                                                                                                                                                                                  tx.executeSql(
                                                                                                                                                                                                    "DELETE FROM PL_Fotos WHERE F_ID_Cedula = ?",
                                                                                                                                                                                                    [id_cedula],
                                                                                                                                                                                                    function (tx, results) {
                                                                                                                                                                                                    $("#conc" + id_cedula).remove();
                                                                                                                                                                                                       
                                                                                                                                                                                                    },
                                                                                                                                                                                                    function (tx, error) {
                                                                                                                                                                                                      swal(
                                                                                                                                                                                                        "Error al eliminar PL_Fotos",
                                                                                                                                                                                                        error.message,
                                                                                                                                                                                                        "error"
                                                                                                                                                                                                      );
                                                                                                                                                                                                    }
                                                                                                                                                                                                  );
                                                                                                                                                                                                },
                                                                                                                                                                                                function (error) { },
                                                                                                                                                                                                function () { }
                                                                                                                                                                                              );
                                                                                                                                                                                        },
                                                                                                                                                                                        function (tx, error) {
                                                                                                                                                                                          swal(
                                                                                                                                                                                            "Error al eliminar Resultado",
                                                                                                                                                                                            error.message,
                                                                                                                                                                                            "error"
                                                                                                                                                                                          );
                                                                                                                                                                                        }
                                                                                                                                                                                      );
                                                                                                                                                                                    },
                                                                                                                                                                                    function (error) { },
                                                                                                                                                                                    function () { }
                                                                                                                                                                                  );
                                                                                                                                                                            },
                                                                                                                                                                            function (tx, error) {
                                                                                                                                                                              swal(
                                                                                                                                                                                "Error al eliminar Stress",
                                                                                                                                                                                error.message,
                                                                                                                                                                                "error"
                                                                                                                                                                              );
                                                                                                                                                                            }
                                                                                                                                                                          );
                                                                                                                                                                        },
                                                                                                                                                                        function (error) { },
                                                                                                                                                                        function () { }
                                                                                                                                                                      );
                                                                                                                                                                },
                                                                                                                                                                function (tx, error) {
                                                                                                                                                                  swal(
                                                                                                                                                                    "Error al eliminar Insumos_C",
                                                                                                                                                                    error.message,
                                                                                                                                                                    "error"
                                                                                                                                                                  );
                                                                                                                                                                }
                                                                                                                                                              );
                                                                                                                                                            },
                                                                                                                                                            function (error) { },
                                                                                                                                                            function () { }
                                                                                                                                                          );
                                                                                                                                                    },
                                                                                                                                                    function (tx, error) {
                                                                                                                                                      swal(
                                                                                                                                                        "Error al eliminar Insumos_B",
                                                                                                                                                        error.message,
                                                                                                                                                        "error"
                                                                                                                                                      );
                                                                                                                                                    }
                                                                                                                                                  );
                                                                                                                                                },
                                                                                                                                                function (error) { },
                                                                                                                                                function () { }
                                                                                                                                              );
                                                                                                                                        },
                                                                                                                                        function (tx, error) {
                                                                                                                                          swal(
                                                                                                                                            "Error al eliminar Insumos_A",
                                                                                                                                            error.message,
                                                                                                                                            "error"
                                                                                                                                          );
                                                                                                                                        }
                                                                                                                                      );
                                                                                                                                    },
                                                                                                                                    function (error) { },
                                                                                                                                    function () { }
                                                                                                                                  );
                                                                                                                            },
                                                                                                                            function (tx, error) {
                                                                                                                              swal(
                                                                                                                                "Error al eliminar Prueba_Calidad_Agua",
                                                                                                                                error.message,
                                                                                                                                "error"
                                                                                                                              );
                                                                                                                            }
                                                                                                                          );
                                                                                                                        },
                                                                                                                        function (error) { },
                                                                                                                        function () { }
                                                                                                                      );
                                                                                                                },
                                                                                                                function (tx, error) {
                                                                                                                  swal(
                                                                                                                    "Error al eliminar Tipo_Sistema",
                                                                                                                    error.message,
                                                                                                                    "error"
                                                                                                                  );
                                                                                                                }
                                                                                                              );
                                                                                                            },
                                                                                                            function (error) { },
                                                                                                            function () { }
                                                                                                          );
                                                                                                    },
                                                                                                    function (tx, error) {
                                                                                                      swal(
                                                                                                        "Error al eliminar Capa_Equipo_B",
                                                                                                        error.message,
                                                                                                        "error"
                                                                                                      );
                                                                                                    }
                                                                                                  );
                                                                                                },
                                                                                                function (error) { },
                                                                                                function () { }
                                                                                              );
                                                                                        },
                                                                                        function (tx, error) {
                                                                                          swal(
                                                                                            "Error al eliminar Capa_Equipo_A",
                                                                                            error.message,
                                                                                            "error"
                                                                                          );
                                                                                        }
                                                                                      );
                                                                                    },
                                                                                    function (error) { },
                                                                                    function () { }
                                                                                  );
                                                                            },
                                                                            function (tx, error) {
                                                                              swal(
                                                                                "Error al eliminar Info_Equipo",
                                                                                error.message,
                                                                                "error"
                                                                              );
                                                                            }
                                                                          );
                                                                        },
                                                                        function (error) { },
                                                                        function () { }
                                                                      );
                                                                },
                                                                function (tx, error) {
                                                                  swal(
                                                                    "Error al eliminar Factor_Humano",
                                                                    error.message,
                                                                    "error"
                                                                  );
                                                                }
                                                              );
                                                            },
                                                            function (error) { },
                                                            function () { }
                                                          );
                                                    },
                                                    function (tx, error) {
                                                      swal(
                                                        "Error al eliminar Ciclo_Charola",
                                                        error.message,
                                                        "error"
                                                      );
                                                    }
                                                  );
                                                },
                                                function (error) { },
                                                function () { }
                                              );
                                        },
                                        function (tx, error) {
                                          swal(
                                            "Error al eliminar DG_PlatoL",
                                            error.message,
                                            "error"
                                          );
                                        }
                                      );
                                    },
                                    function (error) { },
                                    function () { }
                                  );
                            },
                            function (tx, error) {
                              swal(
                                "Error al eliminar cedulas_general",
                                error.message,
                                "error"
                              );
                            }
                          );
                        },
                        function (error) { },
                        function () { }
                    );
                } else {
                    if(tipo_cedula == "levantamiento"){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                    [id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("DELETE FROM levantamiento_servicio WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM levantamiento_evidencia WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        $("#conc" + id_cedula).remove();
                                                                    },
                                                                    function(tx, error){
                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al eliminar cedulas_general",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }
                    if(tipo_cedula == "fumigacion"){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                    [id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("DELETE FROM fumigacion WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM fotos_fumigacion WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        $("#conc" + id_cedula).remove();
                                                                    },
                                                                    function(tx, error){
                                                                        swal("Error al eliminar fumigacion",error.message,"error");
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al eliminar fumigacion",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al eliminar cedulas_general",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }
                    if(tipo_cedula == "sanitizacion"){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                    [id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("DELETE FROM sanitizacion WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM fotos_sanitizacion WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        $("#conc" + id_cedula).remove();
                                                                    },
                                                                    function(tx, error){
                                                                        swal("Error al eliminar sanitizacion",error.message,"error");
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al eliminar fumigacion",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al eliminar cedulas_general",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }
                }
            } else {

            }
        });
    }
    function EliminarRegistrosAntiguos(){
        var id_usuario = localStorage.getItem("id_usuario");
        var fecha = new Date();
        var fecha_ingreso = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate();
        fecha_eliminar = editar_fecha(fecha_ingreso, "-11", "d","-");
        databaseHandler.db.transaction(
            function(tx5){
                tx5.executeSql("SELECT * FROM cedulas_general WHERE fecha_entrada > ? AND id_usuario = ? AND (estatus = 1 OR estatus = 2)",
                    [fecha_eliminar,id_usuario],
                    function(tx5, results){
                        var length = results.rows.length;
                        for(var i = 0; i< length; i++){
                            var item2 = results.rows.item(i);
                            var id_eliminar = item2.IdCedula;
                            databaseHandler.db.transaction(
                                function(tx4){
                                    tx4.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                        [id_eliminar],
                                        function(tx4, results){
                                        },
                                        function(tx4, error){
                                            console.error("Error al eliminar cedula_general: " + error.message);
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                            var empresa = localStorage.getItem("nombre_empresa");
                            if(empresa == "SMC"){
                                if(tipo == "levantamiento"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM levantamiento_smc WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error eliminar levantamiento SMC: " + error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM evidencia_levantamiento_smc WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al Eliminar evidencia levantamiento SMC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                }
                                if(tipo == "mantenimiento"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM mantenimiento_smc WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar mantenimiento SMC: " + error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM evidencia_mantenimiento_smc WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar evidencia mantenimiento SMC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                }
                            } else if(empresa == "Dilimpio"){
                                if (tipo == "Entregas") {
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM DatosentregasDL WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar DatosentregasDL: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM entregasDL WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar entregasDL: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                } else if (tipo == "visitaDilimpio") {
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM visitaDilimpio WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar visitaDilimpio: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM equiposDL WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar equiposDL: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM imagenDL WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar imagenDL: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM entrenaDL WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar entrenaDL: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM almacenDL WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar almacenDL: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM pedidosDL WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar pedidosDL: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                }
                            } else if(empresa == "Field"){
                                if(tipo == "levantamiento"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM levantamiento_Field WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar levantamiento Field: " + error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM evidencia_levantamiento_Field WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar evidencia levantamiento Field: " +error.message);}
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                }
                                if(tipo == "mantenimiento"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM mantenimiento_Field WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Erro al eliminar mantenimiento Field: " + error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM evidencia_mantenimiento_Field WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar evidencia mantenimiento Field: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                }
                            } else if(empresa == "Bennetts"){
                                if(tipo == "baja"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM productos WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar productos Bennetts: " + error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM datos_productos WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar fotos sanitizacion Bennetts: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                }
                            } else if(empresa == "DIPREC"){
                                if(tipo == "reporteTecnico"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM servicio_tecnico WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar servicio tecnico DIPREC: " + error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM datos_equipo WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar datos equipo DIPREC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM evidencia_equipo WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar al eliminar evidencia equipo: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM datos_equipo_antes WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar datos equipo antes DIPREC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM evidencia_refacciones WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminarevidencia refacciones diprec: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM check_list WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error eliminar al check list DIPREC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM check_list2 WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar check list 2 DIPREC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM datos_equipo_despues WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar datos equipo despues DIPREC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                }
                                if(tipo == "minutaCoordinador"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM minuta_coordinador WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar minuta coordonador DIPREC: " + error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM zonas_coordinador WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar zonas coordinador DIPREC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM equipos_coordinador WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar equipos coordinador DIPREC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM datos_coordinador WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar datos coordinador DIPREC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM observaciones WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar observaciones DIPREC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM notas WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar notas DIPREC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                }
                            }  else if(empresa == "SURO"){
                                if(tipo == "sanitizacionSURO"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM sanitizacion_Suro WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar sanitizacion SURO: " + error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM evidencia WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar fotos sanitizacion SURO: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                }
                            } else if(empresa == "VIC"){
                                if (tipo == "ApoyoVIC") {
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM apoyo_bennetts WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar apoyo_bennetts VIC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM fotos_apoyo WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar fotos_apoyo VIC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                } else if (tipo == "VentasVIC") {
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM ventas_bennetts WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar ventas_bennetts VIC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM minuta WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar minuta VIC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                } else if (tipo == "VIC") {
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM datosVIC WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar datosVIC VIC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM equiposVIC WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar equiposVIC VIC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM imagenVIC WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar imagenVIC VIC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM entrenaVIC WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar entrenaVIC VIC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM almacenVIC WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar almacenVIC VIC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM pedidosVIC WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar pedidosVIC VIC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM VIC_Fotos WHERE ID_Cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar VIC_Fotos VIC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM VIC_Respuesta WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar VIC_Respuesta VIC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                }
                            } else {
                                if(tipo == "sanitizacion"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM sanitizacion WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar sanitizacion AYB: " + error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM fotos_sanitizacion WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar fotos sanitizacion AYB: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                }
                                if(tipo == "levantamiento"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM levantamiento_servicio WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar levantamiento AYB: " + error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM levantamiento_evidencia WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar fotos levantamiento AYB: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                }
                                if(tipo == "fumigacion"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM fumigacion WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar fumigacion AYB: " + error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM fotos_fumigacion WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar fotos fumigacion AYB: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                }
                            }                            
                        }
                        
                    },
                    function(tx5, error){
                        console.log("Error al depurar registros: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDescripcionAntes(){
        var id_cedula = localStorage.getItem("IdCedula");
        var descripcion = $('#descripcion').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE fumigacion SET descripcion_antes = ? WHERE id_cedula = ?",
                    [descripcion,id_cedula],
                    function(tx, results){
                        swal("","Descripcion guardada correctamente","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDescripcionAntesSani(){
        var id_cedula = localStorage.getItem("IdCedula");
        var descripcion = $('#descripcion').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE sanitizacion SET descripcion_antes = ? WHERE id_cedula = ?",
                    [descripcion,id_cedula],
                    function(tx, results){
                        swal("","Descripcion guardada correctamente","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDescripcionDurante(){
        var id_cedula = localStorage.getItem("IdCedula");
        var descripcion = $('#descripcion').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE fumigacion SET descripcion_durante = ? WHERE id_cedula = ?",
                    [descripcion,id_cedula],
                    function(tx, results){
                        swal("","Descripcion guardada correctamente","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDescripcionDuranteSanitizacion(){
        var id_cedula = localStorage.getItem("IdCedula");
        var descripcion = $('#descripcion').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE sanitizacion SET descripcion_durante = ? WHERE id_cedula = ?",
                    [descripcion,id_cedula],
                    function(tx, results){
                        swal("","Descripcion guardada correctamente","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDescripcionDespues(){
        var id_cedula = localStorage.getItem("IdCedula");
        var descripcion = $('#descripcion').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE fumigacion SET descripcion_despues = ? WHERE id_cedula = ?",
                    [descripcion,id_cedula],
                    function(tx, results){
                        swal("","Descripcion guardada correctamente","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDescripcionDespuesSanitizacion(){
        var id_cedula = localStorage.getItem("IdCedula");
        var descripcion = $('#descripcion').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE sanitizacion SET descripcion_despues = ? WHERE id_cedula = ?",
                    [descripcion,id_cedula],
                    function(tx, results){
                        swal("","Descripcion guardada correctamente","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function capturePhotoSS1() {
        navigator.camera.getPicture(onSSinglePhotoSucceess1, onSSinglePhotoFail1, {
          quality: 50,
          destinationType: destinationType.DATA_URL,
          targetWidth: 500,
          targetHeight: 500,
          correctOrientation: true
        });
    }
    function captureSingleSMC() {
        navigator.camera.getPicture(onSinglePhotoSMCSucceess, onSinglePhotoSMCFail, {
          quality: 50,
          destinationType: destinationType.DATA_URL,
          targetWidth: 500,
          targetHeight: 500,
          correctOrientation: true
        });
    }
    function onSinglePhotoSMCSucceess(imageData) {
        var smallImage = document.getElementById('smallImage1');
        smallImage.style.display = 'flex';
        var nameima = "data:image/jpeg;base64," + imageData;
        smallImage.src = "data:image/jpeg;base64," + imageData;
        $("#imagenC1").val(nameima);
        $("#photoIcon1").attr("src","img/reload.svg");
    }
    function onSinglePhotoSMCFail(message) {
        swal("Error al tomar foto:",message,"error");
    }
    // Imagen sola 1
    function onSSinglePhotoSucceess1(imageData) {
        var id_cedula = localStorage.getItem("IdCedula");
        var smallImage = document.getElementById('smallImage1');
        smallImage.style.display = 'flex';
        var nameima = "data:image/jpeg;base64," + imageData;
        smallImage.src = "data:image/jpeg;base64," + imageData;
        $("#imagenC1").val(nameima);
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE sanitizacion SET foto_quimico = ? WHERE id_cedula = ?",
                    [nameima,id_cedula],
                    function(tx, results){
                        swal("","Foto quimico fue guardada correctamente","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
        $("#photoIcon1").attr("src","img/reload.svg");
    }
    function onSSinglePhotoFail1(message) {
        swal("Error al tomar foto:",message,"error");
    }
    function capturePhotoSS2() {
        navigator.camera.getPicture(onSSinglePhotoSucceess2, onSSinglePhotoFail2, {
          quality: 50,
          destinationType: destinationType.DATA_URL,
          targetWidth: 500,
          targetHeight: 500,
          correctOrientation: true
        });
    }
    function onSSinglePhotoSucceess2(imageData) {
        var id_cedula = localStorage.getItem("IdCedula");
        var smallImage = document.getElementById('smallImage2');
        smallImage.style.display = 'flex';
        var nameima = "data:image/jpeg;base64," + imageData;
        smallImage.src = "data:image/jpeg;base64," + imageData;
        $("#imagenC2").val(nameima);
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE sanitizacion SET foto_equipo = ? WHERE id_cedula = ?",
                    [nameima,id_cedula],
                    function(tx, results){
                        swal("","Foto equipo fue guardada correctamente","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
        $("#photoIcon2").attr("src","img/reload.svg");
    }
    function onSSinglePhotoFail2(message) {
        swal("Error al tomar foto:",message,"error");
    }
    function capturePhotoSS3() {
        navigator.camera.getPicture(onSSinglePhotoSucceess3, onSSinglePhotoFail3, {
          quality: 50,
          destinationType: destinationType.DATA_URL,
          targetWidth: 500,
          targetHeight: 500,
          correctOrientation: true
        });
    }
    function onSSinglePhotoSucceess3(imageData) {
        var id_cedula = localStorage.getItem("IdCedula");
        var smallImage = document.getElementById('smallImage3');
        smallImage.style.display = 'flex';
        var nameima = "data:image/jpeg;base64," + imageData;
        smallImage.src = "data:image/jpeg;base64," + imageData;
        $("#imagenC3").val(nameima);
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE sanitizacion SET foto_reporte = ? WHERE id_cedula = ?",
                    [nameima,id_cedula],
                    function(tx, results){
                        swal("","Foto del reporte fue guardada correctamente","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
        $("#photoIcon3").attr("src","img/reload.svg");
    }
    function onSSinglePhotoFail3(message) {
        swal("Error al tomar foto:",message,"error");
    }
    //Fumigacion single photo
    function capturePhotoS1() {
        navigator.camera.getPicture(onSinglePhotoSucceess1, onSinglePhotoFail1, {
          quality: 50,
          destinationType: destinationType.DATA_URL,
          targetWidth: 500,
          targetHeight: 500,
          correctOrientation: true
        });
    }
    // Imagen sola 1
    function onSinglePhotoSucceess1(imageData) {
        var id_cedula = localStorage.getItem("IdCedula");
        var smallImage = document.getElementById('smallImage1');
        smallImage.style.display = 'flex';
        var nameima = "data:image/jpeg;base64," + imageData;
        smallImage.src = "data:image/jpeg;base64," + imageData;
        $("#imagenC1").val(nameima);
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE fumigacion SET foto_quimico = ? WHERE id_cedula = ?",
                    [nameima,id_cedula],
                    function(tx, results){
                        swal("","Foto quimico fue guardada correctamente","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
        $("#photoIcon1").attr("src","img/reload.svg");
    }
    function onSinglePhotoFail1(message) {
        swal("Error al tomar foto:",message,"error");
    }
    // Imagen sola 2
    function capturePhotoS2() {
        navigator.camera.getPicture(onSinglePhotoSucceess2, onSinglePhotoFail2, {
          quality: 50,
          destinationType: destinationType.DATA_URL,
          targetWidth: 500,
          targetHeight: 500,
          correctOrientation: true
        });
    }
    function onSinglePhotoSucceess2(imageData) {
        var id_cedula = localStorage.getItem("IdCedula");
        var smallImage = document.getElementById('smallImage2');
        smallImage.style.display = 'flex';
        var nameima = "data:image/jpeg;base64," + imageData;
        smallImage.src = "data:image/jpeg;base64," + imageData;
        $("#imagenC2").val(nameima);
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE fumigacion SET foto_equipo = ? WHERE id_cedula = ?",
                    [nameima,id_cedula],
                    function(tx, results){
                        swal("","Foto equipo fue guardada correctamente","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
        $("#photoIcon2").attr("src","img/reload.svg");
    }
    function onSinglePhotoFail2(message) {
        swal("Error al tomar foto:",message,"error");
    }
    // Imagen sola 3
    function capturePhotoS3() {
        navigator.camera.getPicture(onSinglePhotoSucceess3, onSinglePhotoFail3, {
          quality: 50,
          destinationType: destinationType.DATA_URL,
          targetWidth: 500,
          targetHeight: 500,
          correctOrientation: true
        });
    }
    function onSinglePhotoSucceess3(imageData) {
        var id_cedula = localStorage.getItem("IdCedula");
        var smallImage = document.getElementById('smallImage3');
        smallImage.style.display = 'flex';
        var nameima = "data:image/jpeg;base64," + imageData;
        smallImage.src = "data:image/jpeg;base64," + imageData;
        $("#imagenC3").val(nameima);
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE fumigacion SET foto_reporte = ? WHERE id_cedula = ?",
                    [nameima,id_cedula],
                    function(tx, results){
                        swal("","Foto del reporte fue guardada correctamente","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
        $("#photoIcon3").attr("src","img/reload.svg");
    }
    function onSinglePhotoFail3(message) {
        swal("Error al tomar foto:",message,"error");
    }
    function guardarAntesFumigacion(){
        app.preloader.show('blue');
        if($("#nombreArea").val() == "" || $('#imagenC').val() == "" || $("#imagenC1").val() == "" || $("#imagenC2").val() == "" || $("descripcion").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var area = $("#nombreArea").val();
        var foto_area = $('#imagenC').val();
        var fase = "antes";
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO fotos_fumigacion(id_cedula,fase,foto_area,nombre_area,fecha_foto) VALUES (?,?,?,?,?)",
                    [id_cedula,fase,foto_area,area,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_fumigacion_foto) as Id from fotos_fumigacion",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from fotos_fumigacion where id_fumigacion_foto = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $("#nombreArea").val("");
                                                        $('#imagenC').val("");
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        $("#nombreArea").css("background-color", "#FFFFFF");
                                                        $("#tabla_fumigacion tbody").append("<tr id='fila"+ item.id_fumigacion_foto +"'><td><a href='#' onclick='eliminarFila("+ item.id_fumigacion_foto +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto_area+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.nombre_area + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Registro guardado","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarAntesSanitizacion(){
        app.preloader.show('blue');
        if($("#nombreArea").val() == "" || $('#imagenC').val() == "" || $('#imagenC1').val() == "" || $('#descripcion').val() == "" || ($("#DespejadoSi").prop("checked") == false && $("#DespejadoNo").prop("checked") == false)){
            swal("","Todos los campos son obligatorios","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var area = $("#nombreArea").val();
        var foto_area = $('#imagenC').val();
        var fase = "antes";
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO fotos_sanitizacion(id_cedula,fase,foto_area,nombre_area,fecha_foto) VALUES (?,?,?,?,?)",
                    [id_cedula,fase,foto_area,area,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_sanitizacion_foto) as Id from fotos_sanitizacion",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from fotos_sanitizacion where id_sanitizacion_foto = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $("#nombreArea").val("");
                                                        $('#imagenC').val("");
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        $("#nombreArea").css("background-color", "#FFFFFF");
                                                        $("#tabla_sanitizacion tbody").append("<tr id='fila"+ item.id_sanitizacion_foto +"'><td><a href='#' onclick='eliminarFila("+ item.id_sanitizacion_foto +",3);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto_area+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.nombre_area + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar area guardada",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Area guardada","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar area",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDuranteFumigacion(){
        app.preloader.show('blue');
        if($("#nombreArea").val() == "" || $('#imagenC').val() == "" || $('#descripcion').val() == "") {
            swal("","Todos los campos son obligatorios","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var area = $("#nombreArea").val();
        var foto_area = $('#imagenC').val();
        var fase = "durante";
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO fotos_fumigacion(id_cedula,fase,foto_area,nombre_area,fecha_foto) VALUES (?,?,?,?,?)",
                    [id_cedula,fase,foto_area,area,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_fumigacion_foto) as Id from fotos_fumigacion",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from fotos_fumigacion where id_fumigacion_foto = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $("#nombreArea").val("");
                                                        $('#imagenC').val("");
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        $("#nombreArea").css("background-color", "#FFFFFF");
                                                        $("#tabla-durante-fumigacion tbody").append("<tr id='fila"+ item.id_fumigacion_foto +"'><td><a href='#' onclick='eliminarFila("+ item.id_fumigacion_foto +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto_area+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.nombre_area + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Registro guardado","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDuranteSanitizacion(){
        app.preloader.show('blue');
        if($("#nombreArea").val() == "" || $('#imagenC').val() == "" || $('#descripcion').val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var area = $("#nombreArea").val();
        var foto_area = $('#imagenC').val();
        var fase = "durante";
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO fotos_sanitizacion(id_cedula,fase,foto_area,nombre_area,fecha_foto) VALUES (?,?,?,?,?)",
                    [id_cedula,fase,foto_area,area,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_sanitizacion_foto) as Id from fotos_sanitizacion",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from fotos_sanitizacion where id_sanitizacion_foto = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $("#nombreArea").val("");
                                                        $('#imagenC').val("");
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        $("#nombreArea").css("background-color", "#FFFFFF");
                                                        $("#tabla-durante-sanitizacion tbody").append("<tr id='fila"+ item.id_sanitizacion_foto +"'><td><a href='#' onclick='eliminarFila("+ item.id_sanitizacion_foto +",3);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto_area+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.nombre_area + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Registro guardado","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDespuesSanitizacion(){
        app.preloader.show('blue');
        if($("#nombreArea").val() == "" || $('#imagenC').val() == "" || $('#imagenC3').val() == "" || $('#descripcion').val() =="" || $('#productoUtilizado').val() ==""){
            swal("","Todos los campos son obligatorios","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var area = $("#nombreArea").val();
        var foto_area = $('#imagenC').val();
        var fase = "despues";
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO fotos_sanitizacion(id_cedula,fase,foto_area,nombre_area,fecha_foto) VALUES (?,?,?,?,?)",
                    [id_cedula,fase,foto_area,area,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_sanitizacion_foto) as Id from fotos_sanitizacion",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from fotos_sanitizacion where id_sanitizacion_foto = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $("#nombreArea").val("");
                                                        $('#imagenC').val("");
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        $("#nombreArea").css("background-color", "#FFFFFF");
                                                        $("#tabla-despues-sanitizacion tbody").append("<tr id='fila"+ item.id_sanitizacion_foto +"'><td><a href='#' onclick='eliminarFila("+ item.id_sanitizacion_foto +",3);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto_area+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.nombre_area + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Registro guardado","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDespuesFumigacion(){
        app.preloader.show('blue');
        if($("#nombreArea").val() == "" || $('#imagenC').val() == "" || $('#descripcion').val() == "" || $('#productoUtilizado').val() == "" || $('#imagenC3').val() == "" || $('#tipoAplicacion').val() == "0" || $('#gradoInfestacion').val() == "0" || ($("#MantenimientoSi").prop("checked") == false && $("#MantenimientoNo").prop("checked") == false)){
            swal("","Todos los campos son obligatorios","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var area = $("#nombreArea").val();
        var foto_area = $('#imagenC').val();
        var fase = "despues";
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO fotos_fumigacion(id_cedula,fase,foto_area,nombre_area,fecha_foto) VALUES (?,?,?,?,?)",
                    [id_cedula,fase,foto_area,area,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_fumigacion_foto) as Id from fotos_fumigacion",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from fotos_fumigacion where id_fumigacion_foto = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $("#nombreArea").val("");
                                                        $('#imagenC').val("");
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        $("#nombreArea").css("background-color", "#FFFFFF");
                                                        $("#tabla-despues-fumigacion tbody").append("<tr id='fila"+ item.id_fumigacion_foto +"'><td><a href='#' onclick='eliminarFila("+ item.id_fumigacion_foto +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto_area+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.nombre_area + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Registro guardado","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarProductoFumigacion(){
        var id_cedula = localStorage.getItem("IdCedula");
        var productoUtilizado = $('#productoUtilizado').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE fumigacion SET producto_utilizado = ? WHERE id_cedula = ?",
                    [productoUtilizado,id_cedula],
                    function(tx, results){
                        swal("","El producto utilizado fue guardado correctamente","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function saveTipoAplicacion(valor){
        var id_cedula = localStorage.getItem("IdCedula");
        if(valor == 1){
            var message = "Aspersi√≥n";
            $("#tipo_aplicacion").val(message);
        } else if(valor == 2){
            var message = "Microinyecci√≥n";
            $("#tipo_aplicacion").val(message);
        } else if(valor == 3){
            var message = "Nebulizaci√≥n";
            $("#tipo_aplicacion").val(message);
        } else if(valor == 4){
            var message = "Espolvoreo";
            $("#tipo_aplicacion").val(message);
        } else if(valor == 5){
            var message = "Gel";
            $("#tipo_aplicacion").val(message);
        } else {
            var message = "";
            $("#tipo_aplicacion").val("");
        }
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE fumigacion SET tipo_aplicacion = ?,descripcion_tipo = ? WHERE id_cedula = ?",
                    [valor,message,id_cedula],
                    function(tx, results){
                        if(valor == 0){
                            swal("","Debes seleccionar un tipo de aplicaci√≥n valido","warning");
                        } else {
                            swal("", "Se guardo el tipo de aplicaci√≥n","success");
                        }
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function saveGradoInfestacion(valor){
        var id_cedula = localStorage.getItem("IdCedula");
        if(valor == 1){
            var message = "Sin Actividad";
            $("#grado_infestacion").val(message);
        } else if(valor == 2){
            var message = "Baja";
            $("#grado_infestacion").val(message);
        } else if(valor == 3){
            var message = "Media";
            $("#grado_infestacion").val(message);
        } else if(valor == 4){
            var message = "Alta";
            $("#grado_infestacion").val(message);
        } else {
            var message = "";
            $("#grado_infestacion").val("");
        }
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE fumigacion SET grado_infestacion = ?,descripcion_infestacion = ? WHERE id_cedula = ?",
                    [valor,message,id_cedula],
                    function(tx, results){
                        if(valor == 0){
                            swal("","Debes seleccionar un grado de infestaci√≥n valido","warning");
                        } else {
                            swal("", "Se guardo el el grado de infestaci√≥n","success");
                        }
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function mantenimientoSi(valor){
        if($("#MantenimientoNo").prop("checked") === true){
            $("#MantenimientoNo").prop("checked", false);
        }
        if(!$(valor).prop('checked')){
            $('#detalle_container').css("display","none");
        }else{
            $('#detalle_container').css("display","block");
        }
    }
    function guardarDetalleMantenimiento(){
        var id_cedula = localStorage.getItem("IdCedula");
        var mantenimiento = 1;
        var detalle = $('#detalle').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE fumigacion SET mantenimiento = ?,detalle_mantenimiento = ? WHERE id_cedula = ?",
                    [mantenimiento,detalle,id_cedula],
                    function(tx, results){
                        swal("", "Se guardo el mantenimiento","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function mantenimientoNo(valor){
        var id_cedula = localStorage.getItem("IdCedula");
        if($("#MantenimientoSi").prop("checked") === true){
            $("#MantenimientoSi").prop("checked", false);
            $('#detalle_container').css("display","none");
        }
        if(!$(valor).prop('checked')){

        }else{
            var mantenimiento = 0;
            var detalle = "";
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE fumigacion SET mantenimiento = ?,detalle_mantenimiento = ? WHERE id_cedula = ?",
                        [mantenimiento,detalle,id_cedula],
                        function(tx, results){
                            swal("", "Se guardo el mantenimiento","success");
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function despejadoSi(valor){
        var id_cedula = localStorage.getItem("IdCedula");
        if($("#DespejadoNo").prop("checked") === true){
            $("#DespejadoNo").prop("checked", false);
        }
        if(!$(valor).prop('checked')){

        }else{
            var despejado = 1;
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE sanitizacion SET areas_despejadas = ? WHERE id_cedula = ?",
                        [despejado,id_cedula],
                        function(tx, results){
                            swal("", "Se guardo el estado area y limpieza","success");
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function despejadoNo(valor){
        var id_cedula = localStorage.getItem("IdCedula");
        if($("#DespejadoSi").prop("checked") === true){
            $("#DespejadoSi").prop("checked", false);
        }
        if(!$(valor).prop('checked')){

        }else{
            var despejado = 0;
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE sanitizacion SET areas_despejadas = ? WHERE id_cedula = ?",
                        [despejado,id_cedula],
                        function(tx, results){
                            swal("", "Se guardo el estado area y limpieza","success");
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function guardarRecomendacionesFumigacion(){
        var id_cedula = localStorage.getItem("IdCedula");
        var recomendaciones = $('#recomendaciones').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE fumigacion SET recomendaciones = ? WHERE id_cedula = ?",
                    [recomendaciones,id_cedula],
                    function(tx, results){
                        swal("", "Se guardo la recomendacion","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarRecomendacionesSanitizacion(){
        var id_cedula = localStorage.getItem("IdCedula");
        var recomendaciones = $('#recomendaciones').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE sanitizacion SET recomendaciones = ? WHERE id_cedula = ?",
                    [recomendaciones,id_cedula],
                    function(tx, results){
                        swal("", "Se guardo la recomendacion","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function llevarTodo(id_cedula,tipo_cedula){
        //Aqio va el ajax (tipo de cedula,id_usuario y id_empresa)
        var datos = new Array();
        var id_usuario = localStorage.getItem("id_usuario");
        var id_empresa = localStorage.getItem("id_empresa");
        datos[0] = {'id_usuario':id_usuario,'id_empresa':id_empresa,'tipo_cedula':tipo_cedula};
        $.ajax({
            type: "POST",
            async : true,
            url: "http://www.appbennetts.com/FWM2/app/guardarEnvioCedula.php",
            dataType: 'html',
            data: {'datos': JSON.stringify(datos)},
            success: function(respuesta){
            },
            error: function(){
                console.log("Error en la comunicacion con el servidor");
            }
        });
        swal("Enviando!", "Puedes serguir usando la aplicaci√≥n!", "success");
        var empresa = localStorage.getItem("nombre_empresa");
        if(empresa == "SMC"){
            var datosCedulaGeneral = new Array();
            var cedulageneral = 0;

            var datosLevantamiento = new Array();
            var evidenciaLevantamiento = new Array();
            var levantamiento = 0;
            var evidencialeva = 0;

            var datosMantenimiento = new Array();
            var evidenciaMantenimiento = new Array();
            var mantenimiento = 0;
            var evidenciamant = 0;

            var datosVenta = new Array();
            var evidenciaVenta = new Array();
            var datosEquipoVenta = new Array();

            var datosServicio = new Array();
            var evidenciaServicio = new Array();
            var datosEquipoServicio = new Array();

            var tipo = "";
            var fecha = new Date();
            var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var length = results.rows.length;
                            for(var i = 0; i< length; i++){
                                var item = results.rows.item(i);
                                tipo = item.tipo_cedula;
                                datosCedulaGeneral[cedulageneral] = {'Valor':cedulageneral,'id_cedula':item.id_cedula,'tipo_cedula':item.tipo_cedula,'id_usuario':item.id_usuario,'nombre_usuario':item.nombre_usuario,'fecha_entrada':item.fecha_entrada,'geolocalizacion_entrada': item.geolocalizacion_entrada,'id_cliente': item.id_cliente,'nombre_cliente': item.nombre_cliente,'horario_programado': item.horario_programado,'calificacion': item.calificacion,'fecha_salida':item.fecha_salida,'geolocalizacion_salida':item.geolocalizacion_salida,'nombre_evalua':item.nombre_evalua,'comentario_cliente':item.comentario_cliente,'fecha_envio':fecha_envio};
                                cedulageneral++;
                            }
                            if(tipo == "levantamiento"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM levantamiento_smc WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosLevantamiento[levantamiento] = {'Valor':levantamiento,'id_visita':item2.id_visita,'id_levantamiento':item2.id_levantamiento,'id_cedula':item2.id_cedula,'foto_entrada':item2.foto_entrada,'nombre_cliente':item2.nombre_cliente,'nombre_contacto':item2.nombre_contacto,'telefono_contacto':item2.telefono_contacto,'correo_contacto':item2.correo_contacto,'orden_servicio':item2.orden_servicio,'marca':item2.marca,'modelo':item2.modelo,'numero_serie':item2.numero_serie,'tipo_motor':item2.tipo_motor,'tipo_boquilla':item2.tipo_boquilla,'tipo_combustible':item2.tipo_combustible,'tipo_mastil':item2.tipo_mastil,'comentario_equipo':item2.comentario_equipo,'lugar_reparacion':item2.lugar_reparacion,'reparo_visita':item2.reparo_visita,'firma_cliente':item2.firma_cliente,'fecha_cliente':item2.fecha_cliente,'foto_salida':item2.foto_salida,'fecha_envio':fecha_envio};
                                                    levantamiento++;
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from evidencia_levantamiento_smc WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    evidenciaLevantamiento[evidencialeva] = {'Valor':evidencialeva,'id_evidencia': item3.id_evidencia,'id_cedula': item3.id_cedula,'observacion': item3.observacion,'foto_observacion': item3.foto_observacion,'fecha_regristro': item3.fecha_regristro};
                                                                    evidencialeva++;
                                                                }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarLevantamientoSMC.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'datosLevantamiento': JSON.stringify(datosLevantamiento),'evidenciaLevantamiento': JSON.stringify(evidenciaLevantamiento)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion con el servidor");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar evidencia_levantamiento_smc: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar levantamiento_smc: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                            if(tipo == "mantenimiento"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM mantenimiento_smc WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosMantenimiento[mantenimiento] = {'Valor':mantenimiento,'id_visita':item2.id_visita,'id_levantamiento':item2.id_levantamiento,'id_cedula':item2.id_cedula,'foto_entrada':item2.foto_entrada,'nombre_cliente':item2.nombre_cliente,'nombre_contacto':item2.nombre_contacto,'telefono_contacto':item2.telefono_contacto,'correo_contacto':item2.correo_contacto,'tipo_servicio':item2.tipo_servicio,'orden_servicio':item2.orden_servicio,'marca':item2.marca,'modelo':item2.modelo,'numero_serie':item2.numero_serie,'foto_equipo':item2.foto_equipo,'firma_cliente':item2.firma_cliente,'fecha_cliente':item2.fecha_cliente,'foto_salida':item2.foto_salida,'fecha_envio':fecha_envio};
                                                    mantenimiento++;
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from evidencia_mantenimiento_smc WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    evidenciaMantenimiento[evidenciamant] = {'Valor':evidenciamant,'id_evidencia': item3.id_evidencia,'id_cedula': item3.id_cedula,'fase': item3.fase,'descripcion': item3.descripcion,'foto_decripcion': item3.foto_decripcion,'fecha_regristro': item3.fecha_regristro};
                                                                    evidenciamant++;
                                                                }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarMantenimientoSMC.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'datosMantenimiento': JSON.stringify(datosMantenimiento),'evidenciaMantenimiento': JSON.stringify(evidenciaMantenimiento)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                            if(tipo == "ventaSMC"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM ventaSMC WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosVenta[i] = {'id_cedula':item2.id_cedula,'orden_servicio':item2.orden_servicio,'foto_entrada':item2.foto_entrada,'id_visita':item2.id_visita,'nombre_cliente':item2.nombre_cliente,'rfc_cliente':item2.rfc_cliente,'nombre_contacto':item2.nombre_contacto,'telefono_contacto':item2.telefono_contacto,'correo_contacto':item2.correo_contacto,'tipo_visita':item2.tipo_visita,'comentario_antes':item2.comentario_antes,'comentario_despues':item2.comentario_despues,'objetivo_prospeccion': item2.objetivo_prospeccion, 'necesidad_prospeccion': item2.necesidad_prospeccion, 'marca_montacargas_prospeccion': item2.marca_montacargas_prospeccion,'numero_montacargas_prospeccion': item2.numero_montacargas_prospeccion,'status_montacarga_prospeccion': item2.status_montacarga_prospeccion,'venc_contrato':item2.venc_contrato, 'marca_llantas_prospeccion': item2.marca_llantas_prospeccion,'tipo_llantas_prospeccion': item2.tipo_llantas_prospeccion,'mediadas_prospeccion': item2.mediadas_prospeccion,'resolvio_prospeccion': item2.resolvio_prospeccion,'por_que_prospeccion':item2.por_que_prospeccion,'vista_prospeccion': item2.vista_prospeccion, 'cuando_prospeccion': item2.cuando_prospeccion,'presente_prospeccion': item2.presente_prospeccion, 'cuales_prospeccion': item2.cuales_prospeccion,'copetencia_prospeccion': item2.copetencia_prospeccion,'sugerencia_prospeccion': item2.sugerencia_prospeccion,'comentarios_prospeccion': item2.comentarios_prospeccion,'no_activo':item2.no_activo,'no_contrato':item2.no_contrato,'conclusion_servicio':item2.conclusion_servicio,'firma_cliente':item2.firma_cliente,'fecha_cliente':item2.fecha_cliente,'foto_salida':item2.foto_salida,'fecha_envio':fecha_envio};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from evidencia_venta_smc WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    evidenciaVenta[i] = {'id_cedula': item3.id_cedula,'fase': item3.fase,'comentario': item3.comentario,'foto': item3.foto,'comentario': item3.comentario,'fecha_regristro': item3.fecha_regristro};
                                                                }
                                                                databaseHandler.db.transaction(
                                                                    function(tx){
                                                                        tx.executeSql("SELECT * from datos_equipo_smc WHERE id_cedula = ?",
                                                                            [id_cedula],
                                                                            function(tx, results){
                                                                                var length = results.rows.length;
                                                                                for(var i = 0; i< length; i++){
                                                                                    var item4 = results.rows.item(i);
                                                                                    datosEquipoVenta[i] = {'id_cedula': item4.id_cedula,'marca': item4.marca,'tipo_motor': item4.tipo_motor,'marca_motor': item4.marca_motor,'modelo': item4.modelo,'serie': item4.serie,'aditamentos': item4.aditamentos};
                                                                                }
                                                                                $.ajax({
                                                                                    type: "POST",
                                                                                    async : true,
                                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarVentaSMC.php",
                                                                                    dataType: 'html',
                                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'datosVenta': JSON.stringify(datosVenta),'evidenciaVenta': JSON.stringify(evidenciaVenta),'datosEquipoVenta': JSON.stringify(datosEquipoVenta)},
                                                                                    success: function(respuesta){
                                                                                        var respu1 = respuesta.split("._.");
                                                                                        var dat1 = respu1[0];
                                                                                        var dat2 = respu1[1];
                                                                                        if(dat1 == "CEDULA"){
                                                                                            if(dat2 > 0){
                                                                                                databaseHandler.db.transaction(
                                                                                                    function(tx7){
                                                                                                        tx7.executeSql(
                                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                            [id_cedula],
                                                                                                            function(tx7, results){
                                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                            }
                                                                                                        );
                                                                                                    }
                                                                                                );
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    error: function(){
                                                                                        console.log("Error en la comunicacion");
                                                                                    }
                                                                                });
                                                                            },
                                                                            function(tx, error){
                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                            }
                                                                        );
                                                                    },
                                                                    function(error){},
                                                                    function(){}
                                                                );
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                            if(tipo == "servicioSMC"){
                                console.log(tipo)
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM servicioSMC WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosServicio[i] = {'id_cedula':item2.id_cedula,'orden_servicio':item2.orden_servicio,'foto_entrada':item2.foto_entrada,'id_visita':item2.id_visita,'nombre_cliente':item2.nombre_cliente,'rfc_cliente':item2.rfc_cliente,'nombre_contacto':item2.nombre_contacto,'telefono_contacto':item2.telefono_contacto,'correo_contacto':item2.correo_contacto,'tipo_visita':item2.tipo_visita,'comentario_antes':item2.comentario_antes,'comentario_despues':item2.comentario_despues,'observaciones_prospeccion':item2.observaciones_prospeccion,'estado_monta':item2.estado_monta,'numero_monta':item2.numero_monta,'tipo_monta':item2.tipo_monta,'marca':item2.marca,'mantenimiento':item2.mantenimiento,'no_activo':item2.no_activo,'no_contrato':item2.no_contrato,'conclusion_servicio':item2.conclusion_servicio,'firma_cliente':item2.firma_cliente,'fecha_cliente':item2.fecha_cliente,'foto_salida':item2.foto_salida,'fecha_envio':fecha_envio};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from evidencia_servicio_smc WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    evidenciaServicio[i] = {'id_cedula': item3.id_cedula,'fase': item3.fase,'comentario': item3.comentario,'foto': item3.foto,'fecha_regristro': item3.fecha_regristro};
                                                                }
                                                                databaseHandler.db.transaction(
                                                                    function(tx){
                                                                        tx.executeSql("SELECT * from datos_servicio_smc WHERE id_cedula = ?",
                                                                            [id_cedula],
                                                                            function(tx, results){
                                                                                var length = results.rows.length;
                                                                                for(var i = 0; i< length; i++){
                                                                                    var item4 = results.rows.item(i);
                                                                                    datosEquipoServicio[i] = {'id_cedula': item4.id_cedula,'marca': item4.marca,'tipo_motor': item4.tipo_motor,'marca_motor': item4.marca_motor,'modelo': item4.modelo,'serie': item4.serie,'aditamentos': item4.aditamentos};
                                                                                }
                                                                                $.ajax({
                                                                                    type: "POST",
                                                                                    async : true,
                                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarServicioSMC.php",
                                                                                    dataType: 'html',
                                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'datosServicio': JSON.stringify(datosServicio),'evidenciaServicio': JSON.stringify(evidenciaServicio),'datosEquipoServicio': JSON.stringify(datosEquipoServicio)},
                                                                                    success: function(respuesta){
                                                                                        var respu1 = respuesta.split("._.");
                                                                                        var dat1 = respu1[0];
                                                                                        var dat2 = respu1[1];
                                                                                        if(dat1 == "CEDULA"){
                                                                                            if(dat2 > 0){
                                                                                                databaseHandler.db.transaction(
                                                                                                    function(tx7){
                                                                                                        tx7.executeSql(
                                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                            [id_cedula],
                                                                                                            function(tx7, results){
                                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                            }
                                                                                                        );
                                                                                                    }
                                                                                                );
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    error: function(){
                                                                                        console.log("Error en la comunicacion");
                                                                                    }
                                                                                });
                                                                            },
                                                                            function(tx, error){
                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                            }
                                                                        );
                                                                    },
                                                                    function(error){},
                                                                    function(){}
                                                                );
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                        },
                        function(tx, error){
                            console.log("Error al consultar datos generales: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else if(empresa == "Dilimpio"){
            var datosCedulaGeneral = new Array();
            var cedulageneral = 0;
            var datosDL = new Array();
            var equiposDL = new Array();
            var equiposCDL = new Array();
            var imagenDL = new Array();
            var entrenaDL = new Array();
            var almacenDL = new Array();
            var pedidosDL = new Array();
            var pedidosDL2 = new Array();
            var datosentregasDL = new Array();
            var entregasDL = new Array();

            var fecha = new Date();
            var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();

            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var length = results.rows.length;
                            for(var i = 0; i< length; i++){
                                var item = results.rows.item(i);
                                tipo = item.tipo_cedula;
                                usuario=item.id_usuario;
                                datosCedulaGeneral[i] = {'Valor':i,'id_cedula':item.id_cedula,
                                'tipo_cedula':item.tipo_cedula,
                                'id_usuario':item.id_usuario,
                                'nombre_usuario':item.nombre_usuario,
                                'fecha_entrada':item.fecha_entrada,
                                'geolocalizacion_entrada': item.geolocalizacion_entrada,
                                'id_cliente': item.id_cliente,
                                'nombre_cliente': item.nombre_cliente,
                                'horario_programado': item.horario_programado,
                                'calificacion': item.calificacion,
                                'fecha_salida':item.fecha_salida,
                                'geolocalizacion_salida':item.geolocalizacion_salida,
                                'nombre_evalua':item.nombre_evalua,
                                'comentario_cliente':item.comentario_cliente,
                                'fecha_envio':fecha_envio};
                            }
                            if(tipo == "Entregas"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM DatosentregasDL WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosentregasDL[i] = {'Valor':i,
                                                    'id_entrega':item2.id_datos,
                                                    'id_cedula':item2.id_cedula,
                                                    'id_cliente':item2.id_cliente,
                                                    'nombre_cliente':item2.nombre_cliente,
                                                    'nombre_contacto':item2.nombre_contacto,
                                                    'correo':item2.correo,
                                                    'telefono':item2.telefono,
                                                    'estatus_cliente':item2.estatus_cliente,
                                                    'firma_cliente':item2.firma_cliente,
                                                    'foto_salida':item2.foto_salida,
                                                    'foto_inicio':item2.foto_inicio,
                                                    'observaciones_generales':item2.observaciones_generales };
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from entregasDL WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    entregasDL[i] = {'Valor':i,
                                                                    'id_entrega': item3.id_entrega ,
                                                                    'foto_entrega': item3.foto_entrega ,
                                                                    'id_cedula': item3.id_cedula,
                                                                    'comentarios': item3.comentarios,
                                                                    'fecha': item3.fecha};
                                                                }
                                                                databaseHandler.db.transaction(
                                                                    function(tx){
                                                                        tx.executeSql("SELECT * from pedidosDL WHERE id_cedula = ?",
                                                                            [id_cedula],
                                                                            function(tx, results){
                                                                                var length = results.rows.length;
                                                                                for(var i = 0; i< length; i++){
                                                                                    var item7 = results.rows.item(i);
                                                                                    pedidosDL2[i] = {'Valor':i,
                                                                                    'id_producto': item7.id_producto ,
                                                                                    'id_cedula': item7.id_cedula,
                                                                                    'producto' : item7.producto,
                                                                                    'codigo' : item7.codigo,
                                                                                    'descripcion' : item7.descripcion,
                                                                                    'inventario_dia': item7.inventario_dia,
                                                                                    'cantidad_solicitada': item7.cantidad_solicitada,
                                                                                    'comentarios': item7.comentarios};
                                                                                }
                                                                                /*console.log(datosCedulaGeneral);
                                                                                console.log(datosentregasDL);
                                                                                console.log(entregasDL);
                                                                                console.log(pedidosDL2);*/
                                                                                $.ajax({
                                                                                    type: "POST",
                                                                                    async : true,
                                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarEntregasDL.php",
                                                                                    dataType: 'html',
                                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),
                                                                                    'datosentregasDL': JSON.stringify(datosentregasDL),
                                                                                    'pedidosDL2': JSON.stringify(pedidosDL2),
                                                                                    'entregasDL': JSON.stringify(entregasDL)
                                                                                    },
                                                                                    success: function(respuesta){
                                                                                        var respu1 = respuesta.split("._.");
                                                                                        var dat1 = respu1[0];
                                                                                        var dat2 = respu1[1];
                                                                                        if(dat1 == "CEDULA"){
                                                                                            if(dat2 > 0){
                                                                                                databaseHandler.db.transaction(
                                                                                                    function(tx7){
                                                                                                        tx7.executeSql(
                                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                            [id_cedula],
                                                                                                            function(tx7, results){
                                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                            }
                                                                                                        );
                                                                                                    }
                                                                                                );
                                                                                            }
                                                                                        } else {
                                                                                            AlmacenarError(respuesta);
                                                                                        }
                                                                                    },
                                                                                    error: function(){
                                                                                        console.log(respuesta);
                                                                                        console.log("Error en la comunicacion");
                                                                                    }
                                                                                });
                                                                            },//
                                                                            function(tx, error){
                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                            }
                                                                        );
                                                                    },
                                                                    function(error){},
                                                                    function(){}
                                                                );//
                                                            },//
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );//
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            } else if(tipo == "visitaDilimpio"){
                                var enviadoB=0;
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM visitaDilimpio WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){//
                                                    var item2 = results.rows.item(i);
                                                    datosDL[i] = {'Valor':i,'id_datos':item2.id_datos,
                                                    'id_cedula':item2.id_cedula,
                                                    'foto_inicio':item2.foto_inicio,
                                                    'id_cliente':item2.id_cliente,
                                                    'nombre_cliente':item2.nombre_cliente,
                                                    'nombre_contacto':item2.nombre_contacto,
                                                    'correo':item2.correo,
                                                    'telefono':item2.telefono,
                                                    'estatus_cliente':item2.estatus_cliente,
                                                    'firma_cliente':item2.firma_cliente,
                                                    'foto_salida':item2.foto_salida,
                                                    'observaciones_generales':item2.observaciones_generales,
                                                    'estado_cuenta':item2.estado_cuenta,
                                                    'permite_almacen':item2.permite_almacen,
                                                    'persona_cuenta':item2.persona_cuenta,
                                                    'correo_cuenta':item2.correo_cuenta
                                                 };
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from equiposDL WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    equiposDL[i] = {'Valor':i,
                                                                    'id_equipos': item3.id_equipos ,
                                                                    'id_cedula': item3.id_cedula,
                                                                    'estado' : item3.estado,
                                                                    'descripcion' : item3.descripcion,
                                                                    'equipo' : item3.equipo,
                                                                    'cantidad': item3.cantidad,
                                                                    'motivo': item3.motivo,
                                                                    'comentarios': item3.comentarios,
                                                                    'ubicacion': item3.ubicacion,
                                                                    'foto': item3.foto,
                                                                    'fecha': item3.fecha};
                                                                }
                                                                databaseHandler.db.transaction(
                                                                    function(tx){
                                                                        tx.executeSql("SELECT * from imagenDL WHERE id_cedula = ?",
                                                                            [id_cedula],
                                                                            function(tx, results){
                                                                                var length = results.rows.length;
                                                                                for(var i = 0; i< length; i++){
                                                                                    var item4 = results.rows.item(i);
                                                                                    imagenDL[i] = {'Valor':i,
                                                                                    'id_imagen': item4.id_imagen ,
                                                                                    'id_cedula': item4.id_cedula,
                                                                                    'tipo' : item4.tipo,
                                                                                    'estado' : item4.estado,
                                                                                    'cantidad' : item4.cantidad,
                                                                                    'ubicacion': item4.ubicacion,
                                                                                    'comentarios': item4.comentarios,
                                                                                    'foto': item4.foto,
                                                                                    'fecha': item4.fecha};
                                                                                }
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx){
                                                                                        tx.executeSql("SELECT * from entrenaDL WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx, results){
                                                                                                var length = results.rows.length;
                                                                                                for(var i = 0; i< length; i++){
                                                                                                    var item5 = results.rows.item(i);
                                                                                                    entrenaDL[i] = {'Valor':i,
                                                                                                    'id_entrena': item5.id_entrena ,
                                                                                                    'id_cedula': item5.id_cedula,
                                                                                                    'tipo' : item5.tipo,
                                                                                                    'persona_capacita' : item5.persona_capacita,
                                                                                                    'puesto_capacita' : item5.puesto_capacita,
                                                                                                    'tema_capacita': item5.tema_capacita,
                                                                                                    'comentarios': item5.comentarios,
                                                                                                    'foto': item5.foto,
                                                                                                    'fecha': item5.fecha};
                                                                                                }
                                                                                                databaseHandler.db.transaction(
                                                                                                    function(tx){
                                                                                                        tx.executeSql("SELECT * from almacenDL WHERE id_cedula = ?",
                                                                                                            [id_cedula],
                                                                                                            function(tx, results){
                                                                                                                var length = results.rows.length;
                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                    var item6 = results.rows.item(i);
                                                                                                                    almacenDL[i] = {'Valor':i,
                                                                                                                    'id_almacen': item6.id_almacen ,
                                                                                                                    'id_cedula': item6.id_cedula,
                                                                                                                    'observaciones' : item6.observaciones,
                                                                                                                    'foto' : item6.foto,
                                                                                                                    'fecha' : item6.fecha};
                                                                                                                }
                                                                                                                databaseHandler.db.transaction(
                                                                                                                    function(tx){
                                                                                                                        tx.executeSql("SELECT * from pedidosDL WHERE id_cedula = ?",
                                                                                                                            [id_cedula],
                                                                                                                            function(tx, results){
                                                                                                                                var length = results.rows.length;
                                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                                    var item7 = results.rows.item(i);
                                                                                                                                    pedidosDL[i] = {'Valor':i,
                                                                                                                                    'id_producto': item7.id_producto ,
                                                                                                                                    'id_cedula': item7.id_cedula,
                                                                                                                                    'producto' : item7.producto,
                                                                                                                                    'codigo' : item7.codigo,
                                                                                                                                    'descripcion' : item7.descripcion,
                                                                                                                                    'inventario_dia': item7.inventario_dia,
                                                                                                                                    'cantidad_solicitada': item7.cantidad_solicitada,
                                                                                                                                    'comentarios': item7.comentarios};
                                                                                                                                }
                                                                                                                                databaseHandler.db.transaction(
                                                                                                                                    function(tx){
                                                                                                                                        tx.executeSql("SELECT * from equiposCargadosDL WHERE enviado = ?",
                                                                                                                                            [enviadoB],
                                                                                                                                            function(tx, results){
                                                                                                                                                var length = results.rows.length;
                                                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                                                    var item10 = results.rows.item(i);
                                                                                                                                                    equiposCDL[i] = {'Valor':i,
                                                                                                                                                    'id_equipo': item10.id_equipo ,
                                                                                                                                                    'id_cliente': item10.id_cliente,
                                                                                                                                                    'codigo' : item10.codigo,
                                                                                                                                                    'descripcion' : item10.descripcion,
                                                                                                                                                    'id_usuario' : item10.id_usuario,
                                                                                                                                                    'estatus': item10.enviado,
                                                                                                                                                    };
                                                                                                                                                }
                                                                                                                                                    /*console.log(datosCedulaGeneral);
                                                                                                                                                    console.log(datosDL);
                                                                                                                                                    console.log(equiposDL);
                                                                                                                                                    console.log(equiposCDL);
                                                                                                                                                    console.log(imagenDL);
                                                                                                                                                    console.log(entrenaDL);
                                                                                                                                                    console.log(almacenDL);
                                                                                                                                                    console.log(pedidosDL);*/
                                                                                                                                                    $.ajax({
                                                                                                                                                        type: "POST",
                                                                                                                                                        async : true,
                                                                                                                                                        url: "http://www.appbennetts.com/FWM2/app/guardarVisitaDL.php",
                                                                                                                                                        dataType: 'html',
                                                                                                                                                        data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),
                                                                                                                                                        'datosDL': JSON.stringify(datosDL),
                                                                                                                                                        'equiposDL': JSON.stringify(equiposDL),
                                                                                                                                                        'equiposCDL': JSON.stringify(equiposCDL),
                                                                                                                                                        'imagenDL': JSON.stringify(imagenDL),
                                                                                                                                                        'entrenaDL': JSON.stringify(entrenaDL),
                                                                                                                                                        'almacenDL': JSON.stringify(almacenDL),
                                                                                                                                                        'pedidosDL': JSON.stringify(pedidosDL)
                                                                                                                                                        },
                                                                                                                                                        success: function(respuesta){
                                                                                                                                                            var respu1 = respuesta.split("._.");
                                                                                                                                                            var dat1 = respu1[0];
                                                                                                                                                            var dat2 = respu1[1];
                                                                                                                                                            var enviadoA=0;
                                                                                                                                                            if(dat1 == "CEDULA"){
                                                                                                                                                                if(dat2 > 0){
                                                                                                                                                                    databaseHandler.db.transaction(
                                                                                                                                                                        function(tx7){
                                                                                                                                                                            tx7.executeSql(
                                                                                                                                                                                "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                                                                                                [id_cedula],
                                                                                                                                                                                function(tx7, results){
                                                                                                                                                                                    localStorage.setItem("sendFlag", 0);
                                                                                                                                                                                    swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                                                                                                    databaseHandler.db.transaction(
                                                                                                                                                                                        function(tx8){
                                                                                                                                                                                            tx8.executeSql(
                                                                                                                                                                                                "UPDATE equiposCargadosDL SET enviado = 1 WHERE enviado = ?",
                                                                                                                                                                                                 [enviadoA],
                                                                                                                                                                                                function(tx8, results){
                                                                                                                                                                                                }
                                                                                                                                                                                            );
                                                                                                                                                                                        }
                                                                                                                                                                                    );
                                                                                                                                                                                }
                                                                                                                                                                            );
                                                                                                                                                                        }
                                                                                                                                                                    );
                                                                                                                                                                }
                                                                                                                                                            } else {
                                                                                                                                                                AlmacenarError(respuesta);
                                                                                                                                                            }
                                                                                                                                                        },
                                                                                                                                                        error: function(){
                                                                                                                                                            console.log(respuesta);
                                                                                                                                                            console.log("Error en la comunicacion");
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                                },
                                                                                                                                                function(tx, error){
                                                                                                                                                    console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                                                                }
                                                                                                                                            );
                                                                                                                                        },
                                                                                                                                        function(error){},
                                                                                                                                        function(){}
                                                                                                                                    );

                                                                                                                            },
                                                                                                                            function(tx, error){
                                                                                                                                console.log("Error al consultar pedidos: " +error.message);
                                                                                                                            }
                                                                                                                        );
                                                                                                                    },
                                                                                                                    function(error){
                                                                                                                        console.log("Error: " +error.message);
                                                                                                                    },
                                                                                                                    function(){}
                                                                                                                );
                                                                                                            
                                                                                                            },
                                                                                                            function(tx, error){
                                                                                                                console.log("Error al consultar almacen: " +error.message);
                                                                                                            }
                                                                                                        );
                                                                                                    },
                                                                                                    function(error){},
                                                                                                    function(){}
                                                                                                );
                                                                                            
                                                                                            },
                                                                                            function(tx, error){
                                                                                                console.log("Error al consultar entrenamiento: " +error.message);
                                                                                            }
                                                                                        );
                                                                                    },
                                                                                    function(error){},
                                                                                    function(){}
                                                                                );
                                                                            
                                                                            },
                                                                            function(tx, error){
                                                                                console.log("Error al consultar imagen: " +error.message);
                                                                            }
                                                                        );
                                                                    },
                                                                    function(error){
                                                                        console.log("Error: " + error.message);
                                                                    },
                                                                    function(){}
                                                                );
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar equipos: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){
                                                        console.log("Error: " + error.message);
                                                    },
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar datos: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){
                                        console.log("Error: " + error.message);
                                    },
                                    function(){}
                                );
                            }
                        },
                        function(tx, error){
                            console.log("Error al consultar datos generales: " + error.message);
                        }
                    );
                },
                function(error){
                    console.log("Error: " + error.message);
                },
                function(){}
            );
        } else if(empresa == "VIC"){
            var estatus_proyecto=0;
            var datosCedulaGeneral = new Array();
            var apoyoBennetts = new Array();
            var fotosApoyo = new Array();
            var ventasBennetts = new Array();
            var minuta = new Array();
            var proyectosVic = new Array();
            //VIC new
            var datosVIC = new Array();
            var equiposVIC = new Array();
            var equiposCVIC = new Array();
            var imagenVIC = new Array();
            var entrenaVIC = new Array();
            var almacenVIC = new Array();
            var pedidosVIC = new Array();

            var apoyo = new Array();
            var datosClientes = new Array();

            var rol = localStorage.getItem("rol");
            var roles = rol.split("-");
            var empresa1=roles[1];
            
            var usuario;
    
            var div = localStorage.getItem("division");

            var respuesta = new Array();
            var fotos = new Array();
            //VIC new
            var fecha = new Date();
            var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var length = results.rows.length;
                            for(var i = 0; i< length; i++){
                                var item = results.rows.item(i);
                                tipo = item.tipo_cedula;
                                usuario=item.id_usuario;
                                datosCedulaGeneral[i] = {'Valor':i,'id_cedula':item.id_cedula,
                                'tipo_cedula':item.tipo_cedula,
                                'id_usuario':item.id_usuario,
                                'nombre_usuario':item.nombre_usuario,
                                'fecha_entrada':item.fecha_entrada,
                                'geolocalizacion_entrada': item.geolocalizacion_entrada,
                                'id_cliente': item.id_cliente,
                                'nombre_cliente': item.nombre_cliente,
                                'horario_programado': item.horario_programado,
                                'calificacion': item.calificacion,
                                'fecha_salida':item.fecha_salida,
                                'geolocalizacion_salida':item.geolocalizacion_salida,
                                'nombre_evalua':item.nombre_evalua,
                                'comentario_cliente':item.comentario_cliente,
                                'fecha_envio':fecha_envio};
                            }
                            if(tipo == "ApoyoVIC"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM apoyo_bennetts WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    apoyoBennetts[i] = {'Valor':i,'id_apoyo':item2.id_apoyo,'id_cedula':item2.id_cedula,'foto_entrada':item2.foto_entrada,'nombre_cliente':item2.nombre_cliente,'nombre_comercial':item2.nombre_comercial,'nombre_contacto':item2.nombre_contacto,'telefono':item2.telefono,'correo':item2.correo,'estatus_cliente':item2.estatus_cliente,'firma_cliente':item2.firma_cliente,'fecha_cliente':item2.fecha_cliente ,'foto_salida':item2.foto_salida };
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from fotos_apoyo WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    fotosApoyo[i] = {'Valor':i,
                                                                    'id_foto_apoyo': item3.id_foto_apoyo ,
                                                                    'id_cedula': item3.id_cedula,
                                                                    'foto': item3.foto,
                                                                    'tipo_apoyo': item3.tipo_apoyo,
                                                                    'comentario': item3.comentario,
                                                                    'fechaYHora': item3.fechaYHora};
                                                                }
                                                                //console.log(datosCedulaGeneral);
                                                                //console.log(apoyoBennetts);
                                                                //console.log(fotosApoyo);
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarDatosVIC.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),
                                                                    'apoyoBennetts': JSON.stringify(apoyoBennetts),
                                                                    'fotosApoyo': JSON.stringify(fotosApoyo)
                                                                    },
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log(respuesta);
                                                                        console.log("Error en la comunicacion");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }else if (tipo == "VentasVIC" || tipo == "VentasVIC_SinV" || tipo == "VentasVIC_ConV" || tipo == "VentasVIC_Acompa") {
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM ventas_bennetts WHERE id_cedula = ?",
                                            [id_cedula],
                                            function (tx, results) {
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
                                                for (var i = 0; i < length; i++) {
                                                    var item2 = results.rows.item(i);
                                                    ventasBennetts[i] = {
                                                        'Valor': i, 'id_ventas': item2.id_ventas,
                                                        'id_cedula': item2.id_cedula,
                                                        'foto_inicio': item2.foto_inicio,
                                                        'nombre_cliente': item2.nombre_cliente,
                                                        'puesto_cliente': item2.puesto_cliente,
                                                        'telefono': item2.telefono,
                                                        'correo': item2.correo,
                                                        'firma_cliente': item2.firma_cliente,
                                                        'foto_salida': item2.foto_salida,
                                                        'id_proyecto': item2.id_proyecto,
                                                        'tipo_visita': item2.tipo_visita,
                                                        'foto_visita': item2.foto_visita,
                                                        'nivel': item2.nivel,
                                                        'pendiente_vendedor': item2.pendiente_vendedor,
                                                        'actividadSelect': item2.actividadSelect
                                                    };
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from minuta WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function (tx, results) {
                                                                var length = results.rows.length;
                                                                for (var i = 0; i < length; i++) {
                                                                    var item3 = results.rows.item(i);
                                                                    minuta[i] = {
                                                                        'Valor': i,
                                                                        'id_minuta': item3.id_minuta,
                                                                        'id_cedula': item3.id_cedula,
                                                                        'tema': item3.tema,
                                                                        'compromiso': item3.compromiso,
                                                                        'fecha': item3.fecha,
                                                                        'foto': item3.foto,
                                                                        'fecha_foto': item3.fecha_foto,
                                                                        'h_inicio': item3.h_inicio, 
                                                                        'h_fin':item3.h_fin
                                                                    };
                                                                }
                                                                databaseHandler.db.transaction(
                                                                    function(tx){
                                                                        tx.executeSql("SELECT * from apoyo_venta_vic  WHERE id_cedula = ?",
                                                                        [id_cedula],
                                                                        function (tx, results) {
                                                                            var length = results.rows.length;
                                                                            for (var i = 0; i < length; i++) {
                                                                                var item5 = results.rows.item(i);
                                                                                apoyo[i] = {
                                                                                    'Valor': i,
                                                                                    'proyecto': item5.proyecto,
                                                                                    'companero': item5.companero,
                                                                                    'comentario': item5.comentario,
                                                                                    'fecha': item5.fecha
                                                                                };
                                                                            }
                                                                            databaseHandler.db.transaction(
                                                                                function(tx){
                                                                                    tx.executeSql("SELECT * from datos_contacto  WHERE id_cedula = ?",
                                                                                    [id_cedula],
                                                                                    function (tx, results) {
                                                                                        var length = results.rows.length;
                                                                                        for (var i = 0; i < length; i++) {
                                                                                            var item6 = results.rows.item(i);
                                                                                            datosClientes[i] = {
                                                                                                'Valor': i,
                                                                                                'id_proyecto': item6.id_proyecto,
                                                                                                'nombre_cliente': item6.nombre_cliente,
                                                                                                'puesto_cliente': item6.puesto_cliente,
                                                                                                'telefono': item6.telefono,
                                                                                                'correo': item6.correo
                                                                                            };
                                                                                        }
                                                                                        databaseHandler.db.transaction(
                                                                                            function(tx){
                                                                                                tx.executeSql("SELECT * from proyectos_vic ",
                                                                                                [],
                                                                                                function (tx, results) {
                                                                                                    var length = results.rows.length;
                                                                                                    for (var i = 0; i < length; i++) {
                                                                                                        var item4 = results.rows.item(i);
                                                                                                        proyectosVic[i] = {
                                                                                                            'Valor': i,
                                                                                                            'id_proyecto': item4.id_proyecto,
                                                                                                            'id_usuario': item4.id_usuario,
                                                                                                            'nombre_proyecto': item4.nombre_proyecto,
                                                                                                            'potencial': item4.potencial,
                                                                                                            'segmento': item4.segmento,
                                                                                                            'fecha_creacion': item4.fecha_creacion,
                                                                                                            'division': item4.division,
                                                                                                            'estrategia': item4.estrategia,
                                                                                                            'estatus': item4.estatus,
                                                                                                            'metodo': item4.metodo,
                                                                                                            'grupo': item4.grupo,
                                                                                                            'enviado': item4.enviado
                                                                                                        };
                                                                                                    }
                                                                                                    console.log('apoyo', apoyo);
                                                                                                    console.log('datosC', datosClientes);
                                                                                                    console.log('datog', datosCedulaGeneral);
                                                                                                    console.log('ventas', ventasBennetts);
                                                                                                    console.log('minuta', minuta);
                                                                                                    console.log('proyectosVic', proyectosVic);
                                                                                                    $.ajax({
                                                                                                        type: "POST",
                                                                                                        async: true,
                                                                                                        url: "http://www.appbennetts.com/FWM2/app/guardarDatosVentasVIC.php",
                                                                                                        dataType: 'html',
                                                                                                        data: {
                                                                                                            'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),
                                                                                                            'ventasBennetts': JSON.stringify(ventasBennetts),
                                                                                                            'minuta': JSON.stringify(minuta),
                                                                                                            'proyectosVic': JSON.stringify(proyectosVic),
                                                                                                            'apoyo': JSON.stringify(apoyo),
                                                                                                            'datosClientes': JSON.stringify(datosClientes)
                                                                                                        },
                                                                                                        success: function (respuesta) {
                                                                                                            var respu1 = respuesta.split("._.");
                                                                                                            console.log(respuesta);
                                                                                                            var dat1 = respu1[0];
                                                                                                            var dat2 = respu1[1];
                                                                                                            if (dat1 == "CEDULA") {
                                                                                                                if (dat2 > 0) {
                                                                                                                    databaseHandler.db.transaction(
                                                                                                                        function (tx7) {
                                                                                                                            tx7.executeSql(
                                                                                                                                "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                                                [id_cedula],
                                                                                                                                function (tx7, results) {
                                                                                                                                    localStorage.setItem("sendFlag", 0);
                                                                                                                                    swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                                                    $.ajax({
                                                                                                                                        type: "POST",
                                                                                                                                        async : true,
                                                                                                                                        url: "http://www.appbennetts.com/FWM2/app/ARCHIVOSJSONS/VIC-Gestion.php",
                                                                                                                                        dataType: 'html',
                                                                                                                                        data: {'datos': JSON.stringify(datos)},
                                                                                                                                        success: function(respuesta){
                                                                                                                                            console.log("Entreee123")
                                                                                                                                            window.resolveLocalFileSystemURL(cordova.file.dataDirectory, function(oEntry) {
                                                                                                                                                var jsonHijos = new download();
                                                                                                                                                jsonHijos.Initialize({
                                                                                                                                                  fileSystem : cordova.file.dataDirectory,
                                                                                                                                                  folder: "jsons",
                                                                                                                                                  remove: false,
                                                                                                                                                  timeout: 0,
                                                                                                                                                  success: DownloaderSuccess,
                                                                                                                                                  error: DownloaderError,
                                                                                                                                                  headers: [
                                                                                                                                                    {
                                                                                                                                                      key : "Cache-Control",
                                                                                                                                                      Value: "no-store"
                                                                                                                                                    }
                                                                                                                                                  ]
                                                                                                                                                });
                                                                                                                                                jsonHijos.Get("http://appbennetts.com/FWM2/app/ARCHIVOSJSONS/Gestion-SE-VIC.json");
                                                                                                                                                function DownloaderSuccess() {}
                                                                                                                                                function DownloaderError(err) {
                                                                                                                                                  console.log(err);
                                                                                                                                                }
                                                                                                                                            });
                                                                                                                                        },
                                                                                                                                        error: function(){
                                                                                                                                            console.log("Error en la comunicacion con el servidor");
                                                                                                                                        }
                                                                                                                                    });
                                                                                                                                    databaseHandler.db.transaction(
                                                                                                                                        function (tx8) {
                                                                                                                                            tx8.executeSql(
                                                                                                                                                "UPDATE proyectos_vic SET enviado = 1 WHERE id_usuario = ?",
                                                                                                                                                [id_usuarioP],
                                                                                                                                                function (tx8, results) {
                                                                                                                                                    
                                                                                                                                                }
                                                                                                                                            );
                                                                                                                                        }
                                                                                                                                    );
                                                                                                                                }
                                                                                                                            );
                                                                                                                        }
                                                                                                                    );
                                                                                                                }
                                                                                                            } else {
                                                                                                                AlmacenarError(respuesta);
                                                                                                            }

                                                                                                        },
                                                                                                        error: function () {
                                                                                                            console.log(respuesta);
                                                                                                            console.log("Error en la comunicacion");
                                                                                                        }
                                                                                                    });
                                                                                                    },
                                                                                                    function(tx, error){
                                                                                                        console.log("Error al guardar cedula: " + error.message);
                                                                                                        app.preloader.hide();
                                                                                                    }
                                                                                                );
                                                                                            },
                                                                                            function(error){},
                                                                                            function(){}
                                                                                        );
                                                                                          
                                                                                        },
                                                                                        function(tx, error){
                                                                                            console.log("Error al guardar VENTAS: " + error.message);
                                                                                            app.preloader.hide();
                                                                                        }
                                                                                    );
                                                                                },
                                                                                function(error){},
                                                                                function(){}
                                                                            );
                                                                              
                                                                            },
                                                                            function(tx, error){
                                                                                console.log("Error al guardar VENTAS: " + error.message);
                                                                                app.preloader.hide();
                                                                            }
                                                                        );
                                                                    },
                                                                    function(error){},
                                                                    function(){}
                                                                );
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al guardar VENTAS: " + error.message);
                                                                app.preloader.hide();
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al guardar VENTAS: " + error.message);
                                                app.preloader.hide();
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            } else if(tipo == "VIC"){
                                console.log(tipo)
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM datosVIC WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){//
                                                    var item2 = results.rows.item(i);
                                                    datosVIC[i] = {'Valor':i,'id_datos':item2.id_datos,
                                                    'id_cedula':item2.id_cedula,
                                                    'foto_inicio':item2.foto_inicio,
                                                    'id_cliente':item2.id_cliente,
                                                    'nombre_cliente':item2.nombre_cliente,
                                                    'nombre_comercial':item2.nombre_comercial,
                                                    'nombre_contacto':item2.nombre_contacto,
                                                    'telefono':item2.telefono,
                                                    'correo':item2.correo,
                                                    'estatus_cliente':item2.estatus_cliente,
                                                    'firma_cliente':item2.firma_cliente,
                                                    'foto_salida':item2.foto_salida,
                                                    'observaciones_generales':item2.observaciones_generales,
                                                    'estado_cuenta':item2.estado_cuenta,
                                                    'tipo_visita':item2.tipo_visita,
                                                    'permite_almacen':item2.permite_almacen,
                                                    'persona_cuenta':item2.persona_cuenta,
                                                    'correo_cuenta':item2.correo_cuenta,
                                                    'pregunta_equipo':item2.pregunta_equipo, 
                                                    'pregunta_img':item2.pregunta_img, 
                                                    'pregunta_entrena':item2.pregunta_entrena, 
                                                    'pregunta_pedido':item2.pregunta_pedido
                                                 };
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from equiposVIC WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    equiposVIC[i] = {'Valor':i,
                                                                    'id_equipos': item3.id_equipos ,
                                                                    'id_cedula': item3.id_cedula,
                                                                    'estado' : item3.estado,
                                                                    'descripcion' : item3.descripcion,
                                                                    'equipo' : item3.equipo,
                                                                    'cantidad': item3.cantidad,
                                                                    'motivo': item3.motivo,
                                                                    'comentarios': item3.comentarios,
                                                                    'ubicacion': item3.ubicacion,
                                                                    'foto': item3.foto,
                                                                    'fecha': item3.fecha};
                                                                }
                                                                databaseHandler.db.transaction(
                                                                    function(tx){
                                                                        tx.executeSql("SELECT * from imagenVIC WHERE id_cedula = ?",
                                                                            [id_cedula],
                                                                            function(tx, results){
                                                                                var length = results.rows.length;
                                                                                for(var i = 0; i< length; i++){
                                                                                    var item4 = results.rows.item(i);
                                                                                    imagenVIC[i] = {'Valor':i,
                                                                                    'id_imagen': item4.id_imagen ,
                                                                                    'id_cedula': item4.id_cedula,
                                                                                    'tipo' : item4.tipo,
                                                                                    'estado' : item4.estado,
                                                                                    'cantidad' : item4.cantidad,
                                                                                    'ubicacion': item4.ubicacion,
                                                                                    'comentarios': item4.comentarios,
                                                                                    'foto': item4.foto,
                                                                                    'fecha': item4.fecha};
                                                                                }
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx){
                                                                                        tx.executeSql("SELECT * from entrenaVIC WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx, results){
                                                                                                var length = results.rows.length;
                                                                                                for(var i = 0; i< length; i++){
                                                                                                    var item5 = results.rows.item(i);
                                                                                                    entrenaVIC[i] = {'Valor':i,
                                                                                                    'id_entrena': item5.id_entrena ,
                                                                                                    'id_cedula': item5.id_cedula,
                                                                                                    'tipo' : item5.tipo,
                                                                                                    'persona_capacita' : item5.persona_capacita,
                                                                                                    'puesto_capacita' : item5.puesto_capacita,
                                                                                                    'tema_capacita': item5.tema_capacita,
                                                                                                    'comentarios': item5.comentarios,
                                                                                                    'foto': item5.foto,
                                                                                                    'fecha': item5.fecha};
                                                                                                }
                                                                                                databaseHandler.db.transaction(
                                                                                                    function(tx){
                                                                                                        tx.executeSql("SELECT * from almacenVIC WHERE id_cedula = ?",
                                                                                                            [id_cedula],
                                                                                                            function(tx, results){
                                                                                                                var length = results.rows.length;
                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                    var item6 = results.rows.item(i);
                                                                                                                    almacenVIC[i] = {'Valor':i,
                                                                                                                    'id_almacen': item6.id_almacen ,
                                                                                                                    'id_cedula': item6.id_cedula,
                                                                                                                    'observaciones' : item6.observaciones,
                                                                                                                    'foto' : item6.foto,
                                                                                                                    'fecha' : item6.fecha};
                                                                                                                }
                                                                                                                databaseHandler.db.transaction(
                                                                                                                    function(tx){
                                                                                                                        tx.executeSql("SELECT * from pedidosVIC WHERE id_cedula = ?",
                                                                                                                            [id_cedula],
                                                                                                                            function(tx, results){
                                                                                                                                var length = results.rows.length;
                                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                                    var item7 = results.rows.item(i);
                                                                                                                                    pedidosVIC[i] = {'Valor':i,
                                                                                                                                    'id_producto': item7.id_producto ,
                                                                                                                                    'id_cedula': item7.id_cedula,
                                                                                                                                    'producto' : item7.producto,
                                                                                                                                    'codigo' : item7.codigo,
                                                                                                                                    'descripcion' : item7.descripcion,
                                                                                                                                    'inventario_dia': item7.inventario_dia,
                                                                                                                                    'cantidad_solicitada': item7.cantidad_solicitada,
                                                                                                                                    'comentarios': item7.comentarios};
                                                                                                                                }
                                                                                                                                databaseHandler.db.transaction(
                                                                                                                                    function(tx){
                                                                                                                                        tx.executeSql("SELECT * FROM VIC_Respuesta WHERE id_cedula = ?",
                                                                                                                                            [id_cedula],
                                                                                                                                            function(tx, results){
                                                                                                                                                var length = results.rows.length;
                                                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                                                    var item8 = results.rows.item(i);
                                                                                                                                                    respuesta[i] = {'Valor':i,'id_pregunta': item8.id_pregunta , 'respuesta': item8.respuesta,'recomendacion': item8.recomendacion,'fecha': item8.fecha,'id_usuario': usuario,'div':div};
                                                                                                                                                }
                                                                                                                                                databaseHandler.db.transaction(
                                                                                                                                                    function(tx){
                                                                                                                                                        tx.executeSql("SELECT * from VIC_Fotos WHERE id_cedula = ?",
                                                                                                                                                            [id_cedula],
                                                                                                                                                            function(tx, results){
                                                                                                                                                                var length = results.rows.length;
                                                                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                                                                    var item9 = results.rows.item(i);
                                                                                                                                                                    fotos[i] = {'Valor':i,'pregunta': item9.pregunta,'FechaHora' : item9.FechaHora,'Foto' : item9.Foto};
                                                                                                                                                                }
                                                                                                                                                                        databaseHandler.db.transaction(
                                                                                                                                                                            function(tx){
                                                                                                                                                                                tx.executeSql("SELECT * from equiposCargados WHERE enviado = ?",
                                                                                                                                                                                    [estatus_proyecto],
                                                                                                                                                                                    function(tx, results){
                                                                                                                                                                                        var length = results.rows.length;
                                                                                                                                                                                        for(var i = 0; i< length; i++){
                                                                                                                                                                                            var item10 = results.rows.item(i);
                                                                                                                                                                                            equiposCVIC[i] = {'Valor':i,
                                                                                                                                                                                            'id_equipo': item10.id_equipo ,
                                                                                                                                                                                            'id_cliente': item10.id_cliente,
                                                                                                                                                                                            'codigo' : item10.codigo,
                                                                                                                                                                                            'descripcion' : item10.descripcion,
                                                                                                                                                                                            'id_usuario' : item10.id_usuario,
                                                                                                                                                                                            'estatus': item10.enviado,
                                                                                                                                                                                            'rol': empresa1};
                                                                                                                                                                                        }
                                                                                                                                                                                            /*console.log(datosCedulaGeneral);
                                                                                                                                                                                            console.log(datosVIC);
                                                                                                                                                                                            console.log(equiposVIC);
                                                                                                                                                                                            console.log(equiposCVIC);
                                                                                                                                                                                            console.log(imagenVIC);
                                                                                                                                                                                            console.log(entrenaVIC);
                                                                                                                                                                                            console.log(almacenVIC);
                                                                                                                                                                                            console.log(pedidosVIC);
                                                                                                                                                                                            */
                                                                                                                                                                                            $.ajax({
                                                                                                                                                                                                type: "POST",
                                                                                                                                                                                                async : true,
                                                                                                                                                                                                url: "http://www.appbennetts.com/FWM2/app/guardarVICVIC.php",
                                                                                                                                                                                                dataType: 'html',
                                                                                                                                                                                                data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),
                                                                                                                                                                                                'datosVIC': JSON.stringify(datosVIC),
                                                                                                                                                                                                'equiposVIC': JSON.stringify(equiposVIC),
                                                                                                                                                                                                'equiposCVIC': JSON.stringify(equiposCVIC),
                                                                                                                                                                                                'imagenVIC': JSON.stringify(imagenVIC),
                                                                                                                                                                                                'entrenaVIC': JSON.stringify(entrenaVIC),
                                                                                                                                                                                                'almacenVIC': JSON.stringify(almacenVIC),
                                                                                                                                                                                                'pedidosVIC': JSON.stringify(pedidosVIC),
                                                                                                                                                                                                'respuesta': JSON.stringify(respuesta),
                                                                                                                                                                                                'evidenciaFotografica': JSON.stringify(fotos)
                                                                                                                                                                                                },
                                                                                                                                                                                                success: function(respuesta){
                                                                                                                                                                                                    var respu1 = respuesta.split("._.");
                                                                                                                                                                                                    var dat1 = respu1[0];
                                                                                                                                                                                                    var dat2 = respu1[1];
                                                                                                                                                                                                    var enviadoA=0;
                                                                                                                                                                                                    if(dat1 == "CEDULA"){
                                                                                                                                                                                                        if(dat2 > 0){
                                                                                                                                                                                                            databaseHandler.db.transaction(
                                                                                                                                                                                                                function(tx7){
                                                                                                                                                                                                                    tx7.executeSql(
                                                                                                                                                                                                                        "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                                                                                                                                        [id_cedula],
                                                                                                                                                                                                                        function(tx7, results){
                                                                                                                                                                                                                            localStorage.setItem("sendFlag", 0);
                                                                                                                                                                                                                            swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                                                                                                                                            databaseHandler.db.transaction(
                                                                                                                                                                                                                                function(tx8){
                                                                                                                                                                                                                                    tx8.executeSql(
                                                                                                                                                                                                                                        "UPDATE equiposCargados SET enviado = 1 WHERE enviado = ?",
                                                                                                                                                                                                                                         [enviadoA],
                                                                                                                                                                                                                                        function(tx8, results){
                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                    );
                                                                                                                                                                                                                                }
                                                                                                                                                                                                                            );
                                                                                                                                                                                                                        }
                                                                                                                                                                                                                    );
                                                                                                                                                                                                                }
                                                                                                                                                                                                            );
                                                                                                                                                                                                        }
                                                                                                                                                                                                    } else {
                                                                                                                                                                                                        AlmacenarError(respuesta);
                                                                                                                                                                                                    }
                                                                                                                                                                                                },
                                                                                                                                                                                                error: function(){
                                                                                                                                                                                                    console.log(respuesta);
                                                                                                                                                                                                    console.log("Error en la comunicacion");
                                                                                                                                                                                                    AlmacenarError("Error en en el envio de la app");
                                                                                                                                                                                                }
                                                                                                                                                                                            });


                                                                                                                                                                                        },
                                                                                                                                                                                        function(tx, error){
                                                                                                                                                                                            console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                                                                                                        }
                                                                                                                                                                                    );
                                                                                                                                                                                },
                                                                                                                                                                                function(error){},
                                                                                                                                                                                function(){}
                                                                                                                                                                            );
                                                                                                                                                                        },
                                                                                                                                                                        function(tx, error){
                                                                                                                                                                            console.log("Error al consultar sanitizacion: " + error.message);
                                                                                                                                                                        }
                                                                                                                                                                    );
                                                                                                                                                                },
                                                                                                                                                                function(error){},
                                                                                                                                                                function(){}
                                                                                                                                                            );
                                                                                                                                                        },
                                                                                                                                            function(tx, error){
                                                                                                                                                console.log("Error al consultar equiposCargados: " +error.message);
                                                                                                                                            }
                                                                                                                                        );
                                                                                                                                    },
                                                                                                                                    function(error){
                                                                                                                                        console.log("Error: " +error.message);
                                                                                                                                    },
                                                                                                                                    function(){}
                                                                                                                                );

                                                                                                                            },
                                                                                                                            function(tx, error){
                                                                                                                                console.log("Error al consultar pedidos: " +error.message);
                                                                                                                            }
                                                                                                                        );
                                                                                                                    },
                                                                                                                    function(error){
                                                                                                                        console.log("Error: " +error.message);
                                                                                                                    },
                                                                                                                    function(){}
                                                                                                                );
                                                                                                            
                                                                                                            },
                                                                                                            function(tx, error){
                                                                                                                console.log("Error al consultar almacen: " +error.message);
                                                                                                            }
                                                                                                        );
                                                                                                    },
                                                                                                    function(error){},
                                                                                                    function(){}
                                                                                                );
                                                                                            
                                                                                            },
                                                                                            function(tx, error){
                                                                                                console.log("Error al consultar entrenamiento: " +error.message);
                                                                                            }
                                                                                        );
                                                                                    },
                                                                                    function(error){},
                                                                                    function(){}
                                                                                );
                                                                            
                                                                            },
                                                                            function(tx, error){
                                                                                console.log("Error al consultar imagen: " +error.message);
                                                                            }
                                                                        );
                                                                    },
                                                                    function(error){
                                                                        console.log("Error: " + error.message);
                                                                    },
                                                                    function(){}
                                                                );
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar equipos: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){
                                                        console.log("Error: " + error.message);
                                                    },
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar datos: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){
                                        console.log("Error: " + error.message);
                                    },
                                    function(){}
                                );
                            }
                        },
                        function(tx, error){
                            console.log("Error al consultar datos generales: " + error.message);
                        }
                    );
                },
                function(error){
                    console.log("Error: " + error.message);
                },
                function(){}
            );
        } else if(empresa == "Field"){
            var datosCedulaGeneral = new Array();
            var cedulageneral = 0;

            var datosLevantamiento = new Array();
            var evidenciaLevantamiento = new Array();
            var levantamiento = 0;
            var evidencialeva = 0;

            var datosMantenimiento = new Array();
            var evidenciaMantenimiento = new Array();
            var mantenimiento = 0;
            var evidenciamant = 0;

            var tipo = "";
            var fecha = new Date();
            var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var length = results.rows.length;
                            for(var i = 0; i< length; i++){
                                var item = results.rows.item(i);
                                tipo = item.tipo_cedula;
                                datosCedulaGeneral[cedulageneral] = {'Valor':cedulageneral,'id_cedula':item.id_cedula,'tipo_cedula':item.tipo_cedula,'id_usuario':item.id_usuario,'nombre_usuario':item.nombre_usuario,'fecha_entrada':item.fecha_entrada,'geolocalizacion_entrada': item.geolocalizacion_entrada,'id_cliente': item.id_cliente,'nombre_cliente': item.nombre_cliente,'horario_programado': item.horario_programado,'calificacion': item.calificacion,'fecha_salida':item.fecha_salida,'geolocalizacion_salida':item.geolocalizacion_salida,'nombre_evalua':item.nombre_evalua,'comentario_cliente':item.comentario_cliente,'fecha_envio':fecha_envio};
                                cedulageneral++;
                            }
                            if(tipo == "levantamiento"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM levantamiento_Field WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosLevantamiento[levantamiento] = {'Valor':levantamiento,'id_levantamiento':item2.id_levantamiento,'id_cedula':item2.id_cedula,'foto_entrada':item2.foto_entrada,'nombre_cliente':item2.nombre_cliente,'nombre_contacto':item2.nombre_contacto,'telefono_contacto':item2.telefono_contacto,'correo_contacto':item2.correo_contacto,'orden_servicio':item2.orden_servicio,'marca':item2.marca,'modelo':item2.modelo,'numero_serie':item2.numero_serie,'tipo_motor':item2.tipo_motor,'tipo_boquilla':item2.tipo_boquilla,'tipo_combustible':item2.tipo_combustible,'tipo_mastil':item2.tipo_mastil,'comentario_equipo':item2.comentario_equipo,'lugar_reparacion':item2.lugar_reparacion,'reparo_visita':item2.reparo_visita,'firma_cliente':item2.firma_cliente,'fecha_cliente':item2.fecha_cliente,'foto_salida':item2.foto_salida,'fecha_envio':fecha_envio};
                                                    levantamiento++;
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from evidencia_levantamiento_Field WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    evidenciaLevantamiento[evidencialeva] = {'Valor':evidencialeva,'id_evidencia': item3.id_evidencia,'id_cedula': item3.id_cedula,'observacion': item3.observacion,'foto_observacion': item3.foto_observacion,'fecha_regristro': item3.fecha_regristro};
                                                                    evidencialeva++;
                                                                }
                                                                console.log(evidenciaLevantamiento);

                                                            
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarLevantamientoField.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'datosLevantamiento': JSON.stringify(datosLevantamiento),'evidenciaLevantamiento': JSON.stringify(evidenciaLevantamiento)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion con el servidor");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar evidencia_levantamiento_smc: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar levantamiento_smc: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                            if(tipo == "mantenimiento"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM mantenimiento_Field WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosMantenimiento[mantenimiento] = {'Valor':mantenimiento,'id_levantamiento':item2.id_levantamiento,'id_cedula':item2.id_cedula,'foto_entrada':item2.foto_entrada,'nombre_cliente':item2.nombre_cliente,'nombre_contacto':item2.nombre_contacto,'telefono_contacto':item2.telefono_contacto,'correo_contacto':item2.correo_contacto,'tipo_servicio':item2.tipo_servicio,'orden_servicio':item2.orden_servicio,'marca':item2.marca,'modelo':item2.modelo,'numero_serie':item2.numero_serie,'foto_equipo':item2.foto_equipo,'firma_cliente':item2.firma_cliente,'fecha_cliente':item2.fecha_cliente,'foto_salida':item2.foto_salida,'fecha_envio':fecha_envio};
                                                    mantenimiento++;
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from evidencia_mantenimiento_Field WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    evidenciaMantenimiento[evidenciamant] = {'Valor':evidenciamant,'id_evidencia': item3.id_evidencia,'id_cedula': item3.id_cedula,'fase': item3.fase,'descripcion': item3.descripcion,'foto_decripcion': item3.foto_decripcion,'fecha_regristro': item3.fecha_regristro};
                                                                    evidenciamant++;
                                                                }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarMantenimientoField.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'datosMantenimiento': JSON.stringify(datosMantenimiento),'evidenciaMantenimiento': JSON.stringify(evidenciaMantenimiento)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                        },
                        function(tx, error){
                            console.log("Error al consultar datos generales: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else if(empresa == "CarnesIdeal"){
            var datosCedulaGeneral = new Array();
            var cedulageneral = 0;

            var datosEntrega = new Array();
            var evidenciaEntrega = new Array();

            var datosMantenimiento = new Array();
            var evidenciaMantenimiento = new Array();
            var mantenimiento = 0;
            var evidenciamant = 0;

            var tipo = "";
            var fecha = new Date();
            var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var length = results.rows.length;
                            for(var i = 0; i< length; i++){
                                var item = results.rows.item(i);
                                tipo = item.tipo_cedula;
                                datosCedulaGeneral[cedulageneral] = {'Valor':cedulageneral,'id_cedula':item.id_cedula,'tipo_cedula':item.tipo_cedula,'id_usuario':item.id_usuario,'nombre_usuario':item.nombre_usuario,'fecha_entrada':item.fecha_entrada,'geolocalizacion_entrada': item.geolocalizacion_entrada,'id_cliente': item.id_cliente,'nombre_cliente': item.nombre_cliente,'horario_programado': item.horario_programado,'calificacion': item.calificacion,'fecha_salida':item.fecha_salida,'geolocalizacion_salida':item.geolocalizacion_salida,'nombre_evalua':item.nombre_evalua,'comentario_cliente':item.comentario_cliente,'fecha_envio':fecha_envio};
                                cedulageneral++;
                            }
                            if(tipo == "Entrega"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM datos_entrega WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosEntrega[i] = {'Valor':i,'foto_entrada':item2.foto_entrada,'id_cliente':item2.id_cliente,'nombre_cliente':item2.nombre_cliente,'nombre_contacto':item2.nombre_contacto,'puesto_contacto':item2.puesto_contacto,'telefono_contacto':item2.telefono_contacto,'correo_contacto':item2.correo_contacto,'temperatura':item2.temperatura,'unidad':item2.unidad,'nombre_usuario':item2.nombre_usuario,'firma_cliente':item2.firma_cliente,'foto_salida':item2.foto_salida,'fecha_envio':fecha_envio};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from fotos_entrega WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    evidenciaEntrega[i] = {'Valor':i,'foto': item3.foto,'comentarios': item3.comentarios,'fecha_evidencia': item3.fecha_evidencia};
                                                                }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "https://www.fwm.com.mx/app/guardarEntregaCI.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'datosEntrega': JSON.stringify(datosEntrega),'evidenciaEntrega': JSON.stringify(evidenciaEntrega)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion con el servidor");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar evidencia_levantamiento_smc: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar levantamiento_smc: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                            if(tipo == "mantenimiento"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM mantenimiento_Field WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosMantenimiento[mantenimiento] = {'Valor':mantenimiento,'id_levantamiento':item2.id_levantamiento,'id_cedula':item2.id_cedula,'foto_entrada':item2.foto_entrada,'nombre_cliente':item2.nombre_cliente,'nombre_contacto':item2.nombre_contacto,'telefono_contacto':item2.telefono_contacto,'correo_contacto':item2.correo_contacto,'tipo_servicio':item2.tipo_servicio,'orden_servicio':item2.orden_servicio,'marca':item2.marca,'modelo':item2.modelo,'numero_serie':item2.numero_serie,'foto_equipo':item2.foto_equipo,'firma_cliente':item2.firma_cliente,'fecha_cliente':item2.fecha_cliente,'foto_salida':item2.foto_salida,'fecha_envio':fecha_envio};
                                                    mantenimiento++;
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from evidencia_mantenimiento_Field WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    evidenciaMantenimiento[evidenciamant] = {'Valor':evidenciamant,'id_evidencia': item3.id_evidencia,'id_cedula': item3.id_cedula,'fase': item3.fase,'descripcion': item3.descripcion,'foto_decripcion': item3.foto_decripcion,'fecha_regristro': item3.fecha_regristro};
                                                                    evidenciamant++;
                                                                }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarMantenimientoField.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'datosMantenimiento': JSON.stringify(datosMantenimiento),'evidenciaMantenimiento': JSON.stringify(evidenciaMantenimiento)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                        },
                        function(tx, error){
                            console.log("Error al consultar datos generales: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else if(empresa == "MT"){
            var datosCedulaGeneral = new Array();
            var cedulageneral = 0;

            var datosLevantamiento = new Array();
            var fecha = new Date();
            var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var length = results.rows.length;
                            for(var i = 0; i< length; i++){
                                var item = results.rows.item(i);
                                tipo = item.tipo_cedula;
                                datosCedulaGeneral[cedulageneral] = {'Valor':cedulageneral,'id_cedula':item.id_cedula,'tipo_cedula':item.tipo_cedula,'id_usuario':item.id_usuario,'nombre_usuario':item.nombre_usuario,'fecha_entrada':item.fecha_entrada,'geolocalizacion_entrada': item.geolocalizacion_entrada,'id_cliente': item.id_cliente,'nombre_cliente': item.nombre_cliente,'horario_programado': item.horario_programado,'calificacion': item.calificacion,'fecha_salida':item.fecha_salida,'geolocalizacion_salida':item.geolocalizacion_salida,'nombre_evalua':item.nombre_evalua,'comentario_cliente':item.comentario_cliente,'fecha_envio':fecha_envio};
                                cedulageneral++;
                            }
                            if(tipo == "Visita"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM levantamiento_Field WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosLevantamiento[levantamiento] = {'Valor':levantamiento,'id_levantamiento':item2.id_levantamiento,'id_cedula':item2.id_cedula,'foto_entrada':item2.foto_entrada,'nombre_cliente':item2.nombre_cliente,'nombre_contacto':item2.nombre_contacto,'telefono_contacto':item2.telefono_contacto,'correo_contacto':item2.correo_contacto,'orden_servicio':item2.orden_servicio,'marca':item2.marca,'modelo':item2.modelo,'numero_serie':item2.numero_serie,'tipo_motor':item2.tipo_motor,'tipo_boquilla':item2.tipo_boquilla,'tipo_combustible':item2.tipo_combustible,'tipo_mastil':item2.tipo_mastil,'comentario_equipo':item2.comentario_equipo,'lugar_reparacion':item2.lugar_reparacion,'reparo_visita':item2.reparo_visita,'firma_cliente':item2.firma_cliente,'fecha_cliente':item2.fecha_cliente,'foto_salida':item2.foto_salida,'fecha_envio':fecha_envio};
                                                    levantamiento++;
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from evidencia_levantamiento_Field WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    evidenciaLevantamiento[evidencialeva] = {'Valor':evidencialeva,'id_evidencia': item3.id_evidencia,'id_cedula': item3.id_cedula,'observacion': item3.observacion,'foto_observacion': item3.foto_observacion,'fecha_regristro': item3.fecha_regristro};
                                                                    evidencialeva++;
                                                                }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarLevantamientoField.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'datosLevantamiento': JSON.stringify(datosLevantamiento),'evidenciaLevantamiento': JSON.stringify(evidenciaLevantamiento)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion con el servidor");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar evidencia_levantamiento_smc: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar levantamiento_smc: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                        },
                        function(tx, error){
                            console.log("Error al consultar datos generales: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else if(empresa == "Bennetts"){
            var datosCedulaGeneral = new Array();
            var productos = new Array();
            var datosProductos = new Array();
            var inventario = new Array();
            var conteo = new Array();

            var fecha = new Date();
            var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var length = results.rows.length;
                            for(var i = 0; i< length; i++){
                                var item = results.rows.item(i);
                                tipo = item.tipo_cedula;
                                datosCedulaGeneral[i] = {'Valor':i,'id_cedula':item.id_cedula,'tipo_cedula':item.tipo_cedula,'id_usuario':item.id_usuario,'nombre_usuario':item.nombre_usuario,'fecha_entrada':item.fecha_entrada,'geolocalizacion_entrada': item.geolocalizacion_entrada,'id_cliente': item.id_cliente,'nombre_cliente': item.nombre_cliente,'horario_programado': item.horario_programado,'calificacion': item.calificacion,'fecha_salida':item.fecha_salida,'geolocalizacion_salida':item.geolocalizacion_salida,'nombre_evalua':item.nombre_evalua,'comentario_cliente':item.comentario_cliente,'fecha_envio':fecha_envio};
                            }
                            if(tipo == "baja"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM productos WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    productos[i] = {'Valor':i,'codigo_producto':item2.codigo_producto,'descripcion_producto':item2.descripcion_producto,'cantidad_producto':item2.cantidad_producto,'aplica':item2.aplica,'motivo':item2.motivo,'evidencia_foto_antes':item2.evidencia_foto_antes,'evidencia_foto_despues':item2.evidencia_foto_despues,'fecha':item2.fecha};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from datos_productos WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    datosProductos[i] = {'Valor':i,'puesto': item3.puesto,'firma_cliente': item3.firma_cliente,'correo': item3.correo};
                                                                }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarBajaBennetts.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'productos': JSON.stringify(productos),'datosProductos': JSON.stringify(datosProductos)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            } else if(tipo == "conteo"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM inventario WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    inventario[i] = {'Valor':i,'id_inventario':item2.id_inventario,'id_cedula':item2.id_cedula,'id_conteo_general':item2.id_conteo_general,'numero_conteo':item2.numero_conteo,'empresa':item2.empresa,'pareja_almacen':item2.pareja_almacen,'almacen':item2.almacen,'fecha':item2.fecha};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from conteo WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    conteo[i] = {'Valor':i,'id_conteo_general': item3.id_conteo_general,'numero_conteo': item3.numero_conteo,'codigo_proveedor': item3.codigo_proveedor,'codigo_sap': item3.codigo_sap,'ubicacion': item3.ubicacion,'descripcion': item3.descripcion,'inventario': item3.inventario,'familia': item3.familia,'costo_unitario': item3.costo_unitario,'usuario': item3.usuario,'estatus_diferencia': item3.estatus_diferencia,'fisico': item3.fisico,'enviado': item3.enviado};
                                                                }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarConteoBennetts.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'inventario': JSON.stringify(inventario),'conteo': JSON.stringify(conteo)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                        },
                        function(tx, error){
                            console.log("Error al consultar datos generales: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else if(empresa == "DIPREC"){
            var datosCedulaGeneral = new Array();
            var cedulageneral = 0;

            var servicioTecnico = new Array();
            var datosEquipo = new Array();
            var evidenciaEquipo = new Array();
            var datosEquipoAntes = new Array();
            var evidenciaRefacciones = new Array();
            var checkList = new Array();
            var checkList2 = new Array();
            var datosEquipoDespues = new Array();
            var reporteTecnico = 0;

            var minutaCoordinador = new Array();
            var zonasCoordinador = new Array();
            var equiposCoordinador = new Array();
            var datosCoordinador = new Array();
            var observaciones = new Array();
            var notas = new Array();
            var minutCoordinador = 0;

            var tipo = "";
            var fecha = new Date();
            var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var length = results.rows.length;
                            for(var i = 0; i< length; i++){
                                var item = results.rows.item(i);
                                tipo = item.tipo_cedula;
                                datosCedulaGeneral[cedulageneral] = {'Valor':cedulageneral,'id_cedula':item.id_cedula,'tipo_cedula':item.tipo_cedula,'id_usuario':item.id_usuario,'nombre_usuario':item.nombre_usuario,'fecha_entrada':item.fecha_entrada,'geolocalizacion_entrada': item.geolocalizacion_entrada,'id_cliente': item.id_cliente,'nombre_cliente': item.nombre_cliente,'horario_programado': item.horario_programado,'calificacion': item.calificacion,'fecha_salida':item.fecha_salida,'geolocalizacion_salida':item.geolocalizacion_salida,'nombre_evalua':item.nombre_evalua,'comentario_cliente':item.comentario_cliente,'fecha_envio':fecha_envio};
                                cedulageneral++;
                            }
                            if(tipo == "reporteTecnico"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM servicio_tecnico WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    servicioTecnico[i] = {'Valor':reporteTecnico,'foto_entrada':item2.foto_entrada,'nombre_cliente':item2.nombre_cliente,'atencion':item2.atencion,'documento_ingresar':item2.documento_ingresar,'direccion':item2.direccion,'telefono':item2.telefono,'email':item2.email,'tipo_servicio':item2.tipo_servicio,'firma_cliente':item2.firma_cliente,'fecha_cliente':item2.fecha_cliente,'foto_salida':item2.foto_salida,'puesto':item2.puesto,'fecha_envio':fecha_envio};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from datos_equipo WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    datosEquipo[i] = {'Valor':reporteTecnico,'equipo': item3.equipo,'marca': item3.marca,'modelo': item3.modelo,'no_serie': item3.no_serie,'fecha_registro': item3.fecha_registro};
                                                                }
                                                                databaseHandler.db.transaction(
                                                                    function(tx){
                                                                        tx.executeSql("SELECT * from evidencia_equipo WHERE id_cedula = ?",
                                                                            [id_cedula],
                                                                            function(tx, results){
                                                                                var length = results.rows.length;
                                                                                for(var i = 0; i< length; i++){
                                                                                    var item4 = results.rows.item(i);
                                                                                    evidenciaEquipo[i] = {'Valor':i,'fase': item4.fase,'foto': item4.foto,'equipo': item4.equipo,'fecha_regristro': item4.fecha_regristro};
                                                                                }
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx){
                                                                                        tx.executeSql("SELECT * from datos_equipo_antes WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx, results){
                                                                                                var length = results.rows.length;
                                                                                                for(var i = 0; i< length; i++){
                                                                                                    var item5 = results.rows.item(i);
                                                                                                    datosEquipoAntes[i] = {'Valor':reporteTecnico,'equipo': item5.equipo,'voltaje': item5.voltaje,'estado_voltaje': item5.estado_voltaje,'evidencia_voltaje': item5.evidencia_voltaje,'corriente': item5.corriente,'estado_corriente': item5.estado_corriente,'evidencia_corriente': item5.evidencia_corriente,'fases': item5.fases,'estado_fase': item5.estado_fase,'evidencia_fase': item5.evidencia_fase,'tipo_gas': item5.tipo_gas,'estado_gas': item5.estado_gas,'evidencia_gas': item5.evidencia_gas,'presion_gas': item5.presion_gas,'estado_presion_gas': item5.estado_presion_gas,'evidencia_presion_gas': item5.evidencia_presion_gas,'presion_vapor': item5.presion_vapor,'estado_presion_vapor': item5.estado_presion_vapor,'evidencia_presion_vapor': item5.evidencia_presion_vapor,'temperatura': item5.temperatura,'estado_temperatura': item5.estado_temperatura,'evidencia_estado_temperatura': item5.evidencia_estado_temperatura,'falla_reportada': item5.falla_reportada};
                                                                                                }         
                                                                                                databaseHandler.db.transaction(
                                                                                                    function(tx){
                                                                                                        tx.executeSql("SELECT * from evidencia_refacciones WHERE id_cedula = ?",
                                                                                                            [id_cedula],
                                                                                                            function(tx, results){
                                                                                                                var length = results.rows.length;
                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                    var item6 = results.rows.item(i);
                                                                                                                    evidenciaRefacciones[i] = {'Valor':reporteTecnico,'fase': item6.fase,'clave': item6.clave,'cantidad': item6.cantidad,'descripcion': item6.descripcion,'foto': item6.foto,'fecha_regristro': item6.fecha_regristro};
                                                                                                                }
                                                                                                                databaseHandler.db.transaction(
                                                                                                                    function(tx){
                                                                                                                        tx.executeSql("SELECT * from check_list WHERE id_cedula = ?",
                                                                                                                            [id_cedula],
                                                                                                                            function(tx, results){
                                                                                                                                var length = results.rows.length;
                                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                                    var item7 = results.rows.item(i);
                                                                                                                                    checkList[i] = {'Valor':reporteTecnico,'equipo': item7.equipo,'gabinete_exterior': item7.gabinete_exterior,'gabinete_interior': item7.gabinete_interior,'quemadores': item7.quemadores,'paneles': item7.paneles,'parillas': item7.parillas,'vulvas_espreas': item7.vulvas_espreas,'paneles_control': item7.paneles_control,'condensador': item7.condensador,'evaporador': item7.evaporador,'motores': item7.motores,'compresor': item7.compresor,'flautas': item7.flautas,'sistema_hidraulico': item7.sistema_hidraulico,'sistema_lavado': item7.sistema_lavado,'empaques': item7.empaques,'dereccion_fugas': item7.dereccion_fugas,'ajuste_electrico': item7.ajuste_electrico,'libricacion': item7.libricacion,'revision_operacion': item7.revision_operacion,'filtro_aire': item7.filtro_aire};
                                                                                                                                }
                                                                                                                                databaseHandler.db.transaction(
                                                                                                                                    function(tx){
                                                                                                                                        tx.executeSql("SELECT * from check_list2 WHERE id_cedula = ?",
                                                                                                                                            [id_cedula],
                                                                                                                                            function(tx, results){
                                                                                                                                                var length = results.rows.length;
                                                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                                                    var item8 = results.rows.item(i);
                                                                                                                                                    checkList2[i] = {'Valor':reporteTecnico,'equipo': item8.equipo,'vulvas': item8.vulvas,'termostato': item8.termostato,'control_presion': item8.control_presion,'sensor_flama': item8.sensor_flama,'quemadores': item8.quemadores,'turbinas': item8.turbinas,'resistencias': item8.resistencias,'sondas': item8.sondas,'tarjeta_electronica': item8.tarjeta_electronica,'compresor': item8.compresor,'motor_difusores': item8.motor_difusores,'aspas': item8.aspas,'contractores': item8.contractores,'fuga_tuberia': item8.fuga_tuberia,'aislante_tuberia': item8.aislante_tuberia,'condfensador': item8.condfensador,'iluminacion': item8.iluminacion,'empaques': item8.empaques,'fuga': item8.fuga};
                                                                                                                                                }
                                                                                                                                                databaseHandler.db.transaction(
                                                                                                                                                    function(tx){
                                                                                                                                                        tx.executeSql("SELECT * from datos_equipo_despues WHERE id_cedula = ?",
                                                                                                                                                            [id_cedula],
                                                                                                                                                            function(tx, results){
                                                                                                                                                                var length = results.rows.length;
                                                                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                                                                    var item9 = results.rows.item(i);
                                                                                                                                                                    datosEquipoDespues[i] = {'Valor':reporteTecnico,'equipo': item9.equipo,'voltaje': item9.voltaje,'estado_voltaje': item9.estado_voltaje,'evidencia_voltaje': item9.evidencia_voltaje,'corriente': item9.corriente,'estado_corriente': item9.estado_corriente,'evidencia_corriente': item9.evidencia_corriente,'fases': item9.fases,'estado_fase': item9.estado_fase,'evidencia_fase': item9.evidencia_fase,'tipo_gas': item9.tipo_gas,'estado_gas': item9.estado_gas,'evidencia_gas': item9.evidencia_gas,'presion_gas': item9.presion_gas,'estado_presion_gas': item9.estado_presion_gas,'evidencia_presion_gas': item9.evidencia_presion_gas,'presion_vapor': item9.presion_vapor,'estado_presion_vapor': item9.estado_presion_vapor,'evidencia_presion_vapor': item9.evidencia_presion_vapor,'temperatura': item9.temperatura,'estado_temperatura': item9.estado_temperatura,'evidencia_estado_temperatura': item9.evidencia_estado_temperatura,'falla_reportada': item9.falla_reportada};
                                                                                                                                                                }
                                                                                                                                                                $.ajax({
                                                                                                                                                                    type: "POST",
                                                                                                                                                                    async : true,
                                                                                                                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarReporteDIPREC.php",
                                                                                                                                                                    dataType: 'html',
                                                                                                                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'servicioTecnico': JSON.stringify(servicioTecnico),'datosEquipo': JSON.stringify(datosEquipo),'evidenciaEquipo': JSON.stringify(evidenciaEquipo),'datosEquipoAntes': JSON.stringify(datosEquipoAntes),'evidenciaRefacciones': JSON.stringify(evidenciaRefacciones),'checkList': JSON.stringify(checkList),'checkList2': JSON.stringify(checkList2),'datosEquipoDespues': JSON.stringify(datosEquipoDespues)},
                                                                                                                                                                    success: function(respuesta){
                                                                                                                                                                        var respu1 = respuesta.split("._.");
                                                                                                                                                                        var dat1 = respu1[0];
                                                                                                                                                                        var dat2 = respu1[1];
                                                                                                                                                                        if(dat1 == "CEDULA"){
                                                                                                                                                                            if(dat2 > 0){
                                                                                                                                                                                databaseHandler.db.transaction(
                                                                                                                                                                                    function(tx7){
                                                                                                                                                                                        tx7.executeSql(
                                                                                                                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                                                                                                            [id_cedula],
                                                                                                                                                                                            function(tx7, results){
                                                                                                                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                                                                                                            }
                                                                                                                                                                                        );
                                                                                                                                                                                    }
                                                                                                                                                                                );
                                                                                                                                                                            }
                                                                                                                                                                        }
                                                                                                                                                                    },
                                                                                                                                                                    error: function(){
                                                                                                                                                                        console.log("Error en la comunicacion");
                                                                                                                                                                    }
                                                                                                                                                                });
                                                                                                                                                            },
                                                                                                                                                            function(tx, error){
                                                                                                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                                                                            }
                                                                                                                                                        );
                                                                                                                                                    },
                                                                                                                                                    function(error){},
                                                                                                                                                    function(){}
                                                                                                                                                );
                                                                                                                                            },
                                                                                                                                            function(tx, error){
                                                                                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                                                            }
                                                                                                                                        );
                                                                                                                                    },
                                                                                                                                    function(error){},
                                                                                                                                    function(){}
                                                                                                                                );
                                                                                                                            },
                                                                                                                            function(tx, error){
                                                                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                                            }
                                                                                                                        );
                                                                                                                    },
                                                                                                                    function(error){},
                                                                                                                    function(){}
                                                                                                                );
                                                                                                            },
                                                                                                            function(tx, error){
                                                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                            }
                                                                                                        );
                                                                                                    },
                                                                                                    function(error){},
                                                                                                    function(){}
                                                                                                );
                                                                                            },
                                                                                            function(tx, error){
                                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                            }
                                                                                        );
                                                                                    },
                                                                                    function(error){},
                                                                                    function(){}
                                                                                );
                                                                            },
                                                                            function(tx, error){
                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                            }
                                                                        );
                                                                    },
                                                                    function(error){},
                                                                    function(){}
                                                                );
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                            if(tipo == "minutaCoordinador"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM minuta_coordinador WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    minutaCoordinador[i] = {'Valor':i,'foto_entrada':item2.foto_entrada,'empresa':item2.empresa,'coordinador_obra':item2.coordinador_obra,'nombre_cliente':item2.nombre_cliente,'proyecto':item2.proyecto,'coordonador':item2.coordonador,'direccion':item2.direccion,'firma_cliente':item2.firma_cliente,'fecha_cliente':item2.fecha_cliente,'foto_salida':item2.foto_salida,'puesto':item2.puesto};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from zonas_coordinador WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    zonasCoordinador[i] = {'Valor':i,'nombre': item3.nombre,'foto': item3.foto,'fecha_registro': item3.fecha_registro};
                                                                }
                                                                databaseHandler.db.transaction(
                                                                    function(tx){
                                                                        tx.executeSql("SELECT * from equipos_coordinador WHERE id_cedula = ?",
                                                                            [id_cedula],
                                                                            function(tx, results){
                                                                                var length = results.rows.length;
                                                                                for(var i = 0; i< length; i++){
                                                                                    var item4 = results.rows.item(i);
                                                                                    equiposCoordinador[i] = {'Valor':i,'zona': item4.zona,'equipo': item4.equipo,'foto': item4.foto,'fecha_registro': item4.fecha_registro};
                                                                                }
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx){
                                                                                        tx.executeSql("SELECT * from datos_coordinador WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx, results){
                                                                                                var length = results.rows.length;
                                                                                                for(var i = 0; i< length; i++){
                                                                                                    var item5 = results.rows.item(i);
                                                                                                    datosCoordinador[i] = {'Valor':reporteTecnico,'zona': item5.zona,'equipo': item5.equipo,'voltaje': item5.voltaje,'estado_voltaje': item5.estado_voltaje,'evidencia_voltaje': item5.evidencia_voltaje,'corriente': item5.corriente,'estado_corriente': item5.estado_corriente,'evidencia_corriente': item5.evidencia_corriente,'fases': item5.fases,'estado_fase': item5.estado_fase,'evidencia_fase': item5.evidencia_fase,'tipo_gas': item5.tipo_gas,'estado_gas': item5.estado_gas,'evidencia_gas': item5.evidencia_gas,'presion_gas': item5.presion_gas,'estado_presion_gas': item5.estado_presion_gas,'evidencia_presion_gas': item5.evidencia_presion_gas,'presion_vapor': item5.presion_vapor,'estado_presion_vapor': item5.estado_presion_vapor,'evidencia_presion_vapor': item5.evidencia_presion_vapor,'temperatura': item5.temperatura,'estado_temperatura': item5.estado_temperatura,'evidencia_estado_temperatura': item5.evidencia_estado_temperatura,'falla_reportada': item5.falla_reportada};
                                                                                                }
                                                                                                databaseHandler.db.transaction(
                                                                                                    function(tx){
                                                                                                        tx.executeSql("SELECT * from observaciones WHERE id_cedula = ?",
                                                                                                            [id_cedula],
                                                                                                            function(tx, results){
                                                                                                                var length = results.rows.length;
                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                    var item6 = results.rows.item(i);
                                                                                                                    observaciones[i] = {'Valor':reporteTecnico,'acuerdo': item6.acuerdo,'foto': item6.foto,'fecha_registro': item6.fecha_registro};
                                                                                                                }
                                                                                                                databaseHandler.db.transaction(
                                                                                                                    function(tx){
                                                                                                                        tx.executeSql("SELECT * from notas WHERE id_cedula = ?",
                                                                                                                            [id_cedula],
                                                                                                                            function(tx, results){
                                                                                                                                var length = results.rows.length;
                                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                                    var item7 = results.rows.item(i);
                                                                                                                                    notas[i] = {'Valor':reporteTecnico,'nota': item7.nota,'foto': item7.foto,'fecha_registro': item7.fecha_registro};
                                                                                                                                }
                                                                                                                                $.ajax({
                                                                                                                                    type: "POST",
                                                                                                                                    async : true,
                                                                                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarMinutaDIPREC.php",
                                                                                                                                    dataType: 'html',
                                                                                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'minutaCoordinador': JSON.stringify(minutaCoordinador),'zonasCoordinador': JSON.stringify(zonasCoordinador),'equiposCoordinador': JSON.stringify(equiposCoordinador),'datosCoordinador': JSON.stringify(datosCoordinador),'observaciones': JSON.stringify(observaciones),'notas': JSON.stringify(notas)},
                                                                                                                                    success: function(respuesta){
                                                                                                                                        var respu1 = respuesta.split("._.");
                                                                                                                                        var dat1 = respu1[0];
                                                                                                                                        var dat2 = respu1[1];
                                                                                                                                        if(dat1 == "CEDULA"){
                                                                                                                                            if(dat2 > 0){
                                                                                                                                                databaseHandler.db.transaction(
                                                                                                                                                    function(tx7){
                                                                                                                                                        tx7.executeSql(
                                                                                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                                                                            [id_cedula],
                                                                                                                                                            function(tx7, results){
                                                                                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                                                                            }
                                                                                                                                                        );
                                                                                                                                                    }
                                                                                                                                                );
                                                                                                                                            }
                                                                                                                                        }
                                                                                                                                    },
                                                                                                                                    error: function(){
                                                                                                                                        console.log("Error en la comunicacion");
                                                                                                                                    }
                                                                                                                                });
                                                                                                                            },
                                                                                                                            function(tx, error){
                                                                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                                            }
                                                                                                                        );
                                                                                                                    },
                                                                                                                    function(error){},
                                                                                                                    function(){}
                                                                                                                );
                                                                                                            },
                                                                                                            function(tx, error){
                                                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                            }
                                                                                                        );
                                                                                                    },
                                                                                                    function(error){},
                                                                                                    function(){}
                                                                                                );
                                                                                            },
                                                                                            function(tx, error){
                                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                            }
                                                                                        );
                                                                                    },
                                                                                    function(error){},
                                                                                    function(){}
                                                                                );
                                                                            },
                                                                            function(tx, error){
                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                            }
                                                                        );
                                                                    },
                                                                    function(error){},
                                                                    function(){}
                                                                );
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                        },
                        function(tx, error){
                            console.log("Error al consultar datos generales: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );

        } else if(empresa == "SURO"){
            var datosCedulaGeneral = new Array();
            var sanitizacion = new Array();
            var evidenciaSanitizacion = new Array();
            var evidenciaRecorrido = new Array();
            var Fotos_SURO = new Array();
            var visita = new Array();
            var encuesta = new Array();
            var visitaB = new Array();
            var seguimiento =new Array();

            var fecha = new Date();
            var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var length = results.rows.length;
                            for(var i = 0; i< length; i++){
                                var item = results.rows.item(i);
                                tipo = item.tipo_cedula;
                                datosCedulaGeneral[i] = {'Valor':i,'id_cedula':item.id_cedula,'tipo_cedula':item.tipo_cedula,'id_usuario':item.id_usuario,'nombre_usuario':item.nombre_usuario,'fecha_entrada':item.fecha_entrada,'geolocalizacion_entrada': item.geolocalizacion_entrada,'id_cliente': item.id_cliente,'nombre_cliente': item.nombre_cliente,'horario_programado': item.horario_programado,'calificacion': item.calificacion,'fecha_salida':item.fecha_salida,'geolocalizacion_salida':item.geolocalizacion_salida,'nombre_evalua':item.nombre_evalua,'comentario_cliente':item.comentario_cliente,'fecha_envio':fecha_envio};
                            }
                            if(tipo == "sanitizacionSURO"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM sanitizacion_Suro WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    sanitizacion[i] = {'Valor':i,'nombre_cliente':item2.nombre_cliente,'foto_entrada':item2.foto_entrada,'sucursal':item2.sucursal,'direccion':item2.direccion,'correo':item2.correo,'nombre_usuario':item2.nombre_usuario,'foto_epp':item2.foto_epp,'foto_maquina':item2.foto_maquina,'foto_aspersor':item2.foto_aspersor,'foto_quimico':item2.foto_quimico,'foto_accesos':item2.foto_accesos,'foto_delimita_area':item2.foto_delimita_area,'fecha_foto_epp':item2.fecha_foto_epp,'fecha_foto_maquina':item2.fecha_foto_maquina,'fecha_foto_aspersor':item2.fecha_foto_aspersor,'fecha_foto_quimico':item2.fecha_foto_quimico,'fecha_foto_acceso':item2.fecha_foto_acceso,'fecha_foto_area':item2.fecha_foto_area,'firma_cliente':item2.firma_cliente,'fecha_cliente':item2.fecha_cliente,'foto_salida':item2.foto_salida,'puesto':item2.puesto};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from evidencia WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    evidenciaSanitizacion[i] = {'Valor':i,'nombre_grupo': item3.nombre_grupo,'foto_evidencia': item3.foto_evidencia,'fases': item3.fases,'fecha_foto': item3.fecha_foto};
                                                                }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarSanitizacionSURO.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'sanitizacion': JSON.stringify(sanitizacion),'datosProductos': JSON.stringify(evidenciaSanitizacion)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        } else {
                                                                            AlmacenarError(respuesta);
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion");
                                                                        AlmacenarError("Error en llevartodo de app");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }else if(tipo == "recorridoSURO"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM Recorrido_SURO WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    evidenciaRecorrido[i] = {'Valor':i,'comentarios_bodega':item2.Comentarios_bodega,'comentarios_maq':item2.Comentarios_maq,'nombre_remitente':item2.Nombre_remitente,'nombre_sitio':item2.Nombre_sitio,'pregunta_bodega':item2.Pregunta_bodega,'pregunta_maq1':item2.Pregunta_maq1,'pregunta_maq2':item2.Pregunta_maq2,'fecha_envio':item2.fecha_envio,'ubicacion':item2.ubicacion,'nombre_cliente': item2.nombre_cliente,'puesto':item2.puesto,'puesto_re':item2.puesto_re};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from Fotos_SURO WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    Fotos_SURO[i] = {'Valor':i,'titulo': item3.titulo,'foto': item3.foto,'fecha': item3.fecha,'recorrido': item3.recorrido, 'procesos' : item3.proceso};
                                                                }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarrecorridoSURO.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'recorrido': JSON.stringify(evidenciaRecorrido),'fotos': JSON.stringify(Fotos_SURO)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );

                            }else if(tipo == "visitaSURO"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM Visita_SURO WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    visita[i] = {'Valor':i,'nombre_cliente':item2.nombre_cliente,'nombre_remitente':item2.Nombre_remitente,'fecha_envio':item2.fecha_envio,'ubcacion':item2.ubicacion,'nombre_sitio':item2.Nombre_sitio,'motivo_visita':item2.motivo_vista,'cali_limpieza':item2.cali_limpieza,'cali_ejecutivo':item2.cali_ejecutivo,'cali_gerente':item2.cali_gerente,'comentarios':item2.Comentarios,'compromiso':item2.compromiso};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from Fotos_SURO WHERE id_cedula = ?",
                                                        [id_cedula],
                                                        function(tx, results){
                                                            var length = results.rows.length;
                                                            for(var i = 0; i< length; i++){
                                                                var item3 = results.rows.item(i);
                                                                Fotos_SURO[i] = {'Valor':i,'titulo': item3.titulo,'foto': item3.foto,'fecha': item3.fecha,'recorrido': item3.recorrido, 'procesos' : item3.proceso};
                                                            }
                                                              $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarvisitaSURO.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'visita': JSON.stringify(visita),'fotos': JSON.stringify(Fotos_SURO)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];                                                                            
                                                                            if(dat1 == "CEDULA"){
                                                                                if(dat2 > 0){
                                                                                    databaseHandler.db.transaction(
                                                                                        function(tx7){
                                                                                            tx7.executeSql(
                                                                                                "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                [id_cedula],
                                                                                                function(tx7, results){
                                                                                                    localStorage.setItem("sendFlag", 0);
                                                                                                    swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                }
                                                                                            );
                                                                                        }
                                                                                    );
                                                                                }
                                                                            }                                                                        
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );

                            }else
                            if(tipo == "encuestaSURO"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM Encuesta_SURO WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    encuesta[i] = {'Valor':i,'nombre_remitente':item2.Nombre_remitente,'fecha_envio':item2.fecha_envio,'ubicacion':item2.ubicacion,'pregunta1':item2.pregunta1,'pregunta2':item2.pregunta2,'pregunta3':item2.pregunta3,'pregunta4':item2.pregunta4,'pregunta5':item2.pregunta5,'pregunta6':item2.pregunta6,'pregunta7':item2.pregunta7,'nombre_cliente':item2.nombre_cliente,'comentario1':item2.comentarios1,'comentario2':item2.comentarios2,'comentario3':item2.comentarios3,'comentario4':item2.comentarios4,'comentario5':item2.comentarios5,'comentario6':item2.comentarios6,'comentario7':item2.comentarios7,'nombre_sitio':item2.nombre_sitio};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from Fotos_SURO WHERE id_cedula = ?",
                                                        [id_cedula],
                                                        function(tx, results){
                                                            var length = results.rows.length;
                                                            for(var i = 0; i< length; i++){
                                                                var item3 = results.rows.item(i);
                                                                Fotos_SURO[i] = {'Valor':i,'titulo': item3.titulo,'foto': item3.foto,'fecha': item3.fecha,'recorrido': item3.recorrido, 'procesos' : item3.proceso};
                                                            }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarencuestaSURO.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'encuesta': JSON.stringify(encuesta),'fotos': JSON.stringify(Fotos_SURO)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );

                            }else
                            if(tipo == "visitaBSURO"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM VisitaB_SURO WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    visitaB[i] = {'Valor':i,'responsable':item2.responsable,'pendientes':item2.pendientes,'fecha':item2.fecha,'almacen1':item2.almacen1,'almacen2':item2.almacen2,'almacen3':item2.almacen3,'frecuencia1':item2.frecuencia1,'frecuencia2':item2.frecuencia2,'frecuencia3':item2.frecuencia3,'frecuencia4':item2.frecuencia4,'gestion1':item2.gestion1,'gestion2':item2.gestion2,'gestion3':item2.gestion3,'gestion4':item2.gestion4,'gestion5':item2.gestion5,'gestion6':item2.gestion6,'gestion7':item2.gestion7,'gestion8':item2.gestion8,'gestion9':item2.gestion9,'recorrido1':item2.recorrido1,'recorrido2':item2.recorrido2,'recorrido3':item2.recorrido3,'sitio':item2.sitio,'numero_ti':item2.numero_ti,'nombre_cliente':item2.nombre_cliente};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from Fotos_SURO WHERE id_cedula = ?",
                                                        [id_cedula],
                                                        function(tx, results){
                                                            var length = results.rows.length;
                                                            for(var i = 0; i< length; i++){
                                                                var item3 = results.rows.item(i);
                                                                Fotos_SURO[i] = {'Valor':i,'titulo': item3.titulo,'foto': item3.foto,'fecha': item3.fecha,'recorrido': item3.recorrido, 'procesos' : item3.proceso};
                                                            }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarvisitaBSURO.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'visitaB': JSON.stringify(visitaB),'fotos': JSON.stringify(Fotos_SURO)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );

                            }else if (tipo == "seguimientoSURO"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM Seguimiento WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                   
                                                    seguimiento[i] = {'Valor':i,'comentarios':item2.comentarios,'fecha':item2.fecha,'motivo':item2.motivo,'nombre_cliente':item2.nombre_cliente,'observacion':item2.observacion,'sitio':item2.sitio};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from Fotos_SURO WHERE id_cedula = ?",
                                                        [id_cedula],
                                                        function(tx, results){
                                                            var length = results.rows.length;
                                                            for(var i = 0; i< length; i++){
                                                                var item3 = results.rows.item(i);
                                                                Fotos_SURO[i] = {'Valor':i,'titulo': item3.titulo,'foto': item3.foto,'fecha': item3.fecha,'recorrido': item3.recorrido, 'procesos' : item3.proceso};
                                                            }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarseguimientoSURO.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'seguimiento': JSON.stringify(seguimiento),'fotos': JSON.stringify(Fotos_SURO)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );

                            }

                        },
                        function(tx, error){
                            console.log("Error al consultar datos generales: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else if(empresa == "MerGroup"){
            var datosCedulaGeneral = new Array();
            var reporteFotografico = new Array();
            var evidenciaFotografica = new Array();

            var fecha = new Date();
            var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var length = results.rows.length;
                            for(var i = 0; i< length; i++){
                                var item = results.rows.item(i);
                                tipo = item.tipo_cedula;
                                datosCedulaGeneral[i] = {'Valor':i,'id_cedula':item.id_cedula,'tipo_cedula':item.tipo_cedula,'id_usuario':item.id_usuario,'nombre_usuario':item.nombre_usuario,'fecha_entrada':item.fecha_entrada,'geolocalizacion_entrada': item.geolocalizacion_entrada,'id_cliente': item.id_cliente,'nombre_cliente': item.nombre_cliente,'horario_programado': item.horario_programado,'calificacion': item.calificacion,'fecha_salida':item.fecha_salida,'geolocalizacion_salida':item.geolocalizacion_salida,'nombre_evalua':item.nombre_evalua,'comentario_cliente':item.comentario_cliente,'fecha_envio':fecha_envio};
                            }
                            if(tipo == "reporteFotografico"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM reporteFotografico WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    reporteFotografico[i] = {'Valor':i,'id_visita':item2.id_visita,'foto_entrada':item2.foto_entrada,'orden_compra':item2.orden_compra,'nombre_cliente':item2.nombre_cliente,'sitio':item2.sitio,'contratista':item2.contratista,'tipo_proyecto':item2.tipo_proyecto,'region':item2.region,'torre':item2.torre,'proceso':item2.proceso,'foto_salida':item2.foto_salida,'firma_cliente':item2.firma_cliente,'fecha_cliente':item2.fecha_cliente};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from evidenciaFotografica WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    evidenciaFotografica[i] = {'Valor':i,'titulo': item3.titulo,'observacion': item3.observacion,'foto': item3.foto,'fecha_registro': item3.fecha_registro};
                                                                }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarReporteFotograficoMerGroup.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'reporteFotografico': JSON.stringify(reporteFotografico),'evidenciaFotografica': JSON.stringify(evidenciaFotografica)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                        },
                        function(tx, error){
                            console.log("Error al consultar datos generales: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else if(empresa == "PlatoLimpio"){
            var datosCedulaGeneral = new Array();
            var DatosGenerales = new Array();
            var Ciclo_Charola = new Array();
            var Factor_Humano = new Array();
            var Info_Equipo = new Array ();
            var Capa_Equipo_A = new Array();
            var Capa_Equipo_B = new Array();
            var Tipo_Sistema = new Array();
            var Prueba_Calidad_Agua = new Array();
            var Insumos_A = new Array();
            var Insumos_B = new Array();
            var Insumos_C = new Array();
            var Stress = new Array();
            var Resultados = new Array();
            var Fotos = new Array();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var length = results.rows.length;
                            for(var i = 0; i< length; i++){
                                var item = results.rows.item(i);
                                tipo = item.tipo_cedula;
                                datosCedulaGeneral[i] = {'Valor':i,'id_cedula':item.id_cedula,'tipo_cedula':item.tipo_cedula,'id_usuario':item.id_usuario,'nombre_usuario':item.nombre_usuario,'fecha_entrada':item.fecha_entrada,'geolocalizacion_entrada': item.geolocalizacion_entrada,'id_cliente': item.id_cliente,'nombre_cliente': item.nombre_cliente,'horario_programado': item.horario_programado,'calificacion': item.calificacion,'fecha_salida':item.fecha_salida,'geolocalizacion_salida':item.geolocalizacion_salida,'nombre_evalua':item.nombre_evalua,'comentario_cliente':item.comentario_cliente,'fecha_envio':fecha_envio};
                            }
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("SELECT * from DG_PlatoL WHERE DG_ID_Cedula = ?",
                                        [id_cedula],
                                        function(tx, results){
                                            var length = results.rows.length;
                                            for(var i = 0; i< length; i++){
                                                var item1 = results.rows.item(i);
                                                DatosGenerales[i] = {'Valor':i,'empresa': item1.DG_Empresa,'titulo': item1.titulo,'empleados': item1.DG_CEmpleados,'fecha': item1.DG_FechaA, 'Hora': item1.DG_HoraA, 'contacto': item1.DG_Contacto, 'puesto': item1.DG_Puesto, 'correo': item1.DG_Correo, 'telefono': item1.DG_Movil, 'bitacora' : item1.DG_CA_Bitacora, 'prl_observaciones' : item1.DG_PRL_Observaciones, 'fhc_observaciones' : item1.DG_FHC_Observaciones, 'manuales': item1.DG_FHC_Manuales , 'notas' : item1.DG_CE_Notas ,'lavaloza' : item1.DG_CE_Lavaloza , 'nombre_r': item1.Nombre_R , 'comentarios_cierre': item1.Comentarios_Cierre};
                                            }  
                                            databaseHandler.db.transaction(
                                                function(tx){
                                                    tx.executeSql("SELECT * from Ciclo_Charola WHERE CC_ID_Cedula = ?",
                                                        [id_cedula],
                                                        function(tx, results){
                                                            var length = results.rows.length; 
                                                            for(var i = 0; i< length; i++){
                                                                var item2 = results.rows.item(i);
                                                                console.log("item2",item2)
                                                                Ciclo_Charola[i] = {'Valor':i,'tipo': item2.CC_tipo ,'etapa': item2.CC_Etapa,'escala': item2.CC_Escala,'oportunidad': item2.CC_Oportunidad, 'comentario' : item2.CC_Comentario , 'responsable': item2.CC_Responsable };
                                                            }
                                                            databaseHandler.db.transaction(
                                                                function(tx){
                                                                    tx.executeSql("SELECT * from Factor_Humano WHERE FH_ID_Cedula = ?",
                                                                        [id_cedula],
                                                                        function(tx, results){
                                                                            var length = results.rows.length;
                                                                            for(var i = 0; i< length; i++){
                                                                                var item3 = results.rows.item(i);
                                                                                console.log("item3",item3)
                                                                                Factor_Humano[i] = {'Valor':i,'puesto': item3.FH_Puesto,'capacitacion': item3.FH_Capacitacion,'certificacion': item3.FH_Certificacion,'observacion': item3.FH_Observacion, 'manuales' : item3.FH_Manuales};
                                                                            } 
                                                                            databaseHandler.db.transaction(
                                                                                function(tx){
                                                                                    tx.executeSql("SELECT * from Info_Equipo WHERE IE_ID_Cedula = ?",
                                                                                        [id_cedula],
                                                                                        function(tx, results){
                                                                                            var length = results.rows.length;
                                                                                            for(var i = 0; i< length; i++){
                                                                                                var item4 = results.rows.item(i);
                                                                                                Info_Equipo[i] = {'Valor':i,'modelo': item4.IE_Modelo,'numero_serie': item4.IE_NS ,'ubicacion': item4.IE_Ubicacion,'fecha': item4.IE_Fecha, 'uso' : item4.IE_Uso, 'consumo' : item4.IE_Consumo, 'agua' : item4.IE_Agua , 'suministro' : item4.IE_Suministro };
                                                                                            }  
                                                                                            databaseHandler.db.transaction(
                                                                                                function(tx){
                                                                                                    tx.executeSql("SELECT * from Capa_Equipo_A WHERE CE_ID_Cedula = ?",
                                                                                                        [id_cedula],
                                                                                                        function(tx, results){
                                                                                                            var length = results.rows.length;
                                                                                                            for(var i = 0; i< length; i++){
                                                                                                                var item5 = results.rows.item(i);
                                                                                                                Capa_Equipo_A[i] = {'Valor':i,'turno': item5.CE_Turno,'horario': item5.CE_Horario,'cantidad': item5.CE_Cantidad};
                                                                                                            }
                                                                                                            databaseHandler.db.transaction(
                                                                                                                function(tx){
                                                                                                                    tx.executeSql("SELECT * from Capa_Equipo_B WHERE CE_ID_Cedula = ?",
                                                                                                                        [id_cedula],
                                                                                                                        function(tx, results){
                                                                                                                            var length = results.rows.length;
                                                                                                                            for(var i = 0; i< length; i++){
                                                                                                                                var item6 = results.rows.item(i);
                                                                                                                                Capa_Equipo_B[i] = {'Valor':i,'utencilio': item6.CE_Utencilio,'cantidad': item6.CE_Cantidad,'tipo': item6.CE_Tipo,'material': item6.CE_Material};
                                                                                                                            }
                                                                                                                            databaseHandler.db.transaction(
                                                                                                                                function(tx){
                                                                                                                                    tx.executeSql("SELECT * from Tipo_Sistema WHERE TS_ID_Cedula = ?",
                                                                                                                                        [id_cedula],
                                                                                                                                        function(tx, results){
                                                                                                                                            var length = results.rows.length;
                                                                                                                                            for(var i = 0; i< length; i++){
                                                                                                                                                var item7 = results.rows.item(i);
                                                                                                                                                Tipo_Sistema[i] = {'Valor':i,'equipo': item7.TS_Equipo,'boiler': item7.TS_Boiler,'booster': item7.TS_Booster,'maquina': item7.TS_Maquina, 'observacion' : item7.TS_Observacion};
                                                                                                                                            } 
                                                                                                                                            databaseHandler.db.transaction(
                                                                                                                                                function(tx){
                                                                                                                                                    tx.executeSql("SELECT * from Prueba_Calidad_Agua WHERE PCA_ID_Cedula = ?",
                                                                                                                                                        [id_cedula],
                                                                                                                                                        function(tx, results){
                                                                                                                                                            var length = results.rows.length;
                                                                                                                                                            for(var i = 0; i< length; i++){
                                                                                                                                                                var item8 = results.rows.item(i);
                                                                                                                                                                Prueba_Calidad_Agua[i] = {'Valor':i,'tipo': item8.PCA_Tipo,'dureza': item8.PCA_Dureza,'partes': item8.PCA_Partes ,'sistema': item8.PCA_Sitema};
                                                                                                                                                            }
                                                                                                                                                            databaseHandler.db.transaction(
                                                                                                                                                                function(tx){
                                                                                                                                                                    tx.executeSql("SELECT * from Insumos_A WHERE ID_Cedula = ?",
                                                                                                                                                                        [id_cedula],
                                                                                                                                                                        function(tx, results){
                                                                                                                                                                            var length = results.rows.length;
                                                                                                                                                                            for(var i = 0; i< length; i++){
                                                                                                                                                                                var item9 = results.rows.item(i);
                                                                                                                                                                                Insumos_A[i] = {'Valor':i,'equipo': item9.Equipo,'marca': item9.Marca,'modelo': item9.Modelo,'dosificador': item9.Dosificador};
                                                                                                                                                                            } 
                                                                                                                                                                            databaseHandler.db.transaction(
                                                                                                                                                                                function(tx){
                                                                                                                                                                                    tx.executeSql("SELECT * from Insumos_B WHERE ID_Cedula = ?",
                                                                                                                                                                                        [id_cedula],
                                                                                                                                                                                        function(tx, results){
                                                                                                                                                                                            var length = results.rows.length;
                                                                                                                                                                                            for(var i = 0; i< length; i++){
                                                                                                                                                                                                var item10 = results.rows.item(i);
                                                                                                                                                                                                Insumos_B[i] = {'Valor':i,'dosificador': item10.Dosificador,'marca': item10.Marca,'modelo': item10.Modelo};
                                                                                                                                                                                            } 
                                                                                                                                                                                            databaseHandler.db.transaction(
                                                                                                                                                                                                function(tx){
                                                                                                                                                                                                    tx.executeSql("SELECT * from Insumos_C WHERE ID_Cedula = ?",
                                                                                                                                                                                                        [id_cedula],
                                                                                                                                                                                                        function(tx, results){
                                                                                                                                                                                                            var length = results.rows.length;
                                                                                                                                                                                                            for(var i = 0; i< length; i++){
                                                                                                                                                                                                                var item11 = results.rows.item(i);
                                                                                                                                                                                                                Insumos_C[i] = {'Valor':i,'horas': item11.Horas,'cantidad': item11.Cantidad};
                                                                                                                                                                                                            }
                                                                                                                                                                                                            databaseHandler.db.transaction(
                                                                                                                                                                                                                function(tx){
                                                                                                                                                                                                                    tx.executeSql("SELECT * from Stress WHERE ID_Cedula = ?",
                                                                                                                                                                                                                        [id_cedula],
                                                                                                                                                                                                                        function(tx, results){
                                                                                                                                                                                                                            var length = results.rows.length;
                                                                                                                                                                                                                            for(var i = 0; i< length; i++){
                                                                                                                                                                                                                                var item12 = results.rows.item(i);
                                                                                                                                                                                                                                Stress[i] = {'Valor':i,'tomas': item12.Tomas,'equipo': item12.Equipo, 'hora' : item12.Hora, 'temp_entrada' : item12.TempeE,'pre_entrada' : item12.PreE, 'temp_salida' : item12.TempeS, 'pre_salida' : item12.PreS, 'bitacora' : item12.Bitacora };
                                                                                                                                                                                                                            } 
                                                                                                                                                                                                                            databaseHandler.db.transaction(
                                                                                                                                                                                                                                function(tx){
                                                                                                                                                                                                                                    tx.executeSql("SELECT * from Resultado WHERE ID_Cedula = ?",
                                                                                                                                                                                                                                        [id_cedula],
                                                                                                                                                                                                                                        function(tx, results){
                                                                                                                                                                                                                                            var length = results.rows.length;
                                                                                                                                                                                                                                            for(var i = 0; i< length; i++){
                                                                                                                                                                                                                                                var item13 = results.rows.item(i);
                                                                                                                                                                                                                                                Resultados[i] = {'Valor':i,'tipo': item13.Tipo,'suciedad': item13.Suciedad, 'detergente' : item13.Detergente };
                                                                                                                                                                                                                                            }  
                                                                                                                                                                                                                                            databaseHandler.db.transaction(
                                                                                                                                                                                                                                                function(tx){
                                                                                                                                                                                                                                                    tx.executeSql("Select * from PL_Fotos WHERE F_ID_Cedula = ?",
                                                                                                                                                                                                                                                        [id_cedula],
                                                                                                                                                                                                                                                        function(tx, results){ 
                                                                                                                                                                                                                                                            var length = results.rows.length;                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                            for(var i = 0; i< length; i++){
                                                                                                                                                                                                                                                                var item14 = results.rows.item(i);
                                                                                                                                                                                                                                                                Fotos[i] = {'Valor':i,'recorrido': item14.F_Recorrido,'proceso': item14.F_Proceso, 'titulo' : item14.F_titulo, 'fecha' : item14.F_FechaHora , 'foto': item14.F_Foto };
                                                                                                                                                                                                                                                            }                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                            $.ajax({
                                                                                                                                                                                                                                                                type: "POST",
                                                                                                                                                                                                                                                                async : true,
                                                                                                                                                                                                                                                                url: "http://www.appbennetts.com/FWM2/app/guardarPLCC.php",
                                                                                                                                                                                                                                                                dataType: 'html',
                                                                                                                                                                                                                                                                data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'DatosGenerales': JSON.stringify(DatosGenerales),'Ciclo_Charola': JSON.stringify(Ciclo_Charola),'Factor_Humano': JSON.stringify(Factor_Humano),'Info_Equipo': JSON.stringify(Info_Equipo),'Capa_Equipo_A': JSON.stringify(Capa_Equipo_A),'Capa_Equipo_B': JSON.stringify(Capa_Equipo_B),'Tipo_Sistema': JSON.stringify(Tipo_Sistema ),'Prueba_Calidad_Agua': JSON.stringify(Prueba_Calidad_Agua ),'Insumos_A': JSON.stringify(Insumos_A),'Insumos_B': JSON.stringify(Insumos_B),'Insumos_C': JSON.stringify(Insumos_C),'Stress': JSON.stringify(Stress),'Resultados': JSON.stringify(Resultados),'Fotos': JSON.stringify(Fotos)},
                                                                                                                                                                                                                                                                success: function(respuesta){
                                                                                                                                                                                                                                                                    var respu1 = respuesta.split("._.");
                                                                                                                                                                                                                                                                    var dat1 = respu1[0];
                                                                                                                                                                                                                                                                    var dat2 = respu1[1];
                                                                                                                                                                                                                                                                    if(dat1 == "CEDULA"){
                                                                                                                                                                                                                                                                        if(dat2 > 0){
                                                                                                                                                                                                                                                                            databaseHandler.db.transaction(
                                                                                                                                                                                                                                                                                function(tx7){
                                                                                                                                                                                                                                                                                    tx7.executeSql(
                                                                                                                                                                                                                                                                                        "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                                                                                                                                                                                                        [id_cedula],
                                                                                                                                                                                                                                                                                        function(tx7, results){
                                                                                                                                                                                                                                                                                            localStorage.setItem("sendFlag", 0);
                                                                                                                                                                                                                                                                                            swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                    );
                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                            );
                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                },
                                                                                                                                                                                                                                                                error: function(){
                                                                                                                                                                                                                                                                    console.log("Error en la comunicacion");
                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                            });             
                                                                                                                                                                                                                                                        },
                                                                                                                                                                                                                                                        function(tx, error){
                                                                                                                                                                                                                                                            console.log("Error al consultar fotos PL_Fotos: " +error.message);
                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                    );
                                                                                                                                                                                                                                                },
                                                                                                                                                                                                                                                function(error){
                                                                                                                                                                                                                                                    console.log("Error al consultar fotos PL_Fotos: " +error.message);
                                                                                                                                                                                                                                                },
                                                                                                                                                                                                                                                function(){}
                                                                                                                                                                                                                                            );               
                                                                                                                                                                                                                                        },
                                                                                                                                                                                                                                        function(tx, error){
                                                                                                                                                                                                                                            console.log("Error al consultar  Resultado: " +error.message);
                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                    );
                                                                                                                                                                                                                                },
                                                                                                                                                                                                                                function(error){
                                                                                                                                                                                                                                    console.log("Error al consultar  Resultado: " +error.message);
                                                                                                                                                                                                                                },
                                                                                                                                                                                                                                function(){}
                                                                                                                                                                                                                            );                 
                                                                                                                                                                                                                        },
                                                                                                                                                                                                                        function(tx, error){
                                                                                                                                                                                                                            console.log("Error al consultar  Stress: " +error.message);
                                                                                                                                                                                                                        }
                                                                                                                                                                                                                    );
                                                                                                                                                                                                                },
                                                                                                                                                                                                                function(error){ console.log("Error al consultar  Stress: " +error.message);},
                                                                                                                                                                                                                function(){}
                                                                                                                                                                                                            );                
                                                                                                                                                                                                        },
                                                                                                                                                                                                        function(tx, error){
                                                                                                                                                                                                            console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                                                                                                                        }
                                                                                                                                                                                                    );
                                                                                                                                                                                                },
                                                                                                                                                                                                function(error){
                                                                                                                                                                                                    console.log("Error al consultarInsumos_C : " +error.message);
                                                                                                                                                                                                },
                                                                                                                                                                                                function(){}
                                                                                                                                                                                            );              
                                                                                                                                                                                        },
                                                                                                                                                                                        function(tx, error){
                                                                                                                                                                                            console.log("Error al consultar Insumos_B: " +error.message);
                                                                                                                                                                                        }
                                                                                                                                                                                    );
                                                                                                                                                                                },
                                                                                                                                                                                function(error){
                                                                                                                                                                                    console.log("Error al consultar Insumos_B: " +error.message);
                                                                                                                                                                                },
                                                                                                                                                                                function(){}
                                                                                                                                                                            );               
                                                                                                                                                                        },
                                                                                                                                                                        function(tx, error){
                                                                                                                                                                            console.log("Error al consultar Insumos_A: " +error.message);
                                                                                                                                                                        }
                                                                                                                                                                    );
                                                                                                                                                                },
                                                                                                                                                                function(error){
                                                                                                                                                                    console.log("Error al consultar Insumos_A: " +error.message);
                                                                                                                                                                },
                                                                                                                                                                function(){}
                                                                                                                                                            );               
                                                                                                                                                        },
                                                                                                                                                        function(tx, error){
                                                                                                                                                            console.log("Error al consultar Prueba_Calidad_Agua: " +error.message);
                                                                                                                                                        }
                                                                                                                                                    );
                                                                                                                                                },
                                                                                                                                                function(error){
                                                                                                                                                    console.log("Error al consultar Prueba_Calidad_Agua: " +error.message);
                                                                                                                                                },
                                                                                                                                                function(){}
                                                                                                                                            );              
                                                                                                                                        },
                                                                                                                                        function(tx, error){
                                                                                                                                            console.log("Error al consultar Tipo_Sistema: " +error.message);
                                                                                                                                        }
                                                                                                                                    );
                                                                                                                                },
                                                                                                                                function(error){
                                                                                                                                    console.log("Error al consultar Tipo_Sistema: " +error.message);
                                                                                                                                },
                                                                                                                                function(){}
                                                                                                                            );              
                                                                                                                        },
                                                                                                                        function(tx, error){
                                                                                                                            console.log("Error al consultar Capa_Equipo_B: " +error.message);
                                                                                                                        }
                                                                                                                    );
                                                                                                                },
                                                                                                                function(error){
                                                                                                                    console.log("Error al consultar Capa_Equipo_B: " +error.message);
                                                                                                                },
                                                                                                                function(){}
                                                                                                            ); 

                                                                                                        },
                                                                                                        function(tx, error){
                                                                                                            console.log("Error al consultar Capa_Equipo_A: " +error.message);
                                                                                                        }
                                                                                                    );
                                                                                                },
                                                                                                function(error){
                                                                                                    console.log("Error al consultar Capa_Equipo_A: " +error.message);
                                                                                                },
                                                                                                function(){}
                                                                                            );            
                                                                                        },
                                                                                        function(tx, error){
                                                                                            console.log("Error al consultar Info_Equipo: " +error.message);
                                                                                        }
                                                                                    );
                                                                                },
                                                                                function(error){
                                                                                    console.log("Error al consultar Info_Equipo: " +error.message);
                                                                                },
                                                                                function(){}
                                                                            );

                                                                        },
                                                                        function(tx, error){
                                                                            console.log("Error al consultar Info_Equipo: " +error.message);
                                                                        }
                                                                    );
                                                                },
                                                                function(error){},
                                                                function(){}
                                                            );               
                                                        },
                                                        function(tx, error){
                                                            console.log("Error al consultar  Factor_Humano : " +error.message);
                                                        }
                                                    );
                                                },
                                                function(error){
                                                    console.log("Error al consultar  Factor_Humano : " +error.message);
                                                },
                                                function(){}
                                            );             
                                        },
                                        function(tx, error){
                                            console.log("Error al consultar Ciclo_Charola : " +error.message);
                                        }
                                    );
                                },
                                function(error){
                                    console.log("Error al consultar Ciclo_Charola : " +error.message);
                                },
                                function(){}
                            );

                        },
                        function(tx, error){
                            console.log("Error al consultar datosCedulaGeneral : " +error.message);
                        }
                    );
                },
                function(error){
                    console.log("Error al consultar datosCedulaGeneral : " +error.message);
                },
                function(){}
            );
        } else if(empresa == "ServInd"){
            var datosCedulaGeneral = new Array();
            var reporteGeneral = new Array();
            var evidenciaReporteGeneral = new Array();
            var equiposReporteGeneral = new Array();

            var checkList = new Array();
            var evidenciaCheckList = new Array();

            var fotosAuditoria = new Array();
            var auditoriaDatos1 = new Array();
            var auditoriaDatos2 = new Array();
            
            var fecha = new Date();
            var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var length = results.rows.length;
                            for(var i = 0; i< length; i++){
                                var item = results.rows.item(i);
                                tipo = item.tipo_cedula;
                                datosCedulaGeneral[i] = {'Valor':i,'id_cedula':item.id_cedula,'tipo_cedula':item.tipo_cedula,'id_usuario':item.id_usuario,'nombre_usuario':item.nombre_usuario,'fecha_entrada':item.fecha_entrada,'geolocalizacion_entrada': item.geolocalizacion_entrada,'id_cliente': item.id_cliente,'nombre_cliente': item.nombre_cliente,'horario_programado': item.horario_programado,'calificacion': item.calificacion,'fecha_salida':item.fecha_salida,'geolocalizacion_salida':item.geolocalizacion_salida,'nombre_evalua':item.nombre_evalua,'comentario_cliente':item.comentario_cliente,'fecha_envio':fecha_envio};
                            }
                            if(tipo == "reporteGeneral"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM reporteGeneral WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    reporteGeneral[i] = {'Valor':i,'id_visita':item2.id_visita,'firma_cliente':item2.firma_cliente,'fecha_cliente':item2.fecha_cliente,'orden_servicio':item2.orden_servicio,'foto_entrada':item2.foto_entrada,'nombre_cliente':item2.nombre_cliente,'nombre_comercial':item2.nombre_comercial,'sucursal':item2.sucursal,'folio_interno':item2.folio_interno,'direccion':item2.direccion,'telefono':item2.telefono,'correo':item2.correo,'equipo':item2.equipo,'marca':item2.marca,'modelo':item2.modelo,'serie':item2.serie,'tipo_servicio':item2.tipo_servicio,'tipo_servicio':item2.tipo_servicio,'ciudad':item2.ciudad,'voltaje':item2.voltaje,'amp':item2.amp,'wc':item2.wc,'tierra_fisica':item2.tierra_fisica,'razon_servicio':item2.razon_servicio,'trabajo_realizado':item2.trabajo_realizado,'equipo_encontrado':item2.equipo_encontrado,'diagnostico':item2.diagnostico,'estatus_reporte':item2.estatus_reporte,'equipo_entrego':item2.equipo_entrego,'comentario':item2.comentario,'horas_activas':item2.horas_activas,'horas_viaje':item2.horas_viaje,'horas_espera':item2.horas_espera,'horas_totales':item2.horas_totales,'cotizacion':item2.cotizacion,'viaticos':item2.viaticos,'refacciones':item2.refacciones,'foto_salida':item2.foto_salida};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from equiposReporte WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    equiposReporteGeneral[i] = {'Valor':i,'origin': item3.origin,'numero_parte': item3.numero_parte,'descripcion': item3.descripcion,'prioridad': item3.prioridad,'cantidad': item3.cantidad,'fecha_registro': item3.fecha_registro};
                                                                }
                                                                databaseHandler.db.transaction(
                                                                    function(tx){
                                                                        tx.executeSql("SELECT * from evidenciasReporte WHERE id_cedula = ?",
                                                                            [id_cedula],
                                                                            function(tx, results){
                                                                                var length = results.rows.length;
                                                                                for(var i = 0; i< length; i++){
                                                                                    var item3 = results.rows.item(i);
                                                                                    evidenciaReporteGeneral[i] = {'Valor':i,'fase': item3.fase,'titulo': item3.titulo,'foto': item3.foto,'fecha_registro': item3.fecha_registro};
                                                                                }
                                                                                $.ajax({
                                                                                    type: "POST",
                                                                                    async : true,
                                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarReporteGeneralServInd.php",
                                                                                    dataType: 'html',
                                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'reporteGeneral': JSON.stringify(reporteGeneral),'equiposReporteGeneral': JSON.stringify(equiposReporteGeneral),'evidenciaReporteGeneral': JSON.stringify(evidenciaReporteGeneral)},
                                                                                    success: function(respuesta){
                                                                                        var respu1 = respuesta.split("._.");
                                                                                        var dat1 = respu1[0];
                                                                                        var dat2 = respu1[1];
                                                                                        if(dat1 == "CEDULA"){
                                                                                            if(dat2 > 0){
                                                                                                databaseHandler.db.transaction(
                                                                                                    function(tx7){
                                                                                                        tx7.executeSql(
                                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                            [id_cedula],
                                                                                                            function(tx7, results){
                                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                            }
                                                                                                        );
                                                                                                    }
                                                                                                );
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    error: function(){
                                                                                        console.log("Error en la comunicacion");
                                                                                    }
                                                                                });
                                                                            },
                                                                            function(tx, error){
                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                            }
                                                                        );
                                                                    },
                                                                    function(error){},
                                                                    function(){}
                                                                );
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                            if(tipo == "checklistServ"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM checklist WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    checkList[i] = {'Valor':i,'id_visita':item2.id_visita,'orden_servicio':item2.orden_servicio,'foto_entrada':item2.foto_entrada,'nombre_cliente':item2.nombre_cliente,'nombre_comercial':item2.nombre_comercial,'sucursal':item2.sucursal,'tienda':item2.nombre_comercial,'tienda':item2.sucursal,'direccion':item2.direccion,'modelo':item2.modelo,'serie':item2.serie,'voltaje':item2.voltaje,'amperaje':item2.amperaje,'breaker':item2.breaker,'presion':item2.presion,'dinamica':item2.dinamica,'estatica':item2.estatica,'amp1':item2.amp1,'amp2':item2.amp2,'amp3':item2.amp3,'amp4':item2.amp4,'amp5':item2.amp5,'amp6':item2.amp6,'amp7':item2.amp7,'amp8':item2.amp8,'temperatura':item2.temperatura,'nivel':item2.nivel,'magneto':item2.magneto,'magnetron':item2.magnetron,'transformadorhv':item2.transformadorhv,'diodohv':item2.diodohv,'capacitorhv':item2.capacitorhv,'firma_cliente':item2.firma_cliente,'fecha_cliente':item2.fecha_cliente,'foto_salida':item2.foto_salida};
                                                }
                                                    databaseHandler.db.transaction(
                                                        function(tx){
                                                            tx.executeSql("SELECT * from selectcheck WHERE id_cedula = ?",
                                                                [id_cedula],
                                                                function(tx, results){
                                                                    var length = results.rows.length;
                                                                    for(var i = 0; i< length; i++){
                                                                        var item3 = results.rows.item(i);
                                                                        evidenciaCheckList[i] = {'Valor':i,'fase': item3.fase,'opcion': item3.opcion,'valor': item3.valor};
                                                                    }
                                                                    $.ajax({
                                                                        type: "POST",
                                                                        async : true,
                                                                        url: "http://www.appbennetts.com/FWM2/app/guardarChecklistServInd.php",
                                                                        dataType: 'html',
                                                                        data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'checkList': JSON.stringify(checkList),'evidenciaCheckList': JSON.stringify(evidenciaCheckList)},
                                                                        success: function(respuesta){
                                                                            var respu1 = respuesta.split("._.");
                                                                            var dat1 = respu1[0];
                                                                            var dat2 = respu1[1];
                                                                            if(dat1 == "CEDULA"){
                                                                                if(dat2 > 0){
                                                                                    databaseHandler.db.transaction(
                                                                                        function(tx7){
                                                                                            tx7.executeSql(
                                                                                                "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                [id_cedula],
                                                                                                function(tx7, results){
                                                                                                    localStorage.setItem("sendFlag", 0);
                                                                                                    swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                }
                                                                                            );
                                                                                        }
                                                                                    );
                                                                                }
                                                                            }
                                                                        },
                                                                        error: function(){
                                                                            console.log("Error en la comunicacion");
                                                                        }
                                                                    });
                                                                },
                                                                function(tx, error){
                                                                    console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                }
                                                            );
                                                        },
                                                        function(error){},
                                                        function(){}
                                                    );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                            if(tipo == "AuditoriaTecnico" || tipo == "AuditoriaSupervisorTecnico" || tipo == "AuditoriaLider"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM SV_Fotos WHERE SV_ID_Cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    fotosAuditoria[i] = {'Valor':i,'SV_Recorrido':item2.SV_Recorrido,'SV_Proceso':item2.SV_Proceso,'SV_titulo':item2.SV_titulo,'SV_FechaHora':item2.SV_FechaHora,'SV_Foto':item2.SV_Foto};
                                                }
                                                    databaseHandler.db.transaction(
                                                        function(tx){
                                                            tx.executeSql("SELECT * from Aud_Tec WHERE AT_ID_cedula = ?",
                                                                [id_cedula],
                                                                function(tx, results){
                                                                    var length = results.rows.length;
                                                                    for(var i = 0; i< length; i++){
                                                                        var item3 = results.rows.item(i);
                                                                        auditoriaDatos1[i] = {'Valor':i,'AT_Pregunta': item3.AT_Pregunta,'AT_Resp1': item3.AT_Resp1,'AT_Resp2': item3.AT_Resp2,'AT_Resp3': item3.AT_Resp3,'AT_Resp4': item3.AT_Resp4,'AT_Resp5': item3.AT_Resp5,'AT_Resp6': item3.AT_Resp6,'AT_Resp7': item3.AT_Resp7,'AT_Resp8': item3.AT_Resp8,'AT_Resp9': item3.AT_Resp9,'AT_Resp10': item3.AT_Resp10,'AT_Resp11': item3.AT_Resp11,'AT_Resp12': item3.AT_Resp12,'AT_Resp13': item3.AT_Resp13,'AT_Resp14': item3.AT_Resp14,'AT_Resp15': item3.AT_Resp15,'AT_Resp16': item3.AT_Resp16,'AT_Resp17': item3.AT_Resp17,'AT_Total': item3.AT_Total};
                                                                    }
                                                                    databaseHandler.db.transaction(
                                                                        function(tx){
                                                                            tx.executeSql("SELECT * from Aud_General WHERE AG_ID_cedula = ?",
                                                                                [id_cedula],
                                                                                function(tx, results){
                                                                                    var length = results.rows.length;
                                                                                    for(var i = 0; i< length; i++){
                                                                                        var item3 = results.rows.item(i);
                                                                                        auditoriaDatos2[i] = {'Valor':i,'AG_Auditoria': item3.AG_Auditoria,'AG_CaliGen': item3.AG_CaliGen,'AG_Cali': item3.AG_Cali,'AG_PorcentajeM': item3.AG_PorcentajeM,'AG_Obse': item3.AG_Obse,'AG_correo': item3.AG_correo,'AG_ID_Tecnico': item3.AG_ID_Tecnico,'AG_Tecnico': item3.AG_Tecnico,'AG_Puesto': item3.AG_Puesto};
                                                                                    }
                                                                                    $.ajax({
                                                                                        type: "POST",
                                                                                        async : true,
                                                                                        url: "http://www.appbennetts.com/FWM2/app/guardarAuditoriaServInd.php",
                                                                                        dataType: 'html',
                                                                                        data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'fotosAuditoria': JSON.stringify(fotosAuditoria),'auditoriaDatos1': JSON.stringify(auditoriaDatos1),'auditoriaDatos2': JSON.stringify(auditoriaDatos2)},
                                                                                        success: function(respuesta){
                                                                                            var respu1 = respuesta.split("._.");
                                                                                            var dat1 = respu1[0];
                                                                                            var dat2 = respu1[1];
                                                                                            if(dat1 == "CEDULA"){
                                                                                                if(dat2 > 0){
                                                                                                    databaseHandler.db.transaction(
                                                                                                        function(tx7){
                                                                                                            tx7.executeSql(
                                                                                                                "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                                [id_cedula],
                                                                                                                function(tx7, results){
                                                                                                                    localStorage.setItem("sendFlag", 0);
                                                                                                                    swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                                }
                                                                                                            );
                                                                                                        }
                                                                                                    );
                                                                                                }
                                                                                            }
                                                                                        },
                                                                                        error: function(){
                                                                                            console.log("Error en la comunicacion");
                                                                                        }
                                                                                    });
                                                                                },
                                                                                function(tx, error){
                                                                                    console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                }
                                                                            );
                                                                        },
                                                                        function(error){},
                                                                        function(){}
                                                                    );
                                                                },
                                                                function(tx, error){
                                                                    console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                }
                                                            );
                                                        },
                                                        function(error){},
                                                        function(){}
                                                    );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                        },
                        function(tx, error){
                            console.log("Error al consultar datos generales: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else if(empresa == "Proteus"){
            var datosCedulaGeneral = new Array();
            var cedulageneral = 0;

            var datosGeneralesProteus = new Array();
            var datos_equipos_proteus = new Array();
            var reposicion_proteus = new Array();
            var evidencias_proteus = new Array();
            var fotos_proteus = new Array();
            var check_limpieza = new Array();
            var check_revision = new Array();
            var mmto_correctivo = new Array();

            var tipo = "";
            var fecha = new Date();
            var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var length = results.rows.length;
                            for(var i = 0; i< length; i++){
                                var item = results.rows.item(i);
                                tipo = item.tipo_cedula;
                                datosCedulaGeneral[cedulageneral] = {'Valor':cedulageneral,'id_cedula':item.id_cedula,'tipo_cedula':item.tipo_cedula,'id_usuario':item.id_usuario,'nombre_usuario':item.nombre_usuario,'fecha_entrada':item.fecha_entrada,'geolocalizacion_entrada': item.geolocalizacion_entrada,'id_cliente': item.id_cliente,'nombre_cliente': item.nombre_cliente,'horario_programado': item.horario_programado,'calificacion': item.calificacion,'fecha_salida':item.fecha_salida,'geolocalizacion_salida':item.geolocalizacion_salida,'nombre_evalua':item.nombre_evalua,'comentario_cliente':item.comentario_cliente,'fecha_envio':fecha_envio};
                                cedulageneral++;
                            }
                            if(tipo == "Preventivo"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM datos_generales_proteus WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosGeneralesProteus[i] = {'Valor':i,
                                                    'direccion':item2.direccion,
                                                    'email':item2.email,
                                                    'fecha_cliente':item2.fecha_cliente,
                                                    'firma_cliente':item2.firma_cliente,
                                                    'foto_entrada':item2.foto_entrada,
                                                    'foto_salida':item2.foto_salida,
                                                    'local':item2.local,
                                                    'nombre_contacto':item2.nombre_contacto,
                                                    'orden_servicio':item2.orden_servicio,
                                                    'razon_social':item2.razon_social,
                                                    'ruc':item2.ruc,
                                                    'telefono1':item2.telefono1,
                                                    'telefono2':item2.telefono2,
                                                    'tipo_servicio':item2.tipo_servicio,
                                                    'cargo': item2.cargo,
                                                    'dni':item2.dni};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from datos_equipos_proteus WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    datos_equipos_proteus[i] = {'Valor':i,
                                                                    'id_cliente':item3.id_cliente,
                                                                    'id_equipo':item3.id_equipo,
                                                                    'marca':item3.marca,
                                                                    'modelo':item3.modelo,
                                                                    'ubicacion':item3.ubicacion};
                                                                }
                                                                databaseHandler.db.transaction(
                                                                    function(tx){
                                                                        tx.executeSql("SELECT * from evidencias_proteus WHERE id_cedula = ?",
                                                                            [id_cedula],
                                                                            function(tx, results){
                                                                                var length = results.rows.length;
                                                                                for(var i = 0; i< length; i++){
                                                                                    var item5 = results.rows.item(i);
                                                                                    evidencias_proteus[i] = {'Valor':i,
                                                                                    'comentario': item5.comentario,
                                                                                    'fecha': item5.fecha,
                                                                                    'foto': item5.foto,'page':item5.page};
                                                                                }         
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx){
                                                                                        tx.executeSql("SELECT * from fotos_proteus WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx, results){
                                                                                                var length = results.rows.length;
                                                                                                for(var i = 0; i< length; i++){
                                                                                                    var item6 = results.rows.item(i);
                                                                                                    fotos_proteus[i] = {'Valor':i,
                                                                                                    'apartado': item6.apartado,
                                                                                                    'fase': item6.fase,
                                                                                                    'fecha': item6.fecha,
                                                                                                    'foto': item6.foto};
                                                                                                }
                                                                                                databaseHandler.db.transaction(
                                                                                                    function(tx){
                                                                                                        tx.executeSql("SELECT * from check_limpieza WHERE id_cedula = ?",
                                                                                                            [id_cedula],
                                                                                                            function(tx, results){
                                                                                                                var length = results.rows.length;
                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                    var item7 = results.rows.item(i);
                                                                                                                    check_limpieza[i] = {'Valor':i,
                                                                                                                    'comentarios': item7.comentarios,
                                                                                                                    'componente': item7.componente,
                                                                                                                    'fallos': item7.fallos,
                                                                                                                    'piezas': item7.piezas};
                                                                                                                }
                                                                                                                databaseHandler.db.transaction(
                                                                                                                    function(tx){
                                                                                                                        tx.executeSql("SELECT * from check_revision WHERE id_cedula = ?",
                                                                                                                            [id_cedula],
                                                                                                                            function(tx, results){
                                                                                                                                var length = results.rows.length;
                                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                                    var item8 = results.rows.item(i);
                                                                                                                                    check_revision[i] = {'Valor':i,
                                                                                                                                    'comentarios': item8.comentarios,
                                                                                                                                    'componente': item8.componente,
                                                                                                                                    'fallos': item8.fallos,
                                                                                                                                    'fuente': item8.fuente,
                                                                                                                                    'piezas': item8.piezas,
                                                                                                                                    'observaciones': item8.observaciones};
                                                                                                                                }
                                                                                                                                    $.ajax({
                                                                                                                                        type: "POST",
                                                                                                                                        async : true,
                                                                                                                                        url: "http://www.appbennetts.com/FWM2/app/guradarPreventivoProteus.php",
                                                                                                                                        dataType: 'html',
                                                                                                                                        data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),
                                                                                                                                                 'datosGeneralesProteus': JSON.stringify(datosGeneralesProteus),
                                                                                                                                                 'datos_equipos_proteus': JSON.stringify(datos_equipos_proteus),
                                                                                                                                                 'evidencias_proteus': JSON.stringify(evidencias_proteus),
                                                                                                                                                 'fotos_proteus': JSON.stringify(fotos_proteus),
                                                                                                                                                 'check_limpieza': JSON.stringify(check_limpieza),
                                                                                                                                                 'check_revision': JSON.stringify(check_revision)},
                                                                                                                                        success: function(respuesta){
                                                                                                                                            var respu1 = respuesta.split("._.");
                                                                                                                                            var dat1 = respu1[0];
                                                                                                                                            var dat2 = respu1[1];
                                                                                                                                            if(dat1 == "CEDULA"){
                                                                                                                                                if(dat2 > 0){
                                                                                                                                                    databaseHandler.db.transaction(
                                                                                                                                                        function(tx7){
                                                                                                                                                            tx7.executeSql(
                                                                                                                                                                "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                                                                                [id_cedula],
                                                                                                                                                                function(tx7, results){
                                                                                                                                                                    localStorage.setItem("sendFlag", 0);
                                                                                                                                                                    swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                                                                                }
                                                                                                                                                            );
                                                                                                                                                        }
                                                                                                                                                    );
                                                                                                                                                }
                                                                                                                                            }
                                                                                                                                        },
                                                                                                                                        error: function(){
                                                                                                                                            console.log("Error en la comunicacion");
                                                                                                                                        }
                                                                                                                                    });
                                                                                                                            },
                                                                                                                            function(tx, error){
                                                                                                                                console.log("Error al consultar check_revision: " +error.message);
                                                                                                                            }
                                                                                                                        );
                                                                                                                    },
                                                                                                                    function(error){},
                                                                                                                    function(){}
                                                                                                                );
                                                                                                            },
                                                                                                            function(tx, error){
                                                                                                                console.log("Error al consultar check_limpieza: " +error.message);
                                                                                                            }
                                                                                                        );
                                                                                                    },
                                                                                                    function(error){},
                                                                                                    function(){}
                                                                                                );
                                                                                            },
                                                                                            function(tx, error){
                                                                                                console.log("Error al consultar fotos_proteus: " +error.message);
                                                                                            }
                                                                                        );
                                                                                    },
                                                                                    function(error){},
                                                                                    function(){}
                                                                                );
                                                                            },
                                                                            function(tx, error){
                                                                                console.log("Error al consultar evidencias_proteus: " +error.message);
                                                                            }
                                                                        );
                                                                    },
                                                                    function(error){},
                                                                    function(){}
                                                                );
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar datos_equipos_proteus: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar datos_generales_proteus: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }else if(tipo == "Reposicion"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM datos_generales_proteus WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosGeneralesProteus[i] = {'Valor':i,
                                                    'direccion':item2.direccion,
                                                    'email':item2.email,
                                                    'fecha_cliente':item2.fecha_cliente,
                                                    'firma_cliente':item2.firma_cliente,
                                                    'foto_entrada':item2.foto_entrada,
                                                    'foto_salida':item2.foto_salida,
                                                    'local':item2.local,
                                                    'nombre_contacto':item2.nombre_contacto,
                                                    'orden_servicio':item2.orden_servicio,
                                                    'razon_social':item2.razon_social,
                                                    'ruc':item2.ruc,
                                                    'telefono1':item2.telefono1,
                                                    'telefono2':item2.telefono2,
                                                    'tipo_servicio':item2.tipo_servicio,
                                                    'cargo': item2.cargo,
                                                    'dni':item2.dni};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from datos_equipos_proteus WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    datos_equipos_proteus[i] = {'Valor':i,
                                                                    'id_cliente':item3.id_cliente,
                                                                    'id_equipo':item3.id_equipo,
                                                                    'marca':item3.marca,
                                                                    'modelo':item3.modelo,
                                                                    'ubicacion':item3.ubicacion};
                                                                }
                                                                databaseHandler.db.transaction(
                                                                    function(tx){
                                                                        tx.executeSql("SELECT * from reposicion_proteus WHERE id_cedula = ?",
                                                                            [id_cedula],
                                                                            function(tx, results){
                                                                                var length = results.rows.length;
                                                                                for(var i = 0; i< length; i++){
                                                                                    var item4 = results.rows.item(i);
                                                                                    reposicion_proteus[i] = {'Valor':i,
                                                                                    'kit_micro': item4.kit_micro,
                                                                                    'micro_activados': item4.micro_activados,
                                                                                    'nivelador': item4.nivelador,
                                                                                    'observaciones': item4.observaciones};
                                                                                }
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx){
                                                                                        tx.executeSql("SELECT * from evidencias_proteus WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx, results){
                                                                                                var length = results.rows.length;
                                                                                                for(var i = 0; i< length; i++){
                                                                                                    var item5 = results.rows.item(i);
                                                                                                    evidencias_proteus[i] = {'Valor':i,
                                                                                                    'comentario': item5.comentario,
                                                                                                    'fecha': item5.fecha,
                                                                                                    'foto': item5.foto, 'page': item5.page};
                                                                                                }
                                                                                                $.ajax({
                                                                                                    type: "POST",
                                                                                                    async : true,
                                                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarReposicionProteus.php",
                                                                                                    dataType: 'html',
                                                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),
                                                                                                             'datosGeneralesProteus': JSON.stringify(datosGeneralesProteus),
                                                                                                             'datos_equipos_proteus': JSON.stringify(datos_equipos_proteus),
                                                                                                             'reposicion_proteus': JSON.stringify(reposicion_proteus),
                                                                                                             'evidencias_proteus': JSON.stringify(evidencias_proteus)},
                                                                                                    success: function(respuesta){
                                                                                                        var respu1 = respuesta.split("._.");
                                                                                                        var dat1 = respu1[0];
                                                                                                        var dat2 = respu1[1];
                                                                                                        if(dat1 == "CEDULA"){
                                                                                                            if(dat2 > 0){
                                                                                                                databaseHandler.db.transaction(
                                                                                                                    function(tx7){
                                                                                                                        tx7.executeSql(
                                                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                                            [id_cedula],
                                                                                                                            function(tx7, results){
                                                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                                            }
                                                                                                                        );
                                                                                                                    }
                                                                                                                );
                                                                                                            }
                                                                                                        }
                                                                                                    },
                                                                                                    error: function(){
                                                                                                        console.log("Error en la comunicacion");
                                                                                                    }
                                                                                                });
                                                                                            },
                                                                                            function(tx, error){
                                                                                                console.log("Error al consultar evidencias_proteus: " +error.message);
                                                                                            }
                                                                                        );
                                                                                    },
                                                                                    function(error){},
                                                                                    function(){}
                                                                                );
                                                                            },
                                                                            function(tx, error){
                                                                                console.log("Error al consultar reposicion_proteus: " +error.message);
                                                                            }
                                                                        );
                                                                    },
                                                                    function(error){},
                                                                    function(){}
                                                                );
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar datos_equipos_proteus: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar datos_generales_proteus: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }else if(tipo == "Correctivo"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM datos_generales_proteus WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosGeneralesProteus[i] = {'Valor':i,
                                                    'direccion':item2.direccion,
                                                    'email':item2.email,
                                                    'fecha_cliente':item2.fecha_cliente,
                                                    'firma_cliente':item2.firma_cliente,
                                                    'foto_entrada':item2.foto_entrada,
                                                    'foto_salida':item2.foto_salida,
                                                    'local':item2.local,
                                                    'nombre_contacto':item2.nombre_contacto,
                                                    'orden_servicio':item2.orden_servicio,
                                                    'razon_social':item2.razon_social,
                                                    'ruc':item2.ruc,
                                                    'telefono1':item2.telefono1,
                                                    'telefono2':item2.telefono2,
                                                    'tipo_servicio':item2.tipo_servicio,
                                                    'cargo': item2.cargo,
                                                    'dni':item2.dni};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from datos_equipos_proteus WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    datos_equipos_proteus[i] = {'Valor':i,
                                                                    'id_cliente':item3.id_cliente,
                                                                    'id_equipo':item3.id_equipo,
                                                                    'marca':item3.marca,
                                                                    'modelo':item3.modelo,
                                                                    'ubicacion':item3.ubicacion};
                                                                }
                                                                databaseHandler.db.transaction(
                                                                    function(tx){
                                                                        tx.executeSql("SELECT * from evidencias_proteus WHERE id_cedula = ?",
                                                                            [id_cedula],
                                                                            function(tx, results){
                                                                                var length = results.rows.length;
                                                                                for(var i = 0; i< length; i++){
                                                                                    var item5 = results.rows.item(i);
                                                                                    evidencias_proteus[i] = {'Valor':i,
                                                                                    'comentario': item5.comentario,
                                                                                    'fecha': item5.fecha,
                                                                                    'foto': item5.foto, 'page':item5.page};
                                                                                }         
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx){
                                                                                        tx.executeSql("SELECT * from mmto_correctivo WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx, results){
                                                                                                var length = results.rows.length;
                                                                                                for(var i = 0; i< length; i++){
                                                                                                    var item9 = results.rows.item(i);
                                                                                                    mmto_correctivo[i] = {'Valor':i,
                                                                                                    'funcionamiento': item9.funcionamiento,
                                                                                                    'reparacion': item9.reparacion};
                                                                                                }
                                                                                                $.ajax({
                                                                                                    type: "POST",
                                                                                                    async : true,
                                                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarCorrectivoProteus.php",
                                                                                                    dataType: 'html',
                                                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),
                                                                                                             'datosGeneralesProteus': JSON.stringify(datosGeneralesProteus),
                                                                                                             'datos_equipos_proteus': JSON.stringify(datos_equipos_proteus),
                                                                                                             'evidencias_proteus': JSON.stringify(evidencias_proteus),
                                                                                                             'mmto_correctivo': JSON.stringify(mmto_correctivo)
                                                                                                            },
                                                                                                    success: function(respuesta){
                                                                                                        var respu1 = respuesta.split("._.");
                                                                                                        var dat1 = respu1[0];
                                                                                                        var dat2 = respu1[1];
                                                                                                        if(dat1 == "CEDULA"){
                                                                                                            if(dat2 > 0){
                                                                                                                databaseHandler.db.transaction(
                                                                                                                    function(tx7){
                                                                                                                        tx7.executeSql(
                                                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                                            [id_cedula],
                                                                                                                            function(tx7, results){
                                                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                                            }
                                                                                                                        );
                                                                                                                    }
                                                                                                                );
                                                                                                            }
                                                                                                        }
                                                                                                    },
                                                                                                    error: function(){
                                                                                                        console.log("Error en la comunicacion");
                                                                                                    }
                                                                                                });
                                                                                            },
                                                                                            function(tx, error){
                                                                                                console.log("Error al consultar mmto_correctivo: " +error.message);
                                                                                            }
                                                                                        );
                                                                                    },
                                                                                    function(error){},
                                                                                    function(){}
                                                                                );
                                                                            },
                                                                            function(tx, error){
                                                                                console.log("Error al consultar evidencias_proteus: " +error.message);
                                                                            }
                                                                        );
                                                                    },
                                                                    function(error){},
                                                                    function(){}
                                                                );
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar datos_equipos_proteus: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar datos_generales_proteus: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }else if(tipo == "Instalacion"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM datos_generales_proteus WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosGeneralesProteus[i] = {'Valor':i,
                                                    'direccion':item2.direccion,
                                                    'email':item2.email,
                                                    'fecha_cliente':item2.fecha_cliente,
                                                    'firma_cliente':item2.firma_cliente,
                                                    'foto_entrada':item2.foto_entrada,
                                                    'foto_salida':item2.foto_salida,
                                                    'local':item2.local,
                                                    'nombre_contacto':item2.nombre_contacto,
                                                    'orden_servicio':item2.orden_servicio,
                                                    'razon_social':item2.razon_social,
                                                    'ruc':item2.ruc,
                                                    'telefono1':item2.telefono1,
                                                    'telefono2':item2.telefono2,
                                                    'tipo_servicio':item2.tipo_servicio,
                                                    'cargo': item2.cargo,
                                                    'dni':item2.dni};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from datos_equipos_proteus WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    datos_equipos_proteus[i] = {'Valor':i,
                                                                    'id_cliente':item3.id_cliente,
                                                                    'id_equipo':item3.id_equipo,
                                                                    'marca':item3.marca,
                                                                    'modelo':item3.modelo,
                                                                    'ubicacion':item3.ubicacion};
                                                                }
                                                                databaseHandler.db.transaction(
                                                                    function(tx){
                                                                        tx.executeSql("SELECT * from evidencias_proteus WHERE id_cedula = ?",
                                                                            [id_cedula],
                                                                            function(tx, results){
                                                                                var length = results.rows.length;
                                                                                for(var i = 0; i< length; i++){
                                                                                    var item5 = results.rows.item(i);
                                                                                    evidencias_proteus[i] = {'Valor':i,
                                                                                    'comentario': item5.comentario,
                                                                                    'fecha': item5.fecha,
                                                                                    'foto': item5.foto, 'page':item5.page};
                                                                                }
                                                                                $.ajax({
                                                                                    type: "POST",
                                                                                    async : true,
                                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarInstalacionProteus.php",
                                                                                    dataType: 'html',
                                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),
                                                                                             'datosGeneralesProteus': JSON.stringify(datosGeneralesProteus),
                                                                                             'evidencias_proteus': JSON.stringify(evidencias_proteus),
                                                                                             'datos_equipos_proteus': JSON.stringify(datos_equipos_proteus)
                                                                                            },
                                                                                    success: function(respuesta){
                                                                                        var respu1 = respuesta.split("._.");
                                                                                        var dat1 = respu1[0];
                                                                                        var dat2 = respu1[1];
                                                                                        if(dat1 == "CEDULA"){
                                                                                            if(dat2 > 0){
                                                                                                databaseHandler.db.transaction(
                                                                                                    function(tx7){
                                                                                                        tx7.executeSql(
                                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                            [id_cedula],
                                                                                                            function(tx7, results){
                                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                            }
                                                                                                        );
                                                                                                    }
                                                                                                );
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    error: function(){
                                                                                        console.log("Error en la comunicacion");
                                                                                    }
                                                                                });
                                                                            },
                                                                            function(tx, error){
                                                                                console.log("Error al consultar evidencias_proteus: " +error.message);
                                                                            }
                                                                        );
                                                                    },
                                                                    function(error){},
                                                                    function(){}
                                                                );
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar datos_equipos_proteus: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar datos_generales_proteus: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                        },
                        function(tx, error){
                            console.log("Error al consultar cedulas generales: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );

        } else {
            var datosCedulaGeneral = new Array();
            var cedulageneral = 0;

            var datosSanitizacion = new Array();
            var evidenciaSanitizacion = new Array();
            var sanitizacion = 0;
            var evidenciaSani = 0;

            var datosLevantamiento = new Array();
            var evidenciaLevantamiento = new Array();
            var levantamiento = 0;
            var evidencialeva = 0;

            var datosFumigacion = new Array();
            var evidenciaFumigacion = new Array();
            var fumigacion = 0;
            var evidenciafumi = 0;

            var tipo = "";
            var fecha = new Date();
            var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var length = results.rows.length;
                            for(var i = 0; i< length; i++){
                                var item = results.rows.item(i);
                                tipo = item.tipo_cedula;
                                datosCedulaGeneral[cedulageneral] = {'Valor':cedulageneral,'id_cedula':item.id_cedula,'tipo_cedula':item.tipo_cedula,'id_usuario':item.id_usuario,'nombre_usuario':item.nombre_usuario,'fecha_entrada':item.fecha_entrada,'geolocalizacion_entrada': item.geolocalizacion_entrada,'id_cliente': item.id_cliente,'nombre_cliente': item.nombre_cliente,'horario_programado': item.horario_programado,'calificacion': item.calificacion,'fecha_salida':item.fecha_salida,'geolocalizacion_salida':item.geolocalizacion_salida,'nombre_evalua':item.nombre_evalua,'comentario_cliente':item.comentario_cliente,'fecha_envio':fecha_envio};
                                cedulageneral++;
                            }
                            if(tipo == "sanitizacion"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM sanitizacion WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosSanitizacion[sanitizacion] = {'Valor':sanitizacion,'id_sanitizacion': item2.id_sanitizacion,'id_cedula': item2.id_cedula,'foto_entrada':item2.foto_entrada,'sucursal':item2.sucursal,'direccion':item2.direccion,'persona_recibe':item2.persona_recibe,'documento_ingresar':item2.documento_ingresar,'descripcion_antes':item2.descripcion_antes,'foto_quimico':item2.foto_quimico,'foto_equipo':item2.foto_equipo,'areas_despejadas':item2.areas_despejadas,'descripcion_durante':item2.descripcion_durante,'descripcion_despues':item2.descripcion_despues,'foto_reporte':item2.foto_reporte,'recomendaciones':item2.recomendaciones,'firma_evalua':item2.firma_evalua,'fecha_firma':item2.fecha_firma,'foto_salida':item2.foto_salida,'fecha_envio':fecha_envio};
                                                    sanitizacion++;
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from fotos_sanitizacion WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                var fecha = new Date();
                                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    evidenciaSanitizacion[evidenciaSani] = {'Valor':evidenciaSani,'id_sanitizacion_foto': item3.id_sanitizacion_foto,'id_cedula': item3.id_cedula,'fase':item3.fase,'foto_area':item3.foto_area,'nombre_area':item3.nombre_area,'fecha_foto':item3.fecha_foto,'fecha_envio':fecha_envio};
                                                                    evidenciaSani++;
                                                                }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarSanitizacion.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'datosSanitizacion': JSON.stringify(datosSanitizacion),'evidenciaSanitizacion': JSON.stringify(evidenciaSanitizacion)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                            if(tipo == "levantamiento"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM levantamiento_servicio WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosLevantamiento[levantamiento] = {'Valor':levantamiento,'id_cedula':item2.id_cedula,'foto_entrada':item2.foto_entrada,'nombre_cliente':item2.nombre_cliente,'direccion':item2.direccion,'colonia':item2.colonia,'revision':item2.revision,'grado_infeccion':item2.grado_infeccion,'descripcion':item2.descripcion,'comentarios_tecnico':item2.comentarios_tecnico,'firma_cliente':item2.firma_cliente,'fecha_cliente':item2.fecha_cliente,'foto_salida':item2.foto_salida,'fecha_envio':fecha_envio};
                                                    levantamiento++;
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from levantamiento_evidencia WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                var fecha = new Date();
                                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    evidenciaLevantamiento[evidencialeva] = {'Valor':evidencialeva,'id_cedula': item3.id_cedula,'area': item3.area,'foto_plaga': item3.foto_plaga,'descripcion_plaga': item3.descripcion_plaga,'observacion': item3.observacion,'fecha_regristro': item3.fecha_regristro,'fecha_envio':fecha_envio};
                                                                    evidencialeva++;
                                                                }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarLevantamiento.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'datosLevantamiento': JSON.stringify(datosLevantamiento),'evidenciaLevantamiento': JSON.stringify(evidenciaLevantamiento)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                            if(tipo == "fumigacion"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM fumigacion WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosFumigacion[fumigacion] = {'Valor':fumigacion,'foto_entrada': item2.foto_entrada,'sucursal': item2.sucursal,'direccion': item2.direccion,'persona_recibe': item2.persona_recibe,'documento_ingresar': item2.documento_ingresar,'alcance_servicio': item2.alcance_servicio,'foto_quimico': item2.foto_quimico,'foto_equipo': item2.foto_equipo,'descripcion_antes': item2.descripcion_antes,'descripcion_durante': item2.descripcion_durante,'descripcion_despues': item2.descripcion_despues,'foto_reporte': item2.foto_reporte,'producto_utilizado': item2.producto_utilizado,'tipo_aplicacion': item2.tipo_aplicacion,'descripcion_tipo': item2.descripcion_tipo,'grado_infestacion': item2.grado_infestacion,'descripcion_infestacion': item2.descripcion_infestacion,'mantenimiento': item2.mantenimiento,'detalle_mantenimiento': item2.detalle_mantenimiento,'recomendaciones': item2.recomendaciones,'firma_evalua': item2.firma_evalua,'fecha_firma': item2.fecha_firma,'foto_salida': item2.foto_salida,'fecha_envio':fecha_envio};
                                                    fumigacion++;
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from fotos_fumigacion WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                var fecha = new Date();
                                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    evidenciaFumigacion[evidenciafumi] = {'Valor':evidenciafumi,'fase': item3.fase,'foto_area': item3.foto_area,'nombre_area':item3.nombre_area,'fecha_foto':item3.fecha_foto,'fecha_envio':fecha_envio};
                                                                    evidenciafumi++;
                                                                }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarFumigacion.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'datosFumigacion': JSON.stringify(datosFumigacion),'evidenciaFumigacion': JSON.stringify(evidenciaFumigacion)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    });
                                                                            }
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                        },
                        function(tx, error){
                            console.log("Error al consultar datos generales: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    // AyB Fin
    //Suro Inicio
    function buscarClienteSURO(){
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_cliente = $("#id_cliente").val();
        var horario_programado = fecha_llegada;
        var foto_llegada = $("#imagenC").val();
        var nombre_cliente = $("#Nombre").val() + " " + $("#Sucursal").val();
        var Sucursal = $("#Sucursal").val();
        var Direccion = $("#Direccion").val();
        var correo = $("#correo").val();
        var estatus = 0;
        if(foto_llegada != ''){
            if(nombre_cliente != ''){
                if(nombre_cliente != ' '){
                    productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                                [],
                                function(tx, results){
                                    var item = results.rows.item(0);
                                    localStorage.setItem("IdCedula", item.Id);
                                    localStorage.setItem("nombreCliente", nombre_cliente);
                                    localStorage.setItem("foto_llegada", foto_llegada);
                                    localStorage.setItem("sucursal", Sucursal);
                                    localStorage.setItem("direccion", Direccion);
                                    localStorage.setItem("correo", correo);
                                    app.views.main.router.navigate({name: 'menuSURO'});
                                    app.preloader.hide();
                                },
                                function(tx, error){
                                    console.log("Error al guardar cedula: " + error.message);
                                    app.preloader.hide();
                                }
                            );
                        },
                        function(error){},
                        function(){}
                    );
                }else {
                    swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
                    app.preloader.hide();
                }
            } else {
                swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        } else {
            swal("Falta un campo", "La fotograf√≠a es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }
    }
    function generarSanitizacionSURO(){
        let id_cedula = localStorage.getItem("IdCedula");
        let nombre_cliente = localStorage.getItem("nombreCliente");
        let nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let tipoCedula = "sanitizacionSURO";
        let direccion = localStorage.getItem("direccion");
        let correo = localStorage.getItem("correo");
        let sucursal = localStorage.getItem("sucursal");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addSanitizacionSURO(id_cedula,foto_llegada,nombre_cliente,nombre_usuario,sucursal,direccion,correo);
                        productHandler.groupInit(id_cedula);
                        app.views.main.router.back('/recorridoSURO/', {force: true, ignoreCache: true, reload: true});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDatosSURO(){
        app.preloader.show('blue');
        if($("#nombreCliente").val() =="" || $("#sucursal").val() == "" || $("#direccion").val() == "" || $("#correo").val() == "" || $("#tecnico").val() == ""){
            swal("", "Debes llenar todos los campos" ,"warning");
            app.preloader.hide();
            return false;
        }
        var cliente = $("#nombreCliente").val();
        var sucursal = $("#sucursal").val();
        var direccion = $("#direccion").val();
        var correo = $("#correo").val();
        // var tipo_servicio = $("#servicio").val();
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE sanitizacion_Suro SET nombre_cliente = ?,sucursal = ?,direccion = ?,correo = ?, nombre_usuario =?  WHERE id_cedula = ?",
                    [cliente,sucursal,direccion,correo, nombre_usuario, id_cedula],
                    function(tx, results){
                        $("#nombreCliente").css("background-color", "#FFFFFF");
                        $("#sucursal").css("background-color", "#FFFFFF");
                        $("#direccion").css("background-color", "#FFFFFF");
                        $("#correo").css("background-color", "#FFFFFF");
                        // $("#servicio").css("background-color", "#FFFFFF");
                        swal("", "Se guardaron los datos correctamente" ,"success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function a√±adirGrupoSuro(grupo) {
        console.log(grupo)
        var id_cedula = localStorage.getItem("IdCedula",id_cedula);
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("Select MAX(indice) as Id from grupos WHERE id_cedula = ? AND fases = ?",
                    [id_cedula,grupo],
                    function(tx, results){
                        var item = results.rows.item(0);
                        var id_evidencia = item.Id;
                        id_evidencia = (id_evidencia + 1);
                        var nameaGroup = "Grupo " + id_evidencia; 
                        app.preloader.hide();
                        //Agregar nuevo grupo
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("insert into grupos(id_cedula,nombre_grupo,fases,indice) values(?,?,?,?)",
                                [id_cedula,nameaGroup,grupo,id_evidencia],
                                    function(tx, results){
                                        $('#grupo').prepend("<option value='"+ nameaGroup +"' >" + nameaGroup + "</option>");
                                        swal("","El grupo fue agregado correctamente","success");
                                        $("#grupo option[value='"+ nameaGroup +"']").attr("selected",true);
                                    },
                                    function(tx, error){
                                        console.log("Error al guardar cedula: " + error.message);
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al mostrar Registro guardado",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function regresarRecorridoSURO(){
        app.views.main.router.back('/recorridoSURO/', {force: true, ignoreCache: true, reload: true});
    }
    function startFromProgramSURO(nombre_comercial,sucursal,direccion,correo,id_cliente){
        localStorage.setItem("nombreCliente", nombre_comercial);
        localStorage.setItem("sucursal", sucursal);
        localStorage.setItem("id_cliente", id_cliente);
        localStorage.setItem("direccion", direccion);
        localStorage.setItem("correo", correo);
        app.views.main.router.navigate({name: 'yallegueSURO2'});
    }
    function iniciarClienteSURO(){
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_cliente = localStorage.getItem("id_cliente");
        var horario_programado = fecha_llegada;
        var foto_llegada = $("#imagenC").val();
        let tipoCedula = "sanitizacionSURO";
        var nombre_cliente = localStorage.getItem("nombreCliente") + " " + localStorage.getItem("sucursal");
        var sucursal = localStorage.getItem("sucursal");
        var direccion = localStorage.getItem("direccion");
        var correo = localStorage.getItem("correo");
        var estatus = 0;
        if(foto_llegada != ''){
            if(nombre_cliente != ''){
                productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                            [],
                            function(tx, results){
                                var item = results.rows.item(0);
                                var id_cedula = item.Id;
                                localStorage.setItem("IdCedula", item.Id);
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                            [tipoCedula,id_cedula],
                                            function(tx, results){
                                                productHandler.addSanitizacionSURO(id_cedula,foto_llegada,nombre_cliente,nombre_usuario,sucursal,direccion,correo);
                                                productHandler.groupInit(id_cedula);
                                                app.views.main.router.back('/recorridoSURO/', {force: true, ignoreCache: true, reload: true});
                                            },
                                            function(tx, error){
                                                console.error("Error al actualizar el tipo de cedula: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                                app.preloader.hide();
                            },
                            function(tx, error){
                                console.log("Error al guardar cedula: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            } else {
                swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        } else {
            swal("Falta un campo", "La fotograf√≠a es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }
    }
    function guardarCierreSanitizacionSURO(){
        if($("#NombreFirma").val() == "" || $("#puesto").val() == "" || $("#signate").val() == "" || $("#eval").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        if($("#eval").val() <= '3' && $("#comentario_cliente").val() == ""){
            swal("","Por favor, ingresa el motivo de tu calificacion","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var calificacion = $("#eval").val();
        var puesto = $("#puesto").val();
        var comentarioCliente = $('#comentario_cliente').val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE sanitizacion_Suro SET firma_cliente = ?,fecha_cliente = ?,puesto = ? WHERE id_cedula = ?",
                    [firmaCliente,fecha_firma,puesto,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                    [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoySanitizacionSURO/', {force: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarSanitizacionSURO(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE sanitizacion_Suro SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function eliminarFilaSURO(index, opc){
        if(opc == 1) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM evidencia WHERE id_evidencia = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimino satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 2) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM Fotos_SURO WHERE id_fotos = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimino satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function alertNotReadySURO(){
        var antes = $('#img2').prop('src');
        if(antes.includes("2")){
            
        } else {
            swal("","Debes llenar el apartado de ANTES, para poder ingresar a este apartado.","warning");
        }
    }
    function generarRecorridoSURO(){
        let id_cedula = localStorage.getItem("IdCedula");
        let nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        let puesto =localStorage.getItem("rol");
        let tipoCedula = "recorridoSURO";
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        let foto_llegada = localStorage.getItem("foto_llegada");
        let titulo = 'Foto de entrada R';
        let proceso = 100;
        let recorrido = 100;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql(
                    "INSERT INTO Recorrido_SURO(id_cedula,Nombre_remitente,fecha_envio,ubicacion,puesto_re) values(?,?,?,?,?)",
                    [id_cedula,nombre_usuario,fecha_llegada,geolocation,puesto],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                    [tipoCedula,id_cedula],
                                    function(tx, results){
                                        console.log(id_cedula,foto_llegada,titulo,fecha_llegada,proceso,recorrido)
                                        productHandler.addfotoSURO(id_cedula,foto_llegada,titulo,fecha_llegada,proceso,recorrido);

                                        app.views.main.router.back('/recorridoSURO1/', {force: true, ignoreCache: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        
                        console.log("Registro de Recorrido_SURO creado exitosamente");
                    },
                    function(tx, error){
                        console.error("Error al registrar el Recorrido_SURO:" + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function generarVisitaSURO(){
        let id_cedula = localStorage.getItem("IdCedula");
        let nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        let tipoCedula = "visitaSURO";
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate();
        var geolocation = $("#geolocation").val();        
        let foto_llegada = localStorage.getItem("foto_llegada");
        let titulo = 'Foto de entrada V';
        let proceso = 400;
        let recorrido = 400;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql(
                    "insert into Visita_SURO(id_cedula,Nombre_remitente, fecha_envio,ubicacion) values(?,?,?,?)",
                    [id_cedula,nombre_usuario,fecha_llegada,geolocation],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                    [tipoCedula,id_cedula],
                                    function(tx, results){
                                        productHandler.addfotoSURO(id_cedula,foto_llegada,titulo,fecha_llegada,proceso,recorrido);
                                        app.views.main.router.back('/recorridoSURO2/', {force: true, ignoreCache: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        
                        console.log("Registro de Visita_SURO creado exitosamente");
                    },
                    function(tx, error){
                        console.error("Error al registrar el Visita_SURO:" + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function generarEncuestaSURO(){
        let id_cedula = localStorage.getItem("IdCedula");
        let nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        let tipoCedula = "encuestaSURO";
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate();
        var geolocation = $("#geolocation").val();
        let foto_llegada = localStorage.getItem("foto_llegada");
        let titulo = 'Foto de entrada E';
        let proceso = 700;
        let recorrido = 700;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql(
                    "insert into Encuesta_SURO(id_cedula,Nombre_remitente, fecha_envio,ubicacion) values(?,?,?,?)",
                    [id_cedula,nombre_usuario,fecha_llegada,geolocation],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                    [tipoCedula,id_cedula],
                                    function(tx, results){
                                        productHandler.addfotoSURO(id_cedula,foto_llegada,titulo,fecha_llegada,proceso,recorrido);

                                        app.views.main.router.back('/recorridoSURO3/', {force: true, ignoreCache: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                       
                        console.log("Registro de Visita_SURO creado exitosamente");
                    },
                    function(tx, error){
                        console.error("Error al registrar el Visita_SURO:" + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );

    }
    function generarVisitaBSURO(){
        let id_cedula = localStorage.getItem("IdCedula");
        let nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        let tipoCedula = "visitaBSURO";
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate();
        var geolocation = $("#geolocation").val();
        let foto_llegada = localStorage.getItem("foto_llegada");
        let titulo = 'Foto de entrada VB';
        let proceso = 400;
        let recorrido = 400;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql(
                    "insert into VisitaB_SURO(id_cedula,responsable,fecha) values(?,?,?)",
                    [id_cedula,nombre_usuario,fecha_llegada],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                    [tipoCedula,id_cedula],
                                    function(tx, results){
                                        productHandler.addfotoSURO(id_cedula,foto_llegada,titulo,fecha_llegada,proceso,recorrido);

                                        app.views.main.router.back('/recorridoSURO4/', {force: true, ignoreCache: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                       
                        console.log("Registro de Visita_SUROB creado exitosamente");
                    },
                    function(tx, error){
                        console.error("Error al registrar el Visita_SUROB:" + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );

    }
    function generarSeguimientoSURO(){
        let id_cedula = localStorage.getItem("IdCedula");
        let nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        let tipoCedula = "seguimientoSURO";
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate();
        var geolocation = $("#geolocation").val();
        let foto_llegada = localStorage.getItem("foto_llegada");
        let titulo = 'Foto de entrada S';
        let proceso = 500;
        let recorrido = 500;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql(
                    "insert into Seguimiento(id_cedula,fecha) values(?,?)",
                    [id_cedula,fecha_llegada],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                    [tipoCedula,id_cedula],
                                    function(tx, results){
                                        productHandler.addfotoSURO(id_cedula,foto_llegada,titulo,fecha_llegada,proceso,recorrido);

                                        app.views.main.router.back('/recorridoSURO5/', {force: true, ignoreCache: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                       
                        console.log("Registro de Seguimiento creado exitosamente");
                    },
                    function(tx, error){
                        console.error("Error al registrar el Seguimiento:" + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function encuestaSURO(elem,val){
        console.log('elemento',elem);
        console.log('val',val);
        if(elem == 1){
            if(val <= 4){
                $('#comentario1').css('display','block');
            }else{
                $('#comentario1').css('display','none');
            }
        }else if(elem == 2){
            if(val <= 4){
                $('#comentario2').css('display','block');
            }else{
                $('#comentario2').css('display','none');
            }
        }else if(elem == 3){
            if(val <= 4){
                $('#comentario3').css('display','block');
            }else{
                $('#comentario3').css('display','none');
            }
        }else if(elem == 4){
            if(val <= 4){
                $('#comentario4').css('display','block');
            }else{
                $('#comentario4').css('display','none');
            }
        }else if(elem == 5){
            if(val <= 4){
                $('#comentario5').css('display','block');
            }else{
                $('#comentario5').css('display','none');
            }
        }else if(elem == 6){
            if(val <= 4){
                $('#comentario6').css('display','block');
            }else{
                $('#comentario6').css('display','none');
            }
        }else if(elem == 7){
            if(val <= 4){
                $('#comentario7').css('display','block');
            }else{
                $('#comentario7').css('display','none');
            }
        }
    }

    function continuarCedSURO(id_cedula,tipo){
        localStorage.setItem("IdCedula",id_cedula);
        localStorage.setItem("Opcion", '1');
        if(tipo == 1){
            app.views.main.router.navigate({ name: 'recorridoSURO'});
        }else if(tipo == 2){
            app.views.main.router.navigate({ name: 'recorridoSURO1'});
        }else if(tipo == 3){
            app.views.main.router.navigate({ name: 'recorridoSURO2'});
        }else if(tipo == 4){
            app.views.main.router.navigate({ name: 'recorridoSURO3'});
        }else if(tipo == 5){
            app.views.main.router.navigate({ name: 'recorridoSURO4'});
        }else if(tipo == 6){
            app.views.main.router.navigate({ name: 'recorridoSURO5'});
        }
    }
    function guardarCierreSURO1(){
        if($("#NombreFirma").val() == "" || $("#puesto").val() == "" || $("#signate").val() == ""  ){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        var puesto = $("#puesto").val();
        var nom_cliente = $("#NombreFirma").val();
        var titulo = 'Firma Cliente R'
        var id_cedula = localStorage.getItem("IdCedula");
        var foto = $('#signate').val();
        var fecha = new Date();
        var fecha_E = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var proceso= 200;
        var recorrido = 200; 
        productHandler.addfotoSURO(id_cedula,foto,titulo,fecha_E,proceso,recorrido);
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE Recorrido_SURO SET puesto = ?,nombre_cliente = ? WHERE id_cedula = ?",
                    [puesto,nom_cliente,id_cedula],
                    function(tx, results){
                        swal("","Guardado correctamente","success");
                        app.views.main.router.back('/yamevoySURO1/', {force: true, reload: true});
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
       

    }
    function guardarCierreSURO2(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == ""  ){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        var nom_cliente = $("#NombreFirma").val();
        var titulo = 'Firma Cliente V'
        var id_cedula = localStorage.getItem("IdCedula");
        var foto = $('#signate').val();
        var fecha = new Date();
        var fecha_E = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var proceso= 500;
        var recorrido = 500; 
        productHandler.addfotoSURO(id_cedula,foto,titulo,fecha_E,proceso,recorrido);
        
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE Visita_SURO SET nombre_cliente = ? WHERE id_cedula = ?",
                    [nom_cliente,id_cedula],
                    function(tx, results){
                        swal("","Guardado correctamente","success");
                        app.views.main.router.back('/yamevoySURO2/', {force: true, reload: true});
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );

    }
    function guardarCierreSURO3(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == ""  ){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        var nom_cliente = $("#NombreFirma").val();
        var titulo = 'Firma Cliente E'
        var id_cedula = localStorage.getItem("IdCedula");
        var foto = $('#signate').val();
        var fecha = new Date();
        var fecha_E = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var proceso= 800;
        var recorrido = 800; 
        productHandler.addfotoSURO(id_cedula,foto,titulo,fecha_E,proceso,recorrido);       
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE Encuesta_SURO SET nombre_cliente = ? WHERE id_cedula = ?",
                    [nom_cliente,id_cedula],
                    function(tx, results){
                        swal("","Guardado correctamente","success");
                        app.views.main.router.back('/yamevoySURO3/', {force: true, reload: true});
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );

    }
    function guardarCierreSURO4(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == ""  ){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        var nom_cliente = $("#NombreFirma").val();
        var titulo = 'Firma Cliente VB'
        var id_cedula = localStorage.getItem("IdCedula");
        var foto = $('#signate').val();
        var fecha = new Date();
        var fecha_E = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var proceso= 1000;
        var recorrido = 1000; 
        productHandler.addfotoSURO(id_cedula,foto,titulo,fecha_E,proceso,recorrido);       
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE VisitaB_SURO SET nombre_cliente = ? WHERE id_cedula = ?",
                    [nom_cliente,id_cedula],
                    function(tx, results){
                        swal("","Guardado correctamente","success");
                        app.views.main.router.back('/yamevoySURO4/', {force: true, reload: true});
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );

    }
    function guardarCierreSURO5(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == ""  ){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        var nom_cliente = $("#NombreFirma").val();
        var titulo = 'Firma Cliente S'
        var id_cedula = localStorage.getItem("IdCedula");
        var foto = $('#signate').val();
        var fecha = new Date();
        var fecha_E = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var proceso= 1200;
        var recorrido = 1200; 
        productHandler.addfotoSURO(id_cedula,foto,titulo,fecha_E,proceso,recorrido);       
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE Seguimiento SET nombre_cliente = ? WHERE id_cedula = ?",
                    [nom_cliente,id_cedula],
                    function(tx, results){
                        swal("","Guardado correctamente","success");
                        app.views.main.router.back('/yamevoySURO5/', {force: true, reload: true});
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );

    }
    function CierreSeguimientoSURO(){
        var id_cedula = localStorage.getItem("IdCedula");
        let com = $("#comentarios").val();
        let comp = $("#compromisos").val();
        if(com && comp){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE Seguimiento SET comentarios  = ?,observacion = ? WHERE id_cedula = ?",
                    [com,comp,id_cedula],
                        function(tx, results){
                            swal("","Evaluacion fue guardada correctamente","success");
                        },
                        function(tx, error){
                            console.log("Error al guardar cedula: " + error.message);
                            app.preloader.hide();
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else{
            swal("","Los campos son obligatorios","warning");
            return false;
        }  
    }
    function guardarEncustaSURO(){
        let res1 =  $( "select#select1 option:checked" ).val();
        let res2 =  $( "select#select2 option:checked" ).val();
        let res3 =  $( "select#select3 option:checked" ).val();
        let res4 =  $( "select#select4 option:checked" ).val();
        let res5 =  $( "select#select5 option:checked" ).val();
        let res6 =  $( "select#select6 option:checked" ).val();
        let res7 =  $( "select#select7 option:checked" ).val();
        let com1 = $("#come1").val();
        let com2 = $("#come2").val();
        let com3 = $("#come3").val();
        let com4 = $("#come4").val();
        let com5 = $("#come5").val();
        let com6 = $("#come6").val();
        let com7 = $("#come7").val();
       var id_cedula = localStorage.getItem("IdCedula");
       if(res1 == 0 ||res2 == 0 || res3 == 0 || res4 == 0 || res5 == 0 || res6 == 0 || res7 == 0){
        swal("","Formulario incompleto","warning");
        return false;
    }

    databaseHandler.db.transaction(
        function(tx){
            tx.executeSql("UPDATE Encuesta_SURO SET pregunta1 = ?,pregunta2 = ?,pregunta3 = ?,pregunta4 = ?,pregunta5 = ?,pregunta6 = ?,pregunta7 = ?,comentarios1 = ?,comentarios2 = ?,comentarios3 = ?,comentarios4 = ?,comentarios5 = ?,comentarios6 = ?,comentarios7 = ? WHERE id_cedula = ?",
            [res1,res2,res3,res4,res5,res6,res7,com1,com2,com3,com4,com5,com6,com7,id_cedula],
                function(tx, results){
                    swal("","La encuesta fue guardada correctamente","success");
                },
                function(tx, error){
                    console.log("Error al guardar cedula: " + error.message);
                    app.preloader.hide();
                }
            );
        },
        function(error){},
        function(){}
    );

    }
    function CierreVisitaEvaSURO(){
        var id_cedula = localStorage.getItem("IdCedula");
        let com = $("#comentarios").val();
        let comp = $("#compromisos").val();
        let cal1 = $('input:radio[name="rating0"]:checked').val();
        let cali2 = $('input:radio[name="rating1"]:checked').val();
        let cali3 = $('input:radio[name="rating2"]:checked').val();
        if(cal1 && cali2 && cali3 && com && comp){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE Visita_SURO SET cali_limpieza = ?,cali_ejecutivo  = ?,cali_gerente  = ?,Comentarios  = ?,compromiso = ? WHERE id_cedula = ?",
                    [cal1,cali2,cali3,com,comp,id_cedula],
                        function(tx, results){
                            swal("","Evaluacion fue guardada correctamente","success");
                        },
                        function(tx, error){
                            console.log("Error al guardar cedula: " + error.message);
                            app.preloader.hide();
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else{
            swal("","Todos los campos son obligatorios","warning");
        }
    }
    function terminarRecorridoSURO(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        if($('#signate').val() == ""){
            swal("","La firma es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var firma = $('#signate').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        var proceso= 300;
        var recorrido = 300; 
        var titulo = 'Foto Salida R'
        var proceso1= 350;
        var recorrido1 = 350; 
        var titulo1 = 'Firma Responsable R'
        productHandler.addfotoSURO(id_cedula,foto_salida,titulo,fecha_salida,proceso,recorrido);
        productHandler.addfotoSURO(id_cedula,firma,titulo1,fecha_salida,proceso1,recorrido1);
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                    function(tx, results){
                        window.location.href = "./menu.html";
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarVisitaSURO(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        if($('#signate').val() == ""){
            swal("","La firma es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        var proceso= 600;
        var recorrido = 600; 
        var titulo = 'Foto Salida V'
        var titulo1 = 'Firma Responsable V'
        var firma = $('#signate').val();
        var proceso1= 650;
        var recorrido1 = 650; 
        productHandler.addfotoSURO(id_cedula,foto_salida,titulo,fecha_salida,proceso,recorrido);
        productHandler.addfotoSURO(id_cedula,firma,titulo1,fecha_salida,proceso1,recorrido1);
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                    function(tx, results){
                        window.location.href = "./menu.html";
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );

    }
    function terminarEncuestaSURO(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        if($('#signate').val() == ""){
            swal("","La firma es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        var proceso= 900;
        var recorrido = 900; 
        var titulo = 'Foto Salida E'
        var titulo1 = 'Firma Responsable E'
        var firma = $('#signate').val();
        var proceso1= 950;
        var recorrido1 = 950; 
        productHandler.addfotoSURO(id_cedula,firma,titulo1,fecha_salida,proceso1,recorrido1);
        productHandler.addfotoSURO(id_cedula,foto_salida,titulo,fecha_salida,proceso,recorrido);
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                    function(tx, results){
                        window.location.href = "./menu.html";
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarvisitaBSURO(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        if($('#signate').val() == ""){
            swal("","La firma es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        var proceso= 1100;
        var recorrido = 1100; 
        var titulo = 'Foto Salida VB'
        var titulo1 = 'Firma Responsable VB'
        var firma = $('#signate').val();
        var proceso1= 1150;
        var recorrido1 = 1150; 
        productHandler.addfotoSURO(id_cedula,firma,titulo1,fecha_salida,proceso1,recorrido1);
        productHandler.addfotoSURO(id_cedula,foto_salida,titulo,fecha_salida,proceso,recorrido);
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                    function(tx, results){
                        window.location.href = "./menu.html";
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarSegSURO(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        if($('#signate').val() == ""){
            swal("","La firma es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        var proceso= 1300;
        var recorrido = 1300; 
        var titulo = 'Foto Salida S'
        var titulo1 = 'Firma Responsable S'
        var firma = $('#signate').val();
        var proceso1= 1350;
        var recorrido1 = 1350; 
        productHandler.addfotoSURO(id_cedula,firma,titulo1,fecha_salida,proceso1,recorrido1);
        productHandler.addfotoSURO(id_cedula,foto_salida,titulo,fecha_salida,proceso,recorrido);
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                    function(tx, results){
                        window.location.href = "./menu.html";
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function GuardarSUROF1(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }else{
            swal("","Se guardaron los datos correctamente", "success");
            app.preloader.hide();
        }
        var titulo = $('#titulo').val();
        if(titulo == ""){
            swal("","Agregar Nombre del Area","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto = $('#imagenC').val();
        var fecha = new Date();
        var fecha_E = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var proceso= 1;
        var recorrido = 1;
        $("#tabla_SURO1 tbody").empty(""); 
        productHandler.addfotoSURO(id_cedula,foto,titulo,fecha_E,proceso,recorrido);
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("Select * from Fotos_SURO where id_cedula = ? and recorrido = ?",
                [id_cedula,recorrido],
                    function(tx, results){
                        
                        var length = results.rows.length;
                        var item = results.rows.item(0);
                        console.log("item",item);
                        if(length == 0){
                                    $("#message-nr").css("display", "block");
                                } else {
                                    for(var i = 0; i< length; i++){
                                        var item = results.rows.item(i);
                                        $("#smallImage").attr("src","img/blank.png");
                                        $('#imagenC').val("");
                                        $("#photoIcon").attr("src","img/camera.svg");
                
                                        $("#titulo").css("background-color", "#FFFFFF");
                
                                        $("#tabla_SURO1 tbody").append("<tr id='fila"+ item.id_fotos +"'><td><a href='#' onclick='eliminarFilaSURO("+ item.id_fotos +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.titulo + "</td><td style='text-align: center;'>" + item.fecha + "</td></tr>");
                                        $("#message-nr").css("display", "none");
                                    }
                                }                     
                        $('.preloader').remove();
                        $('.infinite-scroll-preloader').remove();
                        app.preloader.hide();
                    },
                    function(tx, error){
                        console.log("Error al guardar cedula: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function GuardarSUROF2(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var titulo = $('#titulo').val();
        var comentarios = $('#Comentarios').val();
        if(titulo == ""){
            swal("","Agregar Nombre del Area","warning");
            return false;
        }
        if(comentarios == ""){
            swal("","Agregar comentarios","warning");
            return false;
        } 
        if($('input:radio[name=pregunta1]:checked').val() == 1 || $('input:radio[name=pregunta1]:checked').val() == 2){
            var pregunta = $('input:radio[name=pregunta1]:checked').val();
        } else {
            swal("","Para avanzar necesitas contestar la pregunta 2.1","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto = $('#imagenC').val();
        var fecha = new Date();
        var fecha_E = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var proceso= 1;
        var recorrido = 2; 

        $("#tabla_SURO2 tbody").empty(""); 
        productHandler.addfotoSURO(id_cedula,foto,titulo,fecha_E,proceso,recorrido);
        databaseHandler.db.transaction(
            function(tx){
              tx.executeSql("UPDATE Recorrido_SURO SET Pregunta_bodega = ?,Comentarios_bodega = ? WHERE id_cedula = ?",
              [pregunta,comentarios,id_cedula],
              function(tx, results){
                swal("","Se guardaron los datos correctamente", "success");
                app.preloader.hide();
              },
              function(tx, error){
                swal("Error al guardar", error.message, "error");
                app.preloader.hide();
              }
              );
            },
            function(error){
                swal("Error al guardar", error.message, "error");
                app.preloader.hide();
            },
            function(){}
          );
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("Select * from Fotos_SURO where id_cedula = ? and recorrido = ?",
                [id_cedula, recorrido],
                    function(tx, results){
                        var length = results.rows.length;
                        var item = results.rows.item(0);
                        console.log("item",item);
                        if(length == 0){
                                    $("#message-nr").css("display", "block");
                                } else {
                                    for(var i = 0; i< length; i++){
                                        var item = results.rows.item(i);
                                        $("#smallImage").attr("src","img/blank.png");
                                        $('#imagenC').val("");
                                        $("#photoIcon").attr("src","img/camera.svg");                
                                        $("#titulo").css("background-color", "#FFFFFF");                
                                        $("#tabla_SURO2 tbody").append("<tr id='fila"+ item.id_fotos +"'><td><a href='#' onclick='eliminarFilaSURO("+ item.id_fotos +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.titulo + "</td><td style='text-align: center;'>" + item.fecha + "</td></tr>");
                                        $("#message-nr").css("display", "none");
                                    }
                                }

                        $('.preloader').remove();
                        $('.infinite-scroll-preloader').remove();
                        app.preloader.hide();
                    },
                    function(tx, error){
                        console.log("Error al guardar cedula: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );

    }
    function GuardarSUROF3(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var titulo = $('#titulo').val();
        if(titulo == ""){
            swal("","Agregar Nombre del Area","warning");
            return false;
        }
        var comentarios = $('#comentarios').val();
        var p1 = $('#p1').val();
        var p2 = $('#p2').val();
        if(comentarios == "" || p1 == "" || p2 == ""){
            swal("","Debe de llenar todos los campos","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto = $('#imagenC').val();
        var fecha = new Date();
        var fecha_E = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var proceso= 1;
        var recorrido = 3; 
     
        $("#tabla_SURO3 tbody").empty(""); 
        productHandler.addfotoSURO(id_cedula,foto,titulo,fecha_E,proceso,recorrido);
        databaseHandler.db.transaction(
            function(tx){
              tx.executeSql("UPDATE Recorrido_SURO SET Pregunta_maq1 = ? ,Pregunta_maq2 = ?,Comentarios_maq = ? WHERE id_cedula = ?",
              [p1,p2,comentarios,id_cedula],
              function(tx, results){
                $("#p1").css("background-color", "#FFFFFF");
                $("#p2").css("background-color", "#FFFFFF");
                $("#comentarios").css("background-color", "#FFFFFF");
                swal("","Se guardaron los datos correctamente", "success");
                app.preloader.hide();
              },
              function(tx, error){
                swal("Error al guardar", error.message, "error");
                app.preloader.hide();
              }
              );
            },
            function(error){},
            function(){}
          );
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("Select * from Fotos_SURO where id_cedula = ? and recorrido = ?",
                [id_cedula,recorrido],
                    function(tx, results){
                        
                        var length = results.rows.length;
                        var item = results.rows.item(0);
                        console.log("item",item);
                        if(length == 0){
                                    $("#message-nr").css("display", "block");
                                } else {
                                    for(var i = 0; i< length; i++){
                                        var item = results.rows.item(i);
                                        $("#smallImage").attr("src","img/blank.png");
                                        $('#imagenC').val("");
                                        $('#titulo').val("");
                                        $("#photoIcon").attr("src","img/camera.svg");
                
                                        $("#titulo").css("background-color", "#FFFFFF");
                
                                        $("#tabla_SURO3 tbody").append("<tr id='fila"+ item.id_fotos +"'><td><a href='#' onclick='eliminarFilaSURO("+ item.id_fotos +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.titulo + "</td><td style='text-align: center;'>" + item.fecha + "</td></tr>");
                                        $("#message-nr").css("display", "none");
                                    }
                                }
                        $('.preloader').remove();
                        $('.infinite-scroll-preloader').remove();
                        app.preloader.hide();
                    },
                    function(tx, error){
                        console.log("Error al guardar cedula: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );

    }
    function GuardarSUROF4(){
        
        var p1 = $('input:radio[name=p1]:checked').val();
        var p2 = $('input:radio[name=p2]:checked').val();
        var p3 = $('input:radio[name=p3]:checked').val();
        var p4 = $('input:radio[name=p4]:checked').val();
        var p5 = $('input:radio[name=p5]:checked').val();
        var p6 = $('input:radio[name=p6]:checked').val();
        var p7 = $('input:radio[name=p7]:checked').val();
        var p8 = $('input:radio[name=p8]:checked').val();
        var p9 = $('#p9').val();
        
        if(p1 == ""|| p2 == "" || p3 == ""||p4 == ""|| p5 == "" || p6 == ""||p7== ""|| p8 == "" || p9 == ""){
            swal("","Encuesta incompleta","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");  
        databaseHandler.db.transaction(
            function(tx){
              tx.executeSql("UPDATE VisitaB_SURO SET gestion1 = ? ,gestion2 = ?,gestion3 = ?,gestion4 = ? ,gestion5 = ?,gestion6 = ?,gestion7 = ? ,gestion8 = ?,gestion9 = ? WHERE id_cedula = ?",
              [p1,p2,p3,p4,p5,p6,p7,p8,p9,id_cedula],
              function(tx, results){
                $("#p1").css("background-color", "#FFFFFF");
                $("#p2").css("background-color", "#FFFFFF");
                $("#p3").css("background-color", "#FFFFFF");
                $("#p4").css("background-color", "#FFFFFF");
                $("#p5").css("background-color", "#FFFFFF");
                $("#p6").css("background-color", "#FFFFFF");
                $("#p7").css("background-color", "#FFFFFF");
                $("#p8").css("background-color", "#FFFFFF");
                $("#p9").css("background-color", "#FFFFFF");
                swal("","Se guardaron los datos correctamente", "success");
                app.preloader.hide();
              },
              function(tx, error){
                swal("Error al guardar", error.message, "error");
                app.preloader.hide();
              }
              );
            },
            function(error){},
            function(){}
          );


    }
    function GuardarSUROF5(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }else{
            swal("","Se guardaron los datos correctamente", "success");
            app.preloader.hide();
        }
        var titulo = $('#titulo').val();
        if(titulo == ""){
            swal("","Agregar Nombre del Area","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto = $('#imagenC').val();
        var fecha = new Date();
        var fecha_E = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var proceso= 2;
        var recorrido = 4; 
        var comentarios = $('#comentarios').val();
        $("#tabla_SURO4 tbody").empty(""); 
        // var p1 = $('#p1').val();
        // var p2 = $('#p2').val();
        // var p3 = $('#p3').val();
        // var p4 = $('#p4').val();
        productHandler.addfotoSURO(id_cedula,foto,titulo,fecha_E,proceso,recorrido);
        // databaseHandler.db.transaction(
        //     function(tx){
        //       tx.executeSql("UPDATE VisitaB_SURO SET frecuencia1 = ? ,frecuencia2 = ?,frecuencia3 = ?,frecuencia4 = ? WHERE id_cedula = ?",
        //       [p1,p2,p3,p4,id_cedula],
        //       function(tx, results){
        //         $("#p1").css("background-color", "#FFFFFF");
        //         $("#p2").css("background-color", "#FFFFFF");
        //         $("#p3").css("background-color", "#FFFFFF");
        //         $("#p4").css("background-color", "#FFFFFF");
        //         swal("","Se guardaron los datos correctamente", "success");
        //         app.preloader.hide();
        //       },
        //       function(tx, error){
        //         swal("Error al guardar", error.message, "error");
        //         app.preloader.hide();
        //       }
        //       );
        //     },
        //     function(error){},
        //     function(){}
        //   );
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("Select * from Fotos_SURO where id_cedula = ? and recorrido = ? and proceso = ?",
                [id_cedula,recorrido,proceso],
                    function(tx, results){
             
                        var length = results.rows.length;
                        var item = results.rows.item(0);
                        if(length == 0){
                                    $("#message-nr").css("display", "block");
                                } else {
                                    for(var i = 0; i< length; i++){
                                        var item = results.rows.item(i);
                                        $("#smallImage").attr("src","img/blank.png");
                                        $('#imagenC').val("");
                                        $('#titulo').val("");
                                        $("#photoIcon").attr("src","img/camera.svg");
                
                                        $("#titulo").css("background-color", "#FFFFFF");
                
                                        $("#tabla_SURO4 tbody").append("<tr id='fila"+ item.id_fotos +"'><td><a href='#' onclick='eliminarFilaSURO("+ item.id_fotos +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.titulo + "</td><td style='text-align: center;'>" + item.fecha + "</td></tr>");
                                        $("#message-nr").css("display", "none");
                                    }
                                }
                        $('.preloader').remove();
                        $('.infinite-scroll-preloader').remove();
                        app.preloader.hide();
                    },
                    function(tx, error){
                        console.log("Error al guardar cedula: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );

    }
    function GuardarSUROF6(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var titulo = 'Almacen';
        var id_cedula = localStorage.getItem("IdCedula");
        var foto = $('#imagenC').val();
        var fecha = new Date();
        var fecha_E = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var proceso= 3;
        var recorrido = 4; 
        var p1 = $('#p1').val();
        var p2 = $('#p2').val();
        var p3 = $('#p3').val();
        var p4 = $('#p4').val();
        $("#tabla_SURO5 tbody").empty(""); 
        productHandler.addfotoSURO(id_cedula,foto,titulo,fecha_E,proceso,recorrido);
        databaseHandler.db.transaction(
            function(tx){
              tx.executeSql("UPDATE VisitaB_SURO SET almacen1 = ? ,almacen2 = ?,almacen3 = ?,almacen4 = ? WHERE id_cedula = ?",
              [p1,p2,p3,p4,id_cedula],
              function(tx, results){
                $("#p1").css("background-color", "#FFFFFF");
                $("#p2").css("background-color", "#FFFFFF");
                $("#p3").css("background-color", "#FFFFFF");
                $("#p4").css("background-color", "#FFFFFF");
                swal("","Se guardaron los datos correctamente", "success");
                app.preloader.hide();
              },
              function(tx, error){
                swal("Error al guardar", error.message, "error");
                app.preloader.hide();
              }
              );
            },
            function(error){},
            function(){}
          );
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("Select * from Fotos_SURO where id_cedula = ? and recorrido = ? and proceso = ?",
                [id_cedula,recorrido,proceso],
                    function(tx, results){
               
                        var length = results.rows.length;
                        var item = results.rows.item(0);
                        console.log("item",item);
                        if(length == 0){
                                    $("#message-nr").css("display", "block");
                                } else {
                                    for(var i = 0; i< length; i++){
                                        var item = results.rows.item(i);
                                        $("#smallImage").attr("src","img/blank.png");
                                        $('#imagenC').val("");
                                        $('#titulo').val("");
                                        $("#photoIcon").attr("src","img/camera.svg");                
                                        $("#titulo").css("background-color", "#FFFFFF");                
                                        $("#tabla_SURO5 tbody").append("<tr id='fila"+ item.id_fotos +"'><td><a href='#' onclick='eliminarFilaSURO("+ item.id_fotos +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.titulo + "</td><td style='text-align: center;'>" + item.fecha + "</td></tr>");
                                        $("#message-nr").css("display", "none");
                                    }
                                }
                        $('.preloader').remove();
                        $('.infinite-scroll-preloader').remove();
                        app.preloader.hide();
                    },
                    function(tx, error){
                        console.log("Error al guardar cedula: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );

    }
    function GuardarSUROF7(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var titulo = 'Recorrido';
        var id_cedula = localStorage.getItem("IdCedula");
        var foto = $('#imagenC').val();
        var fecha = new Date();
        var fecha_E = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var proceso= 4;
        var recorrido = 4; 
        var p1 = $('#p1').val();
        var p2 = $('#p2').val();
        var p3 = $('#p3').val();
        $("#tabla_SURO6 tbody").empty(""); 
        productHandler.addfotoSURO(id_cedula,foto,titulo,fecha_E,proceso,recorrido);
        databaseHandler.db.transaction(
            function(tx){
              tx.executeSql("UPDATE VisitaB_SURO SET recorrido1 = ? ,recorrido2 = ?,recorrido3 = ? WHERE id_cedula = ?",
              [p1,p2,p3,id_cedula],
              function(tx, results){
                $("#p1").css("background-color", "#FFFFFF");
                $("#p2").css("background-color", "#FFFFFF");
                $("#p3").css("background-color", "#FFFFFF");
                swal("","Se guardaron los datos correctamente", "success");
                app.preloader.hide();
              },
              function(tx, error){
                swal("Error al guardar", error.message, "error");
                app.preloader.hide();
              }
              );
            },
            function(error){},
            function(){}
          );
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("Select * from Fotos_SURO where id_cedula = ? and recorrido = ? and proceso = ?",
                [id_cedula,recorrido,proceso],
                    function(tx, results){
                        var length = results.rows.length;
                        if(length == 0){
                                    $("#message-nr").css("display", "block");
                                } else {
                                    for(var i = 0; i< length; i++){
                                        var item = results.rows.item(i);
                                        $("#smallImage").attr("src","img/blank.png");
                                        $('#imagenC').val("");
                                        $('#titulo').val("");
                                        $("#photoIcon").attr("src","img/camera.svg");
                
                                        $("#titulo").css("background-color", "#FFFFFF");
                
                                        $("#tabla_SURO6 tbody").append("<tr id='fila"+ item.id_fotos +"'><td><a href='#' onclick='eliminarFilaSURO("+ item.id_fotos +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.titulo + "</td><td style='text-align: center;'>" + item.fecha + "</td></tr>");
                                        $("#message-nr").css("display", "none");
                                    }
                                }

                        $('.preloader').remove();
                        $('.infinite-scroll-preloader').remove();
                        app.preloader.hide();
                    },
                    function(tx, error){
                        console.log("Error al guardar cedula: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function GuardarSUROF8(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto = $('#imagenC').val();
        var fecha = new Date();
        var fecha_E = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var proceso= 5;
        var recorrido = 1; 
        var p1 = $('#p1').val();
        if(p1){
            $("#tabla_SURO9 tbody").empty(""); 
            productHandler.addfotoSURO(id_cedula,foto,p1,fecha_E,proceso,recorrido);
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("Select * from Fotos_SURO where id_cedula = ? and recorrido = ? and proceso = ?",
                    [id_cedula,recorrido,proceso],
                        function(tx, results){                       
                            var length = results.rows.length;
                            var item = results.rows.item(0);
                            if(length == 0){
                                        $("#message-nr").css("display", "block");
                                    } else {
                                        for(var i = 0; i< length; i++){
                                            var item = results.rows.item(i);
                                            $("#smallImage").attr("src","img/blank.png");
                                            $('#imagenC').val("");
                                            $("#photoIcon").attr("src","img/camera.svg");
                                            $("#p1").css("background-color", "#FFFFFF");
                                            $("#p1").val('');
                                            swal("","Se guardaron los datos correctamente", "success");
                                            $("#tabla_SURO9 tbody").append("<tr id='fila"+ item.id_fotos +"'><td><a href='#' onclick='eliminarFilaSURO("+ item.id_fotos +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.titulo + "</td><td style='text-align: center;'>" + item.fecha + "</td></tr>");
                                            $("#message-nr").css("display", "none");
                                        }
                                    } 
    
                            $('.preloader').remove();
                            $('.infinite-scroll-preloader').remove();
                            app.preloader.hide();
                        },
                        function(tx, error){
                            console.log("Error al guardar cedula: " + error.message);
                            app.preloader.hide();
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else{
            swal("","Favor de ingresar un comentario","warning");
        }   
    }
    function guardarDGSURO1(){
        var id_cedula = localStorage.getItem("IdCedula");
        var remitente = $('#remitente').val();
        var Fecha = $('#Fecha').val();
        var sitio = $('#sitio').val();
        if(remitente == "" || Fecha == ""|| sitio == ""){
            swal("","Debes de llenar todos los campos","warning");
            return false;
        }
        databaseHandler.db.transaction(
            function(tx){
              tx.executeSql("UPDATE Recorrido_SURO SET Nombre_remitente = ?, fecha_envio = ?, Nombre_sitio = ? WHERE id_cedula = ?",
              [remitente,Fecha,sitio,id_cedula],
              function(tx, results){
                $("#remitente").css("background-color", "#FFFFFF");
                $("#Fecha").css("background-color", "#FFFFFF");
                $("#sitio").css("background-color", "#FFFFFF");
                swal("","Se guardaron los datos correctamente", "success");
                app.preloader.hide();
              },
              function(tx, error){
                swal("Error al guardar", error.message, "error");
                app.preloader.hide();
              }
              );
            },
            function(error){},
            function(){}
          );
    }
    function guardarDGSURO2(){
        var id_cedula = localStorage.getItem("IdCedula");
        var remitente = $('#remitente').val();
        var Fecha = $('#Fecha').val();
        var sitio = $('#sitio').val();
        var motivo = $('#motivo').val();
        if(remitente == "" || Fecha == ""|| sitio == "" || motivo == ""){
            swal("","Debes de llenar todos los campos","warning");
            return false;
        }
        databaseHandler.db.transaction(
            function(tx){
              tx.executeSql("UPDATE Visita_SURO SET Nombre_remitente = ?, fecha_envio = ?, Nombre_sitio = ?, motivo_vista = ? WHERE id_cedula = ?",
              [remitente,Fecha,sitio,motivo,id_cedula],
              function(tx, results){
                $("#remitente").css("background-color", "#FFFFFF");
                $("#Fecha").css("background-color", "#FFFFFF");
                $("#sitio").css("background-color", "#FFFFFF");
                $("#motivo").css("background-color", "#FFFFFF");
                swal("","Se guardaron los datos correctamente", "success");
                app.preloader.hide();
              },
              function(tx, error){
                swal("Error al guardar", error.message, "error");
                app.preloader.hide();
              }
              );
            },
            function(error){},
            function(){}
          );
    }
    function guardarDGSURO3(){
        var id_cedula = localStorage.getItem("IdCedula");
        var remitente = $('#remitente').val();
        var Fecha = $('#Fecha').val();
        var sitio = $('#sitio').val();
        if(remitente == "" || Fecha == ""|| sitio == ""){
            swal("","Debes de llenar todos los campos","warning");
            return false;
        }
        databaseHandler.db.transaction(
            function(tx){
              tx.executeSql("UPDATE Encuesta_SURO SET nombre_sitio = ? WHERE id_cedula = ?",
              [sitio,id_cedula],
              function(tx, results){
                $("#remitente").css("background-color", "#FFFFFF");
                $("#Fecha").css("background-color", "#FFFFFF");
                $("#sitio").css("background-color", "#FFFFFF");
                $("#motivo").css("background-color", "#FFFFFF");
                swal("","Se guardaron los datos correctamente", "success");
                app.preloader.hide();
              },
              function(tx, error){
                swal("Error al guardar", error.message, "error");
                app.preloader.hide();
              }
              );
            },
            function(error){},
            function(){}
          );
    }
    function guardarDGSURO4(){
        var id_cedula = localStorage.getItem("IdCedula");
        var remitente = $('#remitente').val();
        var Fecha = $('#Fecha').val();
        var sitio = $('#sitio').val();
        var Pendientes = $('#Pendientes').val();
        var numero = $('#numero').val();
        if(remitente == "" || Fecha == ""|| sitio == "" || Pendientes == "" || numero == ""){
            swal("","Debes de llenar todos los campos","warning");
            return false;
        }
        databaseHandler.db.transaction(
            function(tx){
              tx.executeSql("UPDATE VisitaB_SURO SET responsable = ?, fecha = ?, sitio = ?, pendientes = ?, numero_ti = ? WHERE id_cedula = ?",
              [remitente,Fecha,sitio,Pendientes,numero,id_cedula],
              function(tx, results){
                $("#remitente").css("background-color", "#FFFFFF");
                $("#Fecha").css("background-color", "#FFFFFF");
                $("#sitio").css("background-color", "#FFFFFF");
                $("#Pendientes").css("background-color", "#FFFFFF");
                $("#numero").css("background-color", "#FFFFFF");
                swal("","Se guardaron los datos correctamente", "success");
                app.preloader.hide();
              },
              function(tx, error){
                swal("Error al guardar", error.message, "error");
                app.preloader.hide();
              }
              );
            },
            function(error){},
            function(){}
          );
    }
    function guardarDGSURO5(){
        var id_cedula = localStorage.getItem("IdCedula");
        var Fecha = $('#Fecha').val();
        var sitio = $('#Sitio').val();
        var motivo = $('#Motivo').val();
        if(motivo == "" || Fecha == ""|| sitio == ""){
            swal("","Debes de llenar todos los campos","warning");
            return false;
        }
        databaseHandler.db.transaction(
            function(tx){
              tx.executeSql("UPDATE Seguimiento SET fecha = ?, sitio = ?, motivo = ? WHERE id_cedula = ?",
              [Fecha,sitio,motivo,id_cedula],
              function(tx, results){
                swal("","Se guardaron los datos correctamente", "success");
                app.preloader.hide();
                $("#Fecha").css("background-color", "#FFFFFF");
                $("#Sitio").css("background-color", "#FFFFFF");
                $("#Motivo").css("background-color", "#FFFFFF");
              },
              function(tx, error){
                swal("Error al guardar", error.message, "error");
                app.preloader.hide();
              }
              );
            },
            function(error){},
            function(){}
          );
    }
    //Suro Fin
    //INICIO VIC
    function guardarFotoVIC(proceso,limite,id_p) {
        app.preloader.show('blue');
       
        var mesg = '#message-nr' + proceso;
        var smallImage = '#smallImage' + proceso;
        var photoIcon = '#photoIcon' + proceso;
        var tabla2 = '#tabla_fotos' + proceso + ' tbody';
        var id_cedula = localStorage.getItem("IdCedula");
        var FotoVIC= $('#imagenC'+proceso).val();
       
        var fecha = new Date();
        var fecha_foto = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
        $(tabla2).empty("");
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql(
                    "Select * from VIC_Fotos WHERE ID_Cedula = ? and pregunta = ?",
                    [id_cedula,id_p],
                    function (tx, results) {
                        let length = results.rows.length;
                        if (length < limite){
                            if (FotoVIC) {
                                databaseHandler.db.transaction(
                                    function (tx) {
                                        tx.executeSql(
                                            "insert into VIC_Fotos(ID_Cedula, pregunta, FechaHora,Foto,orden) values(?,?,?,?,?)",
                                            [id_cedula,  id_p, fecha_foto, FotoVIC,proceso],
                                            function (tx, results) {                                              
                                                        var id = results.insertId;
                                                        $("#imagenC"+proceso).val();                             
                                                        $(tabla2).append("<tr id='fila" +id+ "'><td><a href='#' onclick='eliminarFila(" + id+ ",5);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a><td><img src='" + FotoVIC + "' width='60px'/></td><td style='text-align: center;'>" + fecha_foto + "</td></tr>");
                                                        $(mesg).hide();
                                                        $(smallImage).attr('src', 'img/blank.png');
                                                        $(photoIcon).attr("src", "img/camera.svg");                                         
                                                       
                                                        databaseHandler.db.transaction(
                                                            function (tx) {
                                                                tx.executeSql(
                                                                    "Select * from VIC_Fotos WHERE ID_Cedula = ? and pregunta = ?",
                                                                    [id_cedula,id_p],
                                                                    function (tx, results) {
                                                                        if (length > 0) {
                                                                            for (var i = 0; i < length; i++) {
                                                                                var item = results.rows.item(i);                            
                                                                                $("#imagenC"+proceso).val();
                                                                                $("#Titulo"+proceso).val("");
                                                                                $("#Titulo"+proceso).css("background","#FFFFFFFF");                                
                                                                                $(tabla2).append("<tr id='fila" + item.ID_Fotos + "'><td><a href='#' onclick='eliminarFila(" + item.ID_Fotos + ",5);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a><td><img src='" + item.Foto + "' width='60px'/></td><td style='text-align: center;'>" + item.FechaHora + "</td></tr>");
                                                                                $(mesg).hide();
                                                                                $(smallImage).attr('src', 'img/blank.png');
                                                                                $(photoIcon).attr("src", "img/camera.svg");
                                                                            }
                                                                        } else {
                                                                           // $(mesg).show();
                                                                        } 
                                                                        app.preloader.hide();
                                                                    },
                                                                    function (tx, error) {
                                                                        console.log("Error: " + error.message);
                                                                        app.preloader.hide();
                                                    
                                                    
                                                                    }
                                                                );
                                                            },
                                                            function (error) { },
                                                            function () { }
                                                        );  
                                                     
                                                
                                            
                                            },
                                            function (tx, error) {
                                                console.error("Error al registrar SV_Fotos: " + error.message);
                                            }
                                        );
                                    },
                                    function (error) { },
                                    function () { }
                                );                               
     
                                }              
                        }else{                         
                            swal("", "Ya acompleto el numero de fotos permitidas para esta pregunta", "warning");
                            databaseHandler.db.transaction(
                                function (tx) {
                                    tx.executeSql(
                                        "Select * from VIC_Fotos WHERE ID_Cedula = ? and pregunta = ?",
                                        [id_cedula,id_p],
                                        function (tx, results) {
                                            console.log('length',length);
                                            if (length > 0) {
                                                for (var i = 0; i < length; i++) {
                                                    console.log(i)
                                                    console.log(item)
                                                    var item = results.rows.item(i);                            
                                                    $("#imagenC"+proceso).val();
                                                    $("#Titulo"+proceso).val("");
                                                    $("#Titulo"+proceso).css("background","#FFFFFFFF");                                
                                                    $(tabla2).append("<tr id='fila" + item.ID_Fotos + "'><td><a href='#' onclick='eliminarFila(" + item.ID_Fotos + ",5);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a><td><img src='" + item.Foto + "' width='60px'/></td><td style='text-align: center;'>" + item.FechaHora + "</td></tr>");
                                                    $(mesg).hide();
                                                    $(smallImage).attr('src', 'img/blank.png');
                                                    $(photoIcon).attr("src", "img/camera.svg");
                                                }
                                            } else {
                                               // $(mesg).show();
                                            } 
                                            app.preloader.hide();
                                        },
                                        function (tx, error) {
                                            console.log("Error: " + error.message);
                                            app.preloader.hide();
                        
                        
                                        }
                                    );
                                },
                                function (error) { },
                                function () { }
                            );
                        }
    
    
    
                        app.preloader.hide();
                    },
                    function (tx, error) {
                        console.log("Error al guardar registroPL: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function (error) { },
            function () { }
        );
    }

    function generarAuditoriaVIC(emp){
        // localStorage.setItem("tipoEmpresa", emp);
        
        let id_cedula = localStorage.getItem("IdCedula");                      
        if(emp == 1){
         var nom = "Dominos";
     }else if(emp == 2){
         var nom = "Vips";
     }else if(emp == 3){
         var nom ="Italianis";
     }
        swal({
         title: "Aviso",
         text: "el tipo de empresa no se podrar modificar, ¬øSeguro que deseas continuar con la empresa "+nom+" ?",
         icon: "warning",
         buttons: true,
         dangerMode: false,
     })
     .then((willGoBack) => {
         if (willGoBack){
         databaseHandler.db.transaction(
             function(tx){
                 tx.executeSql("UPDATE datosVIC SET tipo_empresa = ? WHERE id_cedula = ?",
                     [emp,id_cedula],
                         function(tx, results){ 
                             },
                     function(tx, error){
                         console.log("Error: " + error.message);
                         app.preloader.hide();  
                     }
                 );  
             },
                 function(error){
                     console.log("Error: " + error.message);
                 },
                 function(){}
         );

         // if (emp == undefined){
         //     swal("", "No Existen auditor√≠as disponibles para este cliente", "warning");
         //     return false;
         // }
         var Nom = 'Preguntas-VIC-1';
         app.request.get(cordova.file.dataDirectory + "jsons/"+Nom+".json", function (data) {
             var content2 = JSON.parse(data);    
             var VIC ;
             if(emp == 1){
                 var VIC =content2[0];
             }else if(emp == 2){
                 var VIC =content2[1];
             }else if(emp == 3){
                 var VIC =content2[2];
             }
             databaseHandler.db.transaction(
                 function (tx) {
                     tx.executeSql(
                         "Select * from VIC_Respuesta where id_cedula = ?",
                         [id_cedula],
                         function (tx, results) {
                             let length = results.rows.length;                  
                             var item = results.rows.item(0);
                             if(length == 0){
                                 for(let i = 0; i < VIC.length ;i++){
                                     var orden = VIC[i].Orden;
                                     var id_pregunta = VIC[i].id_pregunta;     
                                     databaseHandler.db.transaction(
                                         function (tx) {
                                             tx.executeSql("insert into VIC_Respuesta(id_cedula, orden ,id_pregunta,obligatorio) values(?,?,?,?)",
                                             [id_cedula, VIC[i].Orden,VIC[i].id_pregunta,VIC[i].OB],
                                                 function (tx, results) {
                                                     // var item = results.rows.item(0);
                                                     // swal("", "Se actualizaron los datos correctamente", "success");                                                                    
                                                 },
                                                 function (tx, error) {
                                                     console.error("Error al registrar Aud_Tec: " + error.message);
                                                 }
                                             );
                                         });
                                 }
                             }
                             app.preloader.hide();
                         },
                         function (tx, error) {
                             console.log("Error: " + error.message);
                             app.preloader.hide();
                         }
                     );
                 },
                 function (error) { },
                 function () { }
             );        
             app.views.main.router.navigate({ name: 'Recorrido1VIC' });
         });   
         } else {}
     });     
    }

    function RespuestaVIC(res,orden,id_pregunta,factor){
        var id_cedula = localStorage.getItem("IdCedula");    
        var fecha = new Date();
        var fechaL = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql(
                    "UPDATE VIC_Respuesta SET respuesta = ? ,fecha = ? , factor = ? WHERE id_cedula = ?  and id_pregunta =?  ",
                    [res,fechaL,factor,id_cedula,id_pregunta],
                    function (tx, results) {
                        app.preloader.hide();
                    },
                    function (tx, error) {
                        console.log("Error al guardar registroVIC: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function (error) { },
            function () { }
        );
    }

    function terminarAuditoriaVIC() {
        id_cedula =localStorage.getItem("IdCedula");
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1; 
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql(
                    "Select * from VIC_Respuesta where id_cedula = ?",
                    [id_cedula],
                    function (tx, results) {
                        let length = results.rows.length; 
                        var obl = '';
                        for (var i = 0; i < length; i++) {
                            var item = results.rows.item(i);
                            var recom = $("#Re"+item.orden).val();                        
                            var a = i+1;
                            if(item.obligatorio == 1 && item.respuesta == null){                            
                                obl += a+',';
                            }              
                        }
                        if(obl != ''){
                            var obli = obl.substring(0, obl.length -1)
                            swal("Falta Pregunta", "Debe de contestar las pregunta numero: "+obli,"warning");
                            return false;
                        }else{
                            // for (var i = 0; i < length; i++) {
                            //     var item = results.rows.item(i); 
                            //     var recom = $("#RE"+item.orden).val();
                            //     tx.executeSql(
                            //     "UPDATE VIC_Respuesta SET recomendacion = ?  WHERE id_cedula = ? and orden =?",
                            //     [recom,id_cedula,item.orden],
                            //     function (tx, results) {
                            //         app.preloader.hide();
                                    app.views.main.router.navigate({name: 'recorridoVIC3'});
                                   
                            //     },
                            //     function (tx, error) {
                            //         console.log("Error al guardar registroVIC: " + error.message);
                            //         app.preloader.hide();
                            //     }
                            // );
                            // }
                        }
                        app.preloader.hide();
                    },
                    function (tx, error) {
                        console.log("Error al guardar registroPL: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function (error) { },
            function () { }
        );
    }

    function regresarVIC(){
            swal({
                title: "Aviso",
                text: "¬øQue acci√≥n desea realizar?",
                icon: "warning",
                buttons: {              
                  bt1: {
                    text: "Salir a Menu",
                    value: "1",
                  },
                  bt2: {
                    text: "Guardar y Salir",
                    value: "2",
                  },
                  cancel: true
                },
              })
              .then((value) => {
                console.log(value);
                switch (value) {
                    
                  case "1":
                    app.views.main.router.navigate({name: 'recorridoVIC3'});
                    break;
               
                  case "2":
                    terminarAuditoriaVIC();
                    break;
               
                  default:
                    
                }
              });   
    }
    function buscarClienteVIC() {
        app.preloader.show('blue');
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario =
          localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var horario_programado = fecha_llegada;
        var foto_llegada = $("#imagenC").val();
        var id_cliente = $("#id_cliente").val();
        var nombre_cliente = $("#nombre_cliente").val();
        var nombre_comercial = $("#NombreComercial").val();
        var nombre_contacto = $("#NombreContacto").val();
        var telefono = $("#Telefono").val();
        var correo = $("#Correo").val();
        var estatus_cliente = 'Estatus';
        var estatus = 0;
        var datos_v = new Array();
        if (foto_llegada!=''){
            if (nombre_cliente!=''){
            productHandler.addCedulaVIC(id_usuario, nombre_usuario, fecha_llegada, geolocation, id_cliente, nombre_cliente, horario_programado, estatus);
            databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql(
                "Select MAX(id_cedula) as Id from cedulas_general",
                [],
                function (tx, results) {
                    var item = results.rows.item(0);
                    datos_v[0] = {'id_usario':id_usuario ,'nombre_usuario':nombre_usuario ,'id_cliente':id_cliente,'nombre_cliente':nombre_cliente,'fecha_envio':fecha_llegada};
                    console.log('datos_v',datos_v)
                    localStorage.setItem("IdCedula", item.Id);
                    localStorage.setItem("foto_llegada", foto_llegada);
                    localStorage.setItem("id_cliente", id_cliente);
                    localStorage.setItem("nombre_cliente", nombre_cliente);
                    localStorage.setItem("nombre_comercial", nombre_comercial);
                    localStorage.setItem("nombre_contacto", nombre_contacto);
                    localStorage.setItem("telefono", telefono);
                    localStorage.setItem("correo", correo);
                    localStorage.setItem("estatus_cliente", estatus_cliente);
                    $.ajax({
                        type: "POST",
                        async : true,
                        url: "http://www.appbennetts.com/FWM2/app/guardardatosVenta.php",
                        dataType: 'html',
                        data: {'datos_v': JSON.stringify(datos_v)},
                        success: function(respuesta){
                           // console.log("Respuesta",respuesta)
                        },
                        error: function(){
                            console.log("Error en la comunicacion con el servidor");
                        }
                    });
    
                    app.views.main.router.navigate({ name: "menuVIC" });
                    app.preloader.hide();
                },
                function (tx, error) {
                    console.log("Error al guardar cedula: " + error.message);
                    app.preloader.hide();
                }
                );
            },
            function (error) {},
            function () {}
            );
            }else{
                swal("", "Favor de seleccionar un Cliente" , "warning");
                app.preloader.hide();
            } 
        }else{
            swal("", "La foto es requerida para continuar" , "warning");
            app.preloader.hide();
        }
    }
      function generarApoyoVIC(){
            let id_cedula = localStorage.getItem("IdCedula");
            let foto_llegada = localStorage.getItem("foto_llegada");
            let id_cliente = localStorage.getItem("id_cliente");
            let nombre_cliente = localStorage.getItem("nombre_cliente");
            let nombre_comercial = localStorage.getItem("nombre_comercial");
            let nombre_contacto = localStorage.getItem("nombre_contacto");
            let telefono = localStorage.getItem("telefono");
            let correo = localStorage.getItem("correo");
            let estatus_cliente = localStorage.getItem("estatus_cliente");
            let tipoCedula = "ApoyoVIC";
            productHandler.addVICDatos(id_cedula, foto_llegada, id_cliente, nombre_cliente, nombre_comercial, nombre_contacto, telefono, correo, estatus_cliente);
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ?  WHERE id_cedula = ?",
                        [tipoCedula,id_cedula],
                        function(tx, results){
                            app.views.main.router.navigate({name: 'recorridoVIC1'});
                        },
                        function(tx, error){
                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        function guardarDatosGeneralesVIC(){
            app.preloader.show('blue');
            //swal("", "Debes de llenar todos los campos" , "warning");
            var id_cedula = localStorage.getItem("IdCedula");
            var nombre_cliente = $('#nombreCliente').val();
            var nombre_comercial = $('#nombreComercial').val();
            var nombre_contacto = $('#nombreContacto').val();
            var telefono = $('#telefonoContacto').val();
            var correo = $('#correoContacto').val();
            var estatus_cliente = 'Estatus';
            if (nombre_cliente !='' && nombre_comercial !='' && nombre_contacto !='' && telefono != '' && correo !='' && estatus_cliente !=''){
                databaseHandler.db.transaction(
                    function (tx) {
                    tx.executeSql(
                        "UPDATE apoyo_bennetts SET nombre_contacto = ?, telefono = ?, correo = ?, estatus_cliente = ? WHERE id_cedula = ?",
                        [nombre_contacto, telefono, correo, estatus_cliente, id_cedula],
                        function (tx, results) {
                        swal("", "Datos actualizados correctamente", "success");
                        app.preloader.hide();
                        $('#nombreCliente').css("background-color","#ffffff");
                        $('#nombreComercial').css("background-color","#ffffff");
                        $('#nombreContacto').css("background-color","#ffffff");
                        $('#telefonoContacto').css("background-color","#ffffff");
                        $('#correoContacto').css("background-color","#ffffff");
                        $('#estatus').css("background-color","#ffffff");
                        },
                        function (tx, error) {
                        console.error("Error al actualizar Datos: " + error.message);
                        app.preloader.hide();
                        }
                    );
                    },
                    function (error) {},
                    function () {}
                );
            }else {
                swal("", "Debes de llenar todos los campos" , "warning");
                app.preloader.hide();
            }
        }
      function guardarApoyoCampo(){
          //console.log("Datos apoyo en campo");
          //console.log("comentario");
          var tipo = $('#tipos').val();
          var id_cedula = localStorage.getItem("IdCedula");
          var smartSelect = app.smartSelect.get('.smart-select');
          var foto = $('#imagenC').val();
          var comentarios = $('#comentarios').val();
          var fecha = new Date();
          var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
          if (tipo!=1){
            //console.log(tipo);
            if (comentarios){
                if(foto){
                    if (tipo!='otros'){
                        //console.log('normal');
                        app.preloader.show('blue');
                        //swal("","Foto y comentario OKay","success");  
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("INSERT INTO fotos_apoyo(id_cedula, foto, tipo_apoyo, comentario,  fechaYHora) VALUES (?,?,?,?,?)",
                                    [id_cedula, foto, tipo, comentarios, fecha_registro],
                                    function(tx, results){
                                        app.preloader.hide();
                                        swal("","Datos guardados correctamente","success");
                                        smartSelect.setValue('1');
                                        $('#imagenC').val("");
                                        $('#comentarios').val("");
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from fotos_apoyo where id_cedula = ? ORDER BY fechaYHora DESC",
                                                [id_cedula],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        $("#ApoyoCampo_content").append("<tr id='fila"+ item.id_foto_apoyo +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaVIC("+ item.id_foto_apoyo +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td id='tdtipo' style='text-align: center;'>" + item.tipo_apoyo + "</td><td id='tdfoto'><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td id='tdcomentario' style='text-align: center;'>" + item.comentario + "</td><td id='tdfecha' style='text-align: center;'>" + item.fechaYHora + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        app.preloader.hide();
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }else{
                        var tipo=$('#otroA').val();
                        //console.log(tipo);
                        app.preloader.show('blue');
                        //swal("","Foto y comentario OKay","success");  
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("INSERT INTO fotos_apoyo(id_cedula, foto, tipo_apoyo, comentario,  fechaYHora) VALUES (?,?,?,?,?)",
                                    [id_cedula, foto, tipo, comentarios, fecha_registro],
                                    function(tx, results){
                                        app.preloader.hide();
                                        swal("","Datos guardados correctamente","success");
                                        smartSelect.setValue('1');
                                        $('#imagenC').val("");
                                        $('#comentarios').val("");
                                        $('#otroA').val("");
                                        $('span[name="otroApoyo"]').hide();
                                        $('input[name="otroApoyo"]').hide();
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from fotos_apoyo where id_cedula = ? ORDER BY fechaYHora DESC",
                                                [id_cedula],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        $("#ApoyoCampo_content").append("<tr id='fila"+ item.id_foto_apoyo +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaVIC("+ item.id_foto_apoyo +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td id='tdtipo' style='text-align: center;'>" + item.tipo_apoyo + "</td><td id='tdfoto'><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td id='tdcomentario' style='text-align: center;'>" + item.comentario + "</td><td id='tdfecha' style='text-align: center;'>" + item.fechaYHora + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        app.preloader.hide();
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }
                }else{
                    swal("","Favor de tomar una foto","warning");
                }
            }else{
                swal("","Favor de colocar un comentario","warning");
            }
          }else{
            //console.log(tipo);
            swal("", "Selecciona un tipo de apoyo", "warning");
          }
      }

      function guardarCierredeApoyo(){
          //console.log("guardarCierredeApoyo");
          if ($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#eval").val() == ""){
          swal("", "Todos los campos son obligatorios", "warning");
          return false;
        }
        
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        if($("#eval").val() <= '3' && $("#comentario_cliente").val() == ""){
            swal("","Por favor, ingresa el motivo de tu calificacion","warning");
            return false;
        }
        var calificacion = $("#eval").val();
        var comentarioCliente = $('#comentario_cliente').val();
        var fecha = new Date();
        var fecha_firma =
          fecha.getFullYear() +
          "-" +
          (fecha.getMonth() + 1) +
          "-" +
          fecha.getDate() +
          " " +
          fecha.getHours() +
          ":" +
          fecha.getMinutes() +
          ":" +
          fecha.getSeconds();
        databaseHandler.db.transaction(
          function (tx) {
            tx.executeSql(
              "UPDATE apoyo_bennetts SET firma_cliente = ?, fecha_cliente = ? WHERE id_cedula = ?",
              [firmaCliente, fecha_firma, id_cedula],
              function (tx, results) {
                databaseHandler.db.transaction(
                  function (tx) {
                    tx.executeSql(
                      "UPDATE cedulas_general SET calificacion = ?, nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                      [calificacion, nombrefirma, comentarioCliente, id_cedula],
                      function (tx, results) {
                        swal("", "Guardado correctamente", "success");
                        app.views.main.router.back("/yamevoyVICApoyo/", {
                          force: true,
                          ignoreCache: true,
                          reload: true,
                        });
                      },
                      function (tx, error) {
                        console.error("Error al guardar cierre: " + error.message);
                      }
                    );
                  },
                  function (error) {},
                  function () {}
                );
              },
              function (tx, error) {
                console.error("Error al guardar cierre: " + error.message);
              }
            );
          },
          function (error) {},
          function () {}
        );
      }

    function tipos2() {
        var option = document.getElementById("tipos").value;
        var smartSelect = app.smartSelect.get('.smart-select');
        //console.log("clic"+option);
        if (option=='otros'){
            //console.log("otroclick")
            app.dialog.prompt("Por favor especifica que tipo de apoyo ser√≠a", `Otro Apoyo`, function (name) {
                    //eliminarubicacion();
                    if(name==''){
                        swal("", "Hay que llenar el campo, la operaci√≥n se cancel√° por la falta de este campo" , "warning");
                        smartSelect.setValue('1');
                        smartSelect.close();
                    }else{
                        $('#otroA').val(name);
                        smartSelect.close();
                        $('span[name="otroApoyo"]').show();
                        $('input[name="otroApoyo"]').show();
                    }
              },function(){
                swal("", "Operaci√≥n cancelada" , "warning");
                smartSelect.setValue('1');
                smartSelect.close();
                //document.getElementById("tipos").selectedIndex = "6";
                //$('#tipos option[value="Mantenimientos a equipos"]').prop("selected", "selected");
              });
        }else{
            //$('#otroA').val(smartSelect.getValue());
            $('#otroA').val('');
            $('span[name="otroApoyo"]').hide();
            $('input[name="otroApoyo"]').hide();
            smartSelect.close();
        }
    }

    function continuarCedVIC(id_cedula,tipo){
        localStorage.setItem("IdCedula",id_cedula);
         if(tipo == 1){
            localStorage.setItem("Opcion", '1');
            app.views.main.router.navigate({ name: 'recorridoVIC1'});
        }else if(tipo == 2){
            localStorage.setItem("Opcion", '2');
            app.views.main.router.navigate({ name: 'recorridoVIC2'});
        }else if(tipo == 3){
            localStorage.setItem("Opcion", '3');
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("Select * from datosVIC where id_cedula = ?",
                    [id_cedula],
                        function(tx, results){
                            var item = results.rows.item(0);
                            var tipos = item.tipo_visita;
                            var nombre_cliente=item.nombre_cliente;
                            var id_cliente=item.id_cliente;
                            if (tipos =='Llamada'){
                                app.views.main.router.navigate({ name: 'recorridoVIC3-1'});
                                localStorage.setItem("TipoVIC", 1);
                                localStorage.setItem("nombre_cliente", nombre_cliente);
                                localStorage.setItem("id_cliente", id_cliente);
                            } else if (tipos =='Visita'){
                                app.views.main.router.navigate({ name: 'recorridoVIC3'});
                                localStorage.setItem("TipoVIC", 2);
                                localStorage.setItem("nombre_cliente", nombre_cliente);
                                localStorage.setItem("id_cliente", id_cliente);
                            }
                        },
                        function(tx, error){
                            console.log("Error al guardar: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else if(tipo == 4){
            localStorage.setItem("Opcion", '4');
            app.views.main.router.navigate({name: 'datosgeneralesVIC4'});
        }else if(tipo == 5){
            localStorage.setItem("Opcion", '5');
            app.views.main.router.navigate({ name: 'recorridoVIC2'});
        }else if(tipo == 6){
            localStorage.setItem("Opcion", '6');
            app.views.main.router.navigate({name: 'recorridoVIC4'});
        }
    }


    function eliminarFilaVIC(index, opc){
        if(opc == 1) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM fotos_apoyo WHERE id_foto_apoyo = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 2) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM minuta WHERE id_minuta = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 3) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM equiposVIC WHERE id_equipos = ?",
                        [index],
                        function(tx, results){
                            console.log(tx, results);
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 4) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM imagenVIC WHERE id_imagen = ?",
                        [index],
                        function(tx, results){
                            console.log(tx, results);
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 5) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM entrenaVIC WHERE id_entrena = ?",
                        [index],
                        function(tx, results){
                            console.log(tx, results);
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 6) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM almacenVIC WHERE id_almacen = ?",
                        [index],
                        function(tx, results){
                            console.log(tx, results);
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 7) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM pedidosVIC WHERE id_producto = ?",
                        [index],
                        function(tx, results){
                            console.log(tx, results);
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }

    function terminarServicioVIC(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE apoyo_bennetts SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function irCierreVIC(){        
        var id_cedula = localStorage.getItem("IdCedula");
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "Select * from datosVIC WHERE id_cedula = ?",
                            [id_cedula],
                            function(tx, results){
                                let length = results.rows.length;
                                for(var i = 0; i< length; i++){
                                    var item = results.rows.item(i);                                    
                                    var emp = item.tipo_empresa; 
                                    console.log("empresa",emp);
                                        if(item.nombre_contacto=='' || item.telefono == '' || item.correo==''){
                                            swal({
                                                title: "Aviso",
                                                text: "Tienes los datos generales incompletos. ¬øSeguro que deseas continuar as√≠?",
                                                icon: "warning",
                                                buttons: true,
                                                dangerMode: false,
                                            })
                                            .then((willGoBack) => {
                                                if (willGoBack){                                                    
                                                    if(emp){
                                                        var Nom = 'Preguntas-VIC-1';
                                                        app.request.get(cordova.file.dataDirectory + "jsons/"+Nom+".json", function (data) {
                                                            var content2 = JSON.parse(data);    
                                                            var VIC ;
                                                            if(emp == 1){
                                                                var VIC =content2[0];
                                                            }else if(emp == 2){
                                                                var VIC =content2[1];
                                                            }else if(emp == 3){
                                                                var VIC =content2[2];
                                                            }                            
                                                            var tamaVic = VIC.length;                            
                                                            databaseHandler.db.transaction(
                                                                function (tx) {
                                                                    tx.executeSql(
                                                                        "Select * from VIC_Respuesta where id_cedula = ? and respuesta IS NOT NULL",
                                                                        [id_cedula],
                                                                        function (tx, results) {
                                                                            let length = results.rows.length; 
                                                                            var obl = '';
                                                                            if (length == tamaVic){
                                                                                app.views.main.router.back('/cierreVIC/', {force: true, ignoreCache: true, reload: true});
                                                                            }else{
                                                                                swal({
                                                                                    title: "Aviso",
                                                                                    text: "Tienes la auditoria incompleta. ¬øSeguro que deseas continuar as√≠?",
                                                                                    icon: "warning",
                                                                                    buttons: true,
                                                                                    dangerMode: false,
                                                                                })
                                                                                .then((willGoBack) => {
                                                                                    if (willGoBack){
                                                                                        app.views.main.router.back('/cierreVIC/', {force: true, ignoreCache: true, reload: true});
                                                                                    } else {}
                                                                                });
                                                                            }
                                                                        },
                                                                        function (tx, error) {
                                                                            console.log("Error al guardar registroPL: " + error.message);
                                                                            app.preloader.hide();
                                                                        }
                                                                    );
                                                                },
                                                                function (error) { },
                                                                function () { }
                                                            );
                            
                                                        });
                            
                            
                            
                                                    } else{
                        
                                                                app.views.main.router.back('/cierreVIC/', {force: true, ignoreCache: true, reload: true});
                                                       
                                                    }                                                   
                                                    // app.views.main.router.back('/cierreVIC/', {force: true, ignoreCache: true, reload: true});
                                                } else {}
                                            });
                                        }else{
                                            if(emp){
                                                var Nom = 'Preguntas-VIC-1';
                                                app.request.get(cordova.file.dataDirectory + "jsons/"+Nom+".json", function (data) {
                                                    var content2 = JSON.parse(data);    
                                                    var VIC ;
                                                    if(emp == 1){
                                                        var VIC =content2[0];
                                                    }else if(emp == 2){
                                                        var VIC =content2[1];
                                                    }else if(emp == 3){
                                                        var VIC =content2[2];
                                                    }
                    
                                                    var tamaVic = VIC.length;
                    
                                                    databaseHandler.db.transaction(
                                                        function (tx) {
                                                            tx.executeSql(
                                                                "Select * from VIC_Respuesta where id_cedula = ? and respuesta IS NOT NULL",
                                                                [id_cedula],
                                                                function (tx, results) {
                                                                    let length = results.rows.length; 
                                                                    var obl = '';
                                                                    if (length == tamaVic){
                                                                        app.views.main.router.back('/cierreVIC/', {force: true, ignoreCache: true, reload: true});
                                                                    }else{
                                                                        swal({
                                                                            title: "Aviso",
                                                                            text: "Tienes la auditoria incompleta. ¬øSeguro que deseas continuar as√≠?",
                                                                            icon: "warning",
                                                                            buttons: true,
                                                                            dangerMode: false,
                                                                        })
                                                                        .then((willGoBack) => {
                                                                            if (willGoBack){
                                                                                app.views.main.router.back('/cierreVIC/', {force: true, ignoreCache: true, reload: true});
                                                                            } else {}
                                                                        });
                                                                    }
                                                                },
                                                                function (tx, error) {
                                                                    console.log("Error al guardar registroPL: " + error.message);
                                                                    app.preloader.hide();
                                                                }
                                                            );
                                                        },
                                                        function (error) { },
                                                        function () { }
                                                    );
                    
                                                });
                    
                    
                    
                                            } else{
                         
                                                app.views.main.router.back('/cierreVIC/', {force: true, ignoreCache: true, reload: true});
                                                
                                            }
                                        }
                                }
                                },
                                    function(tx, error){
                                        console.log("Error: " + error.message);
                                        app.preloader.hide();  
                                    }
                    );  
                },
                    function(error){},
                    function(){}
            );
    }
    function guardarActividadComercial(){
        let id_cedula = localStorage.getItem("IdCedula");
        let proyecto = localStorage.getItem("IdProyecto");
        var foto_visita=$('#imagenC').val();
        var nivel=$('#niveles').val();
        var act=$('#actividadSe').val();
        console.log('NIVEL',nivel);
        console.log('act',act);
        var pendiente_vendedor=$('#pendiente_vendor').val();
        if($('#V1').is(':checked') || $('#V2').is(':checked')){ 
            if($('#V1').is(':checked')){ 
                var tipo_visita=$('#V1').val();
            }else if ($('#V2').is(':checked')){
                var tipo_visita=$('#V2').val();
            }
            // var subir = $('input:radio[name=pregunta1]:checked').val();
            // console.log('SUBIR',subir);
            // if(subir== 0){var nivelS =nivel; }else if(subir == 1){var nivelS =parseInt(nivel) + 1; }
            if(foto_visita){
                // if(nivel != 0){
                    if(pendiente_vendedor && nivel && act ){
                        console.log(tipo_visita, nivel, pendiente_vendedor,act,id_cedula,proyecto);
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE ventas_bennetts SET tipo_visita = ?, foto_visita = ?, nivel = ?, pendiente_vendedor= ?,actividadSelect = ?  WHERE  id_proyecto = ?",
                                    [tipo_visita,foto_visita,nivel,pendiente_vendedor,act,proyecto],
                                    function(tx, results){
                                    console.log("results",results);
                                    swal("","Se guardaron los datos correctamente", "success");
                                    },
                                    function(tx, error){
                                        console.error("Error al actualizar: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }else{
                        swal("", "Todos los campos son requeridos para continuar", "warning");    
                    }
                // }else{
                //     swal("", "Favor de seleccionar una actividad", "warning");
                // }
            }else{
                swal("", "La foto es requerida", "warning");
            }
        }else{
            swal("", "Favor de seleccionar el tipo de visita", "warning");
        }
    
    }
    function continuarVentaVIC(id_cedula,tipo){
        localStorage.setItem("IdCedula",id_cedula);
        localStorage.setItem("Opcion", '2');
            app.views.main.router.navigate({ name: 'recorridoVIC2'});
    }

    function guardarVentasVIC(){
        let id_cedula = localStorage.getItem("IdCedula");
        var tema=$('#tema').val();
        var compromiso=$('#compromiso').val();
        var fecha_compromiso=$('#fecha').val();
        var h_inicio=$('#hora_inicio').val();
        var h_fin=$('#hora_fin').val();
        var fecha = new Date();
        var fecha_tomada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        //console.log("patiende: "+Patiende+"- Ppuesto: "+Ppuesto+"- Ptelefono: "+Ptelefono+"- Pcorreo:"+Pcorreo+" actividades:"+actividades+" - tema:"+tema+"- compromiso: "+compromiso+"- fecha:"+fecha);
        if (tema && compromiso && fecha_compromiso && h_inicio && h_fin){
                app.preloader.show('blue');
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("INSERT INTO minuta(id_cedula,tema,compromiso,fecha,fecha_foto,h_inicio,h_fin) VALUES (?,?,?,?,?,?,?)",
                            [id_cedula,tema,compromiso,fecha_compromiso,fecha_tomada,h_inicio,h_fin],
                            function(tx, results){
                                //console.log("Datos Guardados");
                                swal("","Se guardaron los datos correctamente", "success");
                                $('#tema').val('');
                                $('#tema').css("background-color","#ffffff");
                                $('#compromiso').val('');
                                $('#compromiso').css("background-color","#ffffff");
                                $('#fecha').val('');
                                $('#fecha').css("background-color","#ffffff");
                                $('#hora_inicio').val('');
                                $('#hora_inicio').css("background-color","#ffffff");
                                $('#hora_fin').val('');
                                $('#hora_fin').css("background-color","#ffffff");
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("Select * from minuta where id_cedula = ? ORDER BY id_minuta DESC",
                                        [id_cedula],
                                            function(tx, results){
                                                var item = results.rows.item(0);
                                                $("#VentasBennetts_content").append("<tr id='fila"+ item.id_minuta +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaVIC("+ item.id_minuta +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td id='tdtema' style='text-align: center;'>" + item.tema + "</td><td id='tdcompromiso' style='text-align: center;'>" + item.compromiso + "</td><td id='tdfecha' style='text-align: center;'>" + item.fecha + "</td><td id='tdfecha' style='text-align: center;'>" + item.h_inicio + "</td><td id='tdfecha' style='text-align: center;'>" + item.h_fin + "</td></tr>");
                                                $("#message-nr").css("display", "none");
                                                $('.preloader').remove();
                                                $('.infinite-scroll-preloader').remove();
                                                app.preloader.hide();
                                            },
                                            function(tx, error){
                                                console.log("Error al Mostrar los datos: " + error.message);
                                                app.preloader.hide();
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                        },
                            function(tx, error){
                                console.error("Error al guardar: " + error.message);
                                swal("","Ha ocurrido un error al guardar", "error");
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
        }else{
            swal("", "Todos los campos son obligatorios", "warning");
        }
    }
    
    function guardarDatosGVentasVIC(){
        let id_cedula = localStorage.getItem("IdCedula");
        let id_proyecto= localStorage.getItem("IdProyecto");
        var Patiende=$('#Patiende').val();
        var Ppuesto=$('#Ppuesto').val();
        var Ptelefono=$('#Ptelefono').val();
        var Pcorreo=$('#Pcorreo').val();
        //console.log("patiende: "+Patiende+"- Ppuesto: "+Ppuesto+"- Ptelefono: "+Ptelefono+"- Pcorreo:"+Pcorreo+" actividades:"+actividades+" - tema:"+tema+"- compromiso: "+compromiso+"- fecha:"+fecha);
        if (id_proyecto==0){
            swal("", "Favor de seleccionar un proyecto", "warning");
        }else{
            if (Patiende && Ppuesto && Ptelefono && Pcorreo){
                    console.log(id_proyecto);
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql(
                                "Select * from proyectos_vic WHERE id_proyecto = ?",
                                [id_proyecto],
                                function(tx, results){
                                    let length = results.rows.length;
                                    var item = results.rows.item(0);
                                    var actual_nivel = item.nivel;
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("UPDATE ventas_bennetts SET nombre_cliente = ?, puesto_cliente = ?, telefono = ?, correo= ?, id_proyecto = ?, nivel = ? WHERE id_cedula = ?",
                                                [Patiende,Ppuesto,Ptelefono,Pcorreo,id_proyecto,actual_nivel,id_cedula],
                                                function(tx, results){
                                                //console.log("actualizados datos de evidencia");
                                                swal("","Se guardaron los datos correctamente", "success");
                                                $('#Patiende').css("background-color","#ffffff");
                                                $('#Ppuesto').css("background-color","#ffffff");
                                                $('#Ptelefono').css("background-color","#ffffff");
                                                $('#Pcorreo').css("background-color","#ffffff");
                                                },
                                                function(tx, error){
                                                    console.error("Error al actualizar: " + error.message);
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("UPDATE cedulas_general SET nombre_cliente = ? WHERE id_cedula = ?",
                                                [Patiende,id_cedula],
                                                function(tx, results){
                                                //console.log("actualizados datos de evidencia");
                                                swal("","Se guardaron los datos correctamente", "success");
                                                },
                                                function(tx, error){
                                                    console.error("Error al actualizar: " + error.message);
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                },
                                function(tx, error){
                                    console.log("Error: " + error.message);
                                    app.preloader.hide();  
                                }
                            );  
                        },
                        function(error){},
                        function(){}
                    );
            }else{
                swal("", "Todos los campos son obligatorios", "warning");
            }
        }    
    }
            
    function guardarCierredeVentasVIC(){
        console.log("Cierre ventas");
        if ($("#NombreFirma").val() == ""){
            swal("", "Todos los campos son obligatorios", "warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var correo_apoyo = $('#correo_cliente').val();
        console.log(nombrefirma)
        console.log(correo_apoyo)
        databaseHandler.db.transaction(
            function (tx) {
            tx.executeSql("UPDATE ventas_bennetts SET correo_apoyo = ? WHERE id_cedula = ?",
                [correo_apoyo, id_cedula],
                function (tx, results) {
                    console.log(results)
                databaseHandler.db.transaction(
                    function (tx) {
                    tx.executeSql("UPDATE cedulas_general SET nombre_evalua = ? WHERE id_cedula = ?",
                        [nombrefirma, id_cedula],
                        function (tx, results) {
                            console.log(results)
                        swal("", "Guardado correctamente", "success");
                        //console.log(calificacion, nombrefirma, comentarioCliente, id_cedula);
                        app.views.main.router.back("/yamevoyVICVentas/", {
                            force: true,
                            ignoreCache: true,
                            reload: true,
                        });
                        },
                        function (tx, error) {
                        console.error("Error al guardar cierre: " + error.message);
                        }
                    );
                    },
                    function (error) {},
                    function () {}
                );
                },
                function (tx, error) {
                console.error("Error al guardar cierre: " + error.message);
                }
            );
            },
            function (error) {},
            function () {}
        );
}


    function terminarVentasVIC(){
        //console.log("terminar ventas");
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE ventas_bennetts SET foto_salida = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }

        function visitaP3(){
            var id_cedula = localStorage.getItem("IdCedula");
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * from ventas_bennetts WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var item = results.rows.item(0);
                            var avanza1=item.id_proyecto;
                                if(avanza1 != 0){
                                    app.views.main.router.navigate({name: 'datosProyectoVentasVIC'});
                                    }else{
                                        swal("", "Favor de primero llenar los datos generales" , "warning");
                                }
                        },
                        function(tx, error){
                            console.log('Error:'+ error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }

        function visitaP1(){
            var id_cedula = localStorage.getItem("IdCedula");
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * from ventas_bennetts WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var item = results.rows.item(0);
                            var avanza=item.nivel;
                                if(avanza != undefined){
                                    app.views.main.router.navigate({name: 'visitaProyectoVIC'});
                                    }else{
                                        swal("", "Favor de llenar los datos en actividad comercial" , "warning");
                                }
                        },
                        function(tx, error){
                            console.log('Error:'+ error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }

        function visitaP2(){
            var id_cedula = localStorage.getItem("IdCedula");
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "Select * from minuta WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            let length = results.rows.length;
                            if(length == 0){
                                swal("", "Favor llenar la minuta" , "warning");
                            } else {
                                app.views.main.router.navigate({name: 'cierreVIC2'});
                            }
                             
                        },
                        function(tx, error){
                            console.log("Error al guardar cedula: " + error.message);
                            app.preloader.hide();  
                        }
                    );  
                },
                function(error){},
                function(){}
            );
        }

        function ParaCargaProyecto(id){
            //console.log(id);
            var smartSelect = app.smartSelect.get('.smart-select');
            //smartSelect.setValue(id);
            if (id=='asas')
            {}else{
               // console.log('para cargar el smart');
                smartSelect.setValue('1');
            }
        }

function recorrido3(reco){
        let id_cedula = localStorage.getItem("IdCedula");
        let foto_llegada = localStorage.getItem("foto_llegada");
            
        let id_cliente = localStorage.getItem("id_cliente");
        let nombre_cliente = localStorage.getItem("nombre_cliente");
        let nombre_comercial = localStorage.getItem("nombre_comercial");
        let nombre_contacto = localStorage.getItem("nombre_contacto");
        let telefono = localStorage.getItem("telefono");
        let correo = localStorage.getItem("correo");
        let estatus_cliente = localStorage.getItem("estatus_cliente");

        let tipoCedula = "VIC";

        if(reco==1){
            
            let tipoVisita = "Llamada";
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ?  WHERE id_cedula = ?",
                        [tipoCedula,id_cedula],
                        function(tx, results){
                            productHandler.addVICVIC(id_cedula, foto_llegada, tipoVisita, id_cliente, nombre_cliente, nombre_cliente, nombre_contacto, telefono, correo,estatus_cliente);
                            localStorage.setItem("TipoVIC", reco);
                            app.views.main.router.back('/recorridoVIC3-1/', {force: true, ignoreCache: true, reload: true});
                        },
                        function(tx, error){
                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else if(reco==2){
        
            let tipoVisita = "Visita";
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ?  WHERE id_cedula = ?",
                        [tipoCedula,id_cedula],
                        function(tx, results){
                            productHandler.addVICVIC(id_cedula, foto_llegada, tipoVisita, id_cliente, nombre_cliente, nombre_cliente, nombre_contacto, telefono, correo,estatus_cliente);
                            localStorage.setItem("TipoVIC", reco);
                            app.views.main.router.back('/recorridoVIC3/', {force: true, ignoreCache: true, reload: true});
                        },
                        function(tx, error){
                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }

    function regresarRecorridoVIC1(){
        app.views.main.router.back('/recorridoVIC1/', {force: true, ignoreCache: true, reload: true});
    }
    function regresarRecorridoVIC2(){
        app.views.main.router.back('/recorridoVIC2/', {force: true, ignoreCache: true, reload: true});
    }
    function regresarRecorridoVIC3(){
        let tipo = localStorage.getItem("TipoVIC");
        if (tipo==1){
            app.views.main.router.back('/recorridoVIC3-1/', {force: true, ignoreCache: true, reload: true});
        }else if (tipo==2){
            app.views.main.router.back('/recorridoVIC3/', {force: true, ignoreCache: true, reload: true});
        }
    }
    function ProyectoVIC(value){
        console.log(value)
        var id_cedula = localStorage.getItem("IdCedula");
        if (value == 0){
            $('#Patiende').val('');
            $('#Ppuesto').val('');
            $('#Ptelefono').val('');
            $('#Pcorreo').val('');
            localStorage.setItem("IdProyecto", value);
        }else{
            $('#Patiende').val('');
            $('#Ppuesto').val('');
            $('#Ptelefono').val('');
            $('#Pcorreo').val('');
            localStorage.setItem("IdProyecto", value);
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "Select * from ventas_bennetts WHERE id_proyecto = ?",
                            [value],
                                function(tx, results){
                                    let length = results.rows.length;
                                    var item = results.rows.item(0);
                                        console.log(item);                       
                                        console.log(length);  
                                        $('#Patiende').val(item.nombre_cliente);
                                        $('#Ppuesto').val(item.puesto_cliente);
                                        $('#Ptelefono').val(item.telefono);
                                        $('#Pcorreo').val(item.correo);
                                        app.smartSelect.close('.smart-select');
                                        
                                },
                                    function(tx, error){
                                        console.log("Error: " + error.message);
                                        app.preloader.hide();  
                                    }
                    );  
                },
                    function(error){},
                    function(){}
            );  
        }
    }
    function guardarDatosGVIC(){
        let id_cedula = localStorage.getItem("IdCedula");
        let cliente = $("#cliente").val();
        let comercial = $("#nombre_comercial").val();
        let contacto = $("#nombre_contacto").val();
        let telefono = $("#telefono").val();
        let correo = $("#correo").val();
        let estatus = 'Estatus';
        if(cliente && comercial && contacto && telefono && estatus && correo){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE datosVIC SET nombre_comercial=?, nombre_contacto=?, telefono=?, correo=?, estatus_cliente =? WHERE id_cedula = ?",
                        [comercial,contacto,telefono,correo,estatus,id_cedula],
                        function(tx, results){
                        //console.log("actualizados datos de evidencia");
                        swal("","Se guardaron los datos correctamente", "success");
                        $('#cliente').css("background-color","#ffffff");
                        $('#nombre_comercial').css("background-color","#ffffff");
                        $('#nombre_contacto').css("background-color","#ffffff");
                        $('#telefono').css("background-color","#ffffff");
                        $('#correo').css("background-color","#ffffff");
                        $('#estatus_cliente').css("background-color","#ffffff");
                        },
                        function(tx, error){
                            console.error("Error al actualizar: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else{
            swal("", "Debes de llenar todos los campos" , "warning");
        }
    }

    function guardarEquipoVIC(){
        var id_cliente = localStorage.getItem("id_cliente");
        var id_usuario = localStorage.getItem("id_usuario");
        var enviado=0;
        var agrega=0;
        let nombreEquipo=$('#nombre_equipo').val();
        let codigoEquipo = $('#codigoEquipo').val();
        if (codigoEquipo==''){
            app.dialog.alert('Ingresa un equipo v√°lido.', 'Aviso');
        }else{
            if(nombreEquipo){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql(
                            "Select * from equiposCargados where id_cliente = ? and codigo = ? ORDER BY id_equipo DESC",
                                [id_cliente, codigoEquipo],
                                function(tx, results){
                                    let length = results.rows.length;
                                        var item = results.rows.item(0);
                                        if (length!=0){
                                            console.log('existe en base');
                                            swal("","Equipo guardado correctamente", "success");
                                            app.sheet.close('#sheet-modal');
                                            $('#nombre_equipo').val('');
                                            $('#codigoEquipo').val('');
                                        }
                                        else{
                                            console.log('NO existe en base');
                                            databaseHandler.db.transaction(
                                                function(tx){
                                                    tx.executeSql("INSERT INTO equiposCargados(id_cliente, codigo, descripcion, id_usuario, enviado) VALUES (?,?,?,?,?)",
                                                        [id_cliente,codigoEquipo, nombreEquipo, id_usuario, enviado],
                                                            function(tx, results){
                                                                let length = results.rows.length;
                                                                    var item = results.rows.item(0);
                                                                    $("#select-equipo").append("<option value="+codigoEquipo+">"+nombreEquipo+"</option>");
                                                                    swal("","Equipo guardado correctamente", "success");
                                                                    app.sheet.close('#sheet-modal');
                                                                    $('#nombre_equipo').val('');
                                                                    $('#codigoEquipo').val('');
                                                                },
                                                            function(tx, error){
                                                            console.log("Error: " + error.message);
                                                            }
                                                    );
                                                },
                                                    function(error){},
                                                    function(){}
                                            );
                                        };
                                    },
                                function(tx, error){
                                    console.log("Error: " + error.message);
                                }
                        );  
                    },
                        function(error){
                            console.log('NO existe en base');
                                            databaseHandler.db.transaction(
                                                function(tx){
                                                    tx.executeSql("INSERT INTO equiposCargados(id_cliente, codigo, descripcion, id_usuario, enviado) VALUES (?,?,?,?,?)",
                                                        [id_cliente,codigoEquipo, nombreEquipo, id_usuario, enviado],
                                                            function(tx, results){
                                                                let length = results.rows.length;
                                                                    var item = results.rows.item(0);
                                                                    $("#select-equipo").append("<option value="+codigoEquipo+">"+nombreEquipo+"</option>");
                                                                    swal("","Equipo guardado correctamente", "success");
                                                                    app.sheet.close('#sheet-modal');
                                                                    $('#nombre_equipo').val('');
                                                                    $('#codigoEquipo').val('');
                                                                },
                                                            function(tx, error){
                                                            console.log("Error: " + error.message);
                                                            }
                                                    );
                                                },
                                                    function(error){},
                                                    function(){}
                                            );
                        },
                        function(){}
                );
            }else{
                app.dialog.alert('Debes seleccionar un proyecto.', 'Aviso');
            }
        }
    }

    function guardaEquipoVIC(){
        let id_cedula = localStorage.getItem("IdCedula");
        let tipoVIC = localStorage.getItem("TipoVIC");
        let equipos=$('#select-equipo').val();
        let decripcion=$('#descripcionEquipo').val();
        let estado='';
        var fecha = new Date();
        var fecha_foto = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        let cantidad=$('#cantidad').val();
        let ubicacion=$('#ubicacion').val();
        let motivos=$('#motivos').val();
        let comentarios=$('#comentarios').val();
        let foto=$('#imagenC').val();
        if (tipoVIC==1){
            if ($("#radio11").prop("checked") == false && $("#radio12").prop("checked") == false){
            swal("", "Selecciona una opci√≥n de la pregunta" , "warning");
            return false;
            }else{
                    if($("#radio1").prop("checked") == true){
                        estado = "Buen Estado";
                    } else if($("#radio2").prop("checked") == true){
                        estado = "Mal Estado";
                        if(motivos == 0){
                            swal("", "Debes de seleccionar un motivo" , "warning");
                            return false;
                        }
                    }
                if(equipos==0){
                    swal("", "Selecciona un equipo" , "warning");
                }else{
                    if (estado && cantidad && ubicacion && comentarios){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("INSERT INTO equiposVIC(id_cedula, estado, equipo, descripcion, cantidad, ubicacion, motivo, comentarios, foto, fecha) VALUES (?,?,?,?,?,?,?,?,?,?)",
                                    [id_cedula,estado,equipos,decripcion,cantidad,ubicacion,motivos,comentarios, foto, fecha_foto],
                                    function(tx, results){
                                    swal("","Se guardaron los datos correctamente", "success");
                                    $('#select-equipo').val(0);
                                    $('#motivos').val(0);
                                    $('#motivos').css("background-color","#ffffff");
                                    $('#cantidad').val('');
                                    $('#cantidad').css("background-color","#ffffff");
                                    $("#radio1").prop("checked", false);
                                    $("#radio2").prop("checked", false);
                                    $('#ubicacion').val('');
                                    $('#ubicacion').css("background-color","#ffffff");
                                    $("#select-equipo").css("background","#FFFFFF");
                                    $('#comentarios').val('');
                                    $('#descripcionEquipo').val('');
                                    $('#comentarios').css("background-color","#ffffff");
                                    $('#imagenC').val('');
                                    $("#smallImage").attr("src","img/blank.png");
                                    $("#photoIcon").attr("src","img/camera.svg");
                                    $('#motivos').css("display","block");
                                    $('#spanMotivos').css("display","block");
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql( 
                                                    "Select * from equiposVIC where id_cedula = ? ORDER BY id_equipos DESC",
                                                        [id_cedula],
                                                        function(tx, results){ 
                                                                var item = results.rows.item(0);
                                                                let motivo="";
                                                                if (item.motivo==1){
                                                                    motivo="Da√±o del equipo por uso normal";
                                                                }else if (item.motivo==2){
                                                                    motivo="Equipo da√±ado por descuido";
                                                                }else if (item.motivo==3){
                                                                    motivo="Mantenimieto correctivo";
                                                                }else if (item.motivo==4){
                                                                    motivo="Cambio de equipos (Despachadores de Jab√≥n, Toallero o Higi√©nico)";
                                                                }else if (item.motivo==5){
                                                                    motivo="Env√≠o de Rack de 10 o 20 Litros y Rack para atomizadores";
                                                                }
                                                                if (item.foto == ''){
                                                                }else{
                                                                    foto="<img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/>";
                                                                }
                                                                $("#tabla_equipoVIC").append("<tr id='fila"+ item.id_equipos +"'><td><a href='#' onclick='eliminarFilaVIC("+item.id_equipos +",3);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td>"+
                                                                foto+"</td><td style='text-align: center;'>" + item.equipo
                                                                + "</td><td style='text-align: center;'>" + item.descripcion
                                                                + "</td><td style='text-align: center;'>" + item.cantidad 
                                                                + "</td><td style='text-align: center;'>" + item.ubicacion 
                                                                + "</td><td style='text-align: center;'>" + item.estado 
                                                                + "</td><td style='text-align: center;'>" + item.comentarios
                                                                + "</td><td style='text-align: center;'>" + motivo + "</td></tr>");
                                                                    
                                                                    $("#message-nr").css("display", "none");
                                                                    $('.preloader').remove();
                                                                    $('.infinite-scroll-preloader').remove();
                                                            },
                                                                function(tx, error){
                                                                    console.log("Error: " + error.message);
                                                                    app.preloader.hide();  
                                                                }
                                                );  
                                            },
                                                function(error){
                                                    console.log("Error: " + error.message);
                                                },
                                                function(){}
                                        );                
                                    },
                                    function(tx, error){
                                        console.error("Error al actualizar: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }else{
                        swal("", "Debes de llenar todos los campos" , "warning");
                    }
                }
            }
        }else{
            if($("#radio1").prop("checked") == true){
                estado = "Buen Estado";
            } else if($("#radio2").prop("checked") == true){
                estado = "Mal Estado";
                    if(motivos == 0){
                        swal("", "Debes de seleccionar un motivo" , "warning");
                        return false;
                    }
            }
            if(equipos==0){
                swal("", "Debes de llenar todos los campos" , "warning");
            }else{
                if (estado && cantidad && ubicacion && comentarios && foto){
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("INSERT INTO equiposVIC(id_cedula, estado, equipo, descripcion, cantidad, ubicacion, motivo, comentarios, foto, fecha) VALUES (?,?,?,?,?,?,?,?,?,?)",
                                [id_cedula,estado,equipos,decripcion,cantidad,ubicacion,motivos,comentarios, foto, fecha_foto],
                                function(tx, results){
                                swal("","Se guardaron los datos correctamente", "success");
                                $('#select-equipo').val(0);
                                $('#motivos').val(0);
                                $('#motivos').css("background-color","#ffffff");
                                $('#cantidad').val('');
                                $('#cantidad').css("background-color","#ffffff");
                                $("#radio1").prop("checked", false);
                                $("#radio2").prop("checked", false);
                                $('#ubicacion').val('');
                                $('#ubicacion').css("background-color","#ffffff");
                                $("#select-equipo").css("background","#ffffff");
                                $('#comentarios').val('');
                                $('#comentarios').css("background-color","#ffffff");
                                $('#imagenC').val('');
                                $("#smallImage").attr("src","img/blank.png");
                                $("#photoIcon").attr("src","img/camera.svg");
                                $('#motivos').css("display","block");
                                $('#spanMotivos').css("display","block");
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql( 
                                                "Select * from equiposVIC where id_cedula = ? ORDER BY id_equipos DESC",
                                                    [id_cedula],
                                                    function(tx, results){ 
                                                            var item = results.rows.item(0);
                                                            let motivo="";
                                                            if (item.motivo==1){
                                                                motivo="Da√±o del equipo por uso normal";
                                                            }else if (item.motivo==2){
                                                                motivo="Equipo da√±ado por descuido";
                                                            }else if (item.motivo==3){
                                                                motivo="Mantenimieto correctivo";
                                                            }else if (item.motivo==4){
                                                                motivo="Cambio de equipos (Despachadores de Jab√≥n, Toallero o Higi√©nico)";
                                                            }else if (item.motivo==5){
                                                                motivo="Env√≠o de Rack de 10 o 20 Litros y Rack para atomizadores";
                                                            }
                                                            $("#tabla_equipoVIC").append("<tr id='fila"+ item.id_equipos +"'><td><a href='#' onclick='eliminarFilaVIC("+item.id_equipos +",3);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+
                                                            "' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.equipo
                                                            + "</td><td style='text-align: center;'>" + item.descripcion
                                                            + "</td><td style='text-align: center;'>" + item.cantidad 
                                                            + "</td><td style='text-align: center;'>" + item.ubicacion 
                                                            + "</td><td style='text-align: center;'>" + item.estado 
                                                            + "</td><td style='text-align: center;'>" + item.comentarios
                                                            + "</td><td style='text-align: center;'>" + motivo + "</td></tr>");
                                                                
                                                                $("#message-nr").css("display", "none");
                                                                $('.preloader').remove();
                                                                $('.infinite-scroll-preloader').remove();
                                                        },
                                                            function(tx, error){
                                                                console.log("Error: " + error.message);
                                                                app.preloader.hide();  
                                                            }
                                            );  
                                        },
                                            function(error){
                                                console.log("Error: " + error.message);
                                            },
                                            function(){}
                                    );                
                                },
                                function(tx, error){
                                    console.error("Error al actualizar: " + error.message);
                                }
                            );
                        },
                        function(error){
                            console.error("Error: " + error.message);
                        },
                        function(){}
                    );
                }else{
                    swal("", "Debes de llenar todos los campos" , "warning");
                }
            }
        }
    }

    function validaradio(id){
        //console.log(id);
        if (id=="radio1"){
            $("#radio1").prop("checked", true);
            $("#radio2").prop("checked", false);
        }else if (id=="radio2"){
            $("#radio2").prop("checked", true);
            $("#radio1").prop("checked", false);
        }
    }

    function validaradio1(id, apartado){
        let id_cedula = localStorage.getItem("IdCedula");
        let permite='';
        if (id=="radio11"){
            permite='S√≠';
            $("#radio11").prop("checked", true);
            $("#radio12").prop("checked", false);
            if (apartado==1){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("UPDATE datosVIC SET pregunta_equipo = ? WHERE id_cedula = ?",
                            [permite,id_cedula],
                                function(tx, results){ 
                                    },
                            function(tx, error){
                                console.log("Error: " + error.message);
                                app.preloader.hide();  
                            }
                        );  
                    },
                        function(error){
                            console.log("Error: " + error.message);
                        },
                        function(){}
                );
            }else if (apartado==2){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("UPDATE datosVIC SET pregunta_img = ? WHERE id_cedula = ?",
                            [permite,id_cedula],
                                function(tx, results){ 
                                    },
                            function(tx, error){
                                console.log("Error: " + error.message);
                                app.preloader.hide();  
                            }
                        );  
                    },
                        function(error){
                            console.log("Error: " + error.message);
                        },
                        function(){}
                );
            }if (apartado==3){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("UPDATE datosVIC SET pregunta_entrena = ? WHERE id_cedula = ?",
                            [permite,id_cedula],
                                function(tx, results){ 
                                    },
                            function(tx, error){
                                console.log("Error: " + error.message);
                                app.preloader.hide();  
                            }
                        );  
                    },
                        function(error){
                            console.log("Error: " + error.message);
                        },
                        function(){}
                );
            }if (apartado==4){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("UPDATE datosVIC SET pregunta_pedido = ? WHERE id_cedula = ?",
                            [permite,id_cedula],
                                function(tx, results){ 
                                    },
                            function(tx, error){
                                console.log("Error: " + error.message);
                                app.preloader.hide();  
                            }
                        );  
                    },
                        function(error){
                            console.log("Error: " + error.message);
                        },
                        function(){}
                );
            }
        }else if (id=="radio12"){
            permite='No';
            $("#radio12").prop("checked", true);
            $("#radio11").prop("checked", false);
            if (apartado==1){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("UPDATE datosVIC SET pregunta_equipo = ? WHERE id_cedula = ?",
                            [permite,id_cedula],
                                function(tx, results){ 
                                    },
                            function(tx, error){
                                console.log("Error: " + error.message);
                                app.preloader.hide();  
                            }
                        );  
                    },
                        function(error){
                            console.log("Error: " + error.message);
                        },
                        function(){}
                );
            }else if (apartado==2){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("UPDATE datosVIC SET pregunta_img = ? WHERE id_cedula = ?",
                            [permite,id_cedula],
                                function(tx, results){ 
                                    },
                            function(tx, error){
                                console.log("Error: " + error.message);
                                app.preloader.hide();  
                            }
                        );  
                    },
                        function(error){
                            console.log("Error: " + error.message);
                        },
                        function(){}
                );
            }if (apartado==3){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("UPDATE datosVIC SET pregunta_entrena = ? WHERE id_cedula = ?",
                            [permite,id_cedula],
                                function(tx, results){ 
                                    },
                            function(tx, error){
                                console.log("Error: " + error.message);
                                app.preloader.hide();  
                            }
                        );  
                    },
                        function(error){
                            console.log("Error: " + error.message);
                        },
                        function(){}
                );
            }if (apartado==4){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("UPDATE datosVIC SET pregunta_pedido = ? WHERE id_cedula = ?",
                            [permite,id_cedula],
                                function(tx, results){ 
                                    },
                            function(tx, error){
                                console.log("Error: " + error.message);
                                app.preloader.hide();  
                            }
                        );  
                    },
                        function(error){
                            console.log("Error: " + error.message);
                        },
                        function(){}
                );
            }
        }
    }

    function validaradioAlmacen(id){
        let id_cedula = localStorage.getItem("IdCedula");
        let permite='';
        if (id=="radio1"){
            $("#radio1").prop("checked", true);
            $("#radio2").prop("checked", false);
            permite='S√≠';
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE datosVIC SET permite_almacen = ? WHERE id_cedula = ?",
                        [permite,id_cedula],
                            function(tx, results){ 
                                },
                        function(tx, error){
                            console.log("Error: " + error.message);
                            app.preloader.hide();  
                        }
                    );  
                },
                    function(error){
                        console.log("Error: " + error.message);
                    },
                    function(){}
            );
        }else if (id=="radio2"){
            $("#radio2").prop("checked", true);
            $("#radio1").prop("checked", false);
            permite='No';
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE datosVIC SET permite_almacen = ? WHERE id_cedula = ?",
                        [permite,id_cedula],
                            function(tx, results){ 
                                },
                        function(tx, error){
                            console.log("Error: " + error.message);
                            app.preloader.hide();  
                        }
                    );  
                },
                    function(error){
                        console.log("Error: " + error.message);
                    },
                    function(){}
            );
        }
    }

    function validaradioestadoCuenta(id){
        let id_cedula = localStorage.getItem("IdCedula");
        let permite='';
        if (id=="radio1"){
            $("#radio1").prop("checked", true);
            $("#radio2").prop("checked", false);
            $("#div_radios").css("display", "block");
            permite='S√≠';
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE datosVIC SET estado_cuenta = ? WHERE id_cedula = ?",
                        [permite,id_cedula],
                            function(tx, results){ 
                                },
                        function(tx, error){
                            console.log("Error: " + error.message);
                            app.preloader.hide();  
                        }
                    );  
                },
                    function(error){
                        console.log("Error: " + error.message);
                    },
                    function(){}
            );
        }else if (id=="radio2"){
            $("#radio2").prop("checked", true);
            $("#radio1").prop("checked", false);
            $("#div_radios").css("display", "none");
            permite='No';
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE datosVIC SET estado_cuenta = ? WHERE id_cedula = ?",
                        [permite,id_cedula],
                            function(tx, results){ 
                                },
                        function(tx, error){
                            console.log("Error: " + error.message);
                            app.preloader.hide();  
                        }
                    );  
                },
                    function(error){
                        console.log("Error: " + error.message);
                    },
                    function(){}
            );
        }
    }

    function guardarImagenVIC(){
        let id_cedula = localStorage.getItem("IdCedula");
        let tipoVIC = localStorage.getItem("TipoVIC");
        let estado='';
        var fecha = new Date();
        var fecha_foto = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        let tipo=$('#tiposIV').val();
        let cantidad=$('#cantidad').val();
        let ubicacion=$('#ubicacion').val();
        let comentarios=$('#comentarios').val();
        let foto=$('#imagenC').val();
        if (tipoVIC==1){
            if ($("#radio11").prop("checked") == false && $("#radio12").prop("checked") == false){
                swal("", "Selecciona una opci√≥n de la pregunta" , "warning");
                return false;
            }else{
                if($("#radio1").prop("checked") == true){
                    estado = "Buen Estado";
                } else if($("#radio2").prop("checked") == true){
                    estado = "Mal Estado";
                }
                if(tipo == 0 ){
                    swal("", "Selecciona un tipo" , "warning");
                }else{
                    if (estado && cantidad && ubicacion && comentarios && foto){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("INSERT INTO imagenVIC(id_cedula, tipo, estado, cantidad, ubicacion, comentarios, foto, fecha) VALUES (?,?,?,?,?,?,?,?)",
                                    [id_cedula,tipo,estado,cantidad,ubicacion,comentarios, foto, fecha_foto],
                                    function(tx, results){
                                    swal("","Se guardaron los datos correctamente", "success");
                                    $('#tiposIV').val(0);
                                    $('#tiposIV').css("background-color","#ffffff");
                                    $("#radio1").prop("checked", false);
                                    $("#radio2").prop("checked", false);
                                    $('#cantidad').val('');
                                    $('#cantidad').css("background-color","#ffffff");
                                    $('#ubicacion').val('');
                                    $('#ubicacion').css("background-color","#ffffff");
                                    $('#comentarios').val('');
                                    $('#comentarios').css("background-color","#ffffff");
                                    $('#imagenC').val('');
                                    $("#smallImage").attr("src","img/blank.png");
                                    $("#photoIcon").attr("src","img/camera.svg");
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql(
                                                    "Select * from imagenVIC where id_cedula = ? ORDER BY id_imagen DESC",
                                                        [id_cedula],
                                                        function(tx, results){
                                                                var item = results.rows.item(0);
                                                                let tipo="";
                                                                if (item.tipo==1){
                                                                    tipo="Wallchart";
                                                                }else if (item.tipo==2){
                                                                    tipo="Etiqueta";
                                                                }else if (item.tipo==3){
                                                                    tipo="Imagen del Cliente";
                                                                }else if (item.tipo==4){
                                                                    tipo="Carpeta del Cliente";
                                                                }else if (item.tipo==5){
                                                                    tipo="Concentraci√≥n de Equipos";
                                                                }else if (item.tipo==6){
                                                                    tipo="Env√≠o de Etiquetas";
                                                                }else if (item.tipo==7){
                                                                    tipo="Env√≠o de FT electr√≥nicas";
                                                                }
                                                                $("#tabla_imagen").append("<tr id='fila"+ item.id_imagen +"'><td><a href='#' onclick='eliminarFilaVIC("+ item.id_imagen +",4);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+
                                                                    item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + tipo 
                                                                        + "</td><td style='text-align: center;'>" + item.cantidad + "</td><td style='text-align: center;'>" + item.ubicacion + "</td><td style='text-align: center;'>" + item.estado + "</td><td style='text-align: center;'>" + item.comentarios + "</td></tr>");
                                                                    $("#message-nr").css("display", "none");
                                                                    $('.preloader').remove();
                                                                    $('.infinite-scroll-preloader').remove();
                                                            },
                                                                function(tx, error){
                                                                    console.log("Error: " + error.message);
                                                                    app.preloader.hide();  
                                                                    $("#message-nr").css("display", "none");
                                                                    $('.preloader').remove();
                                                                    $('.infinite-scroll-preloader').remove();
                                                                }
                                                );  
                                            },
                                                function(error){},
                                                function(){}
                                        );   
                                    },
                                    function(tx, error){
                                        console.error("Error al actualizar: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }else{
                        swal("", "Debes de llenar todos los campos" , "warning");
                    }
                }
            }
        }else{
        if($("#radio1").prop("checked") == true){
            estado = "Buen Estado";
        } else if($("#radio2").prop("checked") == true){
            estado = "Mal Estado";
        }
        if(tipo == 0 ){
            swal("", "Selecciona un tipo" , "warning");
        }else{
            if (estado && cantidad && ubicacion && comentarios && foto){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("INSERT INTO imagenVIC(id_cedula, tipo, estado, cantidad, ubicacion, comentarios, foto, fecha) VALUES (?,?,?,?,?,?,?,?)",
                            [id_cedula,tipo,estado,cantidad,ubicacion,comentarios, foto, fecha_foto],
                            function(tx, results){
                            swal("","Se guardaron los datos correctamente", "success");
                            $('#tiposIV').val(0);
                            $('#tiposIV').css("background-color","#ffffff");
                            $("#radio1").prop("checked", false);
                            $("#radio2").prop("checked", false);
                            $('#cantidad').val('');
                            $('#cantidad').css("background-color","#ffffff");
                            $('#ubicacion').val('');
                            $('#ubicacion').css("background-color","#ffffff");
                            $('#comentarios').val('');
                            $('#comentarios').css("background-color","#ffffff");
                            $('#imagenC').val('');
                            $("#smallImage").attr("src","img/blank.png");
                            $("#photoIcon").attr("src","img/camera.svg");
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql(
                                            "Select * from imagenVIC where id_cedula = ? ORDER BY id_imagen DESC",
                                                [id_cedula],
                                                function(tx, results){
                                                        var item = results.rows.item(0);
                                                        let tipo="";
                                                        if (item.tipo==1){
                                                            tipo="Wallchart";
                                                        }else if (item.tipo==2){
                                                            tipo="Etiqueta";
                                                        }else if (item.tipo==3){
                                                            tipo="Imagen del Cliente";
                                                        }else if (item.tipo==4){
                                                            tipo="Carpeta del Cliente";
                                                        }else if (item.tipo==5){
                                                            tipo="Concentraci√≥n de Equipos";
                                                        }else if (item.tipo==6){
                                                            tipo="Env√≠o de Etiquetas";
                                                        }else if (item.tipo==7){
                                                            tipo="Env√≠o de FT electr√≥nicas";
                                                        }
                                                        $("#tabla_imagen").append("<tr id='fila"+ item.id_imagen +"'><td><a href='#' onclick='eliminarFilaVIC("+ item.id_imagen +",4);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+
                                                            item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + tipo 
                                                                + "</td><td style='text-align: center;'>" + item.cantidad + "</td><td style='text-align: center;'>" + item.ubicacion + "</td><td style='text-align: center;'>" + item.estado + "</td><td style='text-align: center;'>" + item.comentarios + "</td></tr>");
                                                            $("#message-nr").css("display", "none");
                                                            $('.preloader').remove();
                                                            $('.infinite-scroll-preloader').remove();
                                                    },
                                                        function(tx, error){
                                                            console.log("Error: " + error.message);
                                                            app.preloader.hide();  
                                                            $("#message-nr").css("display", "none");
                                                            $('.preloader').remove();
                                                            $('.infinite-scroll-preloader').remove();
                                                        }
                                        );  
                                    },
                                        function(error){},
                                        function(){}
                                );   
                            },
                            function(tx, error){
                                console.error("Error al actualizar: " + error.message);
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            }else{
                swal("", "Debes de llenar todos los campos" , "warning");
            }
        }
    }
    }

    function guardaEntrenamiento(){
        //console.log('entrena');
        let id_cedula = localStorage.getItem("IdCedula");
        let tipoVIC = localStorage.getItem("TipoVIC");
        var fecha = new Date();
        var fecha_foto = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        let tipo=$('#tiposCapaV').val();
        let pcapacita=$('#Pcapacitada').val();
        let ppuesto=$('#Ppuesto').val();
        let tema=$('#tema').val();
        let comentarios=$('#comentarios').val();
        let foto=$('#imagenC').val();
        if (tipoVIC==1){
            if ($("#radio11").prop("checked") == false && $("#radio12").prop("checked") == false){
                swal("", "Selecciona una opci√≥n de la pregunta" , "warning");
                return false;
            }else{
                if(tipo == 0 ){
                    swal("", "Selecciona un tipo de capacitaci√≥n" , "warning");
                }else{
                    if (pcapacita && ppuesto && tema && comentarios && foto){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("INSERT INTO entrenaVIC(id_cedula, tipo, persona_capacita, puesto_capacita, tema_capacita, comentarios, foto, fecha) VALUES (?,?,?,?,?,?,?,?)",
                                    [id_cedula,tipo,pcapacita,ppuesto,tema,comentarios, foto, fecha_foto],
                                    function(tx, results){
                                    swal("","Se guardaron los datos correctamente", "success");
                                    $('#tiposCapaV').val(0);
                                    $('#tiposCapaV').css("background-color","#ffffff");
                                    $('#Pcapacitada').val('');
                                    $('#Pcapacitada').css("background-color","#ffffff");
                                    $('#Ppuesto').val('');
                                    $('#Ppuesto').css("background-color","#ffffff");
                                    $('#tema').val('');
                                    $('#tema').css("background-color","#ffffff");
                                    $('#comentarios').val('');
                                    $('#comentarios').css("background-color","#ffffff");
                                    $('#imagenC').val('');
                                    $("#smallImage").attr("src","img/blank.png");
                                    $("#photoIcon").attr("src","img/camera.svg");
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql(
                                                    "Select * from entrenaVIC where id_cedula = ? ORDER BY id_entrena DESC",
                                                        [id_cedula],
                                                        function(tx, results){
                                                                var item = results.rows.item(0);
                                                                let tipo="";
                                                                if (item.tipo==1){
                                                                    tipo="Capacitaci√≥n en l√≠nea";
                                                                }else if (item.tipo==2){
                                                                    tipo="Capacitaci√≥n presencial";
                                                                }
                                                                $("#tabla_entrena").append("<tr id='fila"+ item.id_entrena +"'><td><a href='#' onclick='eliminarFilaVIC("+ item.id_entrena +",5);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+
                                                                    item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + tipo 
                                                                        + "</td><td style='text-align: center;'>" + item.persona_capacita + "</td><td style='text-align: center;'>" + item.puesto_capacita + "</td><td style='text-align: center;'>" + item.tema_capacita + "</td><td style='text-align: center;'>" + item.comentarios + "</td></tr>");
                                                                    $("#message-nr").css("display", "none");
                                                                    $('.preloader').remove();
                                                                    $('.infinite-scroll-preloader').remove();
                                                            },
                                                                function(tx, error){
                                                                    console.log("Error: " + error.message);
                                                                    app.preloader.hide();  
                                                                    $("#message-nr").css("display", "none");
                                                                    $('.preloader').remove();
                                                                    $('.infinite-scroll-preloader').remove();
                                                                }
                                                );  
                                            },
                                                function(error){},
                                                function(){}
                                        );   
                                    },
                                    function(tx, error){
                                        console.error("Error al actualizar: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }else{
                        swal("", "Debes de llenar todos los campos" , "warning");
                    }
                }
            }
        }else{
        if(tipo == 0 ){
            swal("", "Selecciona un tipo de capacitaci√≥n" , "warning");
        }else{
            if (pcapacita && ppuesto && tema && comentarios && foto){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("INSERT INTO entrenaVIC(id_cedula, tipo, persona_capacita, puesto_capacita, tema_capacita, comentarios, foto, fecha) VALUES (?,?,?,?,?,?,?,?)",
                            [id_cedula,tipo,pcapacita,ppuesto,tema,comentarios, foto, fecha_foto],
                            function(tx, results){
                            swal("","Se guardaron los datos correctamente", "success");
                            $('#tiposCapaV').val(0);
                            $('#tiposCapaV').css("background-color","#ffffff");
                            $('#Pcapacitada').val('');
                            $('#Pcapacitada').css("background-color","#ffffff");
                            $('#Ppuesto').val('');
                            $('#Ppuesto').css("background-color","#ffffff");
                            $('#tema').val('');
                            $('#tema').css("background-color","#ffffff");
                            $('#comentarios').val('');
                            $('#comentarios').css("background-color","#ffffff");
                            $('#imagenC').val('');
                            $("#smallImage").attr("src","img/blank.png");
                            $("#photoIcon").attr("src","img/camera.svg");
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql(
                                            "Select * from entrenaVIC where id_cedula = ? ORDER BY id_entrena DESC",
                                                [id_cedula],
                                                function(tx, results){
                                                        var item = results.rows.item(0);
                                                        let tipo="";
                                                        if (item.tipo==1){
                                                            tipo="Capacitaci√≥n en l√≠nea";
                                                        }else if (item.tipo==2){
                                                            tipo="Capacitaci√≥n presencial";
                                                        }
                                                        $("#tabla_entrena").append("<tr id='fila"+ item.id_entrena +"'><td><a href='#' onclick='eliminarFilaVIC("+ item.id_entrena +",5);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+
                                                            item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + tipo 
                                                                + "</td><td style='text-align: center;'>" + item.persona_capacita + "</td><td style='text-align: center;'>" + item.puesto_capacita + "</td><td style='text-align: center;'>" + item.tema_capacita + "</td><td style='text-align: center;'>" + item.comentarios + "</td></tr>");
                                                            $("#message-nr").css("display", "none");
                                                            $('.preloader').remove();
                                                            $('.infinite-scroll-preloader').remove();
                                                    },
                                                        function(tx, error){
                                                            console.log("Error: " + error.message);
                                                            app.preloader.hide();  
                                                            $("#message-nr").css("display", "none");
                                                            $('.preloader').remove();
                                                            $('.infinite-scroll-preloader').remove();
                                                        }
                                        );  
                                    },
                                        function(error){},
                                        function(){}
                                );   
                            },
                            function(tx, error){
                                console.error("Error al actualizar: " + error.message);
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            }else{
                swal("", "Debes de llenar todos los campos" , "warning");
            }
        }
    }
    }
     
    function guardaAlmacen(){
        //console.log('Almacen');
        let id_cedula = localStorage.getItem("IdCedula");
        let foto=$('#imagenC').val();
        let observaciones=$('#observaciones').val();
        let almacen='';
        var fecha = new Date();
        var fecha_foto = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        if($("#radio1").prop("checked") == true){
            almacen = "S√≠";
        } else if($("#radio2").prop("checked") == true){
            almacen = "No";
        }
        if (almacen && observaciones && foto){
            databaseHandler.db.transaction(
                function(tx){//observaciones text, foto blob, fecha text)",
                    tx.executeSql("INSERT INTO almacenVIC(id_cedula, observaciones, foto, fecha) VALUES (?,?,?,?)",
                        [id_cedula,observaciones, foto, fecha_foto],
                        function(tx, results){
                        swal("","Se guardaron los datos correctamente", "success");
                        $('#observaciones').val('');
                        $('#observaciones').css("background-color","#ffffff");
                        $('#imagenC').val('');
                        $("#smallImage").attr("src","img/blank.png");
                        $("#photoIcon").attr("src","img/camera.svg");
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql(
                                        "Select * from almacenVIC where id_cedula = ? ORDER BY id_almacen DESC",
                                            [id_cedula],
                                            function(tx, results){
                                                    var item = results.rows.item(0);
                                                    $("#tabla_almacen").append("<tr id='fila"+ item.id_almacen +"'><td><a href='#' onclick='eliminarFilaVIC("+ item.id_almacen +",6);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+
                                                        item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.observaciones + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                },
                                                    function(tx, error){
                                                        console.log("Error: " + error.message);
                                                        app.preloader.hide();  
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                    }
                                    );  
                                },
                                    function(error){},
                                    function(){}
                            );   
                        },
                        function(tx, error){
                            console.error("Error al actualizar: " + error.message);
                        }
                    );
                },
                function(error){
                    console.error("Error al actualizar: " + error.message);
                },
                function(){}
            );
        }else {
            swal("", "Debes de llenar todos los campos" , "warning");
        }
    }
    function guardaPedido(){
        let id_cedula = localStorage.getItem("IdCedula");
        let tipoVIC = localStorage.getItem("TipoVIC");
        let producto=$('#Busca_producto').val();
        let codigo=$('#codigo').val();
        let descripcion=$('#descripcion').val();
        let inventario=$('#inventario').val();
        let cantidad=$('#cantidad').val();
        let comentarios=$('#comentarios').val();
        if (tipoVIC==1){
            if ($("#radio11").prop("checked") == false && $("#radio12").prop("checked") == false){
                swal("", "Selecciona una opci√≥n de la pregunta" , "warning");
                return false;
            }else{
                if (producto && inventario && cantidad && comentarios){
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("INSERT INTO pedidosVIC(id_cedula, codigo, producto, descripcion, inventario_dia, cantidad_solicitada, comentarios) VALUES (?,?,?,?,?,?,?)",
                                [id_cedula, codigo, producto, descripcion, inventario, cantidad, comentarios],
                                function(tx, results){
                                swal("","Se guardaron los datos correctamente", "success");
                                $('#Busca_producto').val('');
                                $('#Busca_producto').css("background-color","#ffffff");
                                $('#codigo').val('');
                                $('#codigo').css("background-color","#ffffff");
                                $('#cantidad').val('');
                                $('#cantidad').css("background-color","#ffffff");
                                $('#descripcion').val('');
                                $('#descripcion').css("background-color","#ffffff");
                                $('#inventario').val('');
                                $('#inventario').css("background-color","#ffffff");
                                $('#comentarios').val('');
                                $('#comentarios').css("background-color","#ffffff");
                                $('#imagenC').val('');
                                $("#smallImage").attr("src","img/blank.png");
                                $("#photoIcon").attr("src","img/camera.svg");
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql(
                                                "Select * from pedidosVIC where id_cedula = ? ORDER BY id_producto DESC",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                            $("#tabla_pedidos").append("<tr id='fila"+ item.id_producto +"'><td><a href='#' onclick='eliminarFilaVIC("+ item.id_producto +",7);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td style='text-align: center;'>" + 
                                                            item.codigo + "</td><td style='text-align: center;'>" + 
                                                            item.descripcion + "</td><td style='text-align: center;'>" + 
                                                            item.inventario_dia + "</td><td style='text-align: center;'>" + 
                                                            item.cantidad_solicitada + "</td><td style='text-align: center;'>" + 
                                                            item.comentarios + "</td><td style='text-align: center;'>promedio</td><td style='text-align: center;'>fecha compra</td></tr>");
                                                                $("#message-nr").css("display", "none");
                                                                $('.preloader').remove();
                                                                $('.infinite-scroll-preloader').remove();
                                                        },
                                                            function(tx, error){
                                                                console.log("Error: " + error.message);
                                                                app.preloader.hide();  
                                                                $("#message-nr").css("display", "none");
                                                                $('.preloader').remove();
                                                                $('.infinite-scroll-preloader').remove();
                                                            }
                                            );  
                                        },
                                            function(error){},
                                            function(){}
                                    );   
                                },
                                function(tx, error){
                                    console.error("Error al actualizar: " + error.message);
                                }
                            );
                        },
                        function(error){
                            console.error("Error al actualizar: " + error.message);
                        },
                        function(){}
                    );
                }else{
                    swal("", "Debes de llenar todos los campos" , "warning");
                }
            }
        }else{        
        if (producto && codigo && descripcion && inventario && cantidad && comentarios){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("INSERT INTO pedidosVIC(id_cedula, codigo, producto, descripcion, inventario_dia, cantidad_solicitada, comentarios) VALUES (?,?,?,?,?,?,?)",
                        [id_cedula, codigo, producto, descripcion, inventario, cantidad, comentarios],
                        function(tx, results){
                        swal("","Se guardaron los datos correctamente", "success");
                        $('#Busca_producto').val('');
                        $('#Busca_producto').css("background-color","#ffffff");
                        $('#codigo').val('');
                        $('#codigo').css("background-color","#ffffff");
                        $('#descripcion').val('');
                        $('#descripcion').css("background-color","#ffffff");
                        $('#producto').val('');
                        $('#producto').css("background-color","#ffffff");
                        $('#cantidad').val('');
                        $('#cantidad').css("background-color","#ffffff");
                        $('#inventario').val('');
                        $('#inventario').css("background-color","#ffffff");
                        $('#comentarios').val('');
                        $('#comentarios').css("background-color","#ffffff");
                        $('#imagenC').val('');
                        $("#smallImage").attr("src","img/blank.png");
                        $("#photoIcon").attr("src","img/camera.svg");
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql(
                                        "Select * from pedidosVIC where id_cedula = ? ORDER BY id_producto DESC",
                                            [id_cedula],
                                            function(tx, results){
                                                    var item = results.rows.item(0);
                                                    //producto text, codigo text, descripcion text, inventario_dia text, cantidad_solicitada integer, comentarios
                                                    $("#tabla_pedidos").append("<tr id='fila"+ item.id_producto +"'><td><a href='#' onclick='eliminarFilaVIC("+ item.id_producto +",7);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td style='text-align: center;'>" + 
                                                    item.codigo + "</td><td style='text-align: center;'>" + 
                                                    item.descripcion + "</td><td style='text-align: center;'>" + 
                                                    item.inventario_dia + "</td><td style='text-align: center;'>" + 
                                                        item.cantidad_solicitada + "</td><td style='text-align: center;'>" + item.comentarios 
                                                        + "</td><td style='text-align: center;'>promedio</td><td style='text-align: center;'>fecha compra</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                },
                                                    function(tx, error){
                                                        console.log("Error: " + error.message);
                                                        app.preloader.hide();  
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                    }
                                    );  
                                },
                                    function(error){},
                                    function(){}
                            );   
                        },
                        function(tx, error){
                            console.error("Error al actualizar: " + error.message);
                        }
                    );
                },
                function(error){
                        console.error("Error al actualizar: " + error.message);
                },
                function(){}
            );
            }else{
                swal("", "Debes de llenar todos los campos" , "warning");
            }
        }
    }
    function guardaObservaGeneral(){
        let id_cedula = localStorage.getItem("IdCedula");
        let observaciones_generales=$('#observaciones_generales').val();
        if (observaciones_generales){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE datosVIC SET observaciones_generales = ? WHERE id_cedula = ?",
                        [observaciones_generales,id_cedula],
                            function(tx, results){ 
                                swal("","Comentario General Guardado Correctamente", "success");
                                $('#observaciones_generales').css("background-color","#ffffff");
                            },
                        function(tx, error){
                            console.log("Error: " + error.message);
                            app.preloader.hide();  
                        }
                    );  
                },
                    function(error){
                        console.log("Error: " + error.message);
                    },
                    function(){}
            );
        }else{
            swal("", "Debes Colocar un Comentario General" , "warning");
        }
    }
    function cierreVIC(){
        var persona_cuenta='N/A';
        var correo_cuenta='N/A';
        var tipoVIC=localStorage.getItem("TipoVIC");

        if (tipoVIC==1){//Llamada
            if ($("#NombreFirma").val() == "" || $("#eval").val() == ""){
                swal("", "Todos los campos son obligatorios", "warning");
                return false;
            }            
        }else if (tipoVIC==2){//Visita
            if ($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#eval").val() == ""){
                swal("", "Todos los campos son obligatorios", "warning");
                return false;
            }
        }

        if ($("#radio1").prop("checked") == true){
            if ($("#persona_cuenta").val() == "" || ($("#correo_cuenta").val()== "")){
                swal("", "Agrega una persona y correo para el estado de cuenta", "warning");
                return false;
            }else{
                persona_cuenta=$("#persona_cuenta").val();
                correo_cuenta=$("#correo_cuenta").val();
            }
        }

        if ($("#radio1").prop("checked") == false && $("#radio2").prop("checked") == false){
            swal("", "Elige una opci√≥n para el estado de cuenta", "warning");
            return false;
        }
      
      var id_cedula = localStorage.getItem("IdCedula");
      var nombrefirma = $("#NombreFirma").val();
      var firmaCliente = $("#signate").val();
      if($("#eval").val() <= '3' && $("#comentario_cliente").val() == ""){
          swal("","Por favor, ingresa el motivo de tu calificacion","warning");
          return false;
      }
      var calificacion = $("#eval").val();
      var comentarioCliente = $('#comentario_cliente').val();
      var fecha = new Date();
      var fecha_firma =
          fecha.getFullYear() +
          "-" +
          (fecha.getMonth() + 1) +
          "-" +
          fecha.getDate() +
          " " +
          fecha.getHours() +
          ":" +
          fecha.getMinutes() +
          ":" +
          fecha.getSeconds();

      databaseHandler.db.transaction(
        function (tx) {
          tx.executeSql(
            "UPDATE datosVIC SET firma_cliente = ?, persona_cuenta = ?, correo_cuenta = ? WHERE id_cedula = ?",
            [firmaCliente, persona_cuenta, correo_cuenta, id_cedula],
            function (tx, results) {
              databaseHandler.db.transaction(
                function (tx) {
                  tx.executeSql(
                    "UPDATE cedulas_general SET calificacion = ?, nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                    [calificacion, nombrefirma, comentarioCliente, id_cedula],
                    function (tx, results) {
                      swal("", "Guardado correctamente", "success");
                      app.views.main.router.back("/yamevoyVICVIC/", {
                        force: true,
                        ignoreCache: true,
                        reload: true,
                      });
                    },
                    function (tx, error) {
                      console.error("Error al guardar cierre: " + error.message);
                    }
                  );
                },
                function (error) {},
                function () {}
              );
            },
            function (tx, error) {
              console.error("Error al guardar cierre: " + error.message);
            }
          );
        },
        function (error) {},
        function () {}
      );
    }

    function terminarVICVIC(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datosVIC SET foto_salida = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function validaradio2(id){
        if (id=="radio1"){
            $("#radio1").prop("checked", true);
            $("#radio2").prop("checked", false);
            $('#motivos').css("display","none");
            $('#spanMotivos').css("display","none");
            $('#motivos').val(0);
        }else if (id=="radio2"){
            $("#radio2").prop("checked", true);
            $("#radio1").prop("checked", false);
            $('#motivos').css("display","block");
            $('#spanMotivos').css("display","block");
        }
    }
    function equipos(){
        var rol = localStorage.getItem("rol");
        var roles = rol.split("-");
        var empresa1=roles[1];

        app.preloader.show('blue');
        var enviado=1;
        if (empresa1=='B'){
            var NomDescCli = "Equipos_1BEN";
        }else if (empresa1=='K'){
            var NomDescCli = "Equipos_1KEY";
        }
        
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("DELETE FROM equiposCargados WHERE enviado = ?",
                [enviado],
                function(tx, results){
                    app.request.get(cordova.file.dataDirectory + "jsons/"+NomDescCli+".json", function (data) {
                        var content = JSON.parse(data);
                        for (var i = 0; i < content.length; i++) {
                            var id_cliente = (content[i].id_cliente);
                            var codigo=(content[i].codigo);
                            var descripcion = (content[i].descripcion);
                            productHandler.addVICEquipos(id_cliente,codigo,descripcion, enviado);
                        }
                        app.preloader.hide();
                    });
                },
                function(tx, error){
                    swal("Error al borrar equipos cargados", error.message, "error");
                    app.preloader.hide();
                }
                );
            },
            function(error){app.preloader.hide();},
            function(){}
        );
    }
    function validarAud(){
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("Select * from datosVIC where id_cedula = ?",
                [id_cedula],
                    function(tx, results){
                        var item = results.rows.item(0);
                        var emp = item.tipo_empresa; 
                        console.log("empresa",emp);
                        if(emp){
                            app.views.main.router.navigate({ name: 'Recorrido1VIC' });
                        }else{
                            app.views.main.router.navigate({ name: 'tipoAud' });
                        }
                    },
                    function(tx, error){
                        console.log("Error al guardar: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function RecomendacionVIC(res,orden,id_pregunta,factor){
        var id_cedula = localStorage.getItem("IdCedula");    
         databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql(
                    "UPDATE VIC_Respuesta SET recomendacion = ? WHERE id_cedula = ?   and orden =? and id_pregunta =?  ",
                    [res,id_cedula,orden,id_pregunta],
                    function (tx, results) {
                        app.preloader.hide();
                    },
                    function (tx, error) {
                        console.log("Error al guardar registroVIC: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function (error) { },
            function () { }
        );
    }
    function AlmacenarError(respuesta){
        var datos = new Array();
        var id_usuario = localStorage.getItem("id_usuario"); ;
        var id_empresa = localStorage.getItem("id_empresa");;
        datos[0] = {'id_usario':id_usuario,'id_empresa':id_empresa,'respuesta':respuesta};
        console.log(datos)
        $.ajax({
            type: "POST",
            async : true,
            url: "http://www.appbennetts.com/FWM2/app/guardarErrorRespuesta.php",
            dataType: 'html',
            data: {'datos': JSON.stringify(datos)},
            success: function(respuesta){
                if(respuesta != 'ok'){
                   // AlmacenarError(respuesta)
                }

            },
            error: function(){
                console.log("Error en la comunicacion con el servidor");
            }
        });
    }
    function guardarDatosApoyoVIC(){
        let id_cedula = localStorage.getItem("IdCedula");
        var  proyecto=$('#noPro').val();
        var comentarios=$('#comentarios').val();
        var companero=$('#noCom').val();
        var fecha = new Date();
        var fecha_creacion = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate();
        var estatusEn = 1;
        var fecha = new Date();
        var fecha_tomada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        
        if(proyecto && comentarios && companero){
            app.preloader.show('blue');
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("INSERT INTO apoyo_venta_vic(id_cedula, proyecto , companero , comentario,fecha ) VALUES (?,?,?,?,?)",
                        [id_cedula,proyecto,comentarios,companero,fecha_tomada],
                        function(tx, results){
                            //console.log("Datos Guardados");
                            swal("","Se guardaron los datos correctamente", "success");
                            //$('#nombreCliente').css("background-color","#ffffff");
                            $('#noPro').val('');
                            $('#comentarios').val('');
                            $('#noCom').val('');
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("UPDATE cedulas_general SET estatus = ?, fecha_salida = ? WHERE id_cedula = ?",
                                        [estatusEn,fecha_creacion,id_cedula],
                                        function(tx, results){                                                                   
                                            swal("","El proyecto se guardo correctamente", "success"); 
                                            window.location.href = "./menu.html";
                                        },
                                        function(tx, error){
                                            swal("Error al guardar",error.message,"error");
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                           
                    },
                        function(tx, error){
                            console.error("Error al guardar: " + error.message);
                            swal("","Ha ocurrido un error al guardar", "error");
                            app.preloader.hide();
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else{
            swal("", "Todos los campos son obligatorios", "warning"); 
        }
    }
    function guardarDcliente(){
        let id_cedula = localStorage.getItem("IdCedula");
        let id_proyecto= localStorage.getItem("IdProyecto");
        var Patiende=$('#Patiende2').val();
        var Ppuesto=$('#Ppuesto2').val();
        var Ptelefono=$('#Ptelefono2').val();
        var Pcorreo=$('#Pcorreo2').val();
        if (id_proyecto==0){
            swal("", "Favor de seleccionar un proyecto", "warning");
        }else{
            if (Patiende && Ppuesto && Ptelefono && Pcorreo){
            //console.log(actividades);
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("INSERT INTO datos_contacto(id_cedula ,id_proyecto , nombre_cliente , puesto_cliente, telefono, correo) VALUES (?,?,?,?,?,?)",
                                [id_cedula,id_proyecto,Patiende,Ppuesto,Ptelefono,Pcorreo],
                                function(tx, results){
                                //console.log("actualizados datos de evidencia");
                                swal("","Se guardaron los datos correctamente", "success");
                                $('#Patiende').css("background-color","#ffffff");
                                $('#Ppuesto').css("background-color","#ffffff");
                                $('#Ptelefono').css("background-color","#ffffff");
                                $('#Pcorreo').css("background-color","#ffffff");
                                },
                                function(tx, error){
                                    console.error("Error al actualizar: " + error.message);
                                }
                            );
                        },
                        function(error){},
                        function(){}
                    );
                
            }else{
                swal("", "Todos los campos son obligatorios", "warning");
            }
        }
    }
    function generarVentas(tipo){
        //console.log('generarVentaas');
        let id_cedula = localStorage.getItem("IdCedula");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let sucursal = localStorage.getItem("sucursal");
        localStorage.setItem("IdProyecto",0);
        if (tipo==1){
            var tipoCedula = "VentasVIC_SinV";
        }else if (tipo==2){
            var tipoCedula = "VentasVIC_ConV";
        }else if (tipo==3){
            var tipoCedula = "VentasVIC_Acompa";
        }
        let id_proyecto = 0;
        let nivel = 0;
        var id_usuario = localStorage.getItem("id_usuario");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ?  WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        var Nom = 'Gestion-SE-VIC';
                        app.request.get(cordova.file.dataDirectory + "jsons/"+Nom+".json", function (data) {   
                            var content = JSON.parse(data);    
                            var Proyect = content[3];
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("DELETE FROM proyectos_vic",
                                        [],
                                        function(tx, results){
                                            for(let i = 0; i < Proyect.length ;i++){
                                                if(Proyect[i].id_usuario == id_usuario && Proyect[i].nivel != 6)  {
                                                    databaseHandler.db.transaction(
                                                        function(tx){
                                                            tx.executeSql("Insert into proyectos_vic(id_proyecto,id_usuario, nombre_proyecto, potencial, segmento, division, fecha_creacion, enviado,estrategia,metodo,grupo,nivel) VALUES (?,?,?,?,?,?,?,?,?,?,?,?)",
                                                                [Proyect[i].id_proyecto,Proyect[i].id_usuario, Proyect[i].nombre_proyecto, Proyect[i].potencial, Proyect[i].segmento, Proyect[i].division, Proyect[i].fecha_creacion,  Proyect[i].enviado,Proyect[i].estrategia,Proyect[i].metodo,Proyect[i].grupo,Proyect[i].nivel],
                                                                function(tx, results){
                                                                    databaseHandler.db.transaction(
                                                                        function(tx){
                                                                            tx.executeSql("UPDATE ventas_bennetts SET nivel = ?,nombre_cliente = ?, puesto_cliente = ?, telefono = ?, correo = ? WHERE id_proyecto = ?",
                                                                                [Proyect[i].nivel,Proyect[i].nombre_cliente,Proyect[i].puesto_cliente,Proyect[i].telefono,Proyect[i].correo,Proyect[i].id_proyecto],
                                                                                function(tx, results){
                                                                                    //console.log("actualizados datos de evidencia");
                                                                                    // swal("","Se guardaron los datos correctamente", "success");
                                                                                },
                                                                                function(tx, error){
                                                                                    console.error("Error al actualizar: " + error.message);
                                                                                }
                                                                            );
                                                                        },
                                                                        function(error){},
                                                                        function(){}
                                                                    );
                                                                },
                                                                function(tx, error){
                                                                    swal("Error al guardar",error.message,"error");
                                                                }
                                                            );
                                                        },
                                                        function(error){},
                                                        function(){}
                                                    );
                                                }
                                            }
                                       },
                                        function(tx, error){
                                            console.error("Error: " + error.message);
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                            if (tipoCedula == "VentasVIC_SinV"){
                                app.views.main.router.navigate({name: 'datosgeneralesVIC4'});
                            }else if (tipoCedula == "VentasVIC_ConV"){
                                app.views.main.router.navigate({name: 'recorridoVIC2'});
                            }else if (tipoCedula == "VentasVIC_Acompa"){
                                app.views.main.router.navigate({name: 'recorridoVIC4'});
                            }
                        });
                   },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function regresarRecorridoVIC4(){
        app.views.main.router.back('/menuVentas/', {force: true, ignoreCache: true, reload: true});
    }
    function generarTablaVentas(){
        let foto_llegada = localStorage.getItem("foto_llegada");
        let id_proyecto = 0;
        let nivel = 0;
        let id_cedula = localStorage.getItem("IdCedula");
        productHandler.addVICVentas(id_cedula, foto_llegada,id_proyecto,nivel);               
    }
    function guardarDcliente (){
        let id_cedula = localStorage.getItem("IdCedula");
        let id_proyecto= localStorage.getItem("IdProyecto");
        var Patiende=$('#Patiende2').val();
        var Ppuesto=$('#Ppuesto2').val();
        var Ptelefono=$('#Ptelefono2').val();
        var Pcorreo=$('#Pcorreo2').val();
        if (id_proyecto==0){
            swal("", "Favor de seleccionar un proyecto", "warning");
        }else{
            if (Patiende && Ppuesto && Ptelefono && Pcorreo){
            //console.log(actividades);
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("INSERT INTO datos_contacto(id_cedula ,id_proyecto , nombre_cliente , puesto_cliente, telefono, correo) VALUES (?,?,?,?,?,?)",
                                [id_cedula,id_proyecto,Patiende,Ppuesto,Ptelefono,Pcorreo],
                                function(tx, results){
                                //console.log("actualizados datos de evidencia");
                                swal("","Se guardaron los datos correctamente", "success");
                                $('#Patiende').css("background-color","#ffffff");
                                $('#Ppuesto').css("background-color","#ffffff");
                                $('#Ptelefono').css("background-color","#ffffff");
                                $('#Pcorreo').css("background-color","#ffffff");
                                app.sheet.close('#sheet-modal');
                                document.getElementById('sheet-modal').style.display = 'none';
                                },
                                function(tx, error){
                                    console.error("Error al actualizar: " + error.message);
                                }
                            );
                        },
                        function(error){},
                        function(){}
                    );
                
            }else{
                swal("", "Todos los campos son obligatorios", "warning");
            }
        }
    }
    // Fin VIC
    // Dilimipio Inicio
    function buscarClienteDilimpio() {
        app.preloader.show('blue');
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario =
          localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var horario_programado = fecha_llegada;
        var foto_llegada = $("#imagenC").val();
        var id_cliente = $("#id_cliente").val();
        var nombre_cliente = $("#nombre_cliente").val();
        var nombre_comercial = $("#NombreComercial").val();
        var nombre_contacto = $("#NombreContacto").val();
        var telefono = $("#Telefono").val();
        var correo = $("#Correo").val();
        var estatus_cliente = 'Estatus';
        var estatus = 0;
        if (foto_llegada!=''){
            if (nombre_cliente!=''){
            productHandler.addCedulaDilimpio(id_usuario, nombre_usuario, fecha_llegada, geolocation, id_cliente, nombre_cliente, horario_programado, estatus);
            databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql(
                "Select MAX(id_cedula) as Id from cedulas_general",
                [],
                function (tx, results) {
                    var item = results.rows.item(0);
                    localStorage.setItem("IdCedula", item.Id);
                    localStorage.setItem("foto_llegada", foto_llegada);
                    localStorage.setItem("id_cliente", id_cliente);
                    localStorage.setItem("nombre_cliente", nombre_cliente);
                    localStorage.setItem("nombre_comercial", nombre_comercial);
                    localStorage.setItem("nombre_contacto", nombre_contacto);
                    localStorage.setItem("telefono", telefono);
                    localStorage.setItem("correo", correo);
                    localStorage.setItem("estatus_cliente", estatus_cliente);

                    app.views.main.router.navigate({ name: "menuDilimpio" });
                    app.preloader.hide();
                },
                function (tx, error) {
                    console.log("Error al guardar cedula: " + error.message);
                    app.preloader.hide();
                }
                );
            },
            function (error) {},
            function () {}
            );
            }else{
                swal("", "Favor de seleccionar un Cliente" , "warning");
                app.preloader.hide();
            } 
        }else{
            swal("", "La foto es requerida para continuar" , "warning");
            app.preloader.hide();
        }
    }
    function generarVisitaDilimpio(){
        let id_cedula = localStorage.getItem("IdCedula");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let id_cliente = localStorage.getItem("id_cliente");
        let nombre_cliente = localStorage.getItem("nombre_cliente");
        let nombre_contacto = localStorage.getItem("nombre_contacto");
        let correo = localStorage.getItem("correo");
        let estatus_cliente = localStorage.getItem("estatus_cliente");
        let telefono = localStorage.getItem("telefono");
        let id_visita = localStorage.getItem("id_visita");

        let tipoCedula = "visitaDilimpio";
        
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ?  WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addVisitaDL(id_cedula, foto_llegada, id_cliente, nombre_cliente, nombre_contacto, correo,telefono, id_visita);
                        app.views.main.router.back('/recorridoDL1/', {force: true, ignoreCache: true, reload: true});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){console.error("Error al actualizar el tipo de cedula: " + error.message);},
            function(){}
        );
    }
    function continuarCedDL(id_cedula,tipo){
        localStorage.setItem("IdCedula",id_cedula);
        localStorage.setItem("Opcion", '1');
        if(tipo == 1){
            app.views.main.router.navigate({ name: 'recorridoDL1'});
        } else if(tipo == 2){
            app.views.main.router.navigate({ name: 'recorridoDL2'});
        }
    }
    
    function guardarDatosGDL(){
        let id_cedula = localStorage.getItem("IdCedula");
        let cliente = $("#cliente").val();
        let contacto = $("#nombre_contacto").val();
        let correo = $("#correo").val();
        let estatus = 'Estatus';
        let telefono = $("#telefono").val();
        if(cliente && contacto && estatus && correo && telefono){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE visitaDilimpio SET nombre_contacto=?, correo=?, estatus_cliente =?,telefono=? WHERE id_cedula = ?",
                        [contacto,correo,estatus,telefono,id_cedula],
                        function(tx, results){
                        //console.log("actualizados datos de evidencia");
                        swal("","Se guardaron los datos correctamente", "success");
                        $('#cliente').css("background-color","#ffffff");
                        $('#nombre_contacto').css("background-color","#ffffff");
                        $('#correo').css("background-color","#ffffff");
                        $('#estatus_cliente').css("background-color","#ffffff");
                        $('#telefono').css("background-color","#ffffff");
                        },
                        function(tx, error){
                            console.error("Error al actualizar: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else{
            swal("", "Debes de llenar todos los campos" , "warning");
        }
    }
    function guardaEquipoDL(){  
        let id_cedula = localStorage.getItem("IdCedula");
        let tipoVIC = localStorage.getItem("TipoVIC");
        let equipos=$('#select-equipo').val();
        let decripcion=$('#descripcionEquipo').val();
        let estado='';
        var fecha = new Date();
        var fecha_foto = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        let cantidad=$('#cantidad').val();
        let ubicacion=$('#ubicacion').val();
        let motivos=$('#motivos').val();
        let comentarios=$('#comentarios').val();
        let foto=$('#imagenC').val();
            if($("#radio1").prop("checked") == true){
                estado = "Buen Estado";
            } else if($("#radio2").prop("checked") == true){
                estado = "Mal Estado";
                    if(motivos == 0){
                        swal("", "Debes de seleccionar un motivo" , "warning");
                        return false;
                    }
            }
            if(equipos==0){
                swal("", "Debes de llenar todos los campos" , "warning");
            }else{
                if (estado && cantidad && ubicacion && comentarios && foto){
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("INSERT INTO equiposDL(id_cedula, estado, equipo, descripcion, cantidad, ubicacion, motivo, comentarios, foto, fecha) VALUES (?,?,?,?,?,?,?,?,?,?)",
                                [id_cedula,estado,equipos,decripcion,cantidad,ubicacion,motivos,comentarios, foto, fecha_foto],
                                function(tx, results){
                                swal("","Se guardaron los datos correctamente", "success");
                                $('#select-equipo').val(0);
                                $('#motivos').val(0);
                                $('#motivos').css("background-color","#ffffff");
                                $('#cantidad').val('');
                                $('#cantidad').css("background-color","#ffffff");
                                $("#radio1").prop("checked", false);
                                $("#radio2").prop("checked", false);
                                $('#ubicacion').val('');
                                $('#ubicacion').css("background-color","#ffffff");
                                $("#select-equipo").css("background","#ffffff");
                                $('#comentarios').val('');
                                $('#comentarios').css("background-color","#ffffff");
                                $('#imagenC').val('');
                                $("#smallImage").attr("src","img/blank.png");
                                $("#photoIcon").attr("src","img/camera.svg");
                                $('#motivos').css("display","block");
                                $('#spanMotivos').css("display","block");
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql( 
                                                "Select * from equiposDL where id_cedula = ? ORDER BY id_equipos DESC",
                                                    [id_cedula],
                                                    function(tx, results){ 
                                                            var item = results.rows.item(0);
                                                            let motivo="";
                                                            if (item.motivo==1){
                                                                motivo="Da√±o del equipo por uso normal";
                                                            }else if (item.motivo==2){
                                                                motivo="Equipo da√±ado por descuido";
                                                            }else if (item.motivo==3){
                                                                motivo="Mantenimieto correctivo";
                                                            }else if (item.motivo==4){
                                                                motivo="Cambio de equipos (Despachadores de Jab√≥n, Toallero o Higi√©nico)";
                                                            }else if (item.motivo==5){
                                                                motivo="Env√≠o de Rack de 10 o 20 Litros y Rack para atomizadores";
                                                            }
                                                            $("#tabla_equipoVIC").append("<tr id='fila"+ item.id_equipos +"'><td><a href='#' onclick='eliminarFilaDL("+item.id_equipos +",3);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+
                                                            "' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.equipo
                                                            + "</td><td style='text-align: center;'>" + item.descripcion
                                                            + "</td><td style='text-align: center;'>" + item.cantidad 
                                                            + "</td><td style='text-align: center;'>" + item.ubicacion 
                                                            + "</td><td style='text-align: center;'>" + item.estado 
                                                            + "</td><td style='text-align: center;'>" + item.comentarios
                                                            + "</td><td style='text-align: center;'>" + motivo 
                                                            + "</td><td style='text-align: center;'>" + item.fecha + "</td></tr>");
                                                                
                                                                $("#message-nr").css("display", "none");
                                                                $('.preloader').remove();
                                                                $('.infinite-scroll-preloader').remove();
                                                        },
                                                            function(tx, error){
                                                                console.log("Error: " + error.message);
                                                                app.preloader.hide();  
                                                            }
                                            );  
                                        },
                                            function(error){
                                                console.log("Error: " + error.message);
                                            },
                                            function(){}
                                    );                
                                },
                                function(tx, error){
                                    console.error("Error al actualizar: " + error.message);
                                }
                            );
                        },
                        function(error){
                            console.error("Error: " + error.message);
                        },
                        function(){}
                    );
                }else{
                    swal("", "Debes de llenar todos los campos" , "warning");
                }
            }
    }
    function guardarEquipoDL(){
        var id_cliente = localStorage.getItem("id_cliente");
        var id_usuario = localStorage.getItem("id_usuario");
        var enviado=0;
        var agrega=0;
        let nombreEquipo=$('#nombre_equipo').val();
        let codigoEquipo = $('#codigoEquipo').val();
        if (codigoEquipo==''){
            app.dialog.alert('Ingresa un equipo v√°lido.', 'Aviso');
        }else{
            if(nombreEquipo){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql(
                            "Select * from equiposCargadosDL where id_cliente = ? and codigo = ? ORDER BY id_equipo DESC",
                                [id_cliente, codigoEquipo],
                                function(tx, results){
                                    let length = results.rows.length;
                                        var item = results.rows.item(0);
                                        if (length!=0){
                                            console.log('existe en base');
                                            swal("","Equipo guardado correctamente", "success");
                                            app.sheet.close('#sheet-modal');
                                            $('#nombre_equipo').val('');
                                            $('#codigoEquipo').val('');
                                        }
                                        else{
                                            console.log('NO existe en base');
                                            databaseHandler.db.transaction(
                                                function(tx){
                                                    tx.executeSql("INSERT INTO equiposCargadosDL(id_cliente, codigo, descripcion, id_usuario, enviado) VALUES (?,?,?,?,?)",
                                                        [id_cliente,codigoEquipo, nombreEquipo, id_usuario, enviado],
                                                            function(tx, results){
                                                                let length = results.rows.length;
                                                                    var item = results.rows.item(0);
                                                                    $("#select-equipo").append("<option value="+codigoEquipo+">"+codigoEquipo+"</option>");
                                                                    swal("","Equipo guardado correctamente", "success");
                                                                    app.sheet.close('#sheet-modal');
                                                                    $('#nombre_equipo').val('');
                                                                    $('#codigoEquipo').val('');
                                                                },
                                                            function(tx, error){
                                                            console.log("Error: " + error.message);
                                                            }
                                                    );
                                                },
                                                    function(error){},
                                                    function(){}
                                            );
                                        };
                                    },
                                function(tx, error){
                                    console.log("Error: " + error.message);
                                }
                        );  
                    },
                        function(error){
                            console.log('NO existe en base');
                                            databaseHandler.db.transaction(
                                                function(tx){
                                                    tx.executeSql("INSERT INTO equiposCargadosDL(id_cliente, codigo, descripcion, id_usuario, enviado) VALUES (?,?,?,?,?)",
                                                        [id_cliente,codigoEquipo, nombreEquipo, id_usuario, enviado],
                                                            function(tx, results){
                                                                let length = results.rows.length;
                                                                    var item = results.rows.item(0);
                                                                    $("#select-equipo").append("<option value="+codigoEquipo+">"+nombreEquipo+"</option>");
                                                                    swal("","Equipo guardado correctamente", "success");
                                                                    app.sheet.close('#sheet-modal');
                                                                    $('#nombre_equipo').val('');
                                                                    $('#codigoEquipo').val('');
                                                                },
                                                            function(tx, error){
                                                            console.log("Error: " + error.message);
                                                            }
                                                    );
                                                },
                                                    function(error){},
                                                    function(){}
                                            );
                        },
                        function(){}
                );
            }else{
                app.dialog.alert('Debes seleccionar un proyecto.', 'Aviso');
            }
        }
    }
    
    function eliminarFilaDL(index, opc){
        if(opc == 1) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM entregasDL WHERE id_entrega = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimino satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 2) {
            
        }
        if(opc == 3) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM equiposDL WHERE id_equipos = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimino satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 4) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM imagenDL WHERE id_imagen = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimino satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 5) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM entrenaDL WHERE id_entrena = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimino satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 6) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM almacenDL WHERE id_almacen = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimino satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 7) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM pedidosDL WHERE id_producto = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimino satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function guardarImagenDL(){
        let id_cedula = localStorage.getItem("IdCedula");
        let estado='';
        var fecha = new Date();
        var fecha_foto = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        let tipo=$('#tiposIV').val();
        let cantidad=$('#cantidad').val();
        let ubicacion=$('#ubicacion').val();
        let comentarios=$('#comentarios').val();
        let foto=$('#imagenC').val();
        if($("#radio1").prop("checked") == true){
            estado = "Buen Estado";
        } else if($("#radio2").prop("checked") == true){
            estado = "Mal Estado";
        }
        if(tipo == 0 ){
            swal("", "Selecciona un tipo" , "warning");
        }else{
            if (estado && cantidad && ubicacion && comentarios && foto){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("INSERT INTO imagenDL(id_cedula, tipo, estado, cantidad, ubicacion, comentarios, foto, fecha) VALUES (?,?,?,?,?,?,?,?)",
                            [id_cedula,tipo,estado,cantidad,ubicacion,comentarios, foto, fecha_foto],
                            function(tx, results){
                            swal("","Se guardaron los datos correctamente", "success");
                            $('#tiposIV').val(0);
                            $('#tiposIV').css("background-color","#ffffff");
                            $("#radio1").prop("checked", false);
                            $("#radio2").prop("checked", false);
                            $('#cantidad').val('');
                            $('#cantidad').css("background-color","#ffffff");
                            $('#ubicacion').val('');
                            $('#ubicacion').css("background-color","#ffffff");
                            $('#comentarios').val('');
                            $('#comentarios').css("background-color","#ffffff");
                            $('#imagenC').val('');
                            $("#smallImage").attr("src","img/blank.png");
                            $("#photoIcon").attr("src","img/camera.svg");
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql(
                                            "Select * from imagenDL where id_cedula = ? ORDER BY id_imagen DESC",
                                                [id_cedula],
                                                function(tx, results){
                                                        var item = results.rows.item(0);
                                                        let tipo="";
                                                        if (item.tipo==1){
                                                            tipo="Wallchart";
                                                        }else if (item.tipo==2){
                                                            tipo="Etiqueta";
                                                        }else if (item.tipo==3){
                                                            tipo="Imagen del Cliente";
                                                        }else if (item.tipo==4){
                                                            tipo="Carpeta del Cliente";
                                                        }else if (item.tipo==5){
                                                            tipo="Concentraci√≥n de Equipos";
                                                        }else if (item.tipo==6){
                                                            tipo="Env√≠o de Etiquetas";
                                                        }else if (item.tipo==7){
                                                            tipo="Env√≠o de FT electr√≥nicas";
                                                        }
                                                        $("#tabla_imagen").append("<tr id='fila"+ item.id_imagen +"'><td><a href='#' onclick='eliminarFilaDL("+ item.id_imagen +",4);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+
                                                            item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + tipo 
                                                                + "</td><td style='text-align: center;'>" + item.cantidad + "</td><td style='text-align: center;'>" + item.ubicacion + "</td><td style='text-align: center;'>" + item.estado + "</td><td style='text-align: center;'>" + item.comentarios + "</td><td style='text-align: center;'>" + item.fecha + "</td></tr>");
                                                            $("#message-nr").css("display", "none");
                                                            $('.preloader').remove();
                                                            $('.infinite-scroll-preloader').remove();
                                                    },
                                                        function(tx, error){
                                                            console.log("Error: " + error.message);
                                                            app.preloader.hide();  
                                                            $("#message-nr").css("display", "none");
                                                            $('.preloader').remove();
                                                            $('.infinite-scroll-preloader').remove();
                                                        }
                                        );  
                                    },
                                        function(error){},
                                        function(){}
                                );   
                            },
                            function(tx, error){
                                console.error("Error al actualizar: " + error.message);
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            }else{
                swal("", "Debes de llenar todos los campos" , "warning");
            }
        }
    }
    function guardaEntrenamientoDL(){
        let id_cedula = localStorage.getItem("IdCedula");
        var fecha = new Date();
        var fecha_foto = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        let tipo=$('#tiposCapaV').val();
        let pcapacita=$('#Pcapacitada').val();
        let ppuesto=$('#Ppuesto').val();
        let tema=$('#tema').val();
        let comentarios=$('#comentarios').val();
        let foto=$('#imagenC').val();
        if(tipo == 0 ){
            swal("", "Selecciona un tipo de capacitaci√≥n" , "warning");
        }else{
            if (pcapacita && ppuesto && tema && comentarios && foto){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("INSERT INTO entrenaDL(id_cedula, tipo, persona_capacita, puesto_capacita, tema_capacita, comentarios, foto, fecha) VALUES (?,?,?,?,?,?,?,?)",
                            [id_cedula,tipo,pcapacita,ppuesto,tema,comentarios, foto, fecha_foto],
                            function(tx, results){
                            swal("","Se guardaron los datos correctamente", "success");
                            $('#tiposCapaV').val(0);
                            $('#tiposCapaV').css("background-color","#ffffff");
                            $('#Pcapacitada').val('');
                            $('#Pcapacitada').css("background-color","#ffffff");
                            $('#Ppuesto').val('');
                            $('#Ppuesto').css("background-color","#ffffff");
                            $('#tema').val('');
                            $('#tema').css("background-color","#ffffff");
                            $('#comentarios').val('');
                            $('#comentarios').css("background-color","#ffffff");
                            $('#imagenC').val('');
                            $("#smallImage").attr("src","img/blank.png");
                            $("#photoIcon").attr("src","img/camera.svg");
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql(
                                            "Select * from entrenaDL where id_cedula = ? ORDER BY id_entrena DESC",
                                                [id_cedula],
                                                function(tx, results){
                                                    var item = results.rows.item(0);
                                                    let tipo="";
                                                    if (item.tipo==1){
                                                        tipo="Capacitaci√≥n en l√≠nea";
                                                    }else if (item.tipo==2){
                                                        tipo="Capacitaci√≥n presencial";
                                                    }
                                                    $("#tabla_entrena").append("<tr id='fila"+ item.id_entrena +"'><td><a href='#' onclick='eliminarFilaDL("+ item.id_entrena +",5);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+
                                                        item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + 
                                                        tipo + "</td><td style='text-align: center;'>" + 
                                                        item.persona_capacita + "</td><td style='text-align: center;'>" + 
                                                        item.puesto_capacita + "</td><td style='text-align: center;'>" + 
                                                        item.tema_capacita + "</td><td style='text-align: center;'>" + 
                                                        item.comentarios + "</td><td style='text-align: center;'>" + 
                                                        item.fecha + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                },
                                                    function(tx, error){
                                                        console.log("Error: " + error.message);
                                                        app.preloader.hide();  
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                    }
                                        );  
                                    },
                                        function(error){},
                                        function(){}
                                );   
                            },
                            function(tx, error){
                                console.error("Error al actualizar: " + error.message);
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            }else{
                swal("", "Debes de llenar todos los campos" , "warning");
            }
        }
    }
    function validaradioAlmacenDL(id){
        let id_cedula = localStorage.getItem("IdCedula");
        let permite='';
        if (id=="radio1"){
            $("#radio1").prop("checked", true);
            $("#radio2").prop("checked", false);
            permite='S√≠';
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE visitaDilimpio SET permite_almacen = ? WHERE id_cedula = ?",
                        [permite,id_cedula],
                            function(tx, results){ 
                                },
                        function(tx, error){
                            console.log("Error: " + error.message);
                            app.preloader.hide();  
                        }
                    );  
                },
                    function(error){
                        console.log("Error: " + error.message);
                    },
                    function(){}
            );
        }else if (id=="radio2"){
            $("#radio2").prop("checked", true);
            $("#radio1").prop("checked", false);
            permite='No';
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE visitaDilimpio SET permite_almacen = ? WHERE id_cedula = ?",
                        [permite,id_cedula],
                            function(tx, results){ 
                                },
                        function(tx, error){
                            console.log("Error: " + error.message);
                            app.preloader.hide();  
                        }
                    );  
                },
                    function(error){
                        console.log("Error: " + error.message);
                    },
                    function(){}
            );
        }
    }
    function guardaAlmacenDL(){
        let id_cedula = localStorage.getItem("IdCedula");
        let foto=$('#imagenC').val();
        let observaciones=$('#observaciones').val();
        let almacen='';
        var fecha = new Date();
        var fecha_foto = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        if($("#radio1").prop("checked") == true){
            almacen = "S√≠";
        } else if($("#radio2").prop("checked") == true){
            almacen = "No";
        }
        if (almacen && observaciones && foto){
            databaseHandler.db.transaction(
                function(tx){//observaciones text, foto blob, fecha text)",
                    tx.executeSql("INSERT INTO almacenDL(id_cedula, observaciones, foto, fecha) VALUES (?,?,?,?)",
                        [id_cedula,observaciones, foto, fecha_foto],
                        function(tx, results){
                        swal("","Se guardaron los datos correctamente", "success");
                        $('#observaciones').val('');
                        $('#observaciones').css("background-color","#ffffff");
                        $('#imagenC').val('');
                        $("#smallImage").attr("src","img/blank.png");
                        $("#photoIcon").attr("src","img/camera.svg");
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql(
                                        "Select * from almacenDL where id_cedula = ? ORDER BY id_almacen DESC",
                                            [id_cedula],
                                            function(tx, results){
                                                    var item = results.rows.item(0);
                                                    $("#tabla_almacen").append("<tr id='fila"+ item.id_almacen +"'><td><a href='#' onclick='eliminarFilaDL("+ 
                                                        item.id_almacen +",6);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+
                                                        item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + 
                                                        item.observaciones + "</td><td style='text-align: center;'>" + 
                                                        item.fecha + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                },
                                                    function(tx, error){
                                                        console.log("Error: " + error.message);
                                                        app.preloader.hide();  
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                    }
                                    );  
                                },
                                    function(error){},
                                    function(){}
                            );   
                        },
                        function(tx, error){
                            console.error("Error al actualizar: " + error.message);
                        }
                    );
                },
                function(error){
                    console.error("Error al actualizar: " + error.message);
                },
                function(){}
            );
        }else {
            swal("", "Debes de llenar todos los campos" , "warning");
        }   
    }
    function guardaPedidoDL(){
        let id_cedula = localStorage.getItem("IdCedula");
        let producto=$('#Busca_producto').val();
        let codigo=$('#codigo').val();
        let descripcion=$('#descripcion').val();
        let inventario=$('#inventario').val();
        let cantidad=$('#cantidad').val();
        let comentarios=$('#comentarios').val();      
        if (producto && codigo && descripcion && inventario && cantidad && comentarios){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("INSERT INTO pedidosDL(id_cedula, codigo, producto, descripcion, inventario_dia, cantidad_solicitada, comentarios) VALUES (?,?,?,?,?,?,?)",
                        [id_cedula, codigo, producto, descripcion, inventario, cantidad, comentarios],
                        function(tx, results){
                        swal("","Se guardaron los datos correctamente", "success");
                        $('#Busca_producto').val('');
                        $('#Busca_producto').css("background-color","#ffffff");
                        $('#codigo').val('');
                        $('#codigo').css("background-color","#ffffff");
                        $('#descripcion').val('');
                        $('#descripcion').css("background-color","#ffffff");
                        $('#producto').val('');
                        $('#producto').css("background-color","#ffffff");
                        $('#cantidad').val('');
                        $('#cantidad').css("background-color","#ffffff");
                        $('#inventario').val('');
                        $('#inventario').css("background-color","#ffffff");
                        $('#comentarios').val('');
                        $('#comentarios').css("background-color","#ffffff");
                        $('#imagenC').val('');
                        $("#smallImage").attr("src","img/blank.png");
                        $("#photoIcon").attr("src","img/camera.svg");
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql(
                                        "Select * from pedidosDL where id_cedula = ? ORDER BY id_producto DESC",
                                            [id_cedula],
                                            function(tx, results){
                                                    var item = results.rows.item(0);
                                                    //producto text, codigo text, descripcion text, inventario_dia text, cantidad_solicitada integer, comentarios
                                                    $("#tabla_pedidos").append("<tr id='fila"+ item.id_producto +"'><td><a href='#' onclick='eliminarFilaDL("+ item.id_producto +",7);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td style='text-align: center;'>" + 
                                                    item.codigo + "</td><td style='text-align: center;'>" + 
                                                    item.descripcion + "</td><td style='text-align: center;'>" + 
                                                    item.inventario_dia + "</td><td style='text-align: center;'>" + 
                                                    item.cantidad_solicitada + "</td><td style='text-align: center;'>" + 
                                                    item.comentarios + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                },
                                                    function(tx, error){
                                                        console.log("Error: " + error.message);
                                                        app.preloader.hide();  
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                    }
                                    );  
                                },
                                    function(error){},
                                    function(){}
                            );   
                        },
                        function(tx, error){
                            console.error("Error al actualizar: " + error.message);
                        }
                    );
                },
                function(error){
                        console.error("Error al actualizar: " + error.message);
                },
                function(){}
            );
            }else{
                swal("", "Debes de llenar todos los campos" , "warning");
            }
    }
    function guardaObservaGeneralDL(){
        let id_cedula = localStorage.getItem("IdCedula");
        let observaciones_generales=$('#observaciones_generales').val();
        if (observaciones_generales){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE visitaDilimpio SET observaciones_generales = ? WHERE id_cedula = ?",
                        [observaciones_generales,id_cedula],
                            function(tx, results){ 
                                swal("","Comentario General Guardado Correctamente", "success");
                                $('#observaciones_generales').css("background-color","#ffffff");
                            },
                        function(tx, error){
                            console.log("Error: " + error.message);
                            app.preloader.hide();  
                        }
                    );  
                },
                    function(error){
                        console.log("Error: " + error.message);
                    },
                    function(){}
            );
        }else{
            swal("", "Debes Colocar un Comentario General" , "warning");
        }
    }
    function cierreDL(){
        var persona_cuenta='N/A';
        var correo_cuenta='N/A';

        if ($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#eval").val() == ""){
            swal("", "Todos los campos son obligatorios", "warning");
            return false;
        }
        
        if ($("#radio1").prop("checked") == true){
            if ($("#persona_cuenta").val() == "" || ($("#correo_cuenta").val()== "")){
                swal("", "Agrega una persona y correo para el estado de cuenta", "warning");
                return false;
            }else{
                persona_cuenta=$("#persona_cuenta").val();
                correo_cuenta=$("#correo_cuenta").val();
            }
        }

        if ($("#radio1").prop("checked") == false && $("#radio2").prop("checked") == false){
            swal("", "Elige una opci√≥n para el estado de cuenta", "warning");
            return false;
        }
      
      var id_cedula = localStorage.getItem("IdCedula");
      var nombrefirma = $("#NombreFirma").val();
      var firmaCliente = $("#signate").val();
      if($("#eval").val() <= '3' && $("#comentario_cliente").val() == ""){
          swal("","Por favor, ingresa el motivo de tu calificacion","warning");
          return false;
      }
      var calificacion = $("#eval").val();
      var comentarioCliente = $('#comentario_cliente').val();
      var fecha = new Date();
      var fecha_firma =
          fecha.getFullYear() +
          "-" +
          (fecha.getMonth() + 1) +
          "-" +
          fecha.getDate() +
          " " +
          fecha.getHours() +
          ":" +
          fecha.getMinutes() +
          ":" +
          fecha.getSeconds();

      databaseHandler.db.transaction(
        function (tx) {
          tx.executeSql(
            "UPDATE visitaDilimpio SET firma_cliente = ?, persona_cuenta = ?, correo_cuenta = ? WHERE id_cedula = ?",
            [firmaCliente, persona_cuenta, correo_cuenta, id_cedula],
            function (tx, results) {
              databaseHandler.db.transaction(
                function (tx) {
                  tx.executeSql(
                    "UPDATE cedulas_general SET calificacion = ?, nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                    [calificacion, nombrefirma, comentarioCliente, id_cedula],
                    function (tx, results) {
                      swal("", "Guardado correctamente", "success");
                      app.views.main.router.back("/yamevoyDL/", {
                        force: true,
                        ignoreCache: true,
                        reload: true,
                      });
                    },
                    function (tx, error) {
                      console.error("Error al guardar cierre: " + error.message);
                    }
                  );
                },
                function (error) {},
                function () {}
              );
            },
            function (tx, error) {
              console.error("Error al guardar cierre: " + error.message);
            }
          );
        },
        function (error) {},
        function () {}
      );
    }
    function terminarServicioDL(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE visitaDilimpio SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function validaradioestadoCuentaDL(id){
        let id_cedula = localStorage.getItem("IdCedula");
        let permite='';
        if (id=="radio1"){
            $("#radio1").prop("checked", true);
            $("#radio2").prop("checked", false);
            $("#div_radios").css("display", "block");
            permite='S√≠';
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE visitaDilimpio SET estado_cuenta = ? WHERE id_cedula = ?",
                        [permite,id_cedula],
                            function(tx, results){ 
                                },
                        function(tx, error){
                            console.log("Error: " + error.message);
                            app.preloader.hide();  
                        }
                    );  
                },
                    function(error){
                        console.log("Error: " + error.message);
                    },
                    function(){}
            );
        }else if (id=="radio2"){
            $("#radio2").prop("checked", true);
            $("#radio1").prop("checked", false);
            $("#div_radios").css("display", "none");
            permite='No';
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE visitaDilimpio SET estado_cuenta = ? WHERE id_cedula = ?",
                        [permite,id_cedula],
                            function(tx, results){ 
                                },
                        function(tx, error){
                            console.log("Error: " + error.message);
                            app.preloader.hide();  
                        }
                    );  
                },
                    function(error){
                        console.log("Error: " + error.message);
                    },
                    function(){}
            );
        }
    }
    function generarEntrgasDL(){
        console.log("Entregas");
        let id_cedula = localStorage.getItem("IdCedula");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let id_cliente = localStorage.getItem("id_cliente");
        let nombre_cliente = localStorage.getItem("nombre_cliente");
        let nombre_contacto = localStorage.getItem("nombre_contacto");
        let correo = localStorage.getItem("correo");
        let estatus_cliente = localStorage.getItem("estatus_cliente");
        let telefono = localStorage.getItem("telefono");
        let tipoCedula = "Entregas";
        
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ?  WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addVentasDL(id_cedula, foto_llegada, id_cliente, nombre_cliente, nombre_contacto, correo, telefono);
                        app.views.main.router.back('/recorridoDL2/', {force: true, ignoreCache: true, reload: true});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){console.error("Error al actualizar el tipo de cedula: " + error.message);},
            function(){}
        );
    }
    function guardarDatosGDL2(){
        let id_cedula = localStorage.getItem("IdCedula");
        let cliente = $("#cliente").val();
        let contacto = $("#nombre_contacto").val();
        let correo = $("#correo").val();
        let telefono = $("#telefono").val();
        if(cliente && contacto && correo && telefono){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE DatosentregasDL SET nombre_contacto=?, correo=?, telefono =? WHERE id_cedula = ?",
                        [contacto,correo,telefono,id_cedula],
                        function(tx, results){
                        swal("","Se guardaron los datos correctamente", "success");
                        $('#cliente').css("background-color","#ffffff");
                        $('#nombre_contacto').css("background-color","#ffffff");
                        $('#correo').css("background-color","#ffffff");
                        $('#estatus_cliente').css("background-color","#ffffff");
                        $('#telefono').css("background-color","#ffffff");
                        },
                        function(tx, error){
                            console.error("Error al actualizar: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else{
            swal("", "Debes de llenar todos los campos" , "warning");
        }
    }
    function guardarEntregasDL(){
        let id_cedula = localStorage.getItem("IdCedula");
        let foto=$('#imagenC').val();
        let comentarios=$('#comentarios').val();
        var fecha = new Date();
        var fecha_foto = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
       
        if (comentarios && foto){
            databaseHandler.db.transaction(
                function(tx){//observaciones text, foto blob, fecha text)",
                    tx.executeSql("INSERT INTO entregasDL(id_cedula, comentarios, foto_entrega, fecha) VALUES (?,?,?,?)",
                        [id_cedula,comentarios, foto, fecha_foto],
                        function(tx, results){
                        swal("","Se guardaron los datos correctamente", "success");
                        $('#comentarios').val('');
                        $('#comentarios').css("background-color","#ffffff");
                        $('#imagenC').val('');
                        $("#smallImage").attr("src","img/blank.png");
                        $("#photoIcon").attr("src","img/camera.svg");
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql(
                                        "Select * from entregasDL where id_cedula = ? ORDER BY id_entrega DESC",
                                            [id_cedula],
                                            function(tx, results){
                                                    var item = results.rows.item(0);
                                                    $("#tabla_entregas").append("<tr id='fila"+ item.id_entrega +"'><td><a href='#' onclick='eliminarFilaDL("+ item.id_entrega +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+
                                                        item.foto_entrega+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.comentarios + "</td><td style='text-align: center;'>" + item.fecha + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                },
                                                    function(tx, error){
                                                        console.log("Error: " + error.message);
                                                        app.preloader.hide();  
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                    }
                                    );  
                                },
                                    function(error){},
                                    function(){}
                            );   
                        },
                        function(tx, error){
                            console.error("Error al actualizar: " + error.message);
                        }
                    );
                },
                function(error){
                    console.error("Error al actualizar: " + error.message);
                },
                function(){}
            );
        }else {
            swal("", "Debes de tomar una fotograf√≠a e ingresar un comentario" , "warning");
        }
    }
    function terminarentregaDL(){
        if ($("#NombreFirma").val() == "" || $("#signate").val() == "" ){
            swal({
                title: "Aviso",
                text: "Los campos de nombre y firma estan vac√≠os, ¬øEstas seguro que deseas continuar?",
                icon: "warning",
                buttons: true,
                dangerMode: false,
            }).then((willGoBack) => {
                if (willGoBack){
                    if ($("#NombreFirma").val() == ""){var nombrefirma = 'Sin Evidencia';}else{var nombrefirma = $("#NombreFirma").val();}
                    if ($("#signate").val() == ""){var firmaCliente = '';}else{var firmaCliente = $("#signate").val();}
                    var id_cedula = localStorage.getItem("IdCedula");
                    var fecha = new Date();
                    var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                    var ubicacion_salida = $('#geolocation').val();
                    var estatus = 1;
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida = ?,geolocalizacion_salida = ?,estatus = ?, nombre_evalua = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,nombrefirma,id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function (tx) {
                                            tx.executeSql(
                                                "UPDATE DatosentregasDL SET firma_cliente = ? WHERE id_cedula = ?",
                                                [firmaCliente, id_cedula],
                                                function (tx, results) {
                                                    window.location.href = "./menu.html";
                                                },
                                                function (tx, error) {
                                                console.error("Error al guardar cierre: " + error.message);
                                                }
                                            );
                                            },
                                            function (error) {},
                                            function () {}
                                        ); 
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                } else {}
            });
        }else{
            var nombrefirma = $("#NombreFirma").val();
            var firmaCliente = $("#signate").val();
            var id_cedula = localStorage.getItem("IdCedula");
            var fecha = new Date();
            var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            var ubicacion_salida = $('#geolocation').val();
            var estatus = 1;
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("UPDATE cedulas_general SET fecha_salida = ?,geolocalizacion_salida = ?,estatus = ?, nombre_evalua = ? WHERE id_cedula = ?",
                            [fecha_salida,ubicacion_salida,estatus,nombrefirma,id_cedula],
                            function(tx, results){
                                databaseHandler.db.transaction(
                                    function (tx) {
                                    tx.executeSql(
                                        "UPDATE DatosentregasDL SET firma_cliente = ? WHERE id_cedula = ?",
                                        [firmaCliente, id_cedula],
                                        function (tx, results) {
                                            window.location.href = "./menu.html";
                                        },
                                        function (tx, error) {
                                        console.error("Error al guardar cierre: " + error.message);
                                        }
                                    );
                                    },
                                    function (error) {},
                                    function () {}
                                ); 
                            },
                            function(tx, error){
                                swal("Error al guardar",error.message,"error");
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
        }
    }
    function regresarDilimpio1(){
        app.views.main.router.navigate({ name: 'recorridoDL1'});
    }
    function regresarDilimpio2(){
        app.views.main.router.navigate({ name: 'recorridoDL2'});
    }
    function equiposDL(){
        app.preloader.show('blue');
        var NomDescCli = "Equipos_1DL";
        var enviado=1;
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("DELETE FROM equiposCargadosDL WHERE enviado = ?",
                    [enviado],
                    function(tx, results){
                        app.request.get(cordova.file.dataDirectory + "jsons/"+NomDescCli+".json", function (data) {
                            var content = JSON.parse(data);
                            for (var i = 0; i < content.length; i++) {
                                var id_cliente = (content[i].id_cliente);
                                var codigo=(content[i].codigo);
                                var descripcion = (content[i].descripcion);
                                productHandler.addVICEquiposDL(id_cliente,codigo,descripcion, enviado);
                            }
                            app.preloader.hide();
                        });
                    },
                    function(tx, error){
                        swal("Error al borrar equipos cargados", error.message, "error");
                        app.preloader.hide();
                    }
                    );
                },
                function(error){app.preloader.hide();},
                function(){}
            );
        }
        function startFromProgramDILIMPIO(id_visita,id_cliente,nombre_comercial,contact_name,horario_programado,telefono,correo,tipo_servicio){
            localStorage.setItem("id_visita", id_visita);
            localStorage.setItem("id_cliente", id_cliente);
            localStorage.setItem("nombre_comercial", nombre_comercial);
            localStorage.setItem("contact_name", contact_name);
            localStorage.setItem("horario_programado", horario_programado);
            localStorage.setItem("telefono", telefono);
            localStorage.setItem("correo", correo);
            localStorage.setItem("tipo_servicio", tipo_servicio);
            app.views.main.router.navigate({name: 'yallegueDilimpio2'});
        }
        function iniciarClienteDilimpio(){
            var id_usuario = localStorage.getItem("id_usuario");
            var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
            var fecha = new Date();
            var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            var geolocation = $("#geolocation").val();
            var id_cliente = localStorage.getItem("id_cliente");
            var horario_programado = localStorage.getItem("horario_programado");;
            var foto_llegada = $("#imagenC").val();
            var nombre_cliente = localStorage.getItem("nombre_comercial");
            var tipo = localStorage.getItem("tipo_servicio");
            var nombre_contacto = localStorage.getItem("contact_name");
            var telefono = localStorage.getItem("telefono");
            var correo = localStorage.getItem("correo");
            var id_visita = localStorage.getItem("id_visita");
            if(tipo == "visitaDilimpio"){
                var tipoCedula = "visitaDilimpio";
            } else if(tipo == "Entregas"){
                var tipoCedula = "Entregas";
            }
            var estatus = 0
            if(foto_llegada != ''){
                if(nombre_cliente != ''){
                    productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                                [],
                                function(tx, results){
                                    var item = results.rows.item(0);
                                    var id_cedula = item.Id;
                                    localStorage.setItem("IdCedula", item.Id);
                                    if(tipo == "visitaDilimpio"){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                                    [tipoCedula,id_cedula],
                                                    function(tx, results){
                                                        productHandler.addVisitaDL(id_cedula,foto_llegada,id_cliente,nombre_cliente,nombre_contacto,correo,telefono,id_visita);
                                                        app.views.main.router.back('/recorridoDL1/', {force: true, ignoreCache: true, reload: true});
                                                    },
                                                    function(tx, error){
                                                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    } else if(tipo == "Entregas"){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                                    [tipoCedula,id_cedula],
                                                    function(tx, results){
                                                        productHandler.addVentasDL(id_cedula,foto_llegada,id_cliente,nombre_cliente,nombre_contacto,correo,telefono,id_visita);
                                                        app.views.main.router.back('/recorridoDL2/', {force: true, ignoreCache: true, reload: true});
                                                    },
                                                    function(tx, error){
                                                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    }
                                    app.preloader.hide();
                                },
                                function(tx, error){
                                    console.log("Error al guardar cedula: " + error.message);
                                    app.preloader.hide();
                                }
                            );
                        },
                        function(error){},
                        function(){}
                    );
                } else {
                    swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
                    app.preloader.hide();
                }
            } else {
                swal("Falta un campo", "La fotograf√≠a es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        }
        function guardaObservaGeneralDL2(){
            let id_cedula = localStorage.getItem("IdCedula");
            let observaciones_generales=$('#observaciones_generales').val();
            if (observaciones_generales){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("UPDATE DatosentregasDL SET observaciones_generales = ? WHERE id_cedula = ?",
                            [observaciones_generales,id_cedula],
                                function(tx, results){ 
                                    swal("","Comentario General Guardado Correctamente", "success");
                                    $('#observaciones_generales').css("background-color","#ffffff");
                                },
                            function(tx, error){
                                console.log("Error: " + error.message);
                                app.preloader.hide();  
                            }
                        );  
                    },
                        function(error){
                            console.log("Error: " + error.message);
                        },
                        function(){}
                );
            }else{
                swal("", "Debes Colocar un Comentario General" , "warning");
            }
        }
    // Dilimpio Fin
    // Funcion global Inicio
    function RegresarCedula(){
        console.log("ENTRO");
        app.dialog.prompt("Por favor escribe la contrase√±a", 'FIELD',function (pws) {
            $.ajax({
                type: "POST",
                async : true,
                url: "http://www.appbennetts.com/FWM2/app/validapsw.php",
                dataType: 'html',
                data: {'psw':pws },
                success: function(respuesta){
                    if(respuesta == "OK"){
                        $("#bandeja2").css('display', 'block');
                        $("#bandeja").css('display', 'none');
                    }else{
                        app.dialog.alert('Contrase√±a Incorrecta.', 'Aviso');
                    }
                },
                error: function(){
                    console.log("Error en la comunicacion");
                }
            });
        });
    }
    function moveProgram(){
        if(localStorage.getItem("programa") == 1){
            app.views.main.router.back('/calendar/', {force: true, ignoreCache: true, reload: true});
        } else {
            app.views.main.router.back('/excel/', {force: true, ignoreCache: true, reload: true});
        }
        
    }
    function changeCamera(check){
        if(check.includes('0')){
            localStorage.setItem("camera", "0");
            swal("","Se cambio exitosamente la configuracion de la camara.","success");
        } else {
            localStorage.setItem("camera", "1");
            swal("","Se cambio exitosamente la configuracion de la camara.","success");
        }
    }
    function changeProgram(check){
        if(check.includes('0')){
            localStorage.setItem("programa", "0");
            swal("","Se cambio exitosamente la configuracion del programa de visitas.","success");
        } else {
            localStorage.setItem("programa", "1");
            swal("","Se cambio exitosamente la configuracion del programa de visitas.","success");
        }
    }
    function capturePhoto() {
        var camera = localStorage.getItem("camera");
        if(camera == 0){
            var camera = app.popup.create({
                content: `
                <div class="popup" id="camera">
                    <div class="app">
                    <div id="deviceready camera-Field-frame">
                        <div class="top"></div>
                        <canvas id="camera-frame" style="display: none;"></canvas>
                        <video id="camera-view" autoplay playsinline class="raster" style="display: none;"></video>
                        <img src="" id="phototaked">
                        <div class="camera">
                            <div class="take" id="take" onclick="onTake()">
                                <div class="bubble-take"></div>
                            </div>
                            <div class="select popup-close" id="select" style="display: none;" onClick="onDone()"><img id="img-select" src="img/validar_camera.svg"></div>
                        </div>
                        <div class="left-action">
                            <div class="cancel popup-close" id="cancelCamera" onClick="onCancelCamera()"><img class="image-cancel" src="img/cerrar_camera.svg"></div>
                            <div class="cancel " id="cancelPicure" onClick="onCancelPicture()"><img class="image-cancel" src="img/cerrar_camera.svg"></div>
                        </div>
                        <div class="actions">
                            <div class="action torch" id="torch" onClick="onTorch()"><img id="flash" src="img/flash_off.svg" width="30px"></div>
                            <div class="action rotate-right" id="rotateRight" onClick="onRotateRight()" style="display:none"><img id="flash" src="img/rotate-right.svg" width="30px"></div>
                            <div class="action rotate-left" id="rotateLeft" onClick="onRotateLeft()" style="display:none"><img id="flash" src="img/rotate-left.svg" width="30px"></div>
                        </div>
                        <div class="right-action">
                            <div class="switch" id="switch" onClick="onSwitch()"><img class="image-switch" src="img/flip.svg"></div>
                        </div>
                        <audio id="audio" controls style="display: none;">
                            <source type="audio/mp3" src="img/camera.mp3">
                        </audio>
                        <input type="hidden" id="deviceOrientation" name="deviceOrientation"/>
                    </div>
                    <fwm></fwm>
                    </div>
                </div>
                `,
                on: {
                    open: function (popup) {
                        var permissions = cordova.plugins.permissions;
                        permissions.checkPermission(permissions.CAMERA, function( status ){
                            if (status.hasPermission){
                                cargarEmpresa(`./js/camera-field.js`, empresaCargada);
                                function empresaCargada(){
                                    cameraStart(onPhotoDataSuccess)
                                }
                                function cargarEmpresa(url, callback){
                                    var pie = document.getElementsByTagName('fwm')[0];
                                    var script = document.createElement('script');
                                    script.type = 'text/javascript';
                                    script.src = url;
                                    script.id = "cameraSource";
                                    script.onload = callback;
                                    pie.appendChild(script);
                                }
                            }else{
                                permissions.requestPermission(permissions.CAMERA, success, error);
                                function error() {
                                    app.sheet.close('.popup')
                                    swal("Field Requiere los permisos","Para poder tomar las evidencias fotograficas necesitamos el permiso.","warning");
                                }
                                function success( status ){
                                    if(!status.hasPermission){
                                        error();
                                    } else {
                                        cargarEmpresa(`./js/camera-field.js`, empresaCargada);
                                        function empresaCargada(){
                                            cameraStart(onPhotoDataSuccess)
                                        }
                                        function cargarEmpresa(url, callback){
                                            var pie = document.getElementsByTagName('fwm')[0];
                                            var script = document.createElement('script');
                                            script.type = 'text/javascript';
                                            script.src = url;
                                            script.id = "cameraSource";
                                            script.onload = callback;
                                            pie.appendChild(script);
                                        }
                                    }

                                }
                            }
                        });
                    },
                    opened: function (popup) {
                      localStorage.setItem("cameraField", "Active");
                    },
                    closed: function (popup) {
                      window.localStorage.removeItem("cameraField");
                    },
                }
            });
            camera.open();
        } else {
            navigator.camera.getPicture(onPhotoDataSuccess, onFail, {
                quality: 100,
                destinationType: destinationType.DATA_URL,
                targetWidth: 500,
                targetHeight: 500,
                correctOrientation: true,
            });
        }
    }
    //Opcion para ir a menu
    function checkStatus(check){
        if(check.includes('1')){
            var valCheck = document.getElementById(check).checked;
            if(valCheck ==true){                        
                var name = check.replace('1','');
                var otherCheck = name + '0';
                document.getElementById(otherCheck).checked = false;
            }
        } else {
            var valCheck = document.getElementById(check).checked;
            if(valCheck ==true){                        
                var name = check.replace('0','');
                var otherCheck = name + '1';
                document.getElementById(otherCheck).checked = false;
            }
        }
    }
    function moveMenu() {
        var empresa = localStorage.getItem("nombre_empresa");
        if(empresa == "SMC"){
            app.views.main.router.navigate({ name: 'yallegueSMC'});
        } else if(empresa == "DIPREC"){
            app.views.main.router.navigate({ name: 'yallegueDIPREC'});
        } else if(empresa == "Bennetts"){
            app.views.main.router.navigate({ name: 'yallegueBennetts'});
        } else if(empresa == "SURO"){
            app.views.main.router.navigate({ name: 'yallegueSURO'});
        } else if(empresa == "Field"){
            app.views.main.router.navigate({ name: 'yallegueField'});
        } else if(empresa == "PlatoLimpio"){
            app.views.main.router.navigate({ name: 'yalleguePlatoLimpio'});
        } else if(empresa == "ServInd"){
            app.views.main.router.navigate({ name: 'yallegueServInd'});
        } else if(empresa == "MerGroup"){
            app.views.main.router.navigate({ name: 'yallegueMerGroup'});
        } else if(empresa == "VIC"){
            app.views.main.router.navigate({ name: 'yallegueVIC'});
        } else if(empresa == "MT"){
            app.views.main.router.navigate({ name: 'yallegueMT'});
        } else if(empresa == "CarnesIdeal"){
            app.views.main.router.navigate({ name: 'yallegueCI'});
        } else if(empresa == "Dilimpio"){
            app.views.main.router.navigate({ name: 'yallegueDilimpio'});
        } else if(empresa == "Proteus"){
            app.views.main.router.navigate({ name: 'yallegueProteus'});
        }
        localStorage.setItem("Opcion", '1');
        app.views.main.router.navigate({ name: 'yallegue'});
    }
    function EliminarActualizacionesAntiguas(){
        var IdUsuario = localStorage.getItem("id_usuario");
        var fecha = new Date();
        var fecha_ingreso = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate();
        fecha_eliminar = editar_fecha(fecha_ingreso, "-30", "d","-");
        databaseHandler.db.transaction(
            function(tx5){
                tx5.executeSql("SELECT * FROM Actualizaciones  WHERE Fecha < ? AND IdUsuario = ?",
                    [fecha_eliminar,IdUsuario],
                    function(tx5, results){
                        var length = results.rows.length;
                        for(var i = 0; i< length; i++){
                            var item2 = results.rows.item(i);
                            var IdEliminar = item2.idActualizacion;
                            databaseHandler.db.transaction(
                                function(tx4){
                                    tx4.executeSql(
                                        "DELETE FROM Actualizaciones WHERE idActualizacion = ?",
                                        [IdEliminar],
                                        function(tx4, results){
                                        },
                                        function(tx4, error){
                                            console.errror("Error al eliminar: " + error.message);
                                        }
                                    );
                                },
                                function(error){
                                    console.error("Error al seleccionar actualzaciones:" + error.message)
                                },
                                function(){}
                            );
                        }
                    }
                )
            }
        );
    }
    function inputLleno(id,value){
        id = "#"+id;
        if (value == "") {
            $(id).css("background-color","#ffffff");
        } else if(value == "0"){
            $(id).css("background-color","#ffffff");
        } else {
            $(id).css("background-color","#E0F8F7");
        }
    }

    function eliminarFila(index, opc){
        if(opc == 1) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM levantamiento_evidencia WHERE id_levantamiento_foto = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 2) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM fotos_fumigacion WHERE id_fumigacion_foto = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 3) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM fotos_sanitizacion WHERE id_sanitizacion_foto = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 5){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM VIC_Fotos WHERE ID_Fotos = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function DeleteDatos(){
        var id_empresa = localStorage.getItem("id_empresa");
        databaseHandler.db.transaction(
            function(tx5){
                tx5.executeSql(
                    "Select * from cedulas_general where estatus in (1,2)",
                    [],
                    function(tx5, results){
                        let length = results.rows.length;
                        console.log('length',length);
                        if(length == 0){
                            databaseHandler.db.transaction(
                                function(tx5){
                                    tx5.executeSql(
                                        "Select * from cedulas_general where estatus in (0)",
                                        [],
                                        function(tx5, results){
                                            let length = results.rows.length;
                                            console.log('length',length);
                                            if(length == 0){
                                                app.dialog.prompt("Para eliminar los datos de la app, por favor escribe 'Eliminar'", 'FIELD',function (name) {
                                                    if(name == "Eliminar"){
                                                      swal({
                                                          title: "Aviso",
                                                          text: "¬øEstas Seguro de querer eiminar los datos de la aplicaci√≥n?",
                                                          icon: "warning",
                                                          buttons: true,
                                                          dangerMode: true,
                                                      })
                                                        .then((RESP) => {
                                                            if (RESP == true) {
                                                                window.sqlitePlugin.deleteDatabase({name: "field.db", location:'default'});
                                                                location.reload();
                                                            } else {}
                                                        });
                                                    }else{}
                                                  });
                                            }else{
                                                swal("","Favor de concluir o eliminar las cedulas pendientes para poder eliminar los datos de la app","warning"); 
                                            }
                                        },
                                        function(tx5, error){
                                            console.log("Error al consultar registro: " + error.message);
                                            app.preloader.hide();
                                        }
                                    );
                                },
                                function(error){console.log("Error al consultar registro: " + error.message);},
                                function(){}
                            );
                        }else{
                            swal({
                                title: "Aviso",
                                text: "¬øAun tienes cedulas pendientes por enviar estas seguro que deseas realizar esta accci√≥n? Se perderan los datos de tu visita!",
                                icon: "warning",
                                buttons: true,
                                dangerMode: true,
                            })
                              .then((RESP) => {
                                  if (RESP == true) {
                                    databaseHandler.db.transaction(
                                        function(tx5){
                                            tx5.executeSql(
                                                "Select * from cedulas_general where estatus in (0)",
                                                [],
                                                function(tx5, results){
                                                    let length = results.rows.length;
                                                    console.log('length',length);
                                                    if(length == 0){
                                                        app.dialog.prompt("Para eliminar los datos de la app, por favor escribe 'Eliminar'", 'FIELD',function (name) {
                                                            if(name == "Eliminar"){
                                                              swal({
                                                                  title: "Aviso",
                                                                  text: "¬øEstas Seguro de querer eiminar los datos de la aplicaci√≥n?",
                                                                  icon: "warning",
                                                                  buttons: true,
                                                                  dangerMode: true,
                                                              })
                                                                .then((RESP) => {
                                                                    if (RESP == true) {
                                                                        window.sqlitePlugin.deleteDatabase({name: "field.db", location:'default'});
                                                                        location.reload();
                                                                    } else {}
                                                                });
                                                            }else{}
                                                          });
                                                    }else{
                                                        swal("","Favor de concluir o eliminar las cedulas pendientes para poder eliminar los datos de la app","warning"); 
                                                    }
                                                },
                                                function(tx5, error){
                                                    console.log("Error al consultar registro: " + error.message);
                                                    app.preloader.hide();
                                                }
                                            );
                                        },
                                        function(error){console.log("Error al consultar registro: " + error.message);},
                                        function(){}
                                    );
                                  } else {}
                              });
                        }
                    },
                    function(tx5, error){
                        console.log("Error al consultar registro: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function(error){console.log("Error al consultar registro: " + error.message);},
            function(){}
        ); 
    }
    // Funcion global Fin

    function buscarC(){
        app.preloader.show('blue');
        var opc = localStorage.getItem("Opcion");
        var Division = localStorage.getItem("Division");
        if(opc == 1){
            var icedulas = localStorage.getItem("IdCedula");
            var cte = $('#cte').val();
            var geolocation = $("#geolocation").val();
            var imagenC = $("#imagenC").val();
            var fecha = new Date();
            var fFinal = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            var ncomercial = $("#ncomercial").val();
            var ncontacto = $("#ncontacto").val();
            var telefono = $("#telefono").val();
            var correo = $("#correo").val();
            var estatusc = $("#estatusc").val();
            var Nomcte = $("#Nomcte").val();
            if(cte != ''){
                if(icedulas > 0){  //Actualizar la cedula de seguimiento
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("UPDATE Cedula SET IdCte = ? WHERE IdCedula = ?",
                                [cte, icedulas],
                                function(tx, results){
                                    app.dialog.alert('El registro se actualizo correctamente.', 'Aviso');
                                    app.preloader.hide();
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("Select * from Clientes where IdCte = ? AND Division = ?",
                                                [cte, Division],
                                                function(tx, results){
                                                    var length = results.rows.length;
                                                    if(length > 0){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("UPDATE Clientes SET NomComercial = ?, NomContacto = ?, Telefono = ?, Email = ?, Estatus = ?, Cliente = ? WHERE IdCte = ? AND Division = ?",
                                                                    [ncomercial, ncontacto, telefono, correo, estatusc, Nomcte ,cte, Division],
                                                                    function(tx, results){
                                                                        app.views.main.router.navigate({name: 'recorrido1'});
                                                                        app.preloader.hide();
                                                                    },
                                                                    function(tx, error){
                                                                        console.log("Error al guardar cedula: " + error.message);
                                                                        app.preloader.hide();
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    } else {
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("INSERT INTO Clientes (NomComercial, NomContacto, Telefono, Email, IdCte, Estatus, Cliente, Division) VALUES (?,?,?,?,?,?,?,?)",
                                                                    [ncomercial, ncontacto, telefono, correo, cte, estatusc, Nomcte, Division ],
                                                                    function(tx, results){
                                                                        app.views.main.router.navigate({name: 'recorrido1'});
                                                                        app.preloader.hide();
                                                                    },
                                                                    function(tx, error){
                                                                        console.log("Error al guardar cedula: " + error.message);
                                                                        app.preloader.hide();
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    }
                                                },
                                                function(tx, error){
                                                    console.log("Error al guardar cedula: " + error.message);
                                                    app.preloader.hide();
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                },
                                function(tx, error){
                                    console.log("Error al guardar cedula: " + error.message);
                                    app.preloader.hide();
                                }
                            );
                        },
                        function(error){},
                        function(){}
                    );
                } else {
                    var Division = localStorage.getItem("Division");
                    if(Division == 3){
                        var NomJson ='ClientesCDC';
                        var NomDescCli = 'ClientesCDCDesc';
                    }else{
                        var NomJson = 'clientes_desc';
                        var NomDescCli = "Clientes";
                    }
                    if(imagenC != ''){//insertar la cedula
                        app.request.get(cordova.file.dataDirectory + "jsons/"+NomDescCli+".json", { IdCed: cte}, function (data) {
                            var content = JSON.parse(data);
                            var valor='';
                            for(var i=0; i < content.length; i++){
                                for (var i = 0; i < data.length; i++) {
                                    if(content[i].IdCte == cte){
                                        //DATOS A GUARDAR
                                        productHandler.addCedula(IdUsuario,cte,fFinal,imagenC,geolocation);
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select MAX(IdCedula) as Id from Cedula",
                                                    [],
                                                    function(tx, results){
                                                        var length = results.rows.length;
                                                        var item = results.rows.item(0);
                                                        localStorage.setItem("IdCedula", item.Id);
                                                        localStorage.setItem("IdCte", cte);
                                                        app.preloader.hide();
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("Select * from Clientes where IdCte = ? AND Division = ?",
                                                                    [cte, Division],
                                                                    function(tx, results){
                                                                        var length = results.rows.length;
                                                                            if(length > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx){
                                                                                        tx.executeSql("UPDATE Clientes SET NomComercial = ?, NomContacto = ?, Telefono = ?, Email = ?, Estatus = ?, Cliente = ? WHERE IdCte = ? AND Division = ?",
                                                                                            [ncomercial, ncontacto, telefono, correo, estatusc, Nomcte ,cte, Division],
                                                                                            function(tx, results){
                                                                                                app.views.main.router.navigate({name: 'recorrido1'});
                                                                                                app.preloader.hide();
                                                                                            },
                                                                                            function(tx, error){
                                                                                                console.log("Error al guardar cedula: " + error.message);
                                                                                                app.preloader.hide();
                                                                                            }
                                                                                        );
                                                                                    },
                                                                                    function(error){},
                                                                                    function(){}
                                                                                );
                                                                            } else {
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx){
                                                                                        tx.executeSql("INSERT INTO Clientes (NomComercial, NomContacto, Telefono, Email, IdCte, Estatus, Cliente, Division) VALUES (?,?,?,?,?,?,?,?)",
                                                                                            [ncomercial, ncontacto, telefono, correo, cte, estatusc, Nomcte , Division],
                                                                                            function(tx, results){
                                                                                                app.views.main.router.navigate({name: 'recorrido1'});
                                                                                            },
                                                                                            function(tx, error){
                                                                                                console.log("Error al guardar cedula: " + error.message);
                                                                                                app.preloader.hide();
                                                                                            }
                                                                                        );
                                                                                    },
                                                                                    function(error){},
                                                                                    function(){}
                                                                                );
                                                                            }
                                                                    },
                                                                    function(tx, error){
                                                                        console.log("Error al guardar cedula: " + error.message);
                                                                        app.preloader.hide();
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    }
                                }
                            }
                        });
                    } else {
                        app.dialog.alert('El campo: Fotograf\u00eda. Es requerido.', 'Aviso');
                        app.preloader.hide();
                    }
                }
            } else {
                app.dialog.alert('Favor de seleccionar un cliente.', 'Aviso');
                app.preloader.hide();
            }
        }
    }
function ObservacionesPe(){
    var icedula = localStorage.getItem("IdCedula");
    var observaciones = $("#Obser").val();
    databaseHandler.db.transaction(
        function(tx1){
            tx1.executeSql(
                "select * from ObservacionesPedido WHERE IdCedula= ?",
                [icedula],
                function(tx1, results){
                    var valor = results.rows.length;
                    if(valor > 0){
                        databaseHandler.db.transaction(
                            function(tx1){
                                tx1.executeSql(
                                    "UPDATE ObservacionesPedido SET Observaciones = ? WHERE IdCedula = ? ",
                                    [observaciones,icedula],
                                    function(tx1, results){
                                        var valor = results.rows.length;
                                        app.preloader.hide();
                                    }
                            )},
                            function(error){},
                            function(){}
                        );
                    }else{
                        databaseHandler.db.transaction(
                            function(tx1){
                                tx1.executeSql(
                                    "INSERT INTO ObservacionesPedido (IdCedula, Observaciones) VALUES (?,?)",
                                    [icedula,observaciones],
                                    function(tx1, results){
                                        var valor = results.rows.length;
                                        app.preloader.hide();
                                    }
                            )},
                            function(error){},
                            function(){}
                        );
                    }
                }
        )},
        function(error){},
        function(){}
    );
}

//imagen
function gimagen(){
    //IMAGEN EN BUEN ESTADO NO PEDIR NADA
    app.preloader.show('blue');
    var file_data = $('#imagenC').val();
    var icedula = localStorage.getItem("IdCedula");
    var tipoimagen = document.getElementById("tipoimagen").value;
    var cantidad = $("#cantidad").val();
    var ubicacion =  $("#ubicacion").val();
    var comentario = $("#comentario").val();
    var radio = $('input[name=demo-radio1]:checked').val();
    app.preloader.hide();
    if(tipoimagen != 0){
        if(radio == 1 || radio == 2){
            if(radio == 1){ //Buen estado
                databaseHandler.db.transaction(
                function(tx1){
                    tx1.executeSql(
                        "INSERT INTO imagen (IdTipoImagen,Cantidad, Ubicacion ,checkbox, Comentario, FotoImagen, IdCedula) VALUES (?,?,?,?,?,?,?)",
                        [tipoimagen, cantidad, ubicacion, radio,comentario, file_data, icedula ],
                        function(tx2, results){
                           //Extraer el ultimo registro
                            databaseHandler.db.transaction(
                            function(tx3){
                                tx3.executeSql(
                                "Select MAX(IdImagen) as Id from imagen",
                                [],
                                function(tx4, results){
                                    var length = results.rows.length;
                                    var item = results.rows.item(0);
                                    var IdCEq = item.Id;
                                    //Consultar el producto
                                    databaseHandler.db.transaction(
                                        function(tx5){
                                            tx5.executeSql(
                                                "Select * from imagen where IdImagen = ?",
                                                [IdCEq],
                                                function(tx5, results){
                                                    var length = results.rows.length;
                                                    var item2 = results.rows.item(0);
                                                    if(item2.IdTipoImagen == 1){ var TipoImagen = "Wallchart"; }
                                                    if(item2.IdTipoImagen == 2){ var TipoImagen = "Etiqueta"; }
                                                    if(item2.IdTipoImagen == 3){ var TipoImagen = "Imagen del cliente"; }
                                                    if(item2.IdTipoImagen == 4){ var TipoImagen = "Carpeta del cliente"; }
                                                    if(item2.IdTipoImagen == 5){ var TipoImagen = "Concentraci&oacute;n de Equipos"; }
                                                    if(item2.IdTipoImagen == 6){ var TipoImagen = "Env&iacute;o de Etiquetas"; }
                                                    if(item2.IdTipoImagen == 7){ var TipoImagen = "Env&iacute;o de FT electr√≥nicas"; }
                                                    if(item2.checkBox == 1){ var Estado ="Imagen en buen estado"; }
                                                    if(item2.checkBox == 2){ var Estado ="Imagen en mal estado"; }
                                                    $("#tablaimagen tbody").append("<tr id='fila"+ item2.IdImagen +"'><td><a href='#' onclick='eliminarFila("+ item2.IdImagen +", 2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></td><td text-align: center;><img src='"+item2.FotoImagen+"' width='60px'/></td><td text-align: center;>" + TipoImagen + "</td><td text-align: center;>" + item2.Cantidad + "</td><td  text-align: center;>"+ item2.Ubicacion+"</td><td  text-align: center;>"+ Estado + "</td><td  text-align: center;>"+ item2.Comentario + "</td></tr>");
                                                    $("#cantidad").val('');
                                                    $("#ubicacion").val('');
                                                    $("#comentario").val('');
                                                    $('#imagenC').val('');

                                                    $("#cantidad").css("background-color", "#ffffff");
                                                    $("#ubicacion").css("background-color", "#ffffff");
                                                    $("#comentario").css("background-color", "#ffffff");
                                                    $("#tipoimagen").css("background-color", "#ffffff");
                                                    document.getElementById("BradioI").checked = false;
                                                    document.getElementById("MradioI").checked = false;

                                                    document.ready = document.getElementById("tipoimagen").value = '0';

                                                    app.preloader.hide();
                                                },
                                                function(tx5, error){
                                                    console.log("Error al guardar registro: " + error.message);
                                                    app.preloader.hide();
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                        //Fin de consulgtar el producto
                                },
                                function(tx4, error){
                                    console.log("Error al guardar registro: " + error.message);
                                }
                            );
                            },
                            function(error){},
                            function(){}
                        ); //FIN DE Extraer el ultimo registro
                           app.dialog.alert('El registro se guardo correctamente.', 'Aviso');
                        },
                        function(tx2, error){
                            console.log("Error al guardar el imagen: " + error.message);

                        }
                    );
                },
                function(error){},
                function(){}
                );
            }else if(radio == 2){ //mal estado
            if(cantidad != ''){
                if(ubicacion != ''){
                    if(comentario != ''){
                        databaseHandler.db.transaction(
                            function(tx1){
                                tx1.executeSql(
                                    "INSERT INTO imagen (IdTipoImagen,Cantidad, Ubicacion ,checkbox, Comentario, FotoImagen, IdCedula) VALUES (?,?,?,?,?,?,?)",
                                    [tipoimagen, cantidad, ubicacion, radio,comentario, file_data, icedula ],
                                    function(tx2, results){
                                       //Extraer el ultimo registro
                                        databaseHandler.db.transaction(
                                        function(tx3){
                                            tx3.executeSql(
                                            "Select MAX(IdImagen) as Id from imagen",
                                            [],
                                            function(tx4, results){
                                                var length = results.rows.length;
                                                var item = results.rows.item(0);
                                                var IdCEq = item.Id;
                                                //Consultar el producto
                                                databaseHandler.db.transaction(
                                                    function(tx5){
                                                        tx5.executeSql(
                                                            "Select * from imagen where IdImagen = ?",
                                                            [IdCEq],
                                                            function(tx5, results){
                                                                var length = results.rows.length;
                                                                var item2 = results.rows.item(0);
                                                                if(item2.IdTipoImagen == 1){ var TipoImagen = "Wallchart"; }
                                                                if(item2.IdTipoImagen == 2){ var TipoImagen = "Etiqueta"; }
                                                                if(item2.IdTipoImagen == 3){ var TipoImagen = "Imagen del cliente"; }
                                                                if(item2.IdTipoImagen == 4){ var TipoImagen = "Carpeta del cliente"; }
                                                                if(item2.IdTipoImagen == 5){ var TipoImagen = "Concentraci&oacute;n de Equipos"; }
                                                                if(item2.IdTipoImagen == 6){ var TipoImagen = "Env&iacute;o de Etiquetas"; }
                                                                if(item2.IdTipoImagen == 7){ var TipoImagen = "Env&iacute;o de FT electr√≥nicas"; }
                                                                if(item2.checkBox == 1){ var Estado ="Imagen en buen estado"; }
                                                                if(item2.checkBox == 2){ var Estado ="Imagen en mal estado"; }
                                                                $("#tablaimagen tbody").append("<tr id='fila"+ item2.IdImagen +"'><td><a href='#' onclick='eliminarFila("+ item2.IdImagen +", 2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></td><td text-align: center;><img src='"+item2.FotoImagen+"' width='60px'/></td><td text-align: center;>" + TipoImagen + "</td><td text-align: center;>" + item2.Cantidad + "</td><td  text-align: center;>"+ item2.Ubicacion+"</td><td  text-align: center;>"+ Estado + "</td><td  text-align: center;>"+ item2.Comentario + "</td></tr>");
                                                                $("#cantidad").val('');
                                                                $("#ubicacion").val('');
                                                                $("#comentario").val('');
                                                                $('#imagenC').val('');

                                                                $("#cantidad").css("background-color", "#ffffff");
                                                                $("#ubicacion").css("background-color", "#ffffff");
                                                                $("#comentario").css("background-color", "#ffffff");
                                                                $("#tipoimagen").css("background-color", "#ffffff");
                                                                document.getElementById("BradioI").checked = false;
                                                                document.getElementById("MradioI").checked = false;
                                                                document.ready = document.getElementById("tipoimagen").value = '0';
                                                                app.preloader.hide();
                                                            },
                                                            function(tx5, error){
                                                                console.log("Error al guardar registro: " + error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                                    //Fin de consulgtar el producto
                                            },
                                            function(tx4, error){
                                                console.log("Error al guardar registro: " + error.message);
                                            }
                                        );
                                        },
                                        function(error){},
                                        function(){}
                                    ); //FIN DE Extraer el ultimo registro
                                       app.dialog.alert('El registro se guardo correctamente.', 'Aviso');
                                    },
                                    function(tx2, error){
                                        console.log("Error al guardar el imagen: " + error.message);

                                    }
                                );
                            },
                            function(error){},
                            function(){}
                            );
                    } else {
                        app.dialog.alert('El campo: Comentario. Es requerido.', 'Aviso');
                        app.preloader.hide();
                    }
                } else {
                    app.dialog.alert('El campo: Ubicacion. Es requerido.', 'Aviso');
                    app.preloader.hide();
                }
            }else {
                app.dialog.alert('El campo: Cantidad. Es requerido.', 'Aviso');
                app.preloader.hide();
            }
            }
        }else {
            app.dialog.alert('Favor de seleccionar en que estado se encuentra. Es requerido.', 'Aviso');
            app.preloader.hide();
        }
    } else {
        app.dialog.alert('El campo: Tipo. Es requerido.', 'Aviso');
        app.preloader.hide();
    }

}
//entrenamiento
function gentrenamiento(){
    app.preloader.show('blue');
    var icedula = localStorage.getItem("IdCedula");
    var file_data = $('#imagenC').val();
    var personaCapacitada = $("#personaCapacitada").val();
    var puesto  = $("#puesto").val();
    var temaCapacitacion = $("#temaCapacitacion").val()
    var comentario = $("#comentario").val();
    var TipoCapacitacion = document.getElementById("TipoCapacitacion").value;

    if(TipoCapacitacion != 0) {
        if($("#personaCapacitada").val() != '' ){
            if($("#puesto").val() != ''){
                if($("#temaCapacitacion").val() != ''){
                    if($("#comentario").val() != ''){
                            databaseHandler.db.transaction(
                                function(tx1){
                                    tx1.executeSql(
                                        "INSERT INTO entrenamiento (IdCedula,PersonaCapacitada, Puesto, TemaCapacitacion, Comentario, ImagenFirma, Tipo) VALUES (?,?,?,?,?,?,?)",
                                        [icedula, personaCapacitada, puesto, temaCapacitacion, comentario, file_data, TipoCapacitacion ],
                                        function(tx2, results){
                                           //Extraer el ultimo registro
                                            databaseHandler.db.transaction(
                                            function(tx3){
                                                tx3.executeSql(
                                                    "Select MAX(IdEntrenamiento) as Id from entrenamiento",
                                                    [],
                                                    function(tx4, results){
                                                        var length = results.rows.length;
                                                        var item = results.rows.item(0);
                                                        var IdCEq = item.Id;
                                                        //Consultar el producto
                                                        databaseHandler.db.transaction(
                                                            function(tx5){
                                                                tx5.executeSql(
                                                                    "Select * from entrenamiento where IdEntrenamiento = ?",
                                                                    [IdCEq],
                                                                    function(tx5, results){
                                                                        var length = results.rows.length;
                                                                        var item2 = results.rows.item(0);
                                                                        app.dialog.alert('El registro se guardo correctamente.', 'Aviso');
                                                                        $("#personaCapacitada").val('');
                                                                        $("#puesto").val('');
                                                                        $("#temaCapacitacion").val('');
                                                                        $("#smallImage").attr("src","img/blank.png");
                                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                                        $("#comentario").val('');
                                                                        $('#imagenC').val('');
                                                                        if(item2.Tipo == 1){
                                                                            var TipoCap = "Capacitacion en linea";
                                                                        }
                                                                        if(item2.Tipo == 2){
                                                                            var TipoCap = "Capacitacion presencial";
                                                                        }
                                                                        $("#tablaE tbody").append("<tr id='fila"+ item2.IdEntrenamiento +"'><td><a href='#' onclick='eliminarFila("+ item2.IdEntrenamiento +", 3);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item2.ImagenFirma+"' width='60px'/></td><td text-align: center;>" + TipoCap + "</td><td text-align: center;>" + item2.PersonaCapacitada+ "</td><td text-align: center;>" + item2.Puesto + "</td><td text-align: center;>" + item2.TemaCapacitacion + "</td><td text-align: center;>" + item2.Comentario + "</td></tr>");
                                                                        $("#personaCapacitada").css("background-color", "#FFFFFF");
                                                                        $("#puesto").css("background-color", "#FFFFFF");
                                                                        $("#temaCapacitacion").css("background-color", "#FFFFFF");
                                                                        $("#comentario").css("background-color", "#FFFFFF");
                                                                        app.preloader.hide();

                                                                    },
                                                                    function(tx5, error){
                                                                        console.log("Error al guardar registro: " + error.message);
                                                                        app.preloader.hide();
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                        //Fin de consulgtar el producto
                                                    },
                                                    function(tx4, error){
                                                        console.log("Error al guardar registro: " + error.message);
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                            ); //FIN DE Extraer el ultimo registro
                                        },
                                        function(tx2, error){
                                            console.log("Error al guardar el imagen: " + error.message);
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );

                    } else{
                        app.dialog.alert('El campo: Comentario. Es requerido.', 'Aviso');
                        app.preloader.hide();
                    }
                } else{
                    app.dialog.alert('El campo: Tema capacitaci\u00f3n. Es requerido.', 'Aviso');
                    app.preloader.hide();
                }
            } else{
               app.dialog.alert('El campo: Puesto. Es requerido.', 'Aviso');
               app.preloader.hide();
            }
        }else{
            app.dialog.alert('El campo: Persona capacitada. Es requerido.', 'Aviso');
            app.preloader.hide();
        }
    }else{
        app.dialog.alert('Favor de seleccionar un tipo de capacitacion.', 'Aviso');
        app.preloader.hide();
    }
}

//Pantalla vertical
function vertical(){
    screen.orientation.lock('portrait');
    screen.orientation.unlock();
}
//Pantalla horizontal
function landsca(){
    screen.orientation.lock('landscape');
    //screen.orientation.unlock();
}
// Cerrar Popup
function gClose(){
    screen.orientation.lock('portrait');
    screen.orientation.unlock();
}
var testFirma;

function createFirma(){
    screen.orientation.lock('landscape');
    var signaturePad = new SignaturePad(document.getElementById('signature-pad'), {
      backgroundColor: 'rgba(255, 255, 255, 0)',
      penColor: 'rgb(6, 62, 127)'
    });
    testFirma = signaturePad;
}
function gfirma(){
    var signaturePad = testFirma;
    var data = signaturePad.toDataURL('data:image/jpeg;base64,');
    screen.orientation.lock('portrait');
    screen.orientation.unlock();
    $("#signate").val(data);
    $('#ImagenFirmaView').attr('src', data);
    $('#VolverFirmar').html("Evidencia");
    var fecha = new Date();
    var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate();
    var hora_firma = fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
    var geo = $('#geolocation').val();
    var firma = geo + "|" + fecha_firma + "|" +hora_firma
    const firmaEn = window.btoa(geo + "|" + fecha_firma + "|" +hora_firma)
    $("#firmaElectro2").html(`<span style="color: gray;font-style: italic;">|${firma}|f-${firmaEn}-</span>`)
}
function gFotoFirmaServ(){
    var data2 = $('#imgSigPhoto').val();
    $("#signate").val(data2);
    $("#imgSigPhoto").val(data2);
    app.popup.close()
    app.popup.open(".popup-encuesta")
    screen.orientation.lock('portrait');
    screen.orientation.unlock();
    $('#ImagenFirmaView').attr('src', data2);
 }

function cleanFirma(){
    var signaturePad = testFirma;
    signaturePad.clear();
}

// Tomar foto firma
function capturaFirma() {
    var camera = localStorage.getItem("camera");
        if(camera == 0){
          var camera = app.popup.create({
            content: `
            <div class="popup" id="camera">
                <div class="app">
                <div id="deviceready camera-Field-frame">
                    <div class="top"></div>
                    <canvas id="camera-frame" style="display: none;"></canvas>
                    <video id="camera-view" autoplay playsinline class="raster" style="display: none;"></video>
                    <img src="" id="phototaked">
                    <div class="camera">
                        <div class="take" id="take" onclick="onTake()">
                            <div class="bubble-take"></div>
                        </div>
                        <div class="select popup-close" id="select" style="display: none;" onClick="onDone()"><img id="img-select" src="img/validar_camera.svg"></div>
                    </div>
                    <div class="left-action">
                        <div class="cancel popup-close" id="cancelCamera" onClick="onCancelCamera()"><img class="image-cancel" src="img/cerrar_camera.svg"></div>
                        <div class="cancel" id="cancelPicure" onClick="onCancelPicture()"><img class="image-cancel" src="img/cerrar_camera.svg"></div>
                    </div>
                    <div class="actions">
                        <div class="action torch" id="torch" onClick="onTorch()"><img id="flash" src="img/flash_off.svg" width="30px"></div>
                        <div class="action rotate-right" id="rotateRight" onClick="onRotateRight()" style="display:none"><img id="flash" src="img/rotate-right.svg" width="30px"></div>
                        <div class="action rotate-left" id="rotateLeft" onClick="onRotateLeft()" style="display:none"><img id="flash" src="img/rotate-left.svg" width="30px"></div>
                    </div>
                    <div class="right-action">
                        <div class="switch" id="switch" onClick="onSwitch()"><img class="image-switch" src="img/flip.svg"></div>
                    </div>
                    <audio id="audio" controls style="display: none;">
                        <source type="audio/mp3" src="img/camera.mp3">
                    </audio>
                    <input type="hidden" id="deviceOrientation" name="deviceOrientation"/>
                </div>
                <fwm></fwm>
                </div>
            </div>
        `,
        on: {
            open: function (popup) {
                var permissions = cordova.plugins.permissions;
                permissions.checkPermission(permissions.CAMERA, function( status ){
                    if (status.hasPermission){
                        cargarEmpresa(`./js/camera-field.js`, empresaCargada);
                        function empresaCargada(){
                            cameraStart(onPhotoSingSuccess)
                        }
                        function cargarEmpresa(url, callback){
                            var pie = document.getElementsByTagName('fwm')[0];
                            var script = document.createElement('script');
                            script.type = 'text/javascript';
                            script.src = url;
                            script.id = "cameraSource";
                            script.onload = callback;
                            pie.appendChild(script);
                        }
                    }else{
                        permissions.requestPermission(permissions.CAMERA, success, error);
                        function error() {
                            app.sheet.close('.popup')
                            swal("Field Requiere los permisos","Para poder tomar las evidencias fotograficas necesitamos el permiso.","warning");
                        }
                        function success( status ){
                            if(!status.hasPermission){
                                error();
                            } else {
                                cargarEmpresa(`./js/camera-field.js`, empresaCargada);
                                function empresaCargada(){
                                    cameraStart(onPhotoSingSuccess)
                                }
                                function cargarEmpresa(url, callback){
                                    var pie = document.getElementsByTagName('fwm')[0];
                                    var script = document.createElement('script');
                                    script.type = 'text/javascript';
                                    script.src = url;
                                    script.id = "cameraSource";
                                    script.onload = callback;
                                    pie.appendChild(script);
                                }
                            }

                        }
                    }
                });
            },
            opened: function (popup) {
              localStorage.setItem("cameraField", "Active");
            },
            closed: function (popup) {
              window.localStorage.removeItem("cameraField");
            },
        }
            });
            camera.open();
        } else {
          navigator.camera.getPicture(onPhotoSingSuccess,onFail, {
              quality: 100,
              destinationType: destinationType.DATA_URL,
              targetWidth: 500,
              targetHeight: 500,
              correctOrientation: true
          });
        }
    $('#FotoYaLLegue').attr('src', "img/camara.png");
}
// Funcion si se logra tomar la foto a la firma
function onPhotoSingSuccess(imageData) {
    var camera = localStorage.getItem("camera");
      if(camera == 0){
        var smallImage = document.getElementById('smallImage');
        smallImage.style.display = 'flex';
        var nameima = imageData;
        smallImage.src = imageData;
        $('#imgSigPhoto').val(nameima);
        $("#photoIcon").attr("src","img/reload.svg");
      }else{
        var smallImage = document.getElementById('smallImage');
        smallImage.style.display = 'flex';
        var nameima = "data:image/jpeg;base64," + imageData;
        smallImage.src = "data:image/jpeg;base64," + imageData;
        $('#imgSigPhoto').val(nameima);
        $("#photoIcon").attr("src","img/reload.svg");
      }
}

// Guarda la fotografia de la firma tomada
function gFotoFirma(){
    var data2 = $('#imgSigPhoto').val();
    $("#signate").val(data2);
    $("#imgSigPhoto").val(data2);
    screen.orientation.lock('portrait');
    screen.orientation.unlock();
    $('#ImagenFirmaView').attr('src', data2);
    var fecha = new Date();
    var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate();
    var hora_firma = fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
    var geo = $('#geolocation').val();
    var firma = geo + "|" + fecha_firma + "|" +hora_firma
    const firmaEn = window.btoa(geo + "|" + fecha_firma + "|" +hora_firma)
    $("#firmaElectro2").html(`<span style="color: gray;font-style: italic;">|${firma}|f-${firmaEn}-</span>`)
 }

//CIERRE
function gcierre(){
    app.preloader.show('blue');
    var IdCte = localStorage.getItem("IdCte");
    var IdCed = localStorage.getItem("IdCedula");
    var file_data = $('#signate').val();
    var estre = $("#eval").val();
    var ccte = $("#text2").val();
    var envio = $('input[name="estado"]:checked').val();
    var geo = $("#geolocation").val();
    var NombreFirma = $("#NombreFirma").val();

    var NombreCuenta = $("#NombreCuenta").val();
    var CorreoCuenta = $("#CorreoCuenta").val();

    var nombre = document.getElementById('cli').innerHTML;
    var ArCadena = nombre.split(' ');
    var cliente = ArCadena[0];
    var ClienteMin = cliente.toLowerCase();

    databaseHandler.db.transaction(
        function(tx1){
            tx1.executeSql(
                "SELECT IdCedula FROM cierre WHERE IdCedula = ?",
                [IdCed],
                function(tx1, results){
                    var length = results.rows.length;

                    if(length > 0){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql(
                                    "UPDATE cierre SET eval = ?,cfirma = ?,coment = ?,NombreFirma = ?, NombreCuenta = ?, CorreoCuenta = ? WHERE IdCedula = ?",
                                    [estre,file_data,ccte,NombreFirma,NombreCuenta,CorreoCuenta,IdCed],
                                    function(tx, results){
                                        $("#adios").html("<input type='hidden' id='imagenC' name='imagenC'/><span style='font-weight: bold; color: #00A7B5;'>Hora de T√©rmino</span><br/><br/><center><div style='background-color: white;border-radius: 20px;width: 147.76px;height: 147.76px;border: solid 3px #00A7B5;'><a href='#' onclick='capturePhoto();'><img src='img/camera.svg' id='photoIcon' width='45px' style='position: absolute;position: fixed;z-index: 100;margin-top: 50px; position: relative;'/></a></div></center><input type='image' name='smallImage' style='margin: 0px auto; width: 147.76px; height: 147.76px; border-radius: 17px; display: none; margin-top: -150.65px;' id='smallImage' src='' /><br><br><label style='font-size: 12px;'><strong>Comentario de la calificaci√≥n:</strong></label><center><textarea rows='5' style='color: grey;' disabled>"+ ccte +"</textarea></center><br><br><a href='#' onclick='gcierref();' style='border: none; outline:none;'><img src='img/save2.png' width='50px' /></a>");
                                        app.preloader.hide();
                                        app.preloader.hide();
                                    },
                                    function(tx, error){
                                        console.log("add client error: " + error.message);
                                        app.dialog.alert('Error al enviar..', 'Error');
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }else{
                        if(estre == 0){
                             app.dialog.alert('Favor de evaluar la visita.', 'Importante');
                             app.preloader.hide();
                        }else if(estre == 1 || estre ==2 || estre ==3 || (ClienteMin == 'dominos')){
                            if(ccte == ''){
                               app.dialog.alert('Favor de colocar sus comentarios.', 'Importante');
                               app.preloader.hide();
                            }  else {
                                databaseHandler.db.transaction(
                                    function(tx1){
                                        tx1.executeSql(
                                            "INSERT INTO cierre (IdCedula,eval,cfirma,geolocalizacion,Solestado,coment,NombreFirma,NombreCuenta,CorreoCuenta) VALUES (?,?,?,?,?,?,?,?,?)",
                                            [IdCed,estre,file_data,geo,envio,ccte,NombreFirma,NombreCuenta,CorreoCuenta],
                                            function(tx1, results){

                                                $('.icon-back').remove();
                                                $('.back').remove();
                                                $("#adios").html("<input type='hidden' id='imagenC' name='imagenC'/><span style='font-weight: bold; color: #00A7B5;'>Hora de T√©rmino</span><br /><br /><center><div style='background-color: white;border-radius: 20px;width: 147.76px;height: 147.76px;border: solid 3px #00A7B5;'><a href='#' onclick='capturePhoto();'><img src='img/camera.svg' id='photoIcon' width='45px' style='position: absolute;position: fixed;z-index: 100;margin-top: 50px; position: relative;'></a></div></center><input type='image' name='smallImage' style='margin: 0px auto; width: 147.76px; height: 147.76px; border-radius: 17px; display: none; margin-top: -150.65px;' id='smallImage' src='' /><br><br><label style='font-size: 12px;'><strong>Comentario de la calificaci√≥n:</strong></label><center><textarea rows='5' style='color: grey;' disabled>"+ ccte +"</textarea></center><br><br><a href='#' onclick='gcierref();' style='border: none; outline:none;'><img src='img/save2.png' width='50px' /></a>");
                                                app.preloader.hide();
                                                 $("#signate").val("");
                                            },
                                            function(tx1, error){
                                                console.log("add client error: " + error.message);
                                                app.preloader.hide();
                                            }
                                        );
                                    }
                                    );
                                }
                            }else {
                                databaseHandler.db.transaction(
                                    function(tx1){
                                        tx1.executeSql(
                                            "INSERT INTO cierre (IdCedula,eval,cfirma,geolocalizacion,Solestado,coment,NombreFirma,NombreCuenta,CorreoCuenta) VALUES (?,?,?,?,?,?,?,?,?)",
                                            [IdCed,estre,file_data,geo,envio,ccte,NombreFirma,NombreCuenta,CorreoCuenta],
                                            function(tx1, results){

                                                $('.icon-back').remove();
                                                $('.back').remove();
                                                $("#adios").html("<input type='hidden' id='imagenC' name='imagenC'/><span style='font-weight: bold; color: #00A7B5;'>Hora de T√©rmino</span><br /><br /><center><div style='background-color: white;border-radius: 20px;width: 147.76px;height: 147.76px;border: solid 3px #00A7B5;'><a href='#' onclick='capturePhoto();'><img src='img/camera.svg' id='photoIcon' width='45px' style='position: absolute;position: fixed;z-index: 100;margin-top: 50px; position: relative;'/></a></div></center><input type='image' name='smallImage' style='margin: 0px auto; width: 147.76px; height: 147.76px; border-radius: 17px; display: none; margin-top: -150.65px;' id='smallImage' src='' /><br><br><label style='font-size: 12px;'><strong>Comentario de la calificaci√≥n:</strong></label><center><textarea rows='5' style='color: grey;' disabled>"+ ccte +"</textarea></center><br><br><a href='#' onclick='gcierref();' style='border: none; outline:none;'><img src='img/save2.png' width='50px' /></a>");
                                                app.preloader.hide();
                                            },
                                            function(tx1, error){
                                                console.log("add client error: " + error.message);
                                                app.preloader.hide();
                                            }
                                        );
                                    }
                                    );
                            }
                    }
                },
                function(tx1, error){
                    console.log("add client error: " + error.message);
                    app.preloader.hide();
                }
            );
        }
    );
}
//CIERRE 2DA PARTE
function gcierref(){
    app.preloader.show('blue');
    var IdCte = localStorage.getItem("IdCte");
    var IdCed = localStorage.getItem("IdCedula");
    var imgF = $("#imagenC").val();
    var file_data = $('#imagenC').val();
    var env = 1;
    var fecha = new Date();
    var fFinal = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
    //VALIDACION DE CAMPOS
    if(file_data != ''){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql(
                    "UPDATE cierre SET fcierre = ?, envio = ?, FechaCierre = ? WHERE IdCedula = ?",
                    [ imgF, env , fFinal ,IdCed ],
                    function(tx, results){
                        app.dialog.alert('El registro se guardo correctamente.', 'Aviso');
                        window.localStorage.removeItem("IdCedula");
                        window.localStorage.removeItem("IdCte");
                        window.localStorage.removeItem("IdInventario");
                        app.preloader.hide();
                        window.location.href = "./menu.html";
                        app.preloader.hide();
                    },
                    function(tx, error){
                        console.log("add client error: " + error.message);
                        app.dialog.alert('Error al enviar..', 'Error');
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }else{
        app.dialog.alert('El campo: Fotograf\u00eda. Es requerido.', 'Aviso');
        app.preloader.hide();
    }
}

function verpdf(IdCte, IdCed, TipoC) {
    var id_empresa = localStorage.getItem("id_empresa");
    if (TipoC == "levantamiento" || TipoC == "mantenimiento") {
        localStorage.setItem("IdBennetts", IdCed);
        localStorage.setItem("TipoCedula", TipoC);
        app.views.main.router.navigate({
            name: "visualizar",
        });
    } else if (TipoC == "sanitizacion") {
        app.views.main.router.navigate({
            name: "visualizars",
            params: { IdCte: IdCte, IdCed: IdCed },
        });
    } else if (TipoC == "fumigacion") {
        app.views.main.router.navigate({
            name: "visualizarf",
            params: { IdCte: IdCte, IdCed: IdCed },
        });
    } else if (TipoC == "baja") {
        localStorage.setItem("IdBennetts", IdCed);
        app.views.main.router.navigate({
            name: "visualizar",
        });
    } else if (TipoC == "reporteTecnico" || TipoC == "minutaCoordinador") {
        localStorage.setItem("IdBennetts", IdCed);
        localStorage.setItem("TipoCedula", TipoC);
        app.views.main.router.navigate({
            name: "visualizar",
        });
    } else if(TipoC == "sanitizacionSURO"){
        localStorage.setItem("IdBennetts", IdCed);
        localStorage.setItem("TipoCedula", TipoC);
        app.views.main.router.navigate({
            name: "visualizar",
        });
    } else if(TipoC == "General"){
        localStorage.setItem("IdBennetts", IdCed);
        localStorage.setItem("TipoCedula", TipoC);
        app.views.main.router.navigate({name: "visualizar"});
    } else if(TipoC == "Checklist"){
        localStorage.setItem("IdBennetts", IdCed);
        localStorage.setItem("TipoCedula", TipoC);
        app.views.main.router.navigate({name: "visualizar"});
    } else if(TipoC == "AuditoriaTecnico" || TipoC == "AuditoriaSupervisorTecnico" || TipoC == "AuditoriaLider"){
        localStorage.setItem("IdBennetts", IdCed);
        localStorage.setItem("TipoCedula", TipoC);
        app.views.main.router.navigate({name: "visualizar"});
    } else if(TipoC == "ventaSMC" || TipoC == "servicioSMC"){
        localStorage.setItem("IdBennetts", IdCed);
        localStorage.setItem("TipoCedula", TipoC);
        app.views.main.router.navigate({name: "visualizar"});
    } else if (TipoC == "ApoyoVIC" || TipoC == "VIC") {
        localStorage.setItem("IdBennetts", IdCed);
        localStorage.setItem("TipoCedula", TipoC);
        app.views.main.router.navigate({
            name: "visualizar",
        });
    } else if (TipoC == "visitaDilimpio" || TipoC == "Entregas") {
        localStorage.setItem("IdBennetts", IdCed);
        localStorage.setItem("TipoCedula", TipoC);
        app.views.main.router.navigate({
            name: "visualizar",
        });
    } else if (TipoC == "Reposicion" || TipoC == "Correctivo" || TipoC == "Instalacion" ||TipoC == "Preventivo") {
        localStorage.setItem("IdBennetts", IdCed);
        localStorage.setItem("TipoCedula", TipoC);
        app.views.main.router.navigate({
            name: "visualizar", 
        });
    }
  }
  

function clientSelected(clientName){
    var mes = $("#month").val();
    localStorage.setItem("id_cliente",clientName);
    localStorage.setItem("mes_detalle",mes);
    app.views.main.router.navigate({name: 'verVisita'});
}
function clientSelected2(clientName,fecha){
    let fechaDetalle = fecha.split("-");
    localStorage.setItem("id_cliente",clientName);
    localStorage.setItem("year_detalle",fechaDetalle[0]);
    localStorage.setItem("month_detalle",fechaDetalle[1]);
    localStorage.setItem("day_detalle",fechaDetalle[2]);    
    app.views.main.router.navigate({name: 'calendar-page'});
}
//metodo regresar
function regresar(){
     window.location.href = "./menu.html";
     screen.orientation.lock('portrait');
}
function sumarDias(fecha, dias){
    var fecha = new Date();
    fecha.setDate(fecha.getDate() + dias);
    var options = { year: "numeric", month: "numeric", day: "numeric" };
    return fecha.toLocaleDateString( fecha.getTimezoneOffset(), options );
}

function regresarRecorrido(){
    app.views.main.router.back('/recorrido/', {force: true, ignoreCache: true, reload: true});
}
function regresarRecorrido2(){
    app.views.main.router.back('/recorrido2/', {force: true, ignoreCache: true, reload: true});
}
function regresarRecorrido3(){
    app.views.main.router.back('/recorrido3/', {force: true, ignoreCache: true, reload: true});
}
function regresarRecorridoSEG(){
    app.views.main.router.back('/recorridoseg/', {force: true, ignoreCache: true, reload: true});
}
function regresarRecorridoSMC1(){
    app.views.main.router.back('/recorridoSMC1/', {force: true, ignoreCache: true, reload: true});
}
function regresarRecorridoSMC2(){
    app.views.main.router.back('/recorridoSMC2/', {force: true, ignoreCache: true, reload: true});
}
function regresarRecorridoSMC3(){
    app.views.main.router.back('/recorridoSMC3/', {force: true, ignoreCache: true, reload: true});
}
function regresarRecorridoSMC4(){
    app.views.main.router.back('/recorridoSMC4/', {force: true, ignoreCache: true, reload: true});
}
function regresarRecorridoDIPREC1(){
    app.views.main.router.back('/recorridoDIPREC1/', {force: true, ignoreCache: true, reload: true});
}
function regresarRecorridoDIPREC2(){
    app.views.main.router.back('/recorridoDIPREC2/', {force: true, ignoreCache: true, reload: true});
}
function regresarRecorridoDIPREC3(){
    app.views.main.router.back('/recorridoDIPREC3/', {force: true, ignoreCache: true, reload: true});
}
function regresarBennetts(){
    app.views.main.router.back('/menuBennetts/', {force: true, ignoreCache: true, reload: true});
}
function regresarBennetts2(){
    app.views.main.router.back('/recorridoBennetts2/', {force: true, ignoreCache: true, reload: true});
}
function regresarRecorridoServInd1(){
    app.views.main.router.back('/recorridoServ1/', {force: true, ignoreCache: true, reload: true});
}
function regresarRecorridoServInd2(){
    app.views.main.router.back('/recorridoServ2/', {force: true, ignoreCache: true, reload: true});
}
function regresarRecorridoMer1(){
    app.views.main.router.back('/recorridoMerGroup/', {force: true, ignoreCache: true, reload: true});
}
function regresarRecorridoSURO1(){
    app.views.main.router.back('/recorridoSURO1/', {force: true, ignoreCache: true, reload: true});
}
function regresarRecorridoSURO2(){
    app.views.main.router.back('/recorridoSURO2/', {force: true, ignoreCache: true, reload: true});
}
function regresarRecorridoSURO3(){
    app.views.main.router.back('/recorridoSURO3/', {force: true, ignoreCache: true, reload: true});
}
function regresarRecorridoSURO4(){
    app.views.main.router.back('/recorridoSURO4/', {force: true, ignoreCache: true, reload: true});
}
function regresarRecorridoSURO5(){
    app.views.main.router.back('/recorridoSURO5/', {force: true, ignoreCache: true, reload: true});
}
function horizontal(){
    screen.orientation.lock('landscape');
}

function Results(){
    $( "#Resultados" ) .show( "fast");
    $( "#LimSani" )    .hide( "fast");
    $( "#ManAli" )     .hide( "fast");
    $( "#higPerso" )   .hide( "fast");
    $( "#ContTemp" )   .hide( "fast");
    $( "#ContPlag" )   .hide( "fast");
    var valCheckuno = document.getElementById("uno").checked;
  //  alert(valCheckuno);
    var valCheckdos = document.getElementById("dos").checked;
  //  alert(valCheckdos);
    if(valCheckuno == true){var n1 = 10;}
    if(valCheckdos == true){ var n2 = 10;}

    var suma = parseInt(n1) + parseInt(n2);
   // alert("La suma es: "+suma);
    $("#res").html("<span>La suma es: "+suma+"</span");
}

function limpiar(){
    $("#NombreRecibe").val("");
    $("#PuestoRecibe").val("");
    $("#Telefono").val("");
    $("#Correo").val("");
    $("#NombreRecibe").css("background-color", "#ffffff");
    $("#PuestoRecibe").css("background-color", "#ffffff");
    $("#Telefono").css("background-color", "#ffffff");
    $("#Correo").css("background-color", "#ffffff");
}

function editar_fecha(fecha, intervalo, dma, separador) {
    var separador = separador || "-";
    var arrayFecha = fecha.split(separador);
    var dia = arrayFecha[2];
    var mes = arrayFecha[1];
    var anio = arrayFecha[0];

    var fechaInicial = new Date(anio, mes - 1, dia);
    var fechaFinal = fechaInicial;
    if(dma=="m" || dma=="M"){
      fechaFinal.setMonth(fechaInicial.getMonth()+parseInt(intervalo));
    }else if(dma=="y" || dma=="Y"){
      fechaFinal.setFullYear(fechaInicial.getFullYear()+parseInt(intervalo));
    }else if(dma=="d" || dma=="D"){
      fechaFinal.setDate(fechaInicial.getDate()+parseInt(intervalo));
    }else{
       return fecha;
    }
    dia = fechaFinal.getDate();
    mes = fechaFinal.getMonth() + 1;
    anio = fechaFinal.getFullYear();
    dia = (dia.toString().length == 1) ? "0" + dia.toString() : dia;
    mes = (mes.toString().length == 1) ? mes.toString() : mes;
    return anio + "-" + mes + "-" + dia;
}

function storageImages(valor){
   var imagen = $("#imagenC"+ valor).val();
   localStorage.setItem("imagenC"+ valor, imagen);
}

function gdatos(){
    var emblechicos = $("#emblechicos").val();
    localStorage.setItem("emblechicos", emblechicos);
    var emblegrandes = $("#emblegrandes").val();
    localStorage.setItem("emblegrandes", emblegrandes);
}